//>>built
require({cache:{"xideve/types":function(){define(["xide/types","xide/utils"],function(q,A){A.mixin(q,{VE_LAYOUT_RIGHT_CENTER_BOTTOM:"VE_LAYOUT_RIGHT_CENTER_BOTTOM",VE_LAYOUT_CENTER_BOTTOM:"VE_LAYOUT_CENTER_BOTTOM",VE_LAYOUT_CENTER_RIGHT:"VE_LAYOUT_CENTER_RIGHT",VE_LAYOUT_LEFT_CENTER_RIGHT:"VE_LAYOUT_LEFT_CENTER_RIGHT",VE_LAYOUT_LEFT_CENTER_RIGHT_BOTTOM:"VE_LAYOUT_LEFT_CENTER_RIGHT_BOTTOM"});A.mixin(q.EVENTS,{WIDGET_PROPERTIES_RENDERED:"OnWidgetPropertiesRendered",WIDGET_PROPERTY_RENDERED:"onWidgetPropertyRendered",
ON_SET_WIDGET_PROPERTY_ACTIONS:"onSetWidgetPropertyActions",ON_GET_LOADER_PACKAGES:"onGetLoaderPackages",ON_VISUAL_EDITOR_SAVE:"onVisualEditorSave",ON_BUILD_HEADER:"onBuildHeader",ON_BUILD_DOJO_CONFIG:"onBuildDojoConfig",ON_SET_DOJO_URL:"onSetDojoUrl",ON_SET_SOURCE_DATA:"onSetSourceData",ON_EVENT_SELECTION_RENDERED:"onEventSelectionRendered",ON_WIDGET_PROPERTY_CHANGED:"onWidgetPropertyChanged",ON_LIBRARY_CONTAINER_CREATED:"onLibraryContainerCreated",ON_CONTEXT_READY:"onContextReady",ON_CONTEXT_DESTROYED:"onContextDestroyed",
ON_BUILD_WIDGET_BLOCK_LIBRARY:"onBuildWidgetBlockLibrary",ON_SHOW_BLOCK_SMART_INPUT:"onShowBlockSmartInput",ON_WIDGET_CHANGED:"onWidgetChanged"});return q})},"xideve/views/VisualEditor":function(){define("dcl/dcl dojo/dom-construct dojo/Deferred dojo/promise/all require xide/layout/ContentPane xide/layout/_Accordion xide/utils xide/types xide/factory davinci/ve/PageEditor davinci/Runtime davinci/Workbench dojo/_base/connect dojo/dom-class davinci/ve/metadata davinci/ve/views/SwitchingStyleView xideve/views/OutlineView xideve/views/OutlineGridView xide/registry xide/layout/_TabContainer xideve/views/VisualEditorSourceEditor xideve/views/VisualEditorLayout xideve/views/VisualEditorAction xideve/views/VisualEditorTools xaction/Action davinci/ve/widget xide/editor/Default xide/_base/_Widget xide/mixins/ReloadMixin xblox/model/html/SetStyle xblox/model/html/SetCSS xblox/model/html/SetState wcDocker/splitter xdocker/Splitter2 wcDocker/types xideve/palette/Palette".split(" "),
function(q,A,m,n,d,g,l,h,w,J,C,a,c,I,v,k,y,D,e,b,r,G,N,E,L,H,t,R,P,x,S,u,V,z,B,W,Y){q=q([P,G,N,E,L,x.dcl],{updateFrame:function(){var b=this.getEditorContext();if(!b||!b.isResizing){var e=this.editor,a=this.getFrame(),c=this;a&&!a._followTimer&&(a._followTimer=setInterval(function(){var b=e._designCP.containerNode,p=$(a),r=$(b),D=r.offset(),b=D.top,D=D.left,k=c.getEditorContext();k&&$(k.rootNode);var v=k?$(k.getDocumentElement().getChildElement("body")):null,k=r.css("width"),r=r.css("height"),E=!1,
y=!1;if(v){v.inlineStyle("max-width");v.inlineStyle("max-height");var G=v.inlineStyle("width");G&&(y=G);(v=v.inlineStyle("height"))&&(E=v)}$(p).css("display",c._hidden?"none":"block");if(0!=b||0!=D)p.css("top",b),p.css("left",D),"none"!==k&&(p.css("width",k),p.css("height",r),b=$(c.getEditorContext().rootNode),p.css("width",k),p.css("height",r),E&&b.css("height",E),y&&b.css("width",y),E||y||(b.css("width",k),b.css("height",r)))},500))}},doSplit:function(b){var e=this.getPageEditor(),a=e.getSourcePane(),
e=e.getSourcePane(),a=a.getSplitter(),e=e.getSplitter();switch(b){case w.VIEW_SPLIT_MODE.DESIGN:console.error("splitter ",e);console.error("splitter ",a);e&&(e.isCollapsed()?e.expand():e.collapse(0,.9));break;case w.VIEW_SPLIT_MODE.SOURCE:e._pane[0].collapsed=!0,e._pane[1].collapsed=!1,e&&(e.isCollapsed()?e.expand():e.collapse(1,.1))}},menuOrder:{File:110,Edit:100,View:90,Widget:80,Block:50,Settings:20,Navigation:10,Step:5,New:4,Window:1},declaredClass:"xideve/views/VisualEditor",templateString:"\x3cdiv style\x3d'height: 100%;width: 100%' attachTo\x3d'containerNode'\x3e\x3c/div\x3e",
isVisualEditor:!0,resizeToParent:!0,showLESS:!0,showBehaviours:!1,showStyleView:!0,blockScopes:null,onReload:function(){},leftLayoutContainer:null,rightLayoutContainer:null,palette:null,paletteContainer:null,showPalette:!0,styleView:null,styleViewContainer:null,addOutline:!0,outlineView:null,outlineContainer:null,outlineGridView:null,outlineGridContainer:null,editor:null,_designMode:!0,_tempLeftContainer:null,textEditor:null,delite:!1,template:null,contextInfo:null,didAddSheetEditors:!1,beanType:w.ITEM_TYPE.WIDGET,
_didInitial:!1,ready:!1,destroyed:!1,_skipTextEditorChange:!1,_getHTMLBlocks:function(b,e,a,c,r){r.push({name:"HTML",iconClass:"fa-paint-brush",items:[{name:"Set Style",owner:e,iconClass:"fa-paint-brush",proto:S,target:a,ctrArgs:{scope:b,group:c}},{name:"Set CSS",owner:e,iconClass:"fa-paint-brush",proto:u,target:a,ctrArgs:{scope:b,group:c}},{name:"Set State",owner:e,iconClass:"fa-paint-brush",proto:V,target:a,ctrArgs:{scope:b,group:c}}]});return r},onBuildBlockInfoListEnd:function(b){var e=b.owner;
(e=e?e.visualEditor:null)&&e===this&&this._getHTMLBlocks(b.scope,b.view,b.item,b.group,b.items)},__reloadModule:function(){Reload.reload().then(function(b){b.component.registerEditors()})},updateFocus:function(){var b=this.getEditorContext();b&&!b.isRezing&&(b.clearCachedWidgetBounds(),b.updateFocusAll())},set:function(b,e){"focused"===b&&this.updateFocus();return this.inherited(arguments)},select:function(b,e){b=_.isArray(b)?b:[b];var a=b[0];if(a){var c=this.getEditorContext();if(c){if(_.isString(a)){var p=
[];_.each(b,function(b){(b=c.getWidget(b))&&p.push(b)});b=p}!0!==e&&c.deselect();_.each(b,function(b){c.select(b,!0,!1)})}}},selectAll:function(){var b=this.getEditorContext(),e=b.getAllWidgets();_.each(e,function(e){b.select(e,!0,!1)})},updateToolbars:function(){},getTemplateDirectoryPathItem:function(){return{mount:"workspace",path:"./templates"}},getSelection:function(){var b=this.getEditorContext(),e=[];if(b)for(var b=b.getSelection(),a=0;a<b.length;a++)e.push(b[a]);return e},ensureSceneFiles:function(b){var e=
new m,a=[],c=b._S,r=b.mount,k=h.getFileExtension(b.path),D=this.ctx.getFileManager(),p=this.getTemplateDirectoryPathItem();c.getParent(b).getPath();var v=function(b,e){var a=new m,v=b.getPath().replace("."+k,"."+e);if(b=c.getSync(v))a.resolve(b);else{var E="./"+v,E=E.replace("././","./"),y=p.path+"/newDHTML."+e;D.mkfile(r,E).then(function(b){D.getContent(r,y,function(b){D.setContent(r,E,b,function(b){a.resolve()})})})}return a};a.push(v(b,"css"));a.push(v(b,"xblox"));a.push(v(b,"js"));n(a).then(function(b){e.resolve()});
return e},getActiveItem:function(){return null},hasItemActions:function(){return this.ready},getItem:function(){return this.currentItem},onReloaded:function(){},_createLeftContainer:function(){var b=this.getMainView();return h.addWidget(g,{closable:!0,style:"padding:0px;width:200px",region:"left",cssClass:"layoutLeft",splitter:!0,parentContainer:b.layoutMain},this,b.layoutMain,!0,"ui-widget-content")},getLeftContainer:function(){var b=this.getMainView(),e=b.leftLayoutContainer;if(e)return e;if(b.leftTabContainer)return b.leftTabContainer;
this._tempLeftContainer=this._createLeftContainer();return this.leftLayoutContainer=h.addWidget(l,{persist:!0,doLayout:!0,cssClass:"ui-widget-content"},this,this._tempLeftContainer.containerNode,!0)},restoreStyleView:function(){return b.byId("html_style_view_parent")},suspendStyleView:function(){},onLastEditorRemoved:function(){this.suspendStyleView();var e=b.byId("html_style_view_parent");e&&e.parentContainer&&(e.parentContainer.removeChild(e),h.destroy(e));(e=b.byId("html_style_view"))&&h.destroy(e);
(e=b.byId("palette-tabcontainer-right-top"))&&h.destroy(e)},clearAll:function(){this.editor&&this.editor.visualEditor.context.deselect();c._switchEditor(null);c.currentEditor=null;a.currentEditor=null;this.destroyed=!0;if(this.blockScopes){for(var b=0;b<this.blockScopes.length;b++){var e=this.blockScopes[b];this.ctx.getBlockManager().removeScope(e.id)}delete this.blockScopes}this.outlineGridView=this.outlineGridContainer=null;this.onLastEditorRemoved()},getFrame:function(){var b=this.getEditorContext();
return b&&b.frameNode?b.frameNode:null},destroy:function(){var b=0==this.getEditors().length,e=this.getMainView(),a=this.getLeftContainer();this.getEditorContext();clearInterval(this._frameTimer);h.destroy(this.getFrame());if(null==this.leftLayoutContainer||a.canDestroy&&!a.canDestroy()){h.destroy(this.paletteContainer,!1);h.destroy(this._cBPalettePane,!1);try{this.outlineGridContainer&&(a.removeChild(this.outlineGridContainer),this.outlineGridView.parentContainer=null),h.destroy(this.outlineGridView,
!0),h.destroy(this.palette)}catch(K){debugger}}else h.destroy(this.leftLayoutContainer,!1),e.layoutMain&&e.layoutMain.removeChild&&e.layoutMain.removeChild(this._tempLeftContainer),h.destroy(this.paletteContainer,!1);this&&this.styleViewContainer&&(this.styleViewContainer.keep=!1);h.destroy(this.styleView,!0,this);h.destroy(this.tabContainer,!0,this);h.destroy(this.styleViewContainer,!0,this);this.publish(w.EVENTS.ON_CONTEXT_DESTROYED,this.getEditorContext());try{this.clearAll()}catch(K){logError(K)}if(b)try{h.destroy(this.editor,
!0,this)}catch(K){logError(K)}},getMainView:function(){return this.mainView},addStyleView:function(b){function e(b){b._on("splitterMoveStart",function(b){a.hideFrame(!0)});b._on("splitterMoveEnd",function(b){a.hideFrame(!1)})}var a=this;this.ctx.getApplication();var c=this.getPageEditor(),k=c.getPropertyPane();if(this.styleView)return this.styleView;e(k);e(c.getDesignPane());c=h.addWidget(r,{region:"center",id:"palette-tabcontainer-right-top",tabPosition:"right-h",tabStrip:!1,"class":"davinciPalette davinciTopPalette widget",
style:"",splitter:!1,direction:"right"},null,k.containerNode,!0);v.add(c.domNode,"davinciPalette davinciTopPalette");this.tabContainer=c;this.styleViewContainer=k;var D=c.createTab("Widget","fa-cogs");try{this.styleView=h.addWidget(y,{toolbarDiv:k.containerNode,context:b,_editor:this.editor,parentContainer:c,tabContainer:c},null,D.containerNode,!0)}catch(Q){console.error("html_style_view crash "+Q)}this.styleView._initialPerspectiveReady()},addOutlineGridView:function(b){var a=this.getLeftContainer();
if(!this.outlineGridView&&a){var c=a.createTab("Outline","fa-cube",!0,null,{parentContainer:a});this.outlineGridContainer=c;var r=this;try{this.outlineGridView=h.addWidget(e,{context:b,resizeToParent:!0,style:"padding:0px;"},null,c.containerNode,!0),c.add(this.outlineGridView),setTimeout(function(){c.resize();r.outlineGridView&&r.outlineGridView.resize()},1E3)}catch(X){logError(X,"outline crash ")}this.outlineGridView.startup();this.add(c);window.outline=this.outlineGridView}},_handleKeyDown:function(b,
e){this._handleKey(b,e)||e||a.handleKeyEvent(b)},_handleKey:function(b,e){if(!this.keyBindings)return!1;var c=this.keyBindings.some(function(c){if((!e||c.keyBinding.allowGlobal)&&a.isKeyEqualToEvent(c.keyBinding,b))return d("davinci/Workbench")._runAction(c.action,this.editor,c.action.id),!0},this);c&&dojo.stopEvent(b);return c},_setupKeyboardHandler:function(b){var e=function(b){this.keyBindings||(this.keyBindings=[]);this.keyBindings.push(b)}.bind(this);this._getViewActions().forEach(function(b){b.actions.forEach(function(b){b.keyBinding&&
e({keyBinding:b.keyBinding,action:b});b.menu&&b.menu.forEach(function(b){b.keyBinding&&e({keyBinding:b.keyBinding,action:b})},this)},this)},this);I.connect(b,"handleKeyEvent",this,"_handleKeyDown")},setDirty:function(){},shouldUpdateTextEditor:function(){return this._skipTextEditorChange?(this._skipTextEditorChange=!0,!1):!0},addPageEditor:function(b){if(!this.editor)try{var e=this;this.editor=new (d("davinci/ve/PageEditor"))(dojo.create("div",{}),b.getPath(),b,function(a,c){return e.createHTMLEditor(a,
c,b)},this.template,[{title:"Blocks"}]);this.editor.ctx=this.ctx;this.editor.editorContainer=this;this.editor.delegate=this;this.containerNode.appendChild(this.editor.domNode);this.declaredClass=this.editor.declaredClass;this.editor.editorID="davinci.ve.HTMLPageEditor";a.currentEditor=this.editor;c.currentEditor=this.editor;this.add(this.editor,null,!1);this._setupKeyboardHandler(this.editor);this.addTextEditor(this.editor.htmlEditor);c._switchEditor(this.editor);setTimeout(function(){dojo.publish("/davinci/ui/editorSelected",
[{editor:e.editor,oldEditor:null}])},2E3);return this.editor}catch(O){console.error("crash in visual editor "+O),logError(O,"crash in visual editor ")}},_widgetSelectionChanged:function(b){if(1!=b.isFake){b=b.selection;var e=(b=1==b.length?b[0]:null)||{dummy:!0};this.currentItem=b||null;this.publish(w.EVENTS.ON_ITEM_SELECTED,{item:e,owner:this,beanType:"widget"});this._emit("selectionChanged",{item:e,owner:this})}},_resume:function(){this.restoreStyleView()},_suspend:function(){this.suspendStyleView()},
hideFrame:function(b){this._hidden=b;var e=this.getFrame();e&&$(e).css("display",b?"none":"block")},onHide:function(){this.inherited(arguments);this.hideFrame(!0);this.updateFocus();this.editor&&(c._switchEditor(null),this.publish("/davinci/ui/editorSelected",[{editor:null,oldEditor:this.editor}]));this._suspend()},onShow:function(){this.inherited(arguments);this.hideFrame(!1);if(this.editor){this.updateFocus();c._switchEditor(this.editor);var b=this;setTimeout(function(){b.publish("/davinci/ui/editorSelected",
[{editor:b.editor,oldEditor:null}])},1E3)}this._resume()},addPalette2:function(e,a,c){var r=this;this.palette=b.byId("html_palette");if(!this.palette){new m;var k=new Y.Palette,D=this.ctx;k.initMeta(D);setTimeout(function(){var b=D.mainView.leftLayoutContainer,b=b.createTab("Palette","fa-cube",!0,null,{parentContainer:b,open:!1});r.paletteContainer=b;try{k.init();var e=k.createStore();r.palette=h.addWidget(Y.Grid,{ctx:D,attachDirect:!0,collection:e,open:!0,expandOnClick:!0,sources:[],palette:k},null,
b,!0);$(r.palette.bodyNode).addClass("dojoyPalette");$(r.palette.bodyNode).addClass("paletteLayoutIcons");r.palette.set("collection",e.filter({parentId:"."}));r.add(b,null,!1);r.add(r.palette,null,!1);setTimeout(function(){r.palette.set("collection",e.filter({parentId:"."}))},4E3)}catch(Z){console.error("palette crash "+Z)}},3E3)}},openItem:function(b){function e(b){a.ensureSceneFiles(b).then(function(){a.editor||a.addPageEditor(b);a.hideFrame(!1);a.updateFrame();a.ctx.getFileManager().getContent(b.mount,
b.path,function(e){a.editor.setContent(b.path,e);a.showPalette&&a.addPalette2(a.editor.visualEditor.context);try{a.styleView||!1===a.showStyleView||a.addStyleView(a.getEditorContext())}catch(Q){console.error("error style view "+Q),logError(Q,"error style view ")}c.resolve()})})}var a=this,c=new m;a.item=b;this.template&&!this.template.isLoaded()?this.template.load().then(function(){e(b)}):e(b);return c},onReady:function(){this.ready=!0;this.hideFrame(!1);this.updateFrame()},onEditorContextLoaded:function(){var b=
this;if(this._didInitial)setTimeout(function(){b.outlineGridView&&(b.outlineGridView.editorChanged({editor:null,oldEditor:b.editor}),b.outlineGridView.editorChanged({editor:b.editor,oldEditor:null}))},800);else{this._didInitial=!0;var e=b.editor.visualEditor.context;if(b.addOutline)try{setTimeout(function(){b.addOutlineGridView(e);dojo.publish("/davinci/ui/editorSelected",[{editor:b.editor,oldEditor:null}]);b.onReady()},800)}catch(O){console.error("outline creation crashed "+O);debugger}}},getNullItem:function(){return this._nullItem?
this._nullItem:this._nullItem={owner:this,beanType:"widget"}},_editors:null,addTextEditor:function(b){!this._editors&&(this._editors=[]);this._editors.push(b)},publishCSSRules:function(b){b=(new CSSParser).parse(b,!1,!0);var e=[];b&&_.each(b.cssRules,function(b){b.mSelectorText&&"body"!==b.mSelectorText&&e.push(b.mSelectorText.replace(".",""))});this.publish("CSSRulesUpdated",{names:e,editor:this})},loadSceneCSSFile:function(b){var e=this;this.ctx.getFileManager().getContent(b.mount,b.path,function(b){e.publishCSSRules(b)})},
onContextReady:function(b){if(b.context==this.getEditorContext()){this.contextInfo=b;var e=this,a=this.getPageEditor(),c=b.context._extraSheets,r=this.item._S;this.ctx.getWindowManager().registerView(this,!0);!1!==this.showLESS&&r&&!this.didAddSheetEditors&&(this.didAddSheetEditors=!0,_.each(c,function(b,c){var k;k=c.replace("././","./");c=c.replace("././","./");var D=r.getSync(k);D&&(b.storeItem=D,b.cssItem=r.getSync(c));D?(c={sheetProps:b,closeable:!1,emmet:!0,resizeToParent:!0},k=w.DOCKER,k=a.createTab(null,
{title:D.name,icon:"fa-paint",tabOrientation:k.TAB.TOP,location:k.DOCK.STACKED,target:a.getSourcePane()}),e.cssPane=k,c=R.Implementation.open(D,k,c,!0),b.edior=c,e.addTextEditor(c),k.add(c),e.loadSceneCSSFile(D),c._on(w.EVENTS.ON_FILE_CONTENT_CHANGED,function(b){e.publishCSSRules(b.content)})):console.error("couldnt find file : ",k)}));this.hideFrame(!1);(c=b.blockScopes)&&c.length&&(this.showBehaviours&&this._buildBlockPalette(b),b.context.eventHandler={click:function(b){e.publish(w.EVENTS.ON_ITEM_SELECTED,
{item:e.currentItem||e.getNullItem(),owner:e,beanType:"widget"});e._emit(w.EVENTS.ON_VIEW_SHOW,{view:e})}})}},onAppReady:function(b){setTimeout(function(){this.outlineView&&b.context&&(this.outlineView.reset(),this.outlineView.createTree())}.bind(this),2E3)},getTextEditor:function(){return this.editor.htmlEditor},getEditor:function(b,e){var a=null;_.each(this._editors,function(c){var r=c.item,k=r.mount.replace("/",""),r=r.path.replace("./","");k===b&&r===e&&(a=c)});return a},onEditorContentChanged:function(b){var e=
this;this.__internUpdate=!0;setTimeout(function(){e.__internUpdate=!1},5E3);return this.reload(b.content)},isSaving:!1,save:function(b,e,a,c){if(!this.isSaving){this.__internUpdate=this.isSaving=!0;var r=this.getTextEditor();r&&r.set("value",c);this.publish(w.EVENTS.ON_VISUAL_EDITOR_SAVE,{pageEditor:b,visualEditor:e,model:a,text:c,item:this.item});var k=this;this.ctx.getFileManager().setContent(this.item.mount,this.item.path,c,function(){k.isSaving=!1})}},fileChanged:function(b){function e(b){b==
a.getTextEditor()&&b.reload().then(function(b){a.reload(b)});b.reload().then(function(){a.onFileChanged({editor:b})})}if(!this.__internUpdate){b=b.data.path;var a=this;if(-1!=b.indexOf("workspace_user")){var c=b.substr(b.indexOf("workspace_user")+15,b.length);if(c=this.getEditor("workspace_user",c))return e(c)}(b=this.ctx.toVFSShort(b,"workspace_user"))&&(c=this.getEditor("workspace_user",b))&&e(c)}},onFileChanged:function(b){if(!b.__did&&(b.__did=!0,b&&b.editor&&b.editor.sheetProps)){var e=b.editor.sheetProps,
a=this.contextInfo.document,c=this;dojo.withDoc(a,function(){var b=a.getElementsByTagName("head")[0];try{e.link&&(b.removeChild(e.link),e.link=null)}catch(Q){dojo.destroy(e.link)}var r=c.ctx.getFileManager().getImageUrl(e.cssItem,!0,!1),r=A.create("link",{rel:"stylesheet",type:"text/css",href:r});b.appendChild(r);dojo.place(r,b,"last");e.link=r})}},onUseActionStore:function(b){},getBlockEditor:function(){return this.getPageEditor().getBlockEditor()},resize:function(){this.updateFrame();this.updateFocus();
var b=this.getPageEditor();this.getEditorContext();b&&(h.resizeTo(b.domNode,this.containerNode,!0,!0,null,{}),b.resize())},startup:function(){var b=this,e=this,a=w.EVENTS;this._frameTimer=setInterval(function(){var e=b.getEditorContext();e&&e.isRezing||b.updateFrame()},1E3);k.getSmartInput("xblox/RunScript");this.subscribe([a.ON_BUILD_BLOCK_INFO_LIST_END,a.ON_ACTION_CONTEXT_CHANGED,a.ON_ACTION_CHANGE_CONTEXT,a.ON_ACTION_CHANGE_CONTEXT,a.ON_FILE_CHANGED,a.ON_CONTEXT_READY,a.ON_APP_READY,{key:w.EVENTS.ON_FILE_CONTENT_CHANGED,
handler:function(b){var a=b.item;e._skipTextEditorChange=!0;if(a==e.item&&b.callee==e.textEditor)e.editor.setContent(e.item.getPath(),b.content);else e.onFileChanged(b)}},{key:"/davinci/ui/widgetSelected",handler:e._widgetSelectionChanged},{key:"/davinci/ui/context/loaded",handler:e.onEditorContextLoaded}]);this.initReload();setTimeout(function(){e.resize()},2E3)},setDesignMode:function(b,e){this._designMode=b;!0===e&&(e=this._designToggleAction)&&(e=e.getVisibility(w.ACTION_VISIBILITY.ACTION_TOOLBAR).widget)&&
e.set("checked",b);(e=this.getEditorContext())&&e.setDesignMode(b)},_didHide:!1,getSettings:function(){return((this.ctx.getSettingsManager().getStore()||{getSync:function(){}}).getSync("ve")||{value:{showEditors:!1,selected:"HTML"}}).value},saveSettings:function(){var b=this.ctx.getSettingsManager(),e=((b.getStore()||{getSync:function(){}}).getSync("ve")||{value:this.getSettings()}).value;e.showEditors=this.showCode;var a=this.getPageEditor().getDocker(),c="HTML";_.each(a.getPanels(),function(b){"Blocks"===
b._title&&!0===b.selected&&(c="Blocks");b._title.indexOf&&-1!==b._title.indexOf(".css")&&!0===b.selected&&(c=b._title)});e.selected=c;b.write2(null,".",{id:"ve"},{value:e},!0,null).then(function(){})},restoreSettings:function(){var b=this,e=this.getSettings();e.showEditors||setTimeout(function(){b._didHide?b.getPageEditor().getDocker():(b._didHide=!0,b.toogleCode())},1500);var e=e.selected,a=this.getPageEditor().getDocker();(e=_.find(a.getPanels(),{_title:e}))&&e.select()},didinitSettings:!1,initSettings:function(){var b=
this;this.didinitSettings||(this.didinitSettings=!0,this.getPageEditor().getDocker()._on(w.DOCKER.EVENT.SELECT,function(e){e=e.title();b.getSettings().selected=e;b.saveSettings()}))},onSceneBlocksLoaded:function(b){var e=this;this.blockScopes=b.blockScopes;var a=this.getPageEditor();window.vee=this;a.onSceneBlocksLoaded(b,this);this.initSettings();setTimeout(function(){e.restoreSettings()},1500)}});e.prototype.reloadModule=q.prototype.reloadModule;D.prototype.reloadModule=q.prototype.reloadModule;
C.prototype.reloadModule=q.prototype.reloadModule;E.prototype.reloadModule=q.prototype.reloadModule;G.prototype.reloadModule=q.prototype.reloadModule;N.prototype.reloadModule=q.prototype.reloadModule;E.prototype.reloadModule=q.prototype.reloadModule;L.prototype.reloadModule=q.prototype.reloadModule;q.getFileActions=function(b,e){return[b.createAction({label:"Preview in Browser",command:"File/Preview",tab:"Home",icon:"fa-eye",tab:"Home",mixin:{quick:!0,addPermission:!0,handler:function(){window.open(b.getContextManager().getViewUrl(e))}},
custom:!0})]};return q})},"xideve/views/OutlineView":function(){define("dcl/dcl dojo/_base/declare dojo/dom-class davinci/Workbench davinci/ui/widgets/OutlineTree xide/layout/ContentPane".split(" "),function(q,A,m,n,d,g){return q([g],{declaredClass:"davinci.workbench.OutlineView",startup:function(){m.remove(this.domNode,"ui-widget-content")},reset:function(){this.outlineTree&&this.outlineTree.destroy();delete this.outlineProvider;delete this.outlineTree},constructor:function(d,h){this.subscribe("/davinci/ui/editorSelected",
this.editorChanged);this.subscribe("/davinci/ui/context/pagerebuilt",this._pageRebuilt)},_getViewActions:function(){return[]},editorChanged:function(d){d=d.editor;if(this.currentEditor){if(this.currentEditor==d)return;this.outlineTree&&this.outlineTree.destroy();delete this.outlineProvider;delete this.outlineTree}if(this.currentEditor=d)d.getOutline&&(this.outlineProvider=d.getOutline()),this.outlineProvider?(this.outlineProvider._outlineView=this,this.createTree()):this.containerNode.innerHTML="no outline aviable"},
createTree:function(){this.outlineTree&&this.removeContent();this.popup&&this.popup.destroyRecursive();!this.outlineProvider&&this.currentEditor&&(this.outlineProvider=this.currentEditor.getOutline(),this.outlineProvider._outlineView=this);this.outlineProvider&&this.outlineProvider.getModel&&(this.outlineModel=this.outlineProvider.getModel(this.currentEditor));var l={model:this.outlineModel,showRoot:this.outlineModel.showRoot,betweenThreshold:this.outlineModel.betweenThreshold,checkItemAcceptance:this.outlineModel.checkItemAcceptance,
isMultiSelect:!0,persist:!1,style:"height:inherit;"};this.outlineProvider.getIconClass&&(l.getIconClass=this.outlineProvider.getIconClass);this.currentEditor.getContext&&(l.context=this.currentEditor.getContext());this.outlineModel.dndController&&(l.dndController=this.outlineModel.dndController);this.outlineTree=new d(l);this.container=new g({style:"padding:0"});this.subcontainer=dojo.doc.createElement("div");this.subcontainer.id="dvOutlineSubcontainer";this.subcontainer.appendChild(this.outlineTree.domNode);
this.container.domNode.appendChild(this.subcontainer);this.setContent(this.container);this.outlineTree.startup();this.outlineProvider&&(this.outlineProvider._tree=this.outlineTree);l=this.outlineProvider.getActionsID&&this.outlineProvider.getActionsID()||"davinci.ui.outline";this.popup=n.createPopup({partID:l,domNode:this.outlineTree.domNode,openCallback:this.outlineTree.getMenuOpenCallback?this.outlineTree.getMenuOpenCallback():null})},_getViewContext:function(){return this.outlineProvider},selectionChanged:function(d){!this.publishing["/davinci/ui/selectionChanged"]&&
d.length&&d[0].model&&this.outlineTree&&this.outlineTree.selectNode([d[0].model])},_pageRebuilt:function(){if(this.outlineTree){var d=this.outlineTree.get("paths");this.createTree();this.outlineTree.set("paths",d)}},modelChanged:function(d){this.outlineModel&&this.outlineModel.refresh?this.outlineModel.refresh():this.outlineProvider&&this.outlineProvider.getStore&&(this.outlineModel.store=this.outlineProvider.getStore(),this.outlineModel.onChange(this.outlineProvider._rootItem))}})})},"xideve/views/OutlineGridView":function(){define("dcl/dcl dojo/dom-class xide/utils xide/types dgrid/Editor xide/data/TreeMemory davinci/ve/widget xide/_base/_Widget xide/mixins/ReloadMixin xgrid/Grid xgrid/TreeRenderer xgrid/KeyboardNavigation xide/widgets/_Widget davinci/ve/States davinci/ve/commands/StyleCommand xideve/views/VisualEditorAction xdojo/declare xaction/DefaultActions".split(" "),
function(q,A,m,n,d,g,l,h,w,J,C,a,c,I,v,k,y,D){y=n.ACTION;var e=J.createGridClass("OutlineGridView",{permissions:[y.RENAME,y.UNDO,y.REDO,y.RELOAD,y.DELETE,y.CLIPBOARD,y.LAYOUT,y.COLUMNS,y.SELECTION,y.SAVE,y.SEARCH,y.TOOLBAR,"File/Properties","File/Edit",y.GO_UP,y.HEADER,y.EDIT,y.COPY,y.CLOSE,y.MOVE,y.RENAME,y.RELOAD,y.CLIPBOARD,y.LAYOUT,y.SELECTION,y.SEARCH,y.TOOLBAR,y.STATUSBAR,y.SOURCE,y.CLIPBOARD_COPY,y.CLIPBOARD_PASTE,y.CLIPBOARD_CUT],menuOrder:{File:110,Edit:100,View:90,Widget:80,Block:50,Settings:20,
Navigation:10,Step:5,New:4,Window:1},options:m.clone(n.DEFAULT_GRID_OPTIONS),getEditorContext:function(){return this.context},startup:function(){this.inherited(arguments);this._createContextMenu()}},{SELECTION:!0,KEYBOARD_SELECTION:!0,PAGINATION:!1,ACTIONS:n.GRID_FEATURES.ACTIONS,CONTEXT_MENU:n.GRID_FEATURES.CONTEXT_MENU,KEYBOARD_NAVIGATION:{CLASS:a},WIDGET:{CLASS:c},EDITOR:{CLASS:d},EXTRAS:{CLASS:k.GridClass}},{RENDERER:C},null,null);return q([h,w.dcl],{templateString:'\x3cdiv attachTo\x3d"domNode"\x3e\x3c/div\x3e',
declaredClass:"xideve.views.OutlineGridView",rootWidget:null,_lastEvent:null,useRichTextLabel:!1,resizeToParent:!0,onItemSelected:function(b,e){var a=this.getContext();e=this.getStore();a&&(b=e.model._getWidget(b),e=a.getSelection(),dojo.forEach(e,dojo.hitch(this,function(b){a.deselect(b)})),a.select(b,!0))},_toggle:function(b,e,a){e=e?"none":"";var c;if(a=I.getFocus(b.domNode.ownerDocument.body))c=a.state;else{a=I.getStatesListCurrent(b.domNode);for(var r=0;r<a.length;r++)if(a[r]){c=a[r];break}}b=
new v(b,[{display:e}],c);this.getContext().getCommandStack().execute(b)},getLabel:function(b){if("myapp"==b.id)return this.getContext().model.fileName;var e="",a=this._getWidget(b);if("xblox/RunScript"===b.type&&a)return a=a.domNode,1==a.mode&&a.targetproperty&&a._targetBlock?a._targetBlock.name+"-\x3e"+a.targetproperty:a&&a.script&&"null"!==a.script?"XBlox::"+a.script:a.targetEvent&&0<a.targetEvent.length?"XBlox::"+a.targetEvent:"XBlox";if("xblox/CSSState"===b.type&&a)return a=a.domNode,"CSS State/"+
a.name;if("xblox/StyleState"===b.type&&a)return a=a.domNode,"Style State/"+a.name;if(a.isWidget)return e=l.getLabel(a);if(e=a.type){b=this.useRichTextLabel?"\x26lt;":"\x3c";var c=this.useRichTextLabel?"\x26gt;":"\x3e",e=0===e.indexOf("html.")?b+e.substring(5)+c:0===e.indexOf("OpenAjax.")?b+e.substring(9)+c:0<e.indexOf(".")?e.substring(e.lastIndexOf(".")+1):a.label||e;(a=l.byId(a.id,this.getContext().getDocument()))&&(a=a.getId())&&(e+=" id\x3d"+a);return e}},getColumns:function(){var b=this;return[{renderExpando:!0,
label:"Name",field:"type",sortable:!1,formatter:function(e,a){e=b.getLabel(a);if("xblox/RunScript"==a.type&&(a=b._getWidget(a))&&(a=a.domNode)){var c=a._targetBlock;if(c){if(-1!=c.declaredClass.indexOf("Command"))return'\x3cspan class\x3d"grid-icon '+c.getIconClass()+'"\x3e\x3c/span\x3e'+c.name+" ("+a.targetevent+")";c.declaredClass.indexOf("Variable")}}return e}}]},createGrid:function(){m.destroy(this.outlineTree);dojo.empty(this.domNode);var b=this,a={features:{},className:"outlineGridView dgrid dgrid-dgrid ui-widget",
cellNavigation:!1,collection:this.store.filter(this.getRootFilter()),deselectOnRefresh:!1,showHeader:!1,owner:this,resizeToParent:!0,columns:this.getColumns()},c=m.addWidget(e,a,null,this,!0);this.grid=c;this.grid.set("collection",this.store.filter({type:"html.body"}));this.outlineTree=c;c.refresh();this.add(c);this._lastState&&(c.setState(this._lastState),delete this._lastState);c._on("selectionChanged",function(e){b.onItemSelected(e.selection[0])});c.on("dgrid-datachange",function(e){var a=c.row(e.target);
e=e.value;var k=b.getContext(),r=b.getStore();k&&(a=r.model._getWidget(a.data))&&b._toggle(a,!e)})},initStore:function(b){return this.store=new g({data:b.items,model:b.model,provider:b.provider,idProperty:"id",parentProperty:"parent",getSync:function(b){var e=this.inherited(arguments),a=this.provider.getModel();!e&&(a=a._getWidget({id:b}))&&(this.putSync(a),e=a);return e},getChildrenSync:function(b){var e=this,a=[];this.model.getChildren(b,function(b){for(var c=0;c<b.length;c++)e.putSync(b[c]);a=
b});return a},getChildren:function(b,e){var a=this;this.model.getChildren(b,function(b){for(var e=0;e<b.length;e++)a.putSync(b[e])});return this.inherited(arguments)},mayHaveChildren:function(b){return this.model.mayHaveChildren(b)}})},getContext:function(){return this.currentEditor?this.currentEditor.getContext():null},_getWidget:function(b){return l.byId(b.id)},getStore:function(){return this.store},getModel:function(){return this.outlineModel},getRootFilter:function(){return{id:this.rootWidget?
this.rootWidget.id:""}},hasItemActions:function(){return!1},_getViewContext:function(){return this.outlineProvider},_getViewActions:function(){return[]},onWidgetChanged:function(b){var e=b.type,a=this.getContext();e===a.WIDGET_ADDED?this.getStore().putSync(b.widget):e===a.WIDGET_REMOVED&&this.getStore().removeSync(b.widget);this.grid&&this.grid.refresh()},onWidgetSelected:function(b){},startup:function(){A.remove(this.domNode,"ui-widget-content");this.subscribe("/davinci/ui/editorSelected",this.editorChanged);
this.subscribe("/davinci/ui/context/pagerebuilt",this._pageRebuilt);this.subscribe(n.EVENTS.ON_WIDGET_CHANGED);this.subscribe("/davinci/ui/widgetSelected",this.onWidgetSelected);this.initReload()},onReloaded:function(){this.reset();this._lastEvent&&this.editorChanged(this._lastEvent)},reset:function(){this.currentEditor=null;delete this.outlineProvider;delete this.outlineTree},editorChanged:function(b){this._lastEvent=b;b=b.editor;if(this.currentEditor){if(this.currentEditor==b)return;this.outlineTree&&
(this._lastState=this.outlineTree.getState(),this.outlineTree.destroy());this.store&&(this.store.destroy(),delete this.store);delete this.outlineProvider;delete this.outlineTree}if(this.currentEditor=b)b.getOutline&&(this.outlineProvider=b.getOutline()),this.outlineProvider?this.createTree():this.containerNode.innerHTML="no outline aviable"},createTree:function(){this.popup&&this.popup.destroyRecursive();!this.outlineProvider&&this.currentEditor&&(this.outlineProvider=this.currentEditor.getOutline(),
this.outlineProvider._outlineView=this);this.outlineProvider&&this.outlineProvider.getModel&&(this.outlineModel=this.outlineProvider.getModel(this.currentEditor));var b=this.outlineModel,e=this.outlineProvider,a=e&&e._context?e._context.rootWidget:null;a||console.error("have no root");this.outlineProvider.getActionsID&&this.outlineProvider.getActionsID();this.initStore({items:[a],model:b,provider:e});this.createGrid()},selectionChanged:function(b){!this.publishing["/davinci/ui/selectionChanged"]&&
b.length&&b[0].model&&this.outlineTree&&this.outlineTree.selectNode([b[0].model])},_pageRebuilt:function(){if(this.outlineTree){var b=this.outlineTree.get("paths");this.createTree();this.outlineTree.set("paths",b)}},_modelChanged:function(b){this.outlineModel&&this.outlineModel.refresh?this.outlineModel.refresh():this.outlineProvider&&this.outlineProvider.getStore&&(this.outlineModel.store=this.outlineProvider.getStore(),this.outlineModel.onChange(this.outlineProvider._rootItem))}})})},"xideve/views/VisualEditorAction":function(){define("dcl/dcl xdojo/has require xaction/Action xide/types davinci/Runtime davinci/Workbench davinci/ve/metadata xaction/ActionProvider xaction/DefaultActions davinci/ve/widget dojo/Deferred xdojo/declare davinci/ve/tools/CreateTool".split(" "),
function(q,A,m,n,d,g,l,h,w,J,C,a,c,I){var v=this;C=d.ACTION;var k=function(a,e,b){var c={context:b,type:"xblox/StyleState",properties:{},userData:{}},k=h.getMetadata(c.type);h.getHelper(a.type,"tool").then(function(e){e=new (e||I)(c,{});e._context=b;b.setActiveTool(e);e._create({position:{x:0,y:0},parent:a,userData:k});b.setActiveTool(null)}.bind(v))};if(window.sctx&&window.vee){var y=window.vee;window._veeHandle&&window._veeHandle.remove();window._runAction=function(a,e){a=e.getEditorContext();var b=
e.getSelection();k(b[0],e,a)};window._veeHandle=vee._on("selectionChanged",function(a){}.bind(y))}C={declaredClass:"xideve/views/VisualEditorAction",_layoutActions:null,_designToggleAction:null,_maqActions:null,_float:function(){var a=this.getPageEditor(),e=a.getDocker(),b=a.getSourcePane();a.getSourcePane();var c=a.getPropertyPane();e.movePanel(b,d.DOCKER.DOCK.FLOAT,null,{x:300,y:300,w:600,h:400});var k=b._parent;k&&k.instanceOf("wcFrame")&&(k.pos(300,300,!0),k._size.x=600,k._size.y=400);k.__update();
k&&k.instanceOf("wcFrame")&&k.pos(300,300,!0);k.__update();e.__focus(k);e.movePanel(c,d.DOCKER.DOCK.STACKED,b);e.movePanel(a.getBlocksPane(),d.DOCKER.DOCK.STACKED,b);e.movePanel(this.cssPane,d.DOCKER.DOCK.STACKED,b);c.maxSize(null,null);c.minSize(null,null);this.cssPane.select()},_dock:function(){var a=this,e=a.getPageEditor(),b=e.getDocker(),c=e.getSourcePane(),k=e.getDesignPane(),v=e.getPropertyPane();b.movePanel(v,d.DOCKER.DOCK.RIGHT,k,{tabOrientation:d.DOCKER.TAB.TOP,location:d.DOCKER.TAB.RIGHT});
v.maxSize(400);v.minSize(350);b.movePanel(c,d.DOCKER.DOCK.BOTTOM,null,{tabOrientation:d.DOCKER.TAB.TOP});b.movePanel(e.getBlocksPane(),d.DOCKER.DOCK.STACKED,c,{});b.movePanel(this.cssPane,d.DOCKER.DOCK.STACKED,c,{});e.resize();b.resize();setTimeout(function(){c.getSplitter().pos(.5);v.maxSize(500);k.getSplitter().pos(.8);a.cssPane.select()},1500)},getWidgetBlockActions:function(){var a=[],e=this;a.push(this.createAction({label:"Add Block",command:"Widget/Add Block",group:"Widget",tab:"Home",icon:"fa-magic",
mixin:{addPermission:!0,quick:!0},shouldDisable:function(){return e.getEditorContext()?1!==e.getSelection().length:!0}}));return a},getMaqettaActions:function(){return this._maqActions},getMaqettaAction:function(a,e,b){e=e||this.getMaqettaActions();var c=_.find(e,{id:a});c||(c=_.find(e,{command:a}));if(c||!1===b&&c)return c;for(b=0;b<e.length;b++){var k=e[b];if(k.menu&&(c=this.getMaqettaAction(a,k.menu,!1)))break}return c},onReload:function(){this.contextInfo.appContext.destroy()},reload:function(c){var e=
this,b=new a;this.onReload();var k=this.getEditorContext(),v=k?$(k.rootNode):null;v&&v[0]&&v[0]._destroyHandles&&(v[0].__didEmitLoad=!1,v[0]._destroyHandles());if(k=k.appContext)k.didWireWidgets=!1;if(e.blockScopes){for(k=0;k<e.blockScopes.length;k++)v=e.blockScopes[k],e.ctx.getBlockManager().removeScope(v.id);delete this.blockScopes}k=function(a){e.editor.setContent(e.item.path,a);b.resolve(a)};c?k(c):e.ctx.getFileManager().getContent(e.item.mount,e.item.path,k);return b},showInOutline:function(a){this.getEditorContext().getDocument();
var e=this.getSelection()[0];this.outlineGridView.grid.select((a||e).id,null,!0,{focus:!0,append:!1,expand:!0,delay:1})},showCode:!0,toogleCode:function(){this.showCode&&this.getPageEditor()?this.getPageEditor()._srcCP.getSplitter().collapse():this.getPageEditor()._srcCP.getSplitter().expand();this.showCode=!this.showCode;this.saveSettings()},runAction:function(a){if(a=_.isString(a)?this.getAction(a):a){var e=a.command,b=e.split("/"),c=b[b.length-1],b=this.getEditorContext();if(-1!==e.indexOf("Widget/State/"))switch(e){case "Widget/State/Add":return window._runAction(a,
this)}if(-1!==e.indexOf("View/Show/Float"))return this._float();if(-1!==e.indexOf("View/Show/Dock"))return this._dock();if(-1!==e.indexOf("View/Show/Code"))return this.toogleCode();if(-1!==e.indexOf("Widget/Focus"))(e=(e=this.getSelection())?e[0].domNode:null)&&e.scrollIntoView();else{if(-1!==e.indexOf("View/Split/"))return this.doSplit(parseInt(c)),this.updateFrame(),!0;if("Widget/Add Block"===e&&(c=this.getBlockEditor()))return c.runAction({command:"File/New Group"});if("View/Layout Mode/Relative"===
e)return this.getPageEditor().selectLayoutFlow();if("File/Reload"===e)return this.reload();if("Widget/Show In Outline"===e)return this.showInOutline();if("View/Layout Mode/Absolute"===e)return this.getPageEditor().selectLayoutAbsolute();if("View/Show/Preview"===e)return this._designMode=!1,this.getPageEditor().getDesignPane().title("\x3cspan class\x3d'text-warning'\x3ePreview\x3c/span\x3e"),this.getPageEditor().getDesignPane().icon("text-warning fa-eye"),this.setDesignMode(this._designMode);if("View/Show/Design"===
e)return this._designMode=!0,this.getPageEditor().getDesignPane().title("Design"),this.getPageEditor().getDesignPane().icon("text-info fa-edit"),this.setDesignMode(this._designMode);if("File/Open In Browser"===e||"File/Preview"===e)return e=this.item.name.replace(".dhtml",".css"),e=this.item.getParent().path+"/"+e,b=this.editor.ctx.getResourceManager().getVariable("VFS_GET_URL"),e=this.editor.ctx.getFileManager().base64_encode(b+""+this.item.mount+"\x26path\x3d"+e),e={template:A("debug")?"view.template.html":
"view.template.release.html",css:e,baseOffset:encodeURIComponent(this.item.getParent().path.replace("./","")),userDirectory:encodeURIComponent(this.editor.ctx.getResourceManager().getVariable("USER_DIRECTORY"))},e=this.ctx.getContextManager().getViewUrl(this.item,null,e),A("electronx")?((b=window.eRequire)||console.error("have no electron"),b("electron").shell.openExternal(e)):window.open(e);if(-1!==e.indexOf("Widget/Align/")){switch(e){case "Widget/Align/Align Left":return this._alignLeftVertical();
case "Widget/Align/Align Center":return this._alignCenterVertical();case "Widget/Align/Align Right":return this._alignRightVertical();case "Widget/Align/Align Top":return this._alignTopHorizontal();case "Widget/Align/Same Size":return this._sameSize();case "Widget/Align/Same Width":return this._sameWidth();case "Widget/Align/Same Height":return this._sameHeight()}return!0}c=a.action;if(!c)switch(e){case "File/Delete":case "Edit/Delete":c=this.getMaqettaAction("delete");break;case "Edit/Undo":c=this.getMaqettaAction("undo");
break;case "Edit/Redo":c=this.getMaqettaAction("redo");break;case "Edit/Copy":c=this.getMaqettaAction("copy");break;case "Edit/Paste":c=this.getMaqettaAction("paste");break;case "Edit/Cut":c=this.getMaqettaAction("cut");break;case "File/ManageStates":c=this.getMaqettaAction("manageStates");break;case "File/Save As Widget":c=this.getMaqettaAction("saveasdijit");break;case "Widget/SourroundWithDIV":c=this.getMaqettaAction("Widget/SourroundWithDIV")}c||(c=this.getMaqettaAction(e));return c?l._runAction(c,
b):this.inherited(arguments)}}},_getIconClass:function(a){if(!a)return"";switch(a){case "editActionIcon undoIcon":return"text-info fa-undo";case "editActionIcon redoIcon":return"text-info fa-repeat";case "editActionIcon editCutIcon":return"text-warning fa-scissors";case "editActionIcon editCopyIcon":return"text-warning fa-copy";case "editActionIcon editPasteIcon":return"text-warning fa-paste";case "editActionIcon editDeleteIcon":return"text-danger fa-remove"}return a},_toCommand:function(a){switch(a){case "Undo":return"Edit/Undo";
case "Redo":return"Edit/Redo";case "Cut":return"Edit/Cut";case "Copy":return"Edit/Copy";case "Paste":return"Edit/Paste";case "Delete":return"Edit/Delete"}},__addAction:function(a){switch(a.id){case "openBrowser":return!1;case "documentSettings":return!1;case "stickynote":return!1;case "tableCommands":return!1}return!0},_createEditToggleAction:function(){var a=this,e=n.createDefault("Design","fa-toggle-on","View/Design Mode","viewActions",null,{widgetClass:"xide/widgets/ToggleButton",widgetArgs:{icon1:"fa-toggle-on",
icon2:"fa-toggle-off",delegate:this,checked:a._designMode},handler:function(b,e,c,k){a._designMode=!a._designMode;k.set("checked",a._designMode);a.setDesignMode(a._designMode)}}).setVisibility(d.ACTION_VISIBILITY.CONTEXT_MENU,null).setVisibility(d.ACTION_VISIBILITY.ACTION_TOOLBAR,{label:"",permanent:function(){return 0==a.destroyed},widgetArgs:{style:"text-align:right;float:right;font-size:120%;"}}).setVisibility(d.ACTION_VISIBILITY.MAIN_MENU,{show:!1});return this._designToggleAction=e},_getItemActions:function(){try{if(!this.editor||
!this.ready)return[];this.restoreStyleView();var a=this._getViewActions();a&&a[0]&&(a=a[0].actions);var e=[],b=this;this._maqActions=a;e.push(this.getSplitViewAction());this._designToggleAction||e.push(this._createEditToggleAction());var c=function(b){b.handler=function(){try{l._runAction(b.action,k)}catch(V){console.error("action failed "+V,b)}}},k=null,v=null;this.editor&&this.editor.currentEditor&&this.editor.currentEditor.context&&(k=this.editor.currentEditor.context);for(var E=0;E<a.length;E++){var y=
a[E];_.isString(y.action)&&l._loadActionClass(y);y.action&&y.action.isEnabled&&y.action.isEnabled(k);"layout"===y.id&&(v=y);var w=this._toAction(y);w&&(w.action=y,c(w),e.push(w))}e.push(n.createDefault("Reload","fa-refresh","File/Reload","viewActions",null,{addPermission:!0,handler:function(){if(b.blockScopes){for(var e=0;e<b.blockScopes.length;e++){var a=b.blockScopes[e];b.ctx.getBlockManager().removeScope(a.id)}delete this.blockScopes}b.ctx.getFileManager().getContent(b.item.mount,b.item.path,function(e){b.editor.setContent(b.item.path,
e)})}}));var I=this.getEditorContext().getSelection();if(I.length){var g=I[0];h.getSmartInput(g.type).then(function(b){b&&b.show&&e.push(n.createDefault("Wizard","fa-magic","Edit/Wizard","viewActions",null,{handler:function(){b.show(g.id)}}))});e=e.concat(this.getWidgetLayoutActions(e))}if(v){var C=n.create("Layout","fa-crosshairs","View/Layout Mode",!1,null,d.ITEM_TYPE.WIDGET,"docActions",null,!1,function(){},{dummy:!0});e.push(C);var x=n.create("Relative","","View/Layout Mode/Relative",!1,null,
d.ITEM_TYPE.WIDGET,"docActions",null,!1,function(){b.getPageEditor().selectLayoutFlow()});e.push(x);var m=n.create("Absolute","","View/Layout Mode/Absolute",!1,null,d.ITEM_TYPE.WIDGET,"docActions",null,!1,function(){b.getPageEditor().selectLayoutAbsolute()});e.push(m)}this._layoutActions||(e=e.concat(this.getLayoutActions()));e.push(n.createDefault("Preview","text-success fa-eye","File/Open In Browser","viewActions",null,{mixin:{quick:!0}}).setVisibility(d.ACTION_VISIBILITY.ACTION_TOOLBAR,{label:"",
widgetArgs:{style:"text-align:right;float:right;font-size:120%;"}}));return e}catch(u){return[]}},getSplitViewActions:function(){return[]},getFlowActions:function(){var a=[],e={addPermission:!0,quick:!0};a.push(this.createAction({label:"Flow",command:"View/Layout Mode",icon:"fa-crosshairs",tab:"Home",group:"View",mixin:e}));a.push(this.createAction({label:"Relative",command:"View/Layout Mode/Relative",tab:"Home",group:"View",mixin:e}));a.push(this.createAction({label:"Absolute",command:"View/Layout Mode/Absolute",
tab:"Home",group:"View",mixin:e}));return a},getFloatActions:function(){var a=[];a.push(this.createAction({label:"Float",command:"View/Show/Float",icon:"fa-compress",tab:"Home",group:"View",mixin:{addPermission:!0,quick:!0}}));a.push(this.createAction({label:"Dock",command:"View/Show/Dock",icon:"fa-expand",tab:"Home",group:"View",mixin:{addPermission:!0,quick:!0}}));a.push(this.createAction({label:"View/Hide Code",command:"View/Show/Code",icon:"fa-code",tab:"Home",group:"View",mixin:{addPermission:!0,
quick:!0}}));return a},getItemActions:function(a){function e(e){var a=c._toAction(e);a&&a.command&&(a.tab="Home",a.mixin=k,a.action=e,b.push(a))}var b=[],c=this,b=b.concat(this.getSplitViewActions()),b=b.concat(this.getFloatActions()),b=b.concat(this.getWidgetBlockActions()),k={addPermission:!0,quick:!0,localize:!1};b.push(this.createAction({label:"Save",command:"File/Save",icon:"fa-save",group:"File",tab:"Home",keycombo:["ctrl s"],mixin:k}));b.push(this.createAction({label:"State",command:"Widget/State",
icon:"fa-magic",group:"Widget",tab:"Home",mixin:k}));b.push(this.createAction({label:"Add State",command:"Widget/State/Add",icon:"fa-magic",group:"Widget",tab:"Home",mixin:k,owner:this}));b.push(this.createAction({label:"Select",command:"Widget/Select",group:"Widget",tab:"Home",icon:"fa-hand-o-up",mixin:k}));b.push(this.createAction({label:"Show In Outline",command:"Widget/Show In Outline",group:"Widget",tab:"Home",icon:"fa-crosshairs",mixin:k}));b.push(this.createAction({label:"Move",command:"Widget/Move",
group:"Widget",tab:"Home",icon:"fa-reorder",mixin:k}));b=b.concat(this.getWidgetLayoutActions());b=b.concat(this.getEditToggleActions());b=b.concat(this.getFlowActions());b.push(this.createAction({label:"Focus",command:"Widget/Focus",group:"Widget",tab:"Home",icon:"fa-crosshairs",mixin:k}));(a=this._getViewActions(a))&&a[0]&&(a=a[0].actions);this._maqActions=a;this.getEditorContext();for(var v=0;v<a.length;v++){var E=a[v];l._loadActionClass(E);["label","showLabel","iconClass"].forEach(function(b){E.hasOwnProperty(b)});
if(E.menu&&("DropDownButton"==E.type||"ComboButton"==E.type))for(var y=0;y<E.menu.length;y++){var d=E.menu[y];l._loadActionClass(d);["label","iconClass"].forEach(function(b){});e(d)}"layout"===E.id&&(layoutAction=E);e(E)}return b},getEditToggleActions:function(){var a=[],e={addPermission:!0,quick:!0};a.push(this.createAction({label:"Edit",command:"View/Show/Design",icon:"fa-edit",tab:"Home",group:"View",mixin:e}));a.push(this.createAction({label:"Preview",command:"View/Show/Preview",icon:"fa-eye",
tab:"Home",group:"View",mixin:e}));return a},_toAction:function(a){var e=a.command||this._toCommand(a.label)||a.id;if(!e)return null;var b=this,e=this.createAction({label:a.label,group:a.group||"Ungrouped",icon:this._getIconClass(a.iconClass)||a.iconClass,command:e,tab:a.tab||"Home",mixin:{action:a,addPermission:!0,quick:!0,actionId:a.id,localize:!1},shouldDisable:function(){var e=b.getEditorContext();return e&&a.action&&a.action.isEnabled?!a.action.isEnabled(e):!1}});switch(a.id){case "documentSettings":return null;
case "outline":e.group="Widget";break;case "undo":case "redo":case "cut":case "copy":case "paste":e.group="Edit";break;case "delete":e.group="Organize";break;case "theme":case "rotateDevice":case "chooseDevice":case "stickynote":case "savecombo":case "showWidgetsPalette":case "layout":case "sourcecombo":case "design":case "closeactiveeditor":case "tableCommands":return null}return e},getWidgetLayoutActions:function(a){function e(e,a,k,v){c.push(b.createAction({label:e,icon:a,group:"Widget",tab:"Home",
command:"Widget/Align/"+k,mixin:{addPermission:!0,quick:!0}}))}var b=this,c=[];c.push(this.createAction({label:"Align",command:"Widget/Align",icon:"fa-arrows",group:"Widget",tab:"Home",mixin:{addPermission:!0,quick:!0,localize:!1},shouldDisable:function(){if(!b.getEditorContext())return!0;var e=b.getSelection();return 0==e.length||2>e.length}}));e("Align Left","layoutIcon-alignLeftVertical","Align Left",b._alignLeftVertical);e("Align Center","layoutIcon-alignCenterVertical","Align Center",b._alignCenterVertical);
e("Align Right","layoutIcon-alignRightVertical","Align Right",b._alignRightVertical);e("Align Top","layoutIcon-alignTopHorizontal","Align Top",b._alignTopHorizontal);e("Align Bottom","layoutIcon-alignBottomHorizontal","Align Bottom",b._alignBottomHorizontal);e("Same Size","layoutIcon-sameSize","Same Size",b._sameSize);e("Same Width","layoutIcon-sameWidth","Same Width",b._sameWidth);e("Same Height","layoutIcon-sameHeight","Same Height",b._sameHeight);return c},_getViewActions:function(){var a=[];g.getExtensions("davinci.editorActions",
function(b){if("davinci.ve.HTMLPageEditor"==b.editorContribution.targetID)return a.push(b.editorContribution),!0});0==a.length&&g.getExtension("davinci.defaultEditorActions",function(b){a.push(b.editorContribution);return!0});var e=h.getLibraryActions("davinci.editorActions","davinci.ve.HTMLPageEditor"),a=dojo.clone(a);0<a.length&&e.length&&dojo.forEach(e,function(b){var e=m("davinci/Workbench");b.action&&e._loadActionClass(b);if(b.menu)for(var c=0;c<b.menu.length;c++){var k=b.menu[0];k.action&&e._loadActionClass(k)}a[0].actions.push(b)});
return a},permissions:[C.RENAME,C.UNDO,C.REDO,C.RELOAD,C.CLIPBOARD,C.LAYOUT,C.COLUMNS,C.SELECTION,C.SAVE,C.SEARCH,C.TOOLBAR,"File/Properties",C.GO_UP,C.HEADER,C.COPY,C.CLOSE,C.MOVE,C.RENAME,C.RELOAD,C.CLIPBOARD,C.LAYOUT,C.SELECTION,C.SEARCH,C.OPEN_IN_TAB,C.TOOLBAR,C.SOURCE,C.CLIPBOARD_COPY,C.CLIPBOARD_PASTE,C.CLIPBOARD_CUT],startup:function(){var a=this,e=J.getDefaultActions(this.permissions,this,this),e=e.concat(this.getItemActions(e));e.push(this.createAction({label:"Edit",command:"Edit",icon:"fa-edit",
tab:"Home",group:"View",mixin:{addPermission:!0,quick:!0}}));this.addActions(e);this._on("selectionChanged",function(b){a.refreshActions();a.updateFocus&&setTimeout(function(){a.updateFocus()},500)});if(this.inherited)return this.inherited(arguments)}};q=q(w.dcl,C);q.GridClass=c("Actions",[w],C);q.Impl=C;return q})},"xideve/views/VisualEditorSourceEditor":function(){define(["dcl/dcl","xace/views/Editor","xide/utils","davinci/model/Factory"],function(q,A,m,n){return q(null,{declaredClass:"xideve/views/VisualEditorSourceEditor",
createHTMLEditor:function(d,g,l){var h=this;g=m.addWidget(A,{__permissions:[],options:{filePath:l.path},config:h.config,delegate:h,owner:h,parentContainer:d,ctx:h.ctx,style:"padding:0px;",item:l,resizeToParent:!0,model:n.newHTML({url:g}),selectModel:function(d){},setVisible:function(){},setContent:function(d,g){this.model.ctx=h.ctx;this.model.fileName=d;this.model.setText(g)},store:null,storeDelegate:{getContent:function(d){h.ctx.getFileManager().getContent(l.mount,l.path,d)},saveContent:function(d,
g,C){h.ctx.getFileManager().setContent(l.mount,l.path,d,g)}},title:"notitle",closable:!0},this,d,!0);h.textEditor=g;d.add(g);return g}})})},"xace/views/Editor":function(){define("dcl/dcl xide/types xide/utils xaction/ActionProvider xace/views/ACEEditor xace/views/_Actions xaction/Toolbar xide/mixins/PersistenceMixin".split(" "),function(q,A,m,n,d,g,l,h){h=q([h.dcl],{declaredClass:"xace.views.EditorPersistence",defaultPrefenceTheme:"idle_fingers",defaultPrefenceFontSize:14,saveValueInPreferences:!0,
getDefaultPreferences:function(){return m.mixin({theme:this.defaultPrefenceTheme,fontSize:this.defaultPrefenceFontSize},this.saveValueInPreferences?{value:this.get("value")}:null)},onAfterAction:function(d){var w=this.getEditor().getTheme();this.savePreferences({theme:w.replace("ace/theme/",""),fontSize:this.getEditor().getFontSize()});return this.inherited(arguments)},toPreferenceId:function(d){if(!d){var w=$("body");d="xTheme-";var g;_.each(["blue","gray","white","transparent"],function(a){g=d+
a;w.hasClass(g)&&(d=g)})}return(d||this.cookiePrefix||"")+"_xace"},getDefaultOptions:function(){var d=this.inherited(arguments),g=this.loadPreferences(null);g&&m.mixin(d,g)||this.savePreferences(this.getDefaultPreferences());return d}});q=q([g,d,n.dcl,h,l.dcl],{toolbarArgs:{actionFilter:{}},getBreadcrumbPath:function(){if(this.item)return{path:m.replaceAll("/","",this.item.mount)+":/"+this.item.path.replace("./","/")}},tabOrder:{Home:100,View:50,Settings:20},menuOrder:{File:110,Edit:100,View:90,Block:50,
Settings:20,Navigation:10,Editor:9,Step:5,New:4,Window:3,Help:2},declaredClass:"xace/views/Editor",options:null,loadingIcon:"fa-spinner fa-spin",iconClassNormal:"fa-code",templateString:'\x3cdiv attachTo\x3d"template" class\x3d"grid-template widget" style\x3d"width: 100%;height: 100%;overflow: hidden !important;position: relative;padding: 0px;margin: 0px"\x3e\x3cdiv attachTo\x3d"header" class\x3d"view-header row bg-opaque" style\x3d"height: auto;width:inherit;height:auto;min-height: 33px"\x3e\x3c/div\x3e\x3cdiv attachTo\x3d"aceNode" class\x3d"view-body row" style\x3d"height:100%;width: 100%;position: relative;"\x3e\x3c/div\x3e\x3cdiv attachTo\x3d"footer" class\x3d"view-footer" style\x3d"position: absolute;bottom: 0px;width: 100%"\x3e\x3c/div\x3e\x3c/div\x3e',
getContent:function(d,g,h){this.storeDelegate?this.storeDelegate.getContent(function(a){g(a)},d||this.item):h&&h("Editor::getContent : Have no store delegate!")},saveContent:function(d,g,h){var a=this;this.set("iconClass","fa-spinner fa-spin");var c=d||this.get("value");if(this.storeDelegate)return this.storeDelegate.saveContent(c,function(){a.set("iconClass",a.iconClassNormal);a.lastSavedContent=c;a.onContentChange(c);a.publish(A.EVENTS.ON_FILE_CONTENT_CHANGED,{path:a.options.filePath,item:a.item,
content:c,editor:a},a)},null,a.item);h&&h("Editor::saveContent : Have no store delegate!");return!1},addCommands:function(){var d=this.getAce(),g=this;ace.require("ace/config").init();var h=[];this.hasHelp&&h.push({name:"showKeyboardShortcuts",bindKey:{win:"Ctrl-Alt-h",mac:"Command-Alt-h"},exec:function(a){g.showHelp(a)}});this.hasConsole&&h.push({name:"gotoline",bindKey:{win:"Ctrl-L",mac:"Command-L"},exec:function(a,c){"object"==typeof c?(c=this.name+" "+a.getCursorPosition().row,a.cmdLine.setValue(c,
1),a.cmdLine.focus()):(c=parseInt(c,10),isNaN(c)||a.gotoLine(c))},readOnly:!0});d.commands.addCommands(h)},getWebRoot:function(){return this.ctx.getResourceManager().getVariable(A.RESOURCE_VARIABLES.APP_URL)},resize:function(){return this._resize()},onResize:function(){return this._resize()},_resize:function(){var d=this.getParent();this._isMaximized?m.resizeTo(this,this._maximizeContainer,!0,!0):d&&m.resizeTo(this,d,!0,!0);var d=this.getToolbar(),g=!1,h=$(this.aceNode);this._isMaximized&&d&&m.resizeTo(d,
this.header,!0,!0);!d||d&&d.isEmpty()?g=!0:d&&(m.resizeTo(d,this.header,!1,!0),d.resize(),m.resizeTo(this.header,d,!0,!1));var a=$(this.domNode).height(),g=1==g?0:$(this.header).height(),c=$(this.footer).height(),a=a-g-c;d&&(a-=4);50<a?h.height(a+"px"):h.height("inherited")},__set:function(d,g){var h=this.inherited(arguments);if("iconClass"===d){var a=this._parent;a&&a.icon&&this._parent.icon(g)}return h},__get:function(d){if("value"===d){var g=this.getEditor();return(g=g?g.session:null)?g.getValue():
null}return this.inherited(arguments)}});q.DEFAULT_PERMISSIONS=g.DEFAULT_PERMISSIONS;return q})},"xace/views/ACEEditor":function(){define("dcl/dcl dojo/has dojo/dom-construct xide/utils xide/types xide/widgets/TemplatedWidgetBase xace/views/_Split xaction/DefaultActions xace/views/_AceMultiDocs".split(" "),function(q,A,m,n,d,g,l,h,w){var J={};g=q([g],{resizeToParent:!0,templateString:'\x3cdiv attachTo\x3d"aceNode" style\x3d"width: 100%;height: 100%" class\x3d""\x3e\x3c/div\x3e'});w=q(w,{declaredClass:"xace/views/EditorInterface",
editorSession:null,_lastValue:null,enableMultiDocuments:function(){this.addFileCompleter().addDocument("asdf.js","var xxxTop \x3d 2*3;")},loadScript:function(a,c,d){c=document.createElement("script");c.type="application/javascript";c.src=a;c.onload=function(){d&&d()};document.body.appendChild(c)},setMode:function(a,c,g){if((c=c||this.ctx||window.sctx)&&c.getResourceManager()){var v=this;if(J[a])v.set("mode",a),g&&g(a);else{var k=null;(k=c.getResourceManager().getVariable(d.RESOURCE_VARIABLES.ACE))?
k=k+"/mode-"+a+".js":(c=c.getResourceManager().getVariable(d.RESOURCE_VARIABLES.APP_URL),A("debug"),k=c+"/xfile/ext/ace//mode-"+a+".js");this.loadScript(k,null,function(){J[a]=!0;v.set("mode",a);g&&g(a)})}}else console.error("have no resource manager!")},get:function(a){if("value"===a){var c=this.getEditor();return(c=c?c.session:null)?c.getValue():null}return this.inherited(arguments)},set:function(a,c){var d=this,v=this.getEditor(),k=this.editorSession;if("iconClass"===a){var y=this._parent;y&&y.icon&&
this._parent.icon(c)}if(v&&k)if(y=v.container,"item"==a&&(k.setUseWorker(!1),d.getContent(c,function(a){var e=d._getMode(c.path);d.set("value",a);d.setMode(e);k.setUseWorker(d.options.useWorker)})),"value"==a&&c)k.setValue(c);else if("theme"==a)"string"==typeof c&&(c="ace/theme/"+c),v.setTheme(c),this.split&&this.split.setTheme(c);else if("mode"==a)try{ace.require(["ace/mode/"+c],function(a){a&&a.Mode&&d.split.$editors.forEach(function(e){e.session.setMode(new a.Mode)})})}catch(D){console.error("ace mode failed : "+
c)}else"readOnly"==a?v.setReadOnly(c):"tabSize"==a?k.setTabSize(c):"softTabs"==a?k.setUseSoftTabs(c):"wordWrap"==a?k.setUseWrapMode(c):"printMargin"==a?v.renderer.setPrintMarginColumn(c):"showPrintMargin"==a?v.setShowPrintMargin(c):"highlightActiveLine"==a?v.setHighlightActiveLine(c):"fontSize"==a?$(y).css(a,c):"showIntentGuides"==a?v.setDisplayIndentGuides(c):"elasticTabstops"==a?v.setOption("useElasticTabstops",c):"useIncrementalSearch"==a?v.setOption("useIncrementalSearch",c):"showGutter"==a&&
v.renderer.setShowGutter(c);return this.inherited("set",arguments)},_getMode:function(a){a=a||this.fileName;var c="javascript";if(a){c=n.getFileExtension(a)||"js";if("js"===c||"xblox"===c)c="javascript";if("h"===c||"cpp"===c)c="c_cpp";if("html"===c||"cfhtml"===c||"dhtml"===c)c="html";"cp"===c&&(c="xml");"md"===c&&(c="markdown");"hbs"===c&&(c="handlebars")}return c},setOptions:function(a){this.options=a;var c=this;_.each(a,function(a,k){c.set(k,a)});var d=this.getEditor();d&&a.aceOptions&&(d.setOptions(a.aceOptions),
d.session.setUseWorker(a.useWorker),d.setOptions({enableBasicAutocompletion:!0,enableSnippets:!0,enableLiveAutocompletion:!0}),this.setMode(a.mode));return this.options},getOptions:function(){return this.options},onContentChange:function(a){this._parent&&this._parent.set&&this._parent.set("changed",a!==this.lastSavedContent)},onDidChange:function(){var a=this.get("value");this._lastValue!==a&&(this._lastValue=a,this._emit("change",a),this.onContentChange(a))},getDefaultOptions:function(a,c){var d=
this;return n.mixin({region:"center",style:"margin: 0; padding: 0; position:relative;overflow: auto;height:inherit;width:inherit;text-align:left;",readOnly:!1,tabSize:2,wordWrap:!1,showPrintMargin:!1,highlightActiveLine:!0,fontSize:16,showGutter:!0,showLineNumbers:!0,useWorker:!0,showInvisibles:!1,displayIndentGuides:!0,useSoftTabs:!0,fileName:"none",mode:"javascript",value:a||this.value||"No value",theme:"idle_fingers",splits:1,useElasticTabstops:!1,animatedScroll:!1,highlightActive:!0,aceOptions:{enableBasicAutocompletion:!0,
enableSnippets:!0,enableLiveAutocompletion:!0},onLoad:function(a){a.$blockScrolling=Infinity},onDidChange:function(){var a=d.get("value");if(a!==d.lastSavedContent)d.onContentChange(a)},onPrefsChanged:function(){d.setPreferences&&d.setPreferences()}},c)},getEditor:function(a){if(this.split)return null==a?this.split.getCurrentEditor():this.split.getEditor(null!=a?a:0);if(this.editor)return this.editor},resize:function(a,c,d){a=this.options||{};this.onResize&&this.onResize();return this.debounce("resize",
function(){var a=this.getEditor(),c=this.split||this.editor;if(a&&this.aceNode&&a.container)return a&&n.resizeTo(a.container,this.aceNode,!0,!0),c?c.resize():null;this.resize_debounced.cancel();this.resize_debounced=null}.bind(this),a.resizeDelay||300,null)},getAce:function(){return this.getEditor()},addBasicCommands:function(a){a=a||this.getEditor();var c=this,d=ace.require("ace/ext/whitespace");this._whiteSpaceExt=d;a.commands.addCommands(d.commands);a.commands.addCommands([{name:"gotoline",bindKey:{win:"Ctrl-L",
mac:"Command-L"},exec:function(a,c){"object"==typeof c?(c=this.name+" "+a.getCursorPosition().row,a.cmdLine.setValue(c,1),a.cmdLine.focus()):(c=parseInt(c,10),isNaN(c)||a.gotoLine(c))},readOnly:!0},{name:"snippet",bindKey:{win:"Alt-C",mac:"Command-Alt-C"},exec:function(a,c){"object"==typeof c?(a.cmdLine.setValue("snippet ",1),a.cmdLine.focus()):(c=snippetManager.getSnippetByName(c,a))&&snippetManager.insertSnippet(a,c.content)},readOnly:!0},{name:"increaseFontSize",bindKey:"Ctrl-+",exec:function(a){a.setFontSize(a.getFontSize()+
1);c.onAfterAction()}},{name:"decreaseFontSize",bindKey:"Ctrl+-",exec:function(a){a.setFontSize(a.getFontSize()-1);c.onAfterAction()}},{name:"resetFontSize",bindKey:"Ctrl+0",exec:function(a){a.setFontSize(12);c.onAfterAction()}}])},onEditorCreated:function(a,c){var d=this;a.getSelectedText=function(){return d.editorSession.getTextRange(this.getSelectionRange())};a.on("change",function(){d.onDidChange(arguments)});this.addBasicCommands(a);a.setFontSize(c.fontSize);a.$blockScrolling=Infinity;this._whiteSpaceExt&&
this._whiteSpaceExt.detectIndentation(a.session)},destroy:function(){var a=this.getEditor();a&&a.destroy();(a=this.resize_debounced)&&a.cancel()},getOptionsMixed:function(a){var c=this.getPreferences?this.getPreferences():{},d=this.getDefaultOptions(this.value,a||this.options);n.mixin(d,a);n.mixin(d,c);d.mode=this._getMode(d.fileName);return d},createEditor:function(a,c){this.set("iconClass",this.iconClassNormal);if(this.editor||this.split)return this.editor||this.split;var d=this.getPreferences?
this.getPreferences():{},v=this.getDefaultOptions(c);n.mixin(v,a);n.mixin(v,d);v.mode=this._getMode(v.fileName);a=v.targetNode||m.create("div");$(a).css({padding:"0",margin:"0",height:"100%",width:"100%"});this.aceNode.appendChild(a);var d=ace.require("ace/config"),k=null,y=null;ace.require("ace/ext/language_tools");try{this.split=k=new (l.getSplitter())(a,null,1),this._aceConfig=d,d.init(),this.editor=y=k.getEditor(0),this.editorSession=this.editor.getSession(),c&&this.editorSession.setValue(c),
k&&k.setSplits(v.splits)}catch(D){logError(D,"error creating editor")}this.setOptions(v);this.onEditorCreated(y,v);return y},addAutoCompleter:function(a){ace.require("ace/ext/language_tools").addCompleter({getCompletions:function(c,d,v,k,y){0===k.length?y(null,[]):a?y(null,a.map(function(a){return{name:a.value,value:a.word,meta:a.meta}})):y(null,[])}})}});var C=q(null,{declaredClass:"xace/views/ACE",onLoaded:function(){this.set("iconClass",this.iconClassNormal)},getKeyTarget:function(){return this.aceNode},
startup:function(){this.aceNode.id=n.createUUID();if(this.permissions){var a=h.getDefaultActions(this.permissions,this,this),a=a.concat(this.getEditorActions(this.permissions));this.addActions(a)}this.iconClassNormal=""+this.iconClass;this.set("iconClass","fa-spinner fa-spin");var c=this,d=this.options||{};if(this.item||null!=this.value)null!=this.value?(this.lastSavedContent=""+this.value,c.createEditor(c.options||null,this.value)):this.getContent(this.item,function(a){c.lastSavedContent=a;c.createEditor(c.options||
d,a)},function(a){c.createEditor(c.options||null,"");logError(a,"error loading content from file")})}});q=q([g,C,w],{});q.EditorImplementation=w;q.Editor=C;q.Container=g;q.Splitter=l;return q})},"xace/views/_Split":function(){define(["dcl/dcl"],function(q){var A=null;q=q(null,{declaredClass:"xace/views/Split"});q.getSplitter=function(){function m(a,c){this.$u=a;this.$doc=c}if(A)return A;var n=ace.require,d=n("ace/lib/oop"),g=n("ace/lib/lang"),l=n("ace/lib/event_emitter").EventEmitter,h=n("ace/editor").Editor,
w=n("ace/virtual_renderer").VirtualRenderer,J=n("ace/edit_session").EditSession,C=n("ace/undomanager").UndoManager;n("ace/keyboard/hash_handler");n=function(a,c,d){this.BELOW=1;this.BESIDE=0;this.$container=a;this.$theme=c;this.$splits=0;this.$editorCSS="";this.$editors=[];this.$orientation=this.BESIDE;this.setSplits(d||1);this.$cEditor=this.$editors[0];this.on("focus",function(a){this.$cEditor=a}.bind(this))};(function(){d.implement(this,l);this.$createEditor=function(){var a=document.createElement("div");
a.className=this.$editorCSS;a.style.cssText="position: absolute; top:0px; bottom:0px";this.$container.appendChild(a);var c=new h(new w(a,this.$theme));c.on("focus",function(){this._emit("focus",c)}.bind(this));this.$editors.push(c);c.session.setUndoManager(new C);c.setFontSize(this.$fontSize);return c};this.setSplits=function(a){var c;if(1>a)throw"The number of splits have to be \x3e 0!";if(a!=this.$splits){if(a>this.$splits){for(;this.$splits<this.$editors.length&&this.$splits<a;)c=this.$editors[this.$splits],
this.$container.appendChild(c.container),c.setFontSize(this.$fontSize),this.$splits++;for(;this.$splits<a;)this.$createEditor(),this.$splits++}else for(;this.$splits>a;)c=this.$editors[this.$splits-1],this.$container.removeChild(c.container),this.$splits--;this.resize()}};this.getSplits=function(){return this.$splits};this.getEditor=function(a){return this.$editors[a]};this.getCurrentEditor=function(){return this.$cEditor};this.focus=function(){this.$cEditor.focus()};this.blur=function(){this.$cEditor.blur()};
this.setSessionOption=function(a,c){this.$editors.forEach(function(d){d=d.session;"mode"==a&&d.setMode(c)})};this.setTheme=function(a){this.$editors.forEach(function(c){c.setTheme(a)})};this.setKeyboardHandler=function(a){this.$editors.forEach(function(c){c.setKeyboardHandler(a)})};this.forEach=function(a,c){this.$editors.forEach(a,c)};this.$fontSize="";this.setFontSize=function(a){this.$fontSize=a;this.forEach(function(c){c.setFontSize(a)})};this.$cloneSession=function(a){var c=new J(a.getDocument(),
a.getMode()),d=a.getUndoManager();d&&(d=new m(d,c),c.setUndoManager(d));c.$informUndoManager=g.delayedCall(function(){c.$deltas=[]});c.setTabSize(a.getTabSize());c.setUseSoftTabs(a.getUseSoftTabs());c.setOverwrite(a.getOverwrite());c.setBreakpoints(a.getBreakpoints());c.setUseWrapMode(a.getUseWrapMode());c.setUseWorker(a.getUseWorker());c.setWrapLimitRange(a.$wrapLimitRange.min,a.$wrapLimitRange.max);c.$foldData=a.$cloneFoldData();return c};this.setSession=function(a,c){c=null==c?this.$cEditor:this.$editors[c];
this.$editors.some(function(c){return c.session===a})&&(a=this.$cloneSession(a));c.setSession(a);return a};this.getOrientation=function(){return this.$orientation};this.setOrientation=function(a){this.$orientation!=a&&(this.$orientation=a,this.resize())};this.resize=function(){var a=this.$container.clientWidth,c=this.$container.clientHeight,d;if(this.$orientation==this.BESIDE){a/=this.$splits;this.diffGutter&&(a-=60/this.$splits);for(var v=0;v<this.$splits;v++){d=this.$editors[v];d.container.style.width=
a+"px";d.container.style.top="0px";d.container.style.left=v*a+"px";1==v&&this.diffGutter&&(d.container.style.left=60+v*a+"px",this.diffGutter.style.left=v*a+"px");if(!c)break;$(d.container).css("height",c+"px");var k=$(d.container).find(".ace_content");d.resize();k.css("height",c+"px")}}else for(c/=this.$splits,v=0;v<this.$splits;v++)d=this.$editors[v],d.container.style.width=a+"px",d.container.style.top=v*c+"px",d.container.style.left="0px",d.container.style.height=c+"px",d.resize()}}).call(n.prototype);
(function(){this.execute=function(a){this.$u.execute(a)};this.undo=function(){var a=this.$u.undo(!0);a&&this.$doc.selection.setSelectionRange(a)};this.redo=function(){var a=this.$u.redo(!0);a&&this.$doc.selection.setSelectionRange(a)};this.reset=function(){this.$u.reset()};this.hasUndo=function(){return this.$u.hasUndo()};this.hasRedo=function(){return this.$u.hasRedo()}}).call(m.prototype);return A=n};return q})},"xace/views/_AceMultiDocs":function(){define(["dcl/dcl","xdojo/declare","module","xace/base_handler",
"xace/complete_util"],function(q,A,m,n,d){function g(a,c,d,g){c=c.split(/[^a-zA-Z_0-9\$]+/);for(var e=0;e<c.length;e++){var b=c[e];b&&(Object.prototype.hasOwnProperty.call(d,b)?d[b]++:(d[b]=1,g[b]={}),g[b][a]=!0)}return d}function l(a){var c=w[a];if(c){for(var d in c)J[d]-=c[d],delete C[d][a],0===J[d]&&(delete J[d],delete C[d]);delete w[a]}}function h(a,c){w[a]||(8E5<c.size?delete w[a]:(w[a]=g(a,c,{},{}),g(a,c,J,C)))}var w={},J={},C={},a,c,I=m.exports=Object.create(n);I.handlesLanguage=function(a){return!0};
I.handlesEditor=function(){return this.HANDLES_ANY};I.getMaxFileSizeSupported=function(){return 1E6};I.onDocumentOpen=function(a,c,d,g){w[a]||h(a,c.getValue());g()};I.addDocument=function(a,c){w[a]||h(a,c)};I.onDocumentClose=function(d,k){l(d);d==a&&(c=null);k()};I.analyze=function(d,k,y,g){c&&this.path!==a&&(l(a),h(a,c),c=null);a=this.path;c=d;y()};I.complete=function(a,c,y,g,e){a=a.getSession().getLine(y.row);y=d.retrievePrecedingIdentifier(a,y.column,this.$getIdentifierRegex());var b=J;a=[];for(var k in b)a.push(k);
k=d.findCompletions(y,a);var v=this.path;k=k.filter(function(a){return!C[a][v]});k=k.slice(0,100);e(k.filter(function(a){return!a.match(/^[0-9$_\/]/)}).map(function(a){var e=(Object.keys(C[a])[0]||"[unknown]").split("/");return{name:a,value:a,icon:null,score:b[a],meta:e[e.length-1],priority:0,isGeneric:!0}}))};I.getCompletions=function(a,c,d,g,e){var b=null;I.complete(a,null,d,null,function(a){b=a});e(null,b)};q=q(null,{declaredClass:"xide.views._AceMultiDocs",didAddMCompleter:!1,multiFileCompleter:null,
addFileCompleter:function(){var a=null;this.didAddMCompleter||(this.multiFileCompleter=a=I,ace.require("ace/ext/language_tools").addCompleter(a),this.didAddMCompleter=!0);return a}});q.completer=I;return q})},"xace/base_handler":function(){define(function(q,A,m){m.exports={HANDLES_ANY:0,HANDLES_EDITOR:1,HANDLES_IMMEDIATE:2,HANDLES_EDITOR_AND_IMMEDIATE:3,language:null,path:null,workspaceDir:null,doc:null,isFeatureEnabled:function(n){return!disabledFeatures[n]},$getIdentifierRegex:function(){return null},
completeUpdate:function(n){throw Error("Use worker_util.completeUpdate instead()");},handlesLanguage:function(n){throw Error("base_handler.handlesLanguage() is not overridden");},handlesEditor:function(){return this.HANDLES_EDITOR},getMaxFileSizeSupported:function(){return 8E5},isParsingSupported:function(){return!1},getIdentifierRegex:function(){return null},getCompletionRegex:function(){return null},getTooltipRegex:function(){return null},parse:function(n,d){d()},findNode:function(n,d,g){g()},getPos:function(n,
d){d()},init:function(n){n()},onUpdate:function(n,d){d()},onDocumentOpen:function(n,d,g,l){l()},onDocumentClose:function(n,d){d()},onCursorMove:function(n,d,g,l,h){h()},tooltip:function(n,d,g,l,h){h()},highlightOccurrences:function(n,d,g,l,h){h()},getRefactorings:function(n,d,g,l,h){h()},outline:function(n,d,g){g()},hierarchy:function(n,d,g){g()},complete:function(n,d,g,l,h){h()},analyze:function(n,d,g,l){g()},getRenamePositions:function(n,d,g,l,h){h()},onRenameBegin:function(n,d){d()},commitRename:function(n,
d,g,l,h){h()},onRenameCancel:function(n){n()},codeFormat:function(n,d){d()},jumpToDefinition:function(n,d,g,l,h){h()},getResolutions:function(n,d,g,l){l()},hasResolution:function(n,d,g,l){l()},getInspectExpression:function(n,d,g,l,h){h()}};for(f in m.exports)"function"===typeof m.exports[f]&&(m.exports[f].base_handler=!0)})},"xace/complete_util":function(){define(function(q,A,m){function n(d,h,l){l=l||g;var a=[];for(--h;0<=h&&d;h--)if(l.test(d[h]))a.push(d[h]);else break;return a.reverse().join("")}
function d(d,g,h,a,c){if(-1===["javascript","jsx"].indexOf(a.getSession().syntax))return!1;a=null==h?n(d,g,l):h;h=9-(c?1:0);g=g-a.length-h;c=d.substr(g,h)+(c?'"':"");return 0<=g&&c.match(/require\(["']/)||d.substr(g+1,h).match(/require\(["']/)}var g=/[a-zA-Z_0-9\$]/,l=/(?!["'])./,h="../static/lib";A.precededByIdentifier=function(g,h,l,a){var c=n(g,h);l&&(c+=l);if(l=""!==c&&!("0"<=c[0]&&"9">=c[0])){if(-1===["javascript","jsx"].indexOf(a.getSession().syntax))l=!0;else{l=null;for(var w=0;w<h;w++)'"'!==
g[w]||l?'"'===g[w]&&'"'===l&&"\\"!==g[w-1]?l=null:"'"!==g[w]||l?"'"===g[w]&&"'"===l&&"\\"!==g[w-1]?l=null:"/"===g[w]&&"/"===g[w+1]?(l="//",w++):"/"!==g[w]||"*"!==g[w+1]||l?"*"===g[w]&&"/"===g[w+1]&&"/*"===l?(l=null,w++):"/"!==g[w]||l?"/"===g[w]&&"/"===l&&"\\"!==g[w-1]&&(l=null):l="/":"global"!==g.substr(w+2,6)&&(l="/*",w++):l="'":l='"';l="/"!=l}l=l||d(g,h,c,a)}return l};A.isRequireJSCall=d;A.retrievePrecedingIdentifier=n;A.retrieveFollowingIdentifier=function(d,h,l){l=l||g;for(var a=[];d&&h<d.length;h++)if(l.test(d[h]))a.push(d[h]);
else break;return a.join("")};A.findCompletions=function(d,g){g.sort();for(var h=0,a=g.length-1,c=Math.floor((a+h)/2);a>h&&0<=c&&0!==g[c].indexOf(d);)d<g[c]?a=c-1:d>g[c]&&(h=c+1),c=Math.floor((a+h)/2);for(;0<c&&0===g[c-1].indexOf(d);)c--;h=[];for(c=0<=c?c:0;c<g.length&&0===g[c].indexOf(d);c++)h.push(g[c]);return h};A.fetchText=function(d){var g=new XMLHttpRequest;d=h+"/"+d;console.error("fetch text : "+d);g.open("GET",d,!1);try{g.send()}catch(C){return!1}return 200===g.status||g.responseText?g.responseText:
!1};A.setStaticPrefix=function(d){h=d};A.DEFAULT_ID_REGEX=g;A.canCompleteForChangedLine=function(d,g,h,a,c){if(h.row!==a.row||0!==g.indexOf(d))return!1;h=n(d,h.column,c);a=n(g,a.column,c);return g.substr(0,g.length-a.length)===d.substr(0,d.length-h.length)}})},"xace/views/_Actions":function(){define("dcl/dcl xide/utils xide/types xide/types/Types xaction/types xaction/ActionProvider xace/views/ACEEditor xaction/Toolbar xaction/DefaultActions dojo/Deferred xace/formatters".split(" "),function(q,A,
m,n,d,g,l,h,w,J,C){n=m.ACTION;var a=m.VIEW_SPLIT_MODE;n=[n.RELOAD,n.SAVE,n.FIND,n.TOOLBAR,"Editor/Keyboard","View/Increase Font Size","View/Decrease Font Size","View/Themes","Help/Editor Shortcuts","Editor/Snippets","Editor/Console","Editor/Settings",n.FULLSCREEN,"View/Layout","Edit/Format"];g=q([l,h.dcl,g.dcl],{permissions:n,_searchBoxOpen:!1,onSingleView:function(){},setSplitMode:function(c){this.splitMode=c;if(!this.doSplit)if("Diff"==c)this.doDiff();else{var d=c==a.SPLIT_HORIZONTAL||c==a.SPLIT_VERTICAL,
g=this.getEditor(),k=this.split;d?(d=1==k.getSplits(),k.setOrientation(c==a.SPLIT_HORIZONTAL?k.BELOW:k.BESIDE),k.setSplits(2),d&&(c=k.getEditor(0).session,k.setSession(c,1).name=c.name,g=g.getOptions(),k.getEditor(1).setOptions(g))):(k.setSplits(1),this.onSingleView())}},onMaximized:function(a){var c=this.getParent();!1===a&&c&&c.resize&&c.resize();var d=this.getToolbar();d&&(a?$(d.domNode).addClass("bg-opaque"):$(d.domNode).removeClass("bg-opaque"));!1===a&&(this.resize(),c&&A.resizeTo(this,c,!0,
!0),this.publish(m.EVENTS.ON_VIEW_MAXIMIZE_END));this.getEditor().focus()},maximize:function(){var a=this.domNode,d=$(a);this.getToolbar();if(this._isMaximized)this._isMaximized=!1,d.removeClass("AceEditorPaneFullScreen"),this._lastParent.appendChild(a),A.destroy(this._maximizeContainer);else{this.publish(m.EVENTS.ON_VIEW_MAXIMIZE_START);this._isMaximized=!0;var d=$(this.domNode.ownerDocument),g=$("body")[0],k=A.create("div",{className:"ACEContainer bg-opaque",style:"z-index:300;height:100%;width:100%"});
this._maximizeContainer=k;g.appendChild(k);$(a).addClass("AceEditorPaneFullScreen");$(a).css("width",d.width());$(a).css("height",d.height());this.resize();this._lastParent=a.parentNode;k.appendChild(a);$(k).addClass("bg-opaque");$(k).css("width",d.width());$(k).css("height",d.height());$(k).css({position:"absolute",left:"0px",top:"0px",border:"none medium",width:"100%",height:"100%"})}this.onMaximized(this._isMaximized);return!0},save:function(a){var c=this.get("value"),d=this.saveContent(this.get("value"),
a),k=this;this._emit(m.EVENTS.ON_FILE_CONTENT_CHANGED,{content:c,item:a});setTimeout(function(){var a=k.getEditor();a&&a.focus()},600);return d},reload:function(){var a=this,d=new J;this.getContent(this.item,function(c){a.lastSavedContent=c;a.set("value",c);d.resolve(c)},function(a){logError(a,"error loading content from file");d.reject(a)});return d},runAction:function(a){a=this.getAction(a);if(!a)return!1;var c=this,d=a.command,k=m.ACTION,g=this.getEditor(),h=this.editorSession;-1!=d.indexOf("View/Layout")&&
c.setSplitMode(a.option,null);switch(d){case k.RELOAD:return this.reload();case "View/Increase Font Size":return g.setFontSize(g.getFontSize()+1),!0;case "View/Decrease Font Size":return g.setFontSize(g.getFontSize()-1),!0;case k.FULLSCREEN:return this.maximize();case "Help/Editor Shortcuts":c.showHelp();break;case k.SAVE:c.save(this.item);break;case k.FIND:var e=function(a){c._searchBoxOpen?(a.hide(),c._searchBoxOpen=!1):(a.show(g.session.getTextRange(),null),c._searchBoxOpen=!0)},h=ace.require("ace/lib/net"),
d=this.getWebRoot();(k=g.searchBox)?e(k):h.loadScript(d+"/xfile/ext/ace/ext-searchbox.js",function(a){a=ace.require("ace/ext/searchbox");e(new a.SearchBox(g))});return!0}if(-1!==d.indexOf("View/Themes")){c.set("theme",a.theme);if(k=a.getParent?a.getParent():null)k=k.getChildren(),_.each(k,function(a){a.set("icon",a._oldIcon)});a.set("icon","fa fa-check")}-1!==d.indexOf("Edit/Format")&&g&&(k=C.format(g,a.formatter),c.set("value",k));if(-1!==d.indexOf("Editor/Settings")){var d=a.option,k=g.getOption(a.option),
b=_.isBoolean(k);if("highlightActive"===d){g.setHighlightActiveLine(!g.getHighlightActiveLine());return}if(b)g.setOption(a.option,!k);else{if("wordWrap"===d)return h=h.getUseWrapMode(),this.set("wordWrap",!h),!0;"off"===k||"on"===k?g.setOption(d,"off"===k?"on":"off"):g.setOption(a.option,!1)}return!0}return this.inherited(arguments)},getEditorActions:function(c){function d(a,e,c,d,h,y,l,t){h=h=h||{};a=k.createAction(A.mixin({label:a,command:e||"Editor/Settings/"+a||"Editor/Settings/"+a,icon:c||"fa-cogs",
group:y||"Settings",mixin:A.mixin({addPermission:!0,option:d,actionType:l,owner:k},h)},t));g.push(a);return a}var g=[],k=this,h=m.ACTION,l=m.ACTION_ICON;g.push(this.createAction({label:"Save",command:h.SAVE,icon:l.SAVE,keycombo:"ctrl s",group:"File"}));g.push(this.createAction({label:"Find",command:h.FIND,icon:l.SEARCH,keycombo:"ctrl f",group:"Search"}));g.push(this.createAction({label:"Fullscreen",command:h.FULLSCREEN,icon:l.MAXIMIZE,keycombo:"ctrl f11",group:"View"}));g.push(this.createAction({label:"Increase Fontsize",
command:"View/Increase Font Size",icon:"fa-text-height",group:"View"}));g.push(this.createAction({label:"Decrease Fontsize",command:"View/Decrease Font Size",icon:"fa-text-height",group:"View"}));w.hasAction(c,"View/Themes")&&(g.push(this.createAction({label:"Themes",command:"View/Themes",icon:"fa-paint-brush",group:"View",mixin:{closeOnClick:!1,value:this.defaultPrefenceTheme},onCreate:function(a){var b=k.getDefaultOptions();a.set("value",b.theme)}})),k._addThemes&&k._addThemes(g));g.push(this.createAction({label:"Help",
command:"Help/Editor Shortcuts",icon:"fa-question",keycombo:"f1"}));g.push(this.createAction({label:"Settings",command:"Editor/Settings",icon:"fa-cogs",group:"Settings"}));h={onCreate:function(a){var b=k.getOptionsMixed()[this.option];null!==b&&a.set("value",b)},onChange:function(a,e){this.value=e;k.runAction(this)}};d("Show Gutters",null,null,"showGutter",null,null,m.ACTION_TYPE.MULTI_TOGGLE,h);d("Show Print Margin",null,null,"showPrintMargin",null,null,m.ACTION_TYPE.MULTI_TOGGLE,h);d("Display Intend Guides",
null,null,"displayIndentGuides",null,null,m.ACTION_TYPE.MULTI_TOGGLE,h);d("Show Line Numbers",null,null,"showLineNumbers",null,null,m.ACTION_TYPE.MULTI_TOGGLE,h);d("Show Indivisibles",null,null,"showInvisibles",null,null,m.ACTION_TYPE.MULTI_TOGGLE,h);d("Use Soft Tabs",null,null,"useSoftTabs",null,null,m.ACTION_TYPE.MULTI_TOGGLE,h);d("Use Elastic Tab Stops",null,null,"useElasticTabstops",null,null,m.ACTION_TYPE.MULTI_TOGGLE,h);d("Animated Scroll",null,null,"animatedScroll",null,null,m.ACTION_TYPE.MULTI_TOGGLE,
h);d("Word Wrap",null,null,"wordWrap",null,null,m.ACTION_TYPE.MULTI_TOGGLE,h);d("Highlight Active Line",null,null,"highlightActive",null,null,m.ACTION_TYPE.MULTI_TOGGLE,h);if(w.hasAction(c,"Edit/Format")){g.push(this.createAction({label:"Format",command:"Edit/Format",icon:"fa-indent",group:"Edit"}));var h=C.modes,l=function(a,e,c){a=k.createAction({label:a,command:"Edit/Format/"+a,icon:"fa-indent",group:"Edit",mixin:{addPermission:!0,formatter:c},onCreate:function(a){}});g.push(a)},e;for(e in h)g.push(l(h[e],
"",e))}w.hasAction(c,"View/Layout")&&(g.push(this.createAction({label:"Split",command:"View/Layout",icon:"fa-columns",group:"View"})),g.push(d("None","View/Layout/None","fa-columns",a.SOURCE,null,"View",m.ACTION_TYPE.SINGLE_TOGGLE)),g.push(d("Horizontal","View/Layout/Horizontal","layoutIcon-horizontalSplit",a.SPLIT_HORIZONTAL,null,"View",m.ACTION_TYPE.SINGLE_TOGGLE)),g.push(d("Vertical","View/Layout/Vertical","layoutIcon-layout293",a.SPLIT_VERTICAL,null,"View",m.ACTION_TYPE.SINGLE_TOGGLE)));return g},
_addThemes:function(a){for(var c=this.getThemeData(),d=this,k=function(a,e,c){return d.createAction({label:a,command:"View/Themes/"+a,group:"View",icon:e,mixin:{addPermission:!0,value:c,theme:c,closeOnClick:!1},onCreate:function(a){a._oldIcon=e;a.set("value",c);a.actionType=m.ACTION_TYPE.SINGLE_TOGGLE}})},g=0;g<c.length;g++){var h=c[g],e=h[1]||h[0].replace(/ /g,"_").toLowerCase(),h=k(h[0]," ",e);a.push(h)}},showHelp:function(a){a=a||this.getEditor();ace.require("ace/config").loadModule("ace/ext/keybinding_menu",
function(c){c.init(a);a.showKeyboardShortcuts()})},getThemeData:function(){return[["Chrome"],["Clouds"],["Crimson Editor"],["Dawn"],["Dreamweaver"],["Eclipse"],["GitHub"],["Solarized Light"],["TextMate"],["Tomorrow"],["XCode"],["Kuroir"],["KatzenMilch"],["Ambiance","ambiance","dark"],["Day","cloud9_day"],["Night","cloud9_night"],["Chaos","chaos","dark"],["Midnight","clouds_midnight","dark"],["Cobalt","cobalt","dark"],["idle Fingers","idle_fingers","dark"],["krTheme","kr_theme","dark"],["Merbivore",
"merbivore","dark"],["Merbivore-Soft","merbivore_soft","dark"],["Mono Industrial","mono_industrial","dark"],["Monokai","monokai","dark"],["Pastel on dark","pastel_on_dark","dark"],["Solarized Dark","solarized_dark","dark"],["Terminal","terminal","dark"],["Tomorrow-Night","tomorrow_night","dark"],["Tomorrow-Night-Blue","tomorrow_night_blue","dark"],["Tomorrow-Night-Bright","tomorrow_night_bright","dark"],["Tomorrow-Night-80s","tomorrow_night_eighties","dark"],["Twilight","twilight","dark"],["Vibrant Ink",
"vibrant_ink","dark"]]}});g.DEFAULT_PERMISSIONS=n;q.chainAfter("runAction",g);return g})},"xace/formatters":function(){define(["xace/lib_jsbeautify"],function(q){return{format:function(A,m){if(!0!==this.disabled){var n=A.session;A=A.selection.getRange();var d={space_before_conditional:!0,keep_array_indentation:!1,preserve_newlines:!0,unescape_strings:!0,jslint_happy:!1,brace_style:"end-expand",indent_char:" "};d.indent_size=n.getTabSize();var g=n.getLine(A.start.row).match(/^\s*/)[0],l=!1;A.start.column<
g.length?A.start.column=0:l=!0;var h=n.getTextRange(A);0==h.length&&(h=n.getValue());n=null;"javascript"==m||"json"==m?n="js":"css"==m||"less"==m?n="css":/^\s*<!?\w/.test(h)?n="html":"xml"==m?n="html":"html"==m?n=/[^<]+?{[\s\-\w]+:[^}]+;/.test(h)?"css":/<\w+[ \/>]/.test(h)?"html":"js":"handlebars"==m&&(d.indent_handlebars=!0,n="html");try{h=q[n+"_beautify"](h,d),l&&(h=h.replace(/^/gm,g).trim()),0===A.end.column&&(h+="\n"+g)}catch(w){return!1}return h}},modes:{javascript:"Javascript (JS Beautify)",
html:"HTML (JS Beautify)",css:"CSS (JS Beautify)",less:"Less (JS Beautify)",xml:"XML (JS Beautify)",json:"JSON (JS Beautify)",handlebars:"Handlebars (JS Beautify)"}}})},"xace/lib_jsbeautify":function(){define(["require","exports","module"],function(q,A,m){var n=m.exports={};(function(){function d(a,c){for(var d=0;d<c.length;d+=1)if(c[d]===a)return!0;return!1}function g(a){return a.replace(/^\s+|\s+$/g,"")}function l(a,c){return(new h(a,c)).beautify()}function h(a,k){function h(a,b){var e=0;a&&(e=
a.indentation_level,!x.just_added_newline()&&a.line_indent_level>e&&(e=a.line_indent_level));return{mode:b,parent:a,last_text:a?a.last_text:"",last_word:a?a.last_word:"",declaration_statement:!1,declaration_assignment:!1,multiline_frame:!1,if_block:!1,else_block:!1,do_block:!1,do_while:!1,in_case_statement:!1,in_case:!1,case_body:!1,indentation_level:e,line_indent_level:a?a.line_indent_level:e,start_line_index:x.get_line_number(),ternary_depth:0}}function l(a){var e=a.newlines;if(F.keep_array_indentation&&
p.mode===c.ArrayLiteral)for(d=0;d<e;d+=1)b(0<d);else if(F.max_preserve_newlines&&e>F.max_preserve_newlines&&(e=F.max_preserve_newlines),F.preserve_newlines&&1<a.newlines){b();for(var d=1;d<e;d+=1)b(!0)}z=a;X[z.type]()}function e(a){a=void 0===a?!1:a;x.just_added_newline()||(F.preserve_newlines&&z.wanted_newline||a?b(!1,!0):F.wrap_line_length&&x.current_line.get_character_count()+z.text.length+(x.space_before_token?1:0)>=F.wrap_line_length&&b(!1,!0))}function b(a,b){if(!b&&";"!==p.last_text&&","!==
p.last_text&&"\x3d"!==p.last_text&&"TK_OPERATOR"!==B)for(;p.mode===c.Statement&&!p.if_block&&!p.do_block;)E();x.add_new_line(a)&&(p.multiline_frame=!0)}function r(a){a=a||z.text;x.just_added_newline()&&(F.keep_array_indentation&&p.mode===c.ArrayLiteral&&z.wanted_newline?(x.current_line.push(z.whitespace_before),x.space_before_token=!1):x.set_indent(p.indentation_level)&&(p.line_indent_level=p.indentation_level));x.add_token(a)}function v(a){p?(O.push(p),M=p):M=h(null,a);p=h(M,a)}function w(a){return d(a,
[c.Expression,c.ForInitializer,c.Conditional])}function E(){0<O.length&&(M=p,p=O.pop(),M.mode===c.Statement&&x.remove_redundant_indentation(M))}function L(){return p.parent.mode===c.ObjectLiteral&&p.mode===c.Statement&&(":"===p.last_text&&0===p.ternary_depth||"TK_RESERVED"===B&&d(p.last_text,["get","set"]))}function H(){return"TK_RESERVED"===B&&d(p.last_text,["var","let","const"])&&"TK_WORD"===z.type||"TK_RESERVED"===B&&"do"===p.last_text||"TK_RESERVED"===B&&"return"===p.last_text&&!z.wanted_newline||
"TK_RESERVED"===B&&"else"===p.last_text&&("TK_RESERVED"!==z.type||"if"!==z.text)||"TK_END_EXPR"===B&&(M.mode===c.ForInitializer||M.mode===c.Conditional)||"TK_WORD"===B&&p.mode===c.BlockStatement&&!p.in_case&&"--"!==z.text&&"++"!==z.text&&"TK_WORD"!==z.type&&"TK_RESERVED"!==z.type||p.mode===c.ObjectLiteral&&(":"===p.last_text&&0===p.ternary_depth||"TK_RESERVED"===B&&d(p.last_text,["get","set"]))?(v(c.Statement),p.indentation_level+=1,"TK_RESERVED"===B&&d(p.last_text,["var","let","const"])&&"TK_WORD"===
z.type&&(p.declaration_statement=!0),L()||e("TK_RESERVED"===z.type&&d(z.text,["do","for","if","while"])),!0):!1}function t(a){return d(a,"case return do if throw else".split(" "))}function n(a){a=u+(a||0);return 0>a||a>=q.length?null:q[a]}function P(){"TK_RESERVED"===z.type&&p.mode!==c.ObjectLiteral&&d(z.text,["set","get"])&&(z.type="TK_WORD");"TK_RESERVED"===z.type&&p.mode===c.ObjectLiteral&&":"==n(1).text&&(z.type="TK_WORD");H()||!z.wanted_newline||w(p.mode)||"TK_OPERATOR"===B&&"--"!==p.last_text&&
"++"!==p.last_text||"TK_EQUALS"===B||!F.preserve_newlines&&"TK_RESERVED"===B&&d(p.last_text,["var","let","const","set","get"])||b();if(p.do_block&&!p.do_while){if("TK_RESERVED"===z.type&&"while"===z.text){x.space_before_token=!0;r();x.space_before_token=!0;p.do_while=!0;return}b();p.do_block=!1}if(p.if_block)if(p.else_block||"TK_RESERVED"!==z.type||"else"!==z.text){for(;p.mode===c.Statement;)E();p.if_block=!1;p.else_block=!1}else p.else_block=!0;if("TK_RESERVED"===z.type&&("case"===z.text||"default"===
z.text&&p.in_case_statement)){b();if(p.case_body||F.jslint_happy)0<p.indentation_level&&(!p.parent||p.indentation_level>p.parent.indentation_level)&&--p.indentation_level,p.case_body=!1;r();p.in_case=!0;p.in_case_statement=!0}else{"TK_RESERVED"===z.type&&"function"===z.text&&(!(d(p.last_text,["}",";"])||x.just_added_newline()&&!d(p.last_text,["[","{",":","\x3d",","]))||x.just_added_blankline()||z.comments_before.length||(b(),b(!0)),"TK_RESERVED"===B||"TK_WORD"===B?"TK_RESERVED"===B&&d(p.last_text,
["get","set","new","return","export"])?x.space_before_token=!0:"TK_RESERVED"===B&&"default"===p.last_text&&"export"===I?x.space_before_token=!0:b():"TK_OPERATOR"===B||"\x3d"===p.last_text?x.space_before_token=!0:(p.multiline_frame||!w(p.mode)&&p.mode!==c.ArrayLiteral)&&b());if("TK_COMMA"===B||"TK_START_EXPR"===B||"TK_EQUALS"===B||"TK_OPERATOR"===B)L()||e();"TK_RESERVED"===z.type&&d(z.text,["function","get","set"])?(r(),p.last_word=z.text):(K="NONE","TK_END_BLOCK"===B?"TK_RESERVED"===z.type&&d(z.text,
["else","catch","finally"])?"expand"===F.brace_style||"end-expand"===F.brace_style||"none"===F.brace_style&&z.wanted_newline?K="NEWLINE":(K="SPACE",x.space_before_token=!0):K="NEWLINE":"TK_SEMICOLON"===B&&p.mode===c.BlockStatement?K="NEWLINE":"TK_SEMICOLON"===B&&w(p.mode)?K="SPACE":"TK_STRING"===B?K="NEWLINE":"TK_RESERVED"===B||"TK_WORD"===B||"*"===p.last_text&&"function"===I?K="SPACE":"TK_START_BLOCK"===B?K="NEWLINE":"TK_END_EXPR"===B&&(x.space_before_token=!0,K="NEWLINE"),"TK_RESERVED"===z.type&&
d(z.text,A.line_starters)&&")"!==p.last_text&&(K="else"===p.last_text||"export"===p.last_text?"SPACE":"NEWLINE"),"TK_RESERVED"===z.type&&d(z.text,["else","catch","finally"])?"TK_END_BLOCK"!==B||"expand"===F.brace_style||"end-expand"===F.brace_style||"none"===F.brace_style&&z.wanted_newline?b():(x.trim(!0),"}"!==x.current_line.last()&&b(),x.space_before_token=!0):"NEWLINE"===K?"TK_RESERVED"===B&&t(p.last_text)?x.space_before_token=!0:"TK_END_EXPR"!==B?"TK_START_EXPR"===B&&"TK_RESERVED"===z.type&&d(z.text,
["var","let","const"])||":"===p.last_text||("TK_RESERVED"===z.type&&"if"===z.text&&"else"===p.last_text?x.space_before_token=!0:b()):"TK_RESERVED"===z.type&&d(z.text,A.line_starters)&&")"!==p.last_text&&b():p.multiline_frame&&p.mode===c.ArrayLiteral&&","===p.last_text&&"}"===I?b():"SPACE"===K&&(x.space_before_token=!0),r(),p.last_word=z.text,"TK_RESERVED"===z.type&&"do"===z.text&&(p.do_block=!0),"TK_RESERVED"===z.type&&"if"===z.text&&(p.if_block=!0))}}var x,q=[],u,A,z,B,I,J,p,M,O,K,X,F,Q="";X={TK_START_EXPR:function(){H();
var a=c.Expression;if("["===z.text){if("TK_WORD"===B||")"===p.last_text){"TK_RESERVED"===B&&d(p.last_text,A.line_starters)&&(x.space_before_token=!0);v(a);r();p.indentation_level+=1;F.space_in_paren&&(x.space_before_token=!0);return}a=c.ArrayLiteral;p.mode!==c.ArrayLiteral||"["!==p.last_text&&(","!==p.last_text||"]"!==I&&"}"!==I)||F.keep_array_indentation||b()}else"TK_RESERVED"===B&&"for"===p.last_text?a=c.ForInitializer:"TK_RESERVED"===B&&d(p.last_text,["if","while"])&&(a=c.Conditional);";"===p.last_text||
"TK_START_BLOCK"===B?b():"TK_END_EXPR"===B||"TK_START_EXPR"===B||"TK_END_BLOCK"===B||"."===p.last_text?e(z.wanted_newline):"TK_RESERVED"===B&&"("===z.text||"TK_WORD"===B||"TK_OPERATOR"===B?"TK_RESERVED"===B&&("function"===p.last_word||"typeof"===p.last_word)||"*"===p.last_text&&"function"===I?F.space_after_anon_function&&(x.space_before_token=!0):"TK_RESERVED"===B&&(d(p.last_text,A.line_starters)||"catch"===p.last_text)&&F.space_before_conditional&&(x.space_before_token=!0):x.space_before_token=!0;
"("!==z.text||"TK_EQUALS"!==B&&"TK_OPERATOR"!==B||L()||e();v(a);r();F.space_in_paren&&(x.space_before_token=!0);p.indentation_level+=1},TK_END_EXPR:function(){for(;p.mode===c.Statement;)E();p.multiline_frame&&e("]"===z.text&&p.mode===c.ArrayLiteral&&!F.keep_array_indentation);F.space_in_paren&&("TK_START_EXPR"!==B||F.space_in_empty_paren?x.space_before_token=!0:(x.trim(),x.space_before_token=!1));"]"===z.text&&F.keep_array_indentation?(r(),E()):(E(),r());x.remove_redundant_indentation(M);p.do_while&&
M.mode===c.Conditional&&(M.mode=c.Expression,p.do_block=!1,p.do_while=!1)},TK_START_BLOCK:function(){var a=n(1),e=n(2);e&&(":"===e.text&&d(a.type,["TK_STRING","TK_WORD","TK_RESERVED"])||d(a.text,["get","set"])&&d(e.type,["TK_WORD","TK_RESERVED"]))?d(I,["class","interface"])?v(c.BlockStatement):v(c.ObjectLiteral):v(c.BlockStatement);a=!a.comments_before.length&&"}"===a.text&&"function"===p.last_word&&"TK_END_EXPR"===B;"expand"===F.brace_style||"none"===F.brace_style&&z.wanted_newline?"TK_OPERATOR"!==
B&&(a||"TK_EQUALS"===B||"TK_RESERVED"===B&&t(p.last_text)&&"else"!==p.last_text)?x.space_before_token=!0:b(!1,!0):"TK_OPERATOR"!==B&&"TK_START_EXPR"!==B?"TK_START_BLOCK"===B?b():x.space_before_token=!0:M.mode===c.ArrayLiteral&&","===p.last_text&&("}"===I?x.space_before_token=!0:b());r();p.indentation_level+=1},TK_END_BLOCK:function(){for(;p.mode===c.Statement;)E();var a="TK_START_BLOCK"===B;"expand"===F.brace_style?a||b():a||(p.mode===c.ArrayLiteral&&F.keep_array_indentation?(F.keep_array_indentation=
!1,b(),F.keep_array_indentation=!0):b());E();r()},TK_WORD:P,TK_RESERVED:P,TK_SEMICOLON:function(){H()&&(x.space_before_token=!1);for(;p.mode===c.Statement&&!p.if_block&&!p.do_block;)E();r()},TK_STRING:function(){H()?x.space_before_token=!0:"TK_RESERVED"===B||"TK_WORD"===B?x.space_before_token=!0:"TK_COMMA"===B||"TK_START_EXPR"===B||"TK_EQUALS"===B||"TK_OPERATOR"===B?L()||e():b();r()},TK_EQUALS:function(){H();p.declaration_statement&&(p.declaration_assignment=!0);x.space_before_token=!0;r();x.space_before_token=
!0},TK_OPERATOR:function(){H();if("TK_RESERVED"===B&&t(p.last_text))x.space_before_token=!0,r();else if("*"===z.text&&"TK_DOT"===B)r();else if(":"===z.text&&p.in_case)p.case_body=!0,p.indentation_level+=1,r(),b(),p.in_case=!1;else if("::"===z.text)r();else{!z.wanted_newline||"--"!==z.text&&"++"!==z.text||b(!1,!0);"TK_OPERATOR"===B&&e();var a=!0,k=!0;d(z.text,["--","++","!","~"])||d(z.text,["-","+"])&&(d(B,["TK_START_BLOCK","TK_START_EXPR","TK_EQUALS","TK_OPERATOR"])||d(p.last_text,A.line_starters)||
","===p.last_text)?(k=a=!1,";"===p.last_text&&w(p.mode)&&(a=!0),"TK_RESERVED"===B||"TK_END_EXPR"===B?a=!0:"TK_OPERATOR"===B&&(a=d(z.text,["--","-"])&&d(p.last_text,["--","-"])||d(z.text,["++","+"])&&d(p.last_text,["++","+"])),p.mode!==c.BlockStatement&&p.mode!==c.Statement||"{"!==p.last_text&&";"!==p.last_text||b()):":"===z.text?0===p.ternary_depth?a=!1:--p.ternary_depth:"?"===z.text?p.ternary_depth+=1:"*"===z.text&&"TK_RESERVED"===B&&"function"===p.last_text&&(k=a=!1);x.space_before_token=x.space_before_token||
a;r();x.space_before_token=k}},TK_COMMA:function(){p.declaration_statement?(w(p.parent.mode)&&(p.declaration_assignment=!1),r(),p.declaration_assignment?(p.declaration_assignment=!1,b(!1,!0)):x.space_before_token=!0):(r(),p.mode===c.ObjectLiteral||p.mode===c.Statement&&p.parent.mode===c.ObjectLiteral?(p.mode===c.Statement&&E(),b()):x.space_before_token=!0)},TK_BLOCK_COMMENT:function(){for(var a=z.text,a=a.replace(/\x0d/g,""),e=[],c=a.indexOf("\n");-1!==c;)e.push(a.substring(0,c)),a=a.substring(c+
1),c=a.indexOf("\n");a.length&&e.push(a);var d,c=a=!1;d=z.whitespace_before;var k=d.length;b(!1,!0);if(1<e.length){var h;a:{h=e.slice(1);for(var E=0;E<h.length;E++)if("*"!==g(h[E]).charAt(0)){h=!1;break a}h=!0}if(h)a=!0;else{a:{h=e.slice(1);for(var E=0,l=h.length,y;E<l;E++)if((y=h[E])&&0!==y.indexOf(d)){d=!1;break a}d=!0}d&&(c=!0)}}r(e[0]);for(d=1;d<e.length;d++)b(!1,!0),a?r(" "+g(e[d])):c&&e[d].length>k?r(e[d].substring(k)):x.add_token(e[d]);b(!1,!0)},TK_INLINE_COMMENT:function(){x.space_before_token=
!0;r();x.space_before_token=!0},TK_COMMENT:function(){z.wanted_newline?b(!1,!0):x.trim(!0);x.space_before_token=!0;r();b(!1,!0)},TK_DOT:function(){H();"TK_RESERVED"===B&&t(p.last_text)?x.space_before_token=!0:e(")"===p.last_text&&F.break_chained_methods);r()},TK_UNKNOWN:function(){r();"\n"===z.text[z.text.length-1]&&b()},TK_EOF:function(){for(;p.mode===c.Statement;)E()}};k=k?k:{};F={};void 0!==k.braces_on_own_line&&(F.brace_style=k.braces_on_own_line?"expand":"collapse");F.brace_style=k.brace_style?
k.brace_style:F.brace_style?F.brace_style:"collapse";"expand-strict"===F.brace_style&&(F.brace_style="expand");F.indent_size=k.indent_size?parseInt(k.indent_size,10):4;F.indent_char=k.indent_char?k.indent_char:" ";F.preserve_newlines=void 0===k.preserve_newlines?!0:k.preserve_newlines;F.break_chained_methods=void 0===k.break_chained_methods?!1:k.break_chained_methods;F.max_preserve_newlines=void 0===k.max_preserve_newlines?0:parseInt(k.max_preserve_newlines,10);F.space_in_paren=void 0===k.space_in_paren?
!1:k.space_in_paren;F.space_in_empty_paren=void 0===k.space_in_empty_paren?!1:k.space_in_empty_paren;F.jslint_happy=void 0===k.jslint_happy?!1:k.jslint_happy;F.space_after_anon_function=void 0===k.space_after_anon_function?!1:k.space_after_anon_function;F.keep_array_indentation=void 0===k.keep_array_indentation?!1:k.keep_array_indentation;F.space_before_conditional=void 0===k.space_before_conditional?!0:k.space_before_conditional;F.unescape_strings=void 0===k.unescape_strings?!1:k.unescape_strings;
F.wrap_line_length=void 0===k.wrap_line_length?0:parseInt(k.wrap_line_length,10);F.e4x=void 0===k.e4x?!1:k.e4x;F.end_with_newline=void 0===k.end_with_newline?!1:k.end_with_newline;F.jslint_happy&&(F.space_after_anon_function=!0);k.indent_with_tabs&&(F.indent_char="\t",F.indent_size=1);for(J="";0<F.indent_size;)J+=F.indent_char,--F.indent_size;k=0;if(a&&a.length){for(;" "===a.charAt(k)||"\t"===a.charAt(k);)Q+=a.charAt(k),k+=1;a=a.substring(k)}B="TK_START_BLOCK";I="";x=new m(J,Q);O=[];v(c.BlockStatement);
this.beautify=function(){var b;A=new C(a,F,J);q=A.tokenize();for(u=0;b=n();){for(var e=0;e<b.comments_before.length;e++)l(b.comments_before[e]);l(b);I=p.last_text;B=b.type;p.last_text=b.text;u+=1}b=x.get_code();F.end_with_newline&&(b+="\n");return b}}function w(a){var c=0,d=-1,g=[],e=!0;this.set_indent=function(b){c=a.baseIndentLength+b*a.indent_length;d=b};this.get_character_count=function(){return c};this.is_empty=function(){return e};this.last=function(){return this._empty?null:g[g.length-1]};
this.push=function(a){g.push(a);c+=a.length;e=!1};this.remove_indent=function(){0<d&&(--d,c-=a.indent_length)};this.trim=function(){for(;" "===this.last();)g.pop(),--c;e=0===g.length};this.toString=function(){var b="";this._empty||(0<=d&&(b=a.indent_cache[d]),b+=g.join(""));return b}}function m(a,d){d=d||"";this.indent_cache=[d];this.baseIndentLength=d.length;this.indent_length=a.length;var k=[];this.baseIndentString=d;this.indent_string=a;this.current_line=null;this.space_before_token=!1;this.get_line_number=
function(){return k.length};this.add_new_line=function(a){return 1===this.get_line_number()&&this.just_added_newline()?!1:a||!this.just_added_newline()?(this.current_line=new w(this),k.push(this.current_line),!0):!1};this.add_new_line(!0);this.get_code=function(){return k.join("\n").replace(/[\r\n\t ]+$/,"")};this.set_indent=function(a){if(1<k.length){for(;a>=this.indent_cache.length;)this.indent_cache.push(this.indent_cache[this.indent_cache.length-1]+this.indent_string);this.current_line.set_indent(a);
return!0}this.current_line.set_indent(0);return!1};this.add_token=function(a){this.add_space_before_token();this.current_line.push(a)};this.add_space_before_token=function(){this.space_before_token&&!this.just_added_newline()&&this.current_line.push(" ");this.space_before_token=!1};this.remove_redundant_indentation=function(a){if(!a.multiline_frame&&a.mode!==c.ForInitializer&&a.mode!==c.Conditional){a=a.start_line_index;for(var e=k.length;a<e;)k[a].remove_indent(),a++}};this.trim=function(c){c=void 0===
c?!1:c;for(this.current_line.trim(a,d);c&&1<k.length&&this.current_line.is_empty();)k.pop(),this.current_line=k[k.length-1],this.current_line.trim()};this.just_added_newline=function(){return this.current_line.is_empty()};this.just_added_blankline=function(){return this.just_added_newline()?1===k.length?!0:k[k.length-2].is_empty():!1}}function C(c,k,h){function l(){var l,x=[];w=0;E="";if(t>=n)return["","TK_EOF"];var m;m=H.length?H[H.length-1]:new q("TK_START_BLOCK","{");var u=c.charAt(t);for(t+=1;d(u,
e);){"\n"===u?(w+=1,x=[]):w&&(u===h?x.push(h):"\r"!==u&&x.push(" "));if(t>=n)return["","TK_EOF"];u=c.charAt(t);t+=1}x.length&&(E=x.join(""));if(b.test(u)){var x=m=!0,D=b;"0"===u&&t<n&&/[Xx]/.test(c.charAt(t))?(x=m=!1,u+=c.charAt(t),t+=1,D=/[0123456789abcdefABCDEF]/):(u="",--t);for(;t<n&&D.test(c.charAt(t));)u+=c.charAt(t),t+=1,m&&t<n&&"."===c.charAt(t)&&(u+=c.charAt(t),t+=1,m=!1),x&&t<n&&/[Ee]/.test(c.charAt(t))&&(u+=c.charAt(t),t+=1,t<n&&/[+-]/.test(c.charAt(t))&&(u+=c.charAt(t),t+=1),m=x=!1);return[u,
"TK_WORD"]}if(a.isIdentifierStart(c.charCodeAt(t-1))){if(t<n)for(;a.isIdentifierChar(c.charCodeAt(t))&&(u+=c.charAt(t),t+=1,t!==n););return"TK_DOT"===m.type||"TK_RESERVED"===m.type&&d(m.text,["set","get"])||!d(u,y)?[u,"TK_WORD"]:"in"===u?[u,"TK_OPERATOR"]:[u,"TK_RESERVED"]}if("("===u||"["===u)return[u,"TK_START_EXPR"];if(")"===u||"]"===u)return[u,"TK_END_EXPR"];if("{"===u)return[u,"TK_START_BLOCK"];if("}"===u)return[u,"TK_END_BLOCK"];if(";"===u)return[u,"TK_SEMICOLON"];if("/"===u){x="";D=!0;if("*"===
c.charAt(t)){t+=1;if(t<n)for(;t<n&&("*"!==c.charAt(t)||!c.charAt(t+1)||"/"!==c.charAt(t+1));){u=c.charAt(t);x+=u;if("\n"===u||"\r"===u)D=!1;t+=1;if(t>=n)break}t+=2;return D&&0===w?["/*"+x+"*/","TK_INLINE_COMMENT"]:["/*"+x+"*/","TK_BLOCK_COMMENT"]}if("/"===c.charAt(t)){for(x=u;"\r"!==c.charAt(t)&&"\n"!==c.charAt(t)&&!(x+=c.charAt(t),t+=1,t>=n););return[x,"TK_COMMENT"]}}if("`"===u||"'"===u||'"'===u||("/"===u||k.e4x&&"\x3c"===u&&c.slice(t-1).match(/^<([-a-zA-Z:0-9_.]+|{[^{}]*}|!\[CDATA\[[\s\S]*?\]\])\s*([-a-zA-Z:0-9_.]+=('[^']*'|"[^"]*"|{[^{}]*})\s*)*\/?\s*>/))&&
("TK_RESERVED"===m.type&&d(m.text,"return case throw else do typeof yield".split(" "))||"TK_END_EXPR"===m.type&&")"===m.text&&m.parent&&"TK_RESERVED"===m.parent.type&&d(m.parent.text,["if","while","for"])||d(m.type,"TK_COMMENT TK_START_EXPR TK_START_BLOCK TK_END_BLOCK TK_OPERATOR TK_EQUALS TK_EOF TK_SEMICOLON TK_COMMA".split(" ")))){m=u;var z=x=!1;l=u;if("/"===m)for(u=!1;t<n&&(x||u||c.charAt(t)!==m)&&!a.newline.test(c.charAt(t));)l+=c.charAt(t),x?x=!1:(x="\\"===c.charAt(t),"["===c.charAt(t)?u=!0:
"]"===c.charAt(t)&&(u=!1)),t+=1;else if(k.e4x&&"\x3c"===m){if(x=/<(\/?)([-a-zA-Z:0-9_.]+|{[^{}]*}|!\[CDATA\[[\s\S]*?\]\])\s*([-a-zA-Z:0-9_.]+=('[^']*'|"[^"]*"|{[^{}]*})\s*)*(\/?)\s*>/g,u=c.slice(t-1),(D=x.exec(u))&&0===D.index){m=D[2];for(l=0;D;){var z=!!D[1],B=D[2],v=!!D[D.length-1]||"![CDATA["===B.slice(0,8);B!==m||v||(z?--l:++l);if(0>=l)break;D=x.exec(u)}m=D?D.index+D[0].length:u.length;t+=m-1;return[u.slice(0,m),"TK_STRING"]}}else for(;t<n&&(x||c.charAt(t)!==m&&("`"===m||!a.newline.test(c.charAt(t))));){l+=
c.charAt(t);if(x){if("x"===c.charAt(t)||"u"===c.charAt(t))z=!0;x=!1}else x="\\"===c.charAt(t);t+=1}if(z&&k.unescape_strings)a:{u=l;x=!1;D="";l=0;z="";for(B=0;x||l<u.length;)if(v=u.charAt(l),l++,x){x=!1;if("x"===v)z=u.substr(l,2),l+=2;else if("u"===v)z=u.substr(l,4),l+=4;else{D+="\\"+v;continue}if(!z.match(/^[0123456789abcdefABCDEF]+$/)){l=u;break a}B=parseInt(z,16);if(0<=B&&32>B)D="x"===v?D+("\\x"+z):D+("\\u"+z);else if(34===B||39===B||92===B)D+="\\"+String.fromCharCode(B);else if("x"===v&&126<B&&
255>=B){l=u;break a}else D+=String.fromCharCode(B)}else"\\"===v?x=!0:D+=v;l=D}if(t<n&&c.charAt(t)===m&&(l+=m,t+=1,"/"===m))for(;t<n&&a.isIdentifierStart(c.charCodeAt(t));)l+=c.charAt(t),t+=1;return[l,"TK_STRING"]}if("#"===u){if(0===H.length&&"!"===c.charAt(t)){for(l=u;t<n&&"\n"!==u;)u=c.charAt(t),l+=u,t+=1;return[g(l)+"\n","TK_UNKNOWN"]}m="#";if(t<n&&b.test(c.charAt(t))){do u=c.charAt(t),m+=u,t+=1;while(t<n&&"#"!==u&&"\x3d"!==u);"#"!==u&&("["===c.charAt(t)&&"]"===c.charAt(t+1)?(m+="[]",t+=2):"{"===
c.charAt(t)&&"}"===c.charAt(t+1)&&(m+="{}",t+=2));return[m,"TK_WORD"]}}if("\x3c"===u&&"\x3c!--"===c.substring(t-1,t+3)){t+=3;for(u="\x3c!--";"\n"!==c.charAt(t)&&t<n;)u+=c.charAt(t),t++;L=!0;return[u,"TK_COMMENT"]}if("-"===u&&L&&"--\x3e"===c.substring(t-1,t+2))return L=!1,t+=2,["--\x3e","TK_COMMENT"];if("."===u)return[u,"TK_DOT"];if(d(u,r)){for(;t<n&&d(u+c.charAt(t),r)&&!(u+=c.charAt(t),t+=1,t>=n););return","===u?[u,"TK_COMMA"]:"\x3d"===u?[u,"TK_EQUALS"]:[u,"TK_OPERATOR"]}return[u,"TK_UNKNOWN"]}var e=
["\n","\r","\t"," "],b=/[0-9]/,r="+ - * / % \x26 ++ -- \x3d +\x3d -\x3d *\x3d /\x3d %\x3d \x3d\x3d \x3d\x3d\x3d !\x3d !\x3d\x3d \x3e \x3c \x3e\x3d \x3c\x3d \x3e\x3e \x3c\x3c \x3e\x3e\x3e \x3e\x3e\x3e\x3d \x3e\x3e\x3d \x3c\x3c\x3d \x26\x26 \x26\x3d | || ! ~ , : ? ^ ^\x3d |\x3d :: \x3d\x3e \x3c%\x3d \x3c% %\x3e \x3c?\x3d \x3c? ?\x3e".split(" ");this.line_starters="continue try throw return var let const if switch case default for while break function yield import export".split(" ");var y=this.line_starters.concat("do in else get set new catch finally typeof".split(" ")),
w,E,L,H,t,n;this.tokenize=function(){n=c.length;t=0;L=!1;H=[];for(var a,b,e=null,d=[],k=[];!b||"TK_EOF"!==b.type;){a=l();for(a=new q(a[1],a[0],w,E);"TK_INLINE_COMMENT"===a.type||"TK_COMMENT"===a.type||"TK_BLOCK_COMMENT"===a.type||"TK_UNKNOWN"===a.type;)k.push(a),a=l(),a=new q(a[1],a[0],w,E);k.length&&(a.comments_before=k,k=[]);"TK_START_BLOCK"===a.type||"TK_START_EXPR"===a.type?(a.parent=b,e=a,d.push(a)):("TK_END_BLOCK"===a.type||"TK_END_EXPR"===a.type)&&e&&("]"===a.text&&"["===e.text||")"===a.text&&
"("===e.text||"}"===a.text&&"}"===e.text)&&(a.parent=e.parent,e=d.pop());H.push(a);b=a}return H}}var a={};(function(a){var c=/[\u00aa\u00b5\u00ba\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u02c1\u02c6-\u02d1\u02e0-\u02e4\u02ec\u02ee\u0370-\u0374\u0376\u0377\u037a-\u037d\u0386\u0388-\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u048a-\u0527\u0531-\u0556\u0559\u0561-\u0587\u05d0-\u05ea\u05f0-\u05f2\u0620-\u064a\u066e\u066f\u0671-\u06d3\u06d5\u06e5\u06e6\u06ee\u06ef\u06fa-\u06fc\u06ff\u0710\u0712-\u072f\u074d-\u07a5\u07b1\u07ca-\u07ea\u07f4\u07f5\u07fa\u0800-\u0815\u081a\u0824\u0828\u0840-\u0858\u08a0\u08a2-\u08ac\u0904-\u0939\u093d\u0950\u0958-\u0961\u0971-\u0977\u0979-\u097f\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09ce\u09dc\u09dd\u09df-\u09e1\u09f0\u09f1\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abd\u0ad0\u0ae0\u0ae1\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3d\u0b5c\u0b5d\u0b5f-\u0b61\u0b71\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bd0\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c33\u0c35-\u0c39\u0c3d\u0c58\u0c59\u0c60\u0c61\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cde\u0ce0\u0ce1\u0cf1\u0cf2\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d3a\u0d3d\u0d4e\u0d60\u0d61\u0d7a-\u0d7f\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0e01-\u0e30\u0e32\u0e33\u0e40-\u0e46\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb0\u0eb2\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0edc-\u0edf\u0f00\u0f40-\u0f47\u0f49-\u0f6c\u0f88-\u0f8c\u1000-\u102a\u103f\u1050-\u1055\u105a-\u105d\u1061\u1065\u1066\u106e-\u1070\u1075-\u1081\u108e\u10a0-\u10c5\u10c7\u10cd\u10d0-\u10fa\u10fc-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u167f\u1681-\u169a\u16a0-\u16ea\u16ee-\u16f0\u1700-\u170c\u170e-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176c\u176e-\u1770\u1780-\u17b3\u17d7\u17dc\u1820-\u1877\u1880-\u18a8\u18aa\u18b0-\u18f5\u1900-\u191c\u1950-\u196d\u1970-\u1974\u1980-\u19ab\u19c1-\u19c7\u1a00-\u1a16\u1a20-\u1a54\u1aa7\u1b05-\u1b33\u1b45-\u1b4b\u1b83-\u1ba0\u1bae\u1baf\u1bba-\u1be5\u1c00-\u1c23\u1c4d-\u1c4f\u1c5a-\u1c7d\u1ce9-\u1cec\u1cee-\u1cf1\u1cf5\u1cf6\u1d00-\u1dbf\u1e00-\u1f15\u1f18-\u1f1d\u1f20-\u1f45\u1f48-\u1f4d\u1f50-\u1f57\u1f59\u1f5b\u1f5d\u1f5f-\u1f7d\u1f80-\u1fb4\u1fb6-\u1fbc\u1fbe\u1fc2-\u1fc4\u1fc6-\u1fcc\u1fd0-\u1fd3\u1fd6-\u1fdb\u1fe0-\u1fec\u1ff2-\u1ff4\u1ff6-\u1ffc\u2071\u207f\u2090-\u209c\u2102\u2107\u210a-\u2113\u2115\u2119-\u211d\u2124\u2126\u2128\u212a-\u212d\u212f-\u2139\u213c-\u213f\u2145-\u2149\u214e\u2160-\u2188\u2c00-\u2c2e\u2c30-\u2c5e\u2c60-\u2ce4\u2ceb-\u2cee\u2cf2\u2cf3\u2d00-\u2d25\u2d27\u2d2d\u2d30-\u2d67\u2d6f\u2d80-\u2d96\u2da0-\u2da6\u2da8-\u2dae\u2db0-\u2db6\u2db8-\u2dbe\u2dc0-\u2dc6\u2dc8-\u2dce\u2dd0-\u2dd6\u2dd8-\u2dde\u2e2f\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303c\u3041-\u3096\u309d-\u309f\u30a1-\u30fa\u30fc-\u30ff\u3105-\u312d\u3131-\u318e\u31a0-\u31ba\u31f0-\u31ff\u3400-\u4db5\u4e00-\u9fcc\ua000-\ua48c\ua4d0-\ua4fd\ua500-\ua60c\ua610-\ua61f\ua62a\ua62b\ua640-\ua66e\ua67f-\ua697\ua6a0-\ua6ef\ua717-\ua71f\ua722-\ua788\ua78b-\ua78e\ua790-\ua793\ua7a0-\ua7aa\ua7f8-\ua801\ua803-\ua805\ua807-\ua80a\ua80c-\ua822\ua840-\ua873\ua882-\ua8b3\ua8f2-\ua8f7\ua8fb\ua90a-\ua925\ua930-\ua946\ua960-\ua97c\ua984-\ua9b2\ua9cf\uaa00-\uaa28\uaa40-\uaa42\uaa44-\uaa4b\uaa60-\uaa76\uaa7a\uaa80-\uaaaf\uaab1\uaab5\uaab6\uaab9-\uaabd\uaac0\uaac2\uaadb-\uaadd\uaae0-\uaaea\uaaf2-\uaaf4\uab01-\uab06\uab09-\uab0e\uab11-\uab16\uab20-\uab26\uab28-\uab2e\uabc0-\uabe2\uac00-\ud7a3\ud7b0-\ud7c6\ud7cb-\ud7fb\uf900-\ufa6d\ufa70-\ufad9\ufb00-\ufb06\ufb13-\ufb17\ufb1d\ufb1f-\ufb28\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40\ufb41\ufb43\ufb44\ufb46-\ufbb1\ufbd3-\ufd3d\ufd50-\ufd8f\ufd92-\ufdc7\ufdf0-\ufdfb\ufe70-\ufe74\ufe76-\ufefc\uff21-\uff3a\uff41-\uff5a\uff66-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc]/,
d=/[\u00aa\u00b5\u00ba\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u02c1\u02c6-\u02d1\u02e0-\u02e4\u02ec\u02ee\u0370-\u0374\u0376\u0377\u037a-\u037d\u0386\u0388-\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u048a-\u0527\u0531-\u0556\u0559\u0561-\u0587\u05d0-\u05ea\u05f0-\u05f2\u0620-\u064a\u066e\u066f\u0671-\u06d3\u06d5\u06e5\u06e6\u06ee\u06ef\u06fa-\u06fc\u06ff\u0710\u0712-\u072f\u074d-\u07a5\u07b1\u07ca-\u07ea\u07f4\u07f5\u07fa\u0800-\u0815\u081a\u0824\u0828\u0840-\u0858\u08a0\u08a2-\u08ac\u0904-\u0939\u093d\u0950\u0958-\u0961\u0971-\u0977\u0979-\u097f\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09ce\u09dc\u09dd\u09df-\u09e1\u09f0\u09f1\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abd\u0ad0\u0ae0\u0ae1\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3d\u0b5c\u0b5d\u0b5f-\u0b61\u0b71\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bd0\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c33\u0c35-\u0c39\u0c3d\u0c58\u0c59\u0c60\u0c61\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cde\u0ce0\u0ce1\u0cf1\u0cf2\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d3a\u0d3d\u0d4e\u0d60\u0d61\u0d7a-\u0d7f\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0e01-\u0e30\u0e32\u0e33\u0e40-\u0e46\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb0\u0eb2\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0edc-\u0edf\u0f00\u0f40-\u0f47\u0f49-\u0f6c\u0f88-\u0f8c\u1000-\u102a\u103f\u1050-\u1055\u105a-\u105d\u1061\u1065\u1066\u106e-\u1070\u1075-\u1081\u108e\u10a0-\u10c5\u10c7\u10cd\u10d0-\u10fa\u10fc-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u167f\u1681-\u169a\u16a0-\u16ea\u16ee-\u16f0\u1700-\u170c\u170e-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176c\u176e-\u1770\u1780-\u17b3\u17d7\u17dc\u1820-\u1877\u1880-\u18a8\u18aa\u18b0-\u18f5\u1900-\u191c\u1950-\u196d\u1970-\u1974\u1980-\u19ab\u19c1-\u19c7\u1a00-\u1a16\u1a20-\u1a54\u1aa7\u1b05-\u1b33\u1b45-\u1b4b\u1b83-\u1ba0\u1bae\u1baf\u1bba-\u1be5\u1c00-\u1c23\u1c4d-\u1c4f\u1c5a-\u1c7d\u1ce9-\u1cec\u1cee-\u1cf1\u1cf5\u1cf6\u1d00-\u1dbf\u1e00-\u1f15\u1f18-\u1f1d\u1f20-\u1f45\u1f48-\u1f4d\u1f50-\u1f57\u1f59\u1f5b\u1f5d\u1f5f-\u1f7d\u1f80-\u1fb4\u1fb6-\u1fbc\u1fbe\u1fc2-\u1fc4\u1fc6-\u1fcc\u1fd0-\u1fd3\u1fd6-\u1fdb\u1fe0-\u1fec\u1ff2-\u1ff4\u1ff6-\u1ffc\u2071\u207f\u2090-\u209c\u2102\u2107\u210a-\u2113\u2115\u2119-\u211d\u2124\u2126\u2128\u212a-\u212d\u212f-\u2139\u213c-\u213f\u2145-\u2149\u214e\u2160-\u2188\u2c00-\u2c2e\u2c30-\u2c5e\u2c60-\u2ce4\u2ceb-\u2cee\u2cf2\u2cf3\u2d00-\u2d25\u2d27\u2d2d\u2d30-\u2d67\u2d6f\u2d80-\u2d96\u2da0-\u2da6\u2da8-\u2dae\u2db0-\u2db6\u2db8-\u2dbe\u2dc0-\u2dc6\u2dc8-\u2dce\u2dd0-\u2dd6\u2dd8-\u2dde\u2e2f\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303c\u3041-\u3096\u309d-\u309f\u30a1-\u30fa\u30fc-\u30ff\u3105-\u312d\u3131-\u318e\u31a0-\u31ba\u31f0-\u31ff\u3400-\u4db5\u4e00-\u9fcc\ua000-\ua48c\ua4d0-\ua4fd\ua500-\ua60c\ua610-\ua61f\ua62a\ua62b\ua640-\ua66e\ua67f-\ua697\ua6a0-\ua6ef\ua717-\ua71f\ua722-\ua788\ua78b-\ua78e\ua790-\ua793\ua7a0-\ua7aa\ua7f8-\ua801\ua803-\ua805\ua807-\ua80a\ua80c-\ua822\ua840-\ua873\ua882-\ua8b3\ua8f2-\ua8f7\ua8fb\ua90a-\ua925\ua930-\ua946\ua960-\ua97c\ua984-\ua9b2\ua9cf\uaa00-\uaa28\uaa40-\uaa42\uaa44-\uaa4b\uaa60-\uaa76\uaa7a\uaa80-\uaaaf\uaab1\uaab5\uaab6\uaab9-\uaabd\uaac0\uaac2\uaadb-\uaadd\uaae0-\uaaea\uaaf2-\uaaf4\uab01-\uab06\uab09-\uab0e\uab11-\uab16\uab20-\uab26\uab28-\uab2e\uabc0-\uabe2\uac00-\ud7a3\ud7b0-\ud7c6\ud7cb-\ud7fb\uf900-\ufa6d\ufa70-\ufad9\ufb00-\ufb06\ufb13-\ufb17\ufb1d\ufb1f-\ufb28\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40\ufb41\ufb43\ufb44\ufb46-\ufbb1\ufbd3-\ufd3d\ufd50-\ufd8f\ufd92-\ufdc7\ufdf0-\ufdfb\ufe70-\ufe74\ufe76-\ufefc\uff21-\uff3a\uff41-\uff5a\uff66-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc\u0300-\u036f\u0483-\u0487\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u0620-\u0649\u0672-\u06d3\u06e7-\u06e8\u06fb-\u06fc\u0730-\u074a\u0800-\u0814\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0840-\u0857\u08e4-\u08fe\u0900-\u0903\u093a-\u093c\u093e-\u094f\u0951-\u0957\u0962-\u0963\u0966-\u096f\u0981-\u0983\u09bc\u09be-\u09c4\u09c7\u09c8\u09d7\u09df-\u09e0\u0a01-\u0a03\u0a3c\u0a3e-\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a66-\u0a71\u0a75\u0a81-\u0a83\u0abc\u0abe-\u0ac5\u0ac7-\u0ac9\u0acb-\u0acd\u0ae2-\u0ae3\u0ae6-\u0aef\u0b01-\u0b03\u0b3c\u0b3e-\u0b44\u0b47\u0b48\u0b4b-\u0b4d\u0b56\u0b57\u0b5f-\u0b60\u0b66-\u0b6f\u0b82\u0bbe-\u0bc2\u0bc6-\u0bc8\u0bca-\u0bcd\u0bd7\u0be6-\u0bef\u0c01-\u0c03\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62-\u0c63\u0c66-\u0c6f\u0c82\u0c83\u0cbc\u0cbe-\u0cc4\u0cc6-\u0cc8\u0cca-\u0ccd\u0cd5\u0cd6\u0ce2-\u0ce3\u0ce6-\u0cef\u0d02\u0d03\u0d46-\u0d48\u0d57\u0d62-\u0d63\u0d66-\u0d6f\u0d82\u0d83\u0dca\u0dcf-\u0dd4\u0dd6\u0dd8-\u0ddf\u0df2\u0df3\u0e34-\u0e3a\u0e40-\u0e45\u0e50-\u0e59\u0eb4-\u0eb9\u0ec8-\u0ecd\u0ed0-\u0ed9\u0f18\u0f19\u0f20-\u0f29\u0f35\u0f37\u0f39\u0f41-\u0f47\u0f71-\u0f84\u0f86-\u0f87\u0f8d-\u0f97\u0f99-\u0fbc\u0fc6\u1000-\u1029\u1040-\u1049\u1067-\u106d\u1071-\u1074\u1082-\u108d\u108f-\u109d\u135d-\u135f\u170e-\u1710\u1720-\u1730\u1740-\u1750\u1772\u1773\u1780-\u17b2\u17dd\u17e0-\u17e9\u180b-\u180d\u1810-\u1819\u1920-\u192b\u1930-\u193b\u1951-\u196d\u19b0-\u19c0\u19c8-\u19c9\u19d0-\u19d9\u1a00-\u1a15\u1a20-\u1a53\u1a60-\u1a7c\u1a7f-\u1a89\u1a90-\u1a99\u1b46-\u1b4b\u1b50-\u1b59\u1b6b-\u1b73\u1bb0-\u1bb9\u1be6-\u1bf3\u1c00-\u1c22\u1c40-\u1c49\u1c5b-\u1c7d\u1cd0-\u1cd2\u1d00-\u1dbe\u1e01-\u1f15\u200c\u200d\u203f\u2040\u2054\u20d0-\u20dc\u20e1\u20e5-\u20f0\u2d81-\u2d96\u2de0-\u2dff\u3021-\u3028\u3099\u309a\ua640-\ua66d\ua674-\ua67d\ua69f\ua6f0-\ua6f1\ua7f8-\ua800\ua806\ua80b\ua823-\ua827\ua880-\ua881\ua8b4-\ua8c4\ua8d0-\ua8d9\ua8f3-\ua8f7\ua900-\ua909\ua926-\ua92d\ua930-\ua945\ua980-\ua983\ua9b3-\ua9c0\uaa00-\uaa27\uaa40-\uaa41\uaa4c-\uaa4d\uaa50-\uaa59\uaa7b\uaae0-\uaae9\uaaf2-\uaaf3\uabc0-\uabe1\uabec\uabed\uabf0-\uabf9\ufb20-\ufb28\ufe00-\ufe0f\ufe20-\ufe26\ufe33\ufe34\ufe4d-\ufe4f\uff10-\uff19\uff3f]/;
a.newline=/[\n\r\u2028\u2029]/;a.isIdentifierStart=function(a){return 65>a?36===a:91>a?!0:97>a?95===a:123>a?!0:170<=a&&c.test(String.fromCharCode(a))};a.isIdentifierChar=function(a){return 48>a?36===a:58>a?!0:65>a?!1:91>a?!0:97>a?95===a:123>a?!0:170<=a&&d.test(String.fromCharCode(a))}})(a);var c={BlockStatement:"BlockStatement",Statement:"Statement",ObjectLiteral:"ObjectLiteral",ArrayLiteral:"ArrayLiteral",ForInitializer:"ForInitializer",Conditional:"Conditional",Expression:"Expression"},q=function(a,
c,d,g,e,b){this.type=a;this.text=c;this.comments_before=[];this.newlines=d||0;this.wanted_newline=0<d;this.whitespace_before=g||"";this.parent=null};"undefined"!==typeof exports?exports.js_beautify=l:"undefined"!==typeof n?n.js_beautify=l:"undefined"!==typeof global&&(global.js_beautify=l)})();(function(){function d(g,l){function h(){return(G=g.charAt(++r))||""}function m(b){var e=r;b&&a();result=g.charAt(r+1)||"";r=e-1;h();return result}function n(a){for(var b=r;h();)if("\\"===G)h();else if(-1!==
a.indexOf(G))break;else if("\n"===G)break;return g.substring(b,r+1)}function q(a){var b=r;a=n(a);r=b-1;h();return a}function a(){for(var a="";b.test(m());)h(),a+=G;return a}function c(){var a="";for(G&&b.test(G)&&(a=G);b.test(h());)a+=G;return a}function A(a){var b=r;a="/"===m();for(h();h();)if(!a&&"*"===G&&"/"===m()){h();break}else if(a&&"\n"===G)return g.substring(b,r);return g.substring(b,r)+G}function v(a){return g.substring(r-a.length,r).toLowerCase()===a}function k(){for(var a=r+1;a<g.length;a++){var b=
g.charAt(a);if("{"===b)return!0;if(";"===b||"}"===b||")"===b)break}return!1}l=l||{};var y=l.indent_size||4,D=l.indent_char||" ",e=void 0===l.selector_separator_newline?!0:l.selector_separator_newline;l=void 0===l.end_with_newline?!1:l.end_with_newline;"string"===typeof y&&(y=parseInt(y,10));var b=/^\s+$/,r=-1,G,N=g.match(/^[\t ]*/)[0],D=Array(y+1).join(D),E=0,L=0,H={"{":function(a){H.singleSpace();t.push(a);H.newLine()},"}":function(a){H.newLine();t.push(a);H.newLine()},_lastCharWhitespace:function(){return b.test(t[t.length-
1])},newLine:function(a){a||H.trim();t.length&&t.push("\n");N&&t.push(N)},singleSpace:function(){t.length&&!H._lastCharWhitespace()&&t.push(" ")},trim:function(){for(;H._lastCharWhitespace();)t.pop()}},t=[];N&&t.push(N);for(var R=!1,P=!1,x="",S="";;){var S=c(),u=""!==S,V=-1!==S.indexOf("\n"),S=x;if(x=G)"/"===G&&"*"===m()?(u=v(""),H.newLine(),t.push(A()),H.newLine(),u&&H.newLine(!0)):"/"===G&&"/"===m()?(V||"{"===S||H.trim(),H.singleSpace(),t.push(A()),H.newLine()):"@"===G?(u&&H.singleSpace(),t.push(G),
u=q(": ,;{}()[]/\x3d'\"").replace(/\s$/,""),u in d.NESTED_AT_RULE?(L+=1,u in d.CONDITIONAL_GROUP_RULE&&(P=!0)):0<=": ".indexOf(u[u.length-1])&&(h(),u=n(": ").replace(/\s$/,""),t.push(u),H.singleSpace())):"{"===G?"}"===m(!0)?(a(),h(),H.singleSpace(),t.push("{}")):(E++,N+=D,H["{"](G),P?(P=!1,R=E>L):R=E>=L):"}"===G?(E--,N=N.slice(0,-y),H["}"](G),R=!1,L&&L--):":"===G?(a(),!R&&!P||v("\x26")||k()?":"===m()?(h(),t.push("::")):t.push(":"):(t.push(":"),H.singleSpace())):'"'===G||"'"===G?(u&&H.singleSpace(),
t.push(n(G))):";"===G?(t.push(G),H.newLine()):"("===G?v("url")?(t.push(G),a(),h()&&(")"!==G&&'"'!==G&&"'"!==G?t.push(n(")")):r--)):(u&&H.singleSpace(),t.push(G),a()):")"===G?t.push(G):","===G?(t.push(G),a(),!R&&e?H.newLine():H.singleSpace()):("]"!==G&&("["===G?u&&H.singleSpace():"\x3d"===G?a():u&&H.singleSpace()),t.push(G));else break}y=t.join("").replace(/[\r\n\t ]+$/,"");l&&(y+="\n");return y}d.NESTED_AT_RULE={"@page":!0,"@font-face":!0,"@keyframes":!0,"@media":!0,"@supports":!0,"@document":!0};
d.CONDITIONAL_GROUP_RULE={"@media":!0,"@supports":!0,"@document":!0};"undefined"!==typeof exports?exports.css_beautify=d:"undefined"!==typeof n?n.css_beautify=d:"undefined"!==typeof global&&(global.css_beautify=d)})();(function(){function d(d,g,l,m){var a,c,h,n,k,y,D,e,b,r,w;g=g||{};void 0!==g.wrap_line_length&&0!==parseInt(g.wrap_line_length,10)||void 0===g.max_char||0===parseInt(g.max_char,10)||(g.wrap_line_length=g.max_char);c=void 0===g.indent_inner_html?!1:g.indent_inner_html;h=void 0===g.indent_size?
4:parseInt(g.indent_size,10);n=void 0===g.indent_char?" ":g.indent_char;y=void 0===g.brace_style?"collapse":g.brace_style;k=0===parseInt(g.wrap_line_length,10)?32786:parseInt(g.wrap_line_length||250,10);D=g.unformatted||"a span img bdo em strong dfn code samp kbd var cite abbr acronym q sub sup tt i b big small u s strike font ins del pre address dt h1 h2 h3 h4 h5 h6".split(" ");b=(e=void 0===g.preserve_newlines?!0:g.preserve_newlines)?isNaN(parseInt(g.max_preserve_newlines,10))?32786:parseInt(g.max_preserve_newlines,
10):0;r=void 0===g.indent_handlebars?!1:g.indent_handlebars;w=void 0===g.end_with_newline?!1:g.end_with_newline;a=new function(){this.pos=0;this.token="";this.current_mode="CONTENT";this.tags={parent:"parent1",parentcount:1,parent1:""};this.token_text=this.last_token=this.last_text=this.token_type=this.tag_type="";this.newlines=0;this.indent_content=c;this.Utils={whitespace:["\n","\r","\t"," "],single_token:"br input link meta !doctype basefont base area hr wbr param img isindex ?xml embed ?php ? ?\x3d".split(" "),
extra_liners:["head","body","/html"],in_array:function(a,b){for(var e=0;e<b.length;e++)if(a===b[e])return!0;return!1}};this.is_whitespace=function(a){for(;0<a.length;a++)if(!this.Utils.in_array(a.charAt(0),this.Utils.whitespace))return!1;return!0};this.traverse_whitespace=function(){var a="",a=this.input.charAt(this.pos);if(this.Utils.in_array(a,this.Utils.whitespace)){for(this.newlines=0;this.Utils.in_array(a,this.Utils.whitespace);)e&&"\n"===a&&this.newlines<=b&&(this.newlines+=1),this.pos++,a=
this.input.charAt(this.pos);return!0}return!1};this.space_or_wrap=function(a){this.line_char_count>=this.wrap_line_length?(this.print_newline(!1,a),this.print_indentation(a)):(this.line_char_count++,a.push(" "))};this.get_content=function(){for(var a="",b=[];"\x3c"!==this.input.charAt(this.pos);){if(this.pos>=this.input.length)return b.length?b.join(""):["","TK_EOF"];if(this.traverse_whitespace())this.space_or_wrap(b);else{if(r)if(a=this.input.substr(this.pos,3),"{{#"===a||"{{/"===a)break;else if("{{"===
this.input.substr(this.pos,2)&&"{{else}}"===this.get_tag(!0))break;a=this.input.charAt(this.pos);this.pos++;this.line_char_count++;b.push(a)}}return b.length?b.join(""):""};this.get_contents_to=function(a){if(this.pos===this.input.length)return["","TK_EOF"];var b="";a=new RegExp("\x3c/"+a+"\\s*\x3e","igm");a.lastIndex=this.pos;a=(a=a.exec(this.input))?a.index:this.input.length;this.pos<a&&(b=this.input.substring(this.pos,a),this.pos=a);return b};this.record_tag=function(a){this.tags[a+"count"]?this.tags[a+
"count"]++:this.tags[a+"count"]=1;this.tags[a+this.tags[a+"count"]]=this.indent_level;this.tags[a+this.tags[a+"count"]+"parent"]=this.tags.parent;this.tags.parent=a+this.tags[a+"count"]};this.retrieve_tag=function(a){if(this.tags[a+"count"]){for(var b=this.tags.parent;b&&a+this.tags[a+"count"]!==b;)b=this.tags[b+"parent"];b&&(this.indent_level=this.tags[a+this.tags[a+"count"]],this.tags.parent=this.tags[b+"parent"]);delete this.tags[a+this.tags[a+"count"]+"parent"];delete this.tags[a+this.tags[a+
"count"]];1===this.tags[a+"count"]?delete this.tags[a+"count"]:this.tags[a+"count"]--}};this.indent_to_tag=function(a){if(this.tags[a+"count"]){for(var b=this.tags.parent;b&&a+this.tags[a+"count"]!==b;)b=this.tags[b+"parent"];b&&(this.indent_level=this.tags[a+this.tags[a+"count"]])}};this.get_tag=function(a){var b="",e=[],b="",c=!1,d,g,k=this.pos,h=this.line_char_count;a=void 0!==a?a:!1;do{if(this.pos>=this.input.length)return a&&(this.pos=k,this.line_char_count=h),e.length?e.join(""):["","TK_EOF"];
b=this.input.charAt(this.pos);this.pos++;if(this.Utils.in_array(b,this.Utils.whitespace))c=!0;else{if("'"===b||'"'===b)b+=this.get_unformatted(b),c=!0;"\x3d"===b&&(c=!1);e.length&&"\x3d"!==e[e.length-1]&&"\x3e"!==b&&c&&(this.space_or_wrap(e),c=!1);r&&"\x3c"===g&&"{{"===b+this.input.charAt(this.pos)&&(b+=this.get_unformatted("}}"),e.length&&" "!==e[e.length-1]&&"\x3c"!==e[e.length-1]&&(b=" "+b),c=!0);"\x3c"!==b||g||(d=this.pos-1,g="\x3c");r&&!g&&2<=e.length&&"{"===e[e.length-1]&&"{"==e[e.length-2]&&
(d="#"===b||"/"===b?this.pos-3:this.pos-2,g="{");this.line_char_count++;e.push(b);if(e[1]&&"!"===e[1]){e=[this.get_comment(d)];break}if(r&&"{"===g&&2<e.length&&"}"===e[e.length-2]&&"}"===e[e.length-1])break}}while("\x3e"!==b);d=e.join("");g=-1!==d.indexOf(" ")?d.indexOf(" "):"{"===d[0]?d.indexOf("}"):d.indexOf("\x3e");g=d.substring("\x3c"!==d[0]&&r?"#"===d[2]?3:2:1,g).toLowerCase();"/"===d.charAt(d.length-2)||this.Utils.in_array(g,this.Utils.single_token)?a||(this.tag_type="SINGLE"):r&&"{"===d[0]&&
"else"===g?a||(this.indent_to_tag("if"),this.tag_type="HANDLEBARS_ELSE",this.indent_content=!0,this.traverse_whitespace()):this.is_unformatted(g,D)?(b=this.get_unformatted("\x3c/"+g+"\x3e",d),e.push(b),this.tag_type="SINGLE"):"script"===g&&(-1===d.search("type")||-1<d.search("type")&&-1<d.search(/\b(text|application)\/(x-)?(javascript|ecmascript|jscript|livescript)/))?a||(this.record_tag(g),this.tag_type="SCRIPT"):"style"===g&&(-1===d.search("type")||-1<d.search("type")&&-1<d.search("text/css"))?
a||(this.record_tag(g),this.tag_type="STYLE"):"!"===g.charAt(0)?a||(this.tag_type="SINGLE",this.traverse_whitespace()):a||("/"===g.charAt(0)?(this.retrieve_tag(g.substring(1)),this.tag_type="END"):(this.record_tag(g),"html"!==g.toLowerCase()&&(this.indent_content=!0),this.tag_type="START"),this.traverse_whitespace()&&this.space_or_wrap(e),this.Utils.in_array(g,this.Utils.extra_liners)&&(this.print_newline(!1,this.output),this.output.length&&"\n"!==this.output[this.output.length-2]&&this.print_newline(!0,
this.output)));a&&(this.pos=k,this.line_char_count=h);return e.join("")};this.get_comment=function(a){var b="",e="\x3e",c=!1;this.pos=a;input_char=this.input.charAt(this.pos);for(this.pos++;this.pos<=this.input.length;){b+=input_char;if(b[b.length-1]===e[e.length-1]&&-1!==b.indexOf(e))break;!c&&10>b.length&&(0===b.indexOf("\x3c![if")?(e="\x3c![endif]\x3e",c=!0):0===b.indexOf("\x3c![cdata[")?(e="]]\x3e",c=!0):0===b.indexOf("\x3c![")?(e="]\x3e",c=!0):0===b.indexOf("\x3c!--")&&(e="--\x3e",c=!0));input_char=
this.input.charAt(this.pos);this.pos++}return b};this.get_unformatted=function(a,b){if(b&&-1!==b.toLowerCase().indexOf(a))return"";var e=b="",c=0,d=!0;do{if(this.pos>=this.input.length)break;b=this.input.charAt(this.pos);this.pos++;if(this.Utils.in_array(b,this.Utils.whitespace)){if(!d){this.line_char_count--;continue}if("\n"===b||"\r"===b){e+="\n";this.line_char_count=0;continue}}e+=b;this.line_char_count++;d=!0;r&&"{"===b&&e.length&&"{"===e[e.length-2]&&(e+=this.get_unformatted("}}"),c=e.length)}while(-1===
e.toLowerCase().indexOf(a,c));return e};this.get_token=function(){var a;if("TK_TAG_SCRIPT"===this.last_token||"TK_TAG_STYLE"===this.last_token){var b=this.last_token.substr(7);a=this.get_contents_to(b);return"string"!==typeof a?a:[a,"TK_"+b]}if("CONTENT"===this.current_mode)return a=this.get_content(),"string"!==typeof a?a:[a,"TK_CONTENT"];if("TAG"===this.current_mode)return a=this.get_tag(),"string"!==typeof a?a:[a,"TK_TAG_"+this.tag_type]};this.get_full_indent=function(a){a=this.indent_level+a||
0;return 1>a?"":Array(a+1).join(this.indent_string)};this.is_unformatted=function(a,b){if(!this.Utils.in_array(a,b))return!1;if("a"!==a.toLowerCase()||!this.Utils.in_array("a",b))return!0;a=(this.get_tag(!0)||"").match(/^\s*<\s*\/?([a-z]*)\s*[^>]*>\s*$/);return!a||this.Utils.in_array(a,b)?!0:!1};this.printer=function(a,b,e,c,d){this.input=a||"";this.output=[];this.indent_character=b;this.indent_string="";this.indent_size=e;this.brace_style=d;this.indent_level=0;this.wrap_line_length=c;for(a=this.line_char_count=
0;a<this.indent_size;a++)this.indent_string+=this.indent_character;this.print_newline=function(a,b){this.line_char_count=0;b&&b.length&&(a||"\n"!==b[b.length-1])&&("\n"!==b[b.length-1]&&(b[b.length-1]=b[b.length-1].replace(/\s+$/g,"")),b.push("\n"))};this.print_indentation=function(a){for(var b=0;b<this.indent_level;b++)a.push(this.indent_string),this.line_char_count+=this.indent_string.length};this.print_token=function(a){if(!this.is_whitespace(a)||this.output.length)(a||""!==a)&&this.output.length&&
"\n"===this.output[this.output.length-1]&&(this.print_indentation(this.output),a=a.replace(/^\s+/g,"")),this.print_token_raw(a)};this.print_token_raw=function(a){0<this.newlines&&(a=a.replace(/\s+$/g,""));a&&""!==a&&(1<a.length&&"\n"===a[a.length-1]?(this.output.push(a.slice(0,-1)),this.print_newline(!1,this.output)):this.output.push(a));for(a=0;a<this.newlines;a++)this.print_newline(0<a,this.output);this.newlines=0};this.indent=function(){this.indent_level++};this.unindent=function(){0<this.indent_level&&
this.indent_level--}};return this};for(a.printer(d,n,h,k,y);;){d=a.get_token();a.token_text=d[0];a.token_type=d[1];if("TK_EOF"===a.token_type)break;switch(a.token_type){case "TK_TAG_START":a.print_newline(!1,a.output);a.print_token(a.token_text);a.indent_content&&(a.indent(),a.indent_content=!1);a.current_mode="CONTENT";break;case "TK_TAG_STYLE":case "TK_TAG_SCRIPT":a.print_newline(!1,a.output);a.print_token(a.token_text);a.current_mode="CONTENT";break;case "TK_TAG_END":"TK_CONTENT"===a.last_token&&
""===a.last_text&&(d=a.token_text.match(/\w+/)[0],h=null,a.output.length&&(h=a.output[a.output.length-1].match(/(?:<|{{#)\s*(\w+)/)),null!==h&&h[1]===d||a.print_newline(!1,a.output));a.print_token(a.token_text);a.current_mode="CONTENT";break;case "TK_TAG_SINGLE":(d=a.token_text.match(/^\s*<([a-z-]+)/i))&&a.Utils.in_array(d[1],D)||a.print_newline(!1,a.output);a.print_token(a.token_text);a.current_mode="CONTENT";break;case "TK_TAG_HANDLEBARS_ELSE":a.print_token(a.token_text);a.indent_content&&(a.indent(),
a.indent_content=!1);a.current_mode="CONTENT";break;case "TK_CONTENT":a.print_token(a.token_text);a.current_mode="TAG";break;case "TK_STYLE":case "TK_SCRIPT":if(""!==a.token_text){a.print_newline(!1,a.output);d=a.token_text;var q;n=1;"TK_SCRIPT"===a.token_type?q="function"===typeof l&&l:"TK_STYLE"===a.token_type&&(q="function"===typeof m&&m);"keep"===g.indent_scripts?n=0:"separate"===g.indent_scripts&&(n=-a.indent_level);h=a.get_full_indent(n);q?d=q(d.replace(/^\s*/,h),g):(k=d.match(/^\s*/)[0].match(/[^\n\r]*$/)[0].split(a.indent_string).length-
1,n=a.get_full_indent(n-k),d=d.replace(/^\s*/,h).replace(/\r\n|\r|\n/g,"\n"+n).replace(/\s+$/,""));d&&(a.print_token_raw(d),a.print_newline(!0,a.output))}a.current_mode="TAG";break;default:""!==a.token_text&&a.print_token(a.token_text)}a.last_token=a.token_type;a.last_text=a.token_text}g=a.output.join("").replace(/[\r\n\t ]+$/,"");w&&(g+="\n");return g}if("undefined"!==typeof exports){var g=require("./beautify.js"),l=require("./beautify-css.js");exports.html_beautify=function(h,n){return d(h,n,g.js_beautify,
l.css_beautify)}}else"undefined"!==typeof n?n.html_beautify=function(g,l){return d(g,l,n.js_beautify,n.css_beautify)}:"undefined"!==typeof global&&(global.html_beautify=function(g,l){return d(g,l,global.js_beautify,global.css_beautify)})})()})},"xideve/views/VisualEditorLayout":function(){define(["dcl/dcl","xaction/Action","xide/types","davinci/Workbench","dojo/dom-style"],function(q,A,m,n,d){return q(null,{declaredClass:"xideve/views/VisualEditorLayout",changeGlobalLayout:function(g){this.getPageEditor();
var l=this.getMainView(),h=l.layoutLeft,l=l.layoutRight,n=this;switch(g){case m.VE_LAYOUT_RIGHT_CENTER_BOTTOM:h._splitterWidget&&h._splitterWidget.set("state","closed");l._splitterWidget&&l._splitterWidget.set("state","full");this.doSplit(m.VIEW_SPLIT_MODE.SPLIT_HORIZONTAL);break;case m.VE_LAYOUT_CENTER_BOTTOM:this.doSplit(m.VIEW_SPLIT_MODE.SPLIT_HORIZONTAL);h._splitterWidget&&h._splitterWidget.set("state","closed");l._splitterWidget&&l._splitterWidget.set("state","closed");break;case m.VE_LAYOUT_CENTER_RIGHT:this.doSplit(m.VIEW_SPLIT_MODE.DESIGN);
h._splitterWidget&&h._splitterWidget.set("state","closed");l._splitterWidget&&l._splitterWidget.set("state","full");break;case m.VE_LAYOUT_LEFT_CENTER_RIGHT:this.doSplit(m.VIEW_SPLIT_MODE.DESIGN);h._splitterWidget&&h._splitterWidget.set("state","full");l._splitterWidget&&l._splitterWidget.set("state","full");break;case m.VE_LAYOUT_LEFT_CENTER_RIGHT_BOTTOM:this.doSplit(m.VIEW_SPLIT_MODE.SPLIT_HORIZONTAL),d.set(h.domNode,{width:"200px"}),h._splitterWidget&&h._splitterWidget.set("state","full"),l._splitterWidget&&
l._splitterWidget.set("state","full")}this.publish(m.EVENTS.RESIZE);setTimeout(function(){n.publish(m.EVENTS.RESIZE)},1E3)},getLayoutActions:function(){function d(a,c,d,g){a=A.create(a,d,"View/"+c+"_"+h,!1,null,m.ITEM_TYPE.WIDGET,"viewActions",null,!1,function(){l.changeGlobalLayout(c)});a.setVisibility(m.ACTION_VISIBILITY.ACTION_TOOLBAR,{label:"",widgetArgs:{style:"text-align:right;float:right;font-size:120%;"},permanent:function(){return 0==l.destroyed}});h++;return a}if(this._layoutActions)return this._layoutActions;
var l=this,h=0,n=d("Center Bottom Right",m.VE_LAYOUT_RIGHT_CENTER_BOTTOM,"layoutIcon-rightCenterBottom"),q=d("Center Bottom",m.VE_LAYOUT_CENTER_BOTTOM,"layoutIcon-centerBottom"),C=d("Center Right",m.VE_LAYOUT_CENTER_RIGHT,"layoutIcon-centerRight"),a=d("Left Center Right",m.VE_LAYOUT_LEFT_CENTER_RIGHT,"layoutIcon-leftCenterRight"),c=d("Left Center Right Bottom",m.VE_LAYOUT_LEFT_CENTER_RIGHT_BOTTOM,"layoutIcon-leftCenterRightBottom");return this._layoutActions=n=[n,q,C,a,c]},doSplit:function(d){},onSplit:function(){this.editor&&
(n._switchEditor(null),this.publish("/davinci/ui/editorSelected",[{editor:null,oldEditor:this.editor}]))},getSplitTarget:function(){return this.containerNode},getSplitContent:function(){return this.editor.domNode}})})},"xideve/views/VisualEditorTools":function(){define(["dcl/dcl","davinci/ve/widget"],function(q,A){$.fn.inlineStyle=function(m){var n=this.attr("style"),d;n&&n.split(";").forEach(function(g){g=g.split(":");$.trim(g[0])===m&&(d=g[1])});return d};return q(null,{declaredClass:"xideve/views/VisualEditorTools",
getEditors:function(){var m=[];if(this.parentContainer)for(var n=this.parentContainer.getChildren(),d=0;d<n.length;d++){var g=n[d];"davinci.ve.PageEditor"===g.declaredClass&&m.push(g)}return m},getEditorContext:function(){var m=null;this.editor&&this.editor.currentEditor&&this.editor.currentEditor.context&&(m=this.editor.currentEditor.context);return m},getPageEditor:function(){return this.editor},onWidgetAction:function(m){},_sameSize:function(){var m=this.getEditorContext();m.getDocument();var n=
this.getSelection(),d=$(n[0].domNode),g=d.css("width"),d=d.css("height");n.shift();for(var l=0;l<n.length;l++){var h=n[l];$(h.domNode);(h=m.getCommandForStyleChange({appliesTo:"inline",appliesToWhichState:null,cascade:null,values:[{width:g,height:d}]},[h]))&&m.getCommandStack().execute(h)}},_sameWidth:function(){var m=this.getEditorContext();m.getDocument();var n=this.getSelection(),d=$(n[0].domNode),g=d.css("width");d.css("height");n.shift();for(d=0;d<n.length;d++){var l=n[d];$(l.domNode);(l=m.getCommandForStyleChange({appliesTo:"inline",
appliesToWhichState:null,cascade:null,values:[{width:g}]},[l]))&&m.getCommandStack().execute(l)}},_sameHeight:function(){var m=this.getEditorContext();m.getDocument();var n=this.getSelection(),d=$(n[0].domNode);d.css("width");d=d.css("height");n.shift();this.getSelection();for(var g=0;g<n.length;g++){var l=n[g];$(l.domNode);if(l=m.getCommandForStyleChange({appliesTo:"inline",appliesToWhichState:null,cascade:null,values:[{height:d}]},[l]))m.getCommandStack().execute(l,!0),this.getSelection(),l._newId&&
A.byId(l._newId,context.getDocument())}},_alignBottomHorizontal:function(){var m=this.getEditorContext(),n=m.getDocument(),d=this.getSelection(),g=d[0];d.shift();for(var l=0;l<d.length;l++){var h=d[l],w=(new jQuery.PositionCalculator({item:$(g.domNode),target:$(h.domNode),itemAt:"bottom right",targetAt:"bottom left",boundary:$(n.body)})).calculate(),q=$(h.domNode),C=q.position().top;q.position();(h=m.getCommandForStyleChange({appliesTo:"inline",appliesToWhichState:null,cascade:null,values:[{top:C+
-1*w.moveBy.y+"px"}]},[h]))&&m.getCommandStack().execute(h)}},_alignTopHorizontal:function(){var m=this.getEditorContext(),n=m.getDocument(),d=this.getSelection(),g=d[0];d.shift();for(var l=0;l<d.length;l++){var h=d[l],w=(new jQuery.PositionCalculator({item:$(g.domNode),target:$(h.domNode),itemAt:"top right",targetAt:"top left",boundary:$(n.body)})).calculate(),q=$(h.domNode),C=q.position().top;q.position();(h=m.getCommandForStyleChange({appliesTo:"inline",appliesToWhichState:null,cascade:null,values:[{top:C+
-1*w.moveBy.y+"px"}]},[h]))&&m.getCommandStack().execute(h)}},_alignRightVertical:function(){var m=this.getEditorContext(),n=m.getDocument(),d=this.getSelection(),g=d[0];d.shift();for(var l=0;l<d.length;l++){var h=d[l],w=(new jQuery.PositionCalculator({item:$(g.domNode),target:$(h.domNode),itemAt:"bottom right",targetAt:"top right",boundary:$(n.body)})).calculate(),q=$(h.domNode);q.position();w={appliesTo:"inline",appliesToWhichState:null,cascade:null,values:[{left:q.position().left+-1*w.moveBy.x+
"px"}]};(h=m.getCommandForStyleChange(w,[h]))&&m.getCommandStack().execute(h)}},_alignCenterVertical:function(){var m=this.getEditorContext(),n=m.getDocument(),d=this.getSelection(),g=d[0];d.shift();for(var l=0;l<d.length;l++){var h=d[l],w=(new jQuery.PositionCalculator({item:$(g.domNode),target:$(h.domNode),itemAt:"bottom center",targetAt:"top center",boundary:$(n.body)})).calculate(),q=$(h.domNode);q.position();w={appliesTo:"inline",appliesToWhichState:null,cascade:null,values:[{left:q.position().left+
-1*w.moveBy.x+"px"}]};(h=m.getCommandForStyleChange(w,[h]))&&m.getCommandStack().execute(h)}},_alignLeftVertical:function(){var m=this.getEditorContext(),n=m.getDocument(),d=this.getSelection(),g=d[0];d.shift();for(var l=0;l<d.length;l++){var h=d[l],w=(new jQuery.PositionCalculator({item:$(g.domNode),target:$(h.domNode),itemAt:"bottom left",targetAt:"top left",boundary:$(n.body)})).calculate(),q=$(h.domNode);q.position();w={appliesTo:"inline",appliesToWhichState:null,cascade:null,values:[{left:q.position().left+
-1*w.moveBy.x+"px"}]};(h=m.getCommandForStyleChange(w,[h]))&&m.getCommandStack().execute(h,!0)}}})})},"xideve/palette/Palette":function(){define("xdojo/declare xide/types xide/utils module xideve/tests/Reload xideve/views/VisualEditor xideve/views/VisualEditorAction davinci/Workbench davinci/library davinci/Runtime xide/lodash dcl/dcl xgrid/ListRenderer xgrid/TreeRenderer xgrid/Grid xgrid/MultiRenderer dgrid/Editor xgrid/Defaults xgrid/Layout xgrid/Focus dgrid/OnDemandGrid xide/mixins/EventedMixin xblox/views/BlockGrid xblox/BlockActions xide/views/_LayoutMixin xide/widgets/_Widget xide/factory xblox/views/ThumbRenderer xblox/views/DnD dojo/dom-construct xgrid/Selection xgrid/Search xgrid/KeyboardNavigation xaction/ActionStore xlang/i18 xide/$ xide/_base/_Widget xdojo/has dstore/Trackable xide/data/TreeMemory dijit/focus davinci/ui/dnd/DragManager davinci/ve/utils/GeomUtils davinci/ui/dnd/DragSource davinci/ve/metadata davinci/ve/tools/CreateTool dojo/_base/lang dojo/promise/all xide/model/Path dojo/Deferred".split(" "),
function(q,A,m,n,d,g,l,h,w,J,C,a,c,I,v,k,y,D,e,b,r,G,N,E,L,H,t,R,P,x,S,u,V,z,B,W,Y,p,M,O,K,X,F,Q,U,Z,aa,ca,da,ba){d=q("xblox.ThumbRenderer2",[R],{resizeThumb:!0,__type:"thumb",deactivateRenderer:function(){W(this.domNode.parentNode).removeClass("metro");W(this.domNode).css("padding","");this.isThumbGrid=!1},activateRenderer:function(){W(this.contentNode).css("padding","8px");this.isThumbGrid=!0;this.refresh()},_getIconUri:function(a,b){return a?0==a.indexOf("http")?a:h.location()+a:require.toUrl("davinci/"+
b)},_setIconProperties:function(a){a.icon=a.iconBase64||a.icon&&this._getIconUri(a.icon,"ve/resources/images/file_obj.gif")||a.iconLargeBase64||a.iconLarge&&this._getIconUri(a.iconLarge,"ve/resources/images/file_obj.gif")||this._getIconUri(a.icon,"ve/resources/images/file_obj.gif");a.iconLarge=a.iconLargeBase64||a.iconLarge&&this._getIconUri(a.iconLarge,"ve/resources/images/file_obj.gif")||a.iconBase64||this._getIconUri(a.icon,"ve/resources/images/file_obj.gif")},template2:'\x3cspan class\x3d"paletteItemSelectionContainer"\x3e\x3c/span\x3e\x3cspan class\x3d"paletteItemNormalContainer"\x3e\x3cspan class\x3d"paletteItemImageContainer" style\x3d"margin-top:8px"\x3e\x3cimg class\x3d"paletteItemImage" border\x3d"0"/\x3e\x3c/span\x3e\x3cspan class\x3d"paletteItemLabelContainer"\x3e\x3cspan class\x3d"paletteItemLabel"\x3e\x3c/span\x3e\x3c/span\x3e\x3c/span\x3e',
renderRow:function(a){var b=x.create("div",{className:"tile widget form-control dojoyPaletteCommon dojoyPaletteItem maqPaletteSection_desktop dojoyPaletteItemSunken widgetBase"}),e=a.name;b.innerHTML=this.template2;this._setIconProperties(a);-1!==a.icon.indexOf("base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAIAAACRXR")&&(a.icon="");e=b.querySelector(".paletteItemLabel");e.appendChild(dojo.doc.createTextNode(a.name));e=b.querySelector("img");a&&a.iconHTML?(dojo.destroy(e),b.querySelector(".paletteItemImageContainer").innerHTML=
item.iconHTML):e.src=a.icon;return b}});n=q("xblox.GroupRenderer",I,{itemClass:d,groupClass:I,renderRow:function(a){return(a.group?this.groupClass:this.itemClass).prototype.renderRow.apply(this,arguments)}});d=[n,d,I];k=q.classFactory("xgrid/MultiRendererGroups",{},d,k.Implementation);v=v.createGridClass("xblox.views.BlockGridPalette",{},{SELECTION:{CLASS:S},KEYBOARD_SELECTION:!0,CONTEXT_MENU:!1,ACTIONS:A.GRID_FEATURES.ACTIONS,TOOLBAR:A.GRID_FEATURES.TOOLBAR,WIDGET:{CLASS:H},KEYBOARD_NAVIGATION:{CLASS:V},
SEARCH:{CLASS:u}},{RENDERER:k},{renderers:d,selectedRenderer:n});v=q("ActionGrid",v,{formatColumn:function(a,b,e){var c=this.selectedRenderer?this.selectedRenderer.prototype:this;if(c.formatColumn_&&(c=c.formatColumn.apply(arguments))||e.renderColumn_&&(c=e.renderColumn.apply(this,arguments)))return c;switch(a){case "title":b=e.group?'\x3cspan style\x3d"float:left;margin-right: 10px"\x3e'+b+'\x3c/span\x3e\x3chr style\x3d"margin-top: 13px;margin-left: 4px"/\x3e':b}return b},_columns:{},postMixInProperties:function(){var a=
this.state;a&&a._columns&&(this._columns=a._columns);this.columns=this.getColumns();return this.inherited(arguments)},getColumns:function(a){var b=this;return this.columns=[{renderExpando:!0,label:"Name",field:"title",sortable:!0,formatter:function(a,e){return b.formatColumn("title",a,e)},hidden:!1}]},dragMananager:null,veContext:null,updateDragManager:function(a){this.dragMananager.document=a.getDocument();var b=a.frameNode;b&&(b=dojo.coords(b),a=a.getContainerNode(),this.dragMananager.documentX=
b.x-F.getScrollLeft(a),this.dragMananager.documentY=b.y-F.getScrollTop(a))},onContextDestroyed:function(a){a.__veDNDDevHandles&&(C.each(a.__veDNDDevHandles,m.destroy),a.__veDNDDevHandles);delete this.editorContext},onAppReady:function(a){this.editorContext&&this.editorContext!=a.context&&(this.editorContext=a.context);this.dragMananager||(this.dragMananager=X);this.editorContext=a.context;this.updateDragManager(a.context)},addCustomWidget:function(a){var b=this;if(a&&a.$wm&&a.$wm.widgets&&a.$wm.widgets.length){J.currentEditor.getContext();
var e=this.palette,c=a.$wm;a=a.$wm.widgets;for(var d=0;d<a.length;d++){var g=a[d],k;for(k in this.palette._presetSections){var h=null,l=this.palette._presetSections[k];if(l){for(var r=0;r<l.length;r++){var n=l[r];if("$$UserWidgets$$"==n.id){h=n;break}}h||(h=dojo.clone(e._userWidgetSection),h.preset=e._presetSections[k],h.presetId=k,h.items=[],l.push(h),this.customSection=h,this.palette._presetCreated[k]&&(h._created=!0,h.subsections=[],h.group=4));l="type:"+g.type;0>h.includes.indexOf(l)&&(h.includes.push(l),
g.$library=c,g.section=h,g._paletteItemGroup=e._paletteItemGroupCount++,h.items.push(g),this.__c||(h._created=!0,h.subsections=[],h.group=4,e.createRootItem(h),this.set("collection",this.collection.filter({parentId:"."})),this.__c=!0),e.createItem(g,h))}else console.error("Palette.js:addCustomWidget - no sections for comptype\x3d"+k)}}setTimeout(function(){b.set("collection",b.collection.filter({parentId:"."}))},1E3)}},startup:function(a){this._loaded=!0;this.subscribe("/davinci/ui/addedCustomWidget",
this.addCustomWidget);var b=function(a,b,e,c,d,g,k){d=aa.clone(d);aa.mixin(d.properties,k);g=c.dragSource.data.userData||g;g.onCreate=function(){};U.getHelper(d.type,"tool").then(function(a){a=new (a||Z)(dojo.clone(d),g);e.setActiveTool(a)}.bind(this));e.blockChange(!1);c._dragClone&&(W(c._dragClone).addClass("paletteDragContainer"),dojo.create("div",{className:"maqCandidateParents"},c._dragClone));e.setActiveDragDiv(c._dragClone)};I.prototype.activateRenderer.apply(this);var e=function(a,e,c,d,g,
k){var h=e.domNode,l=new Q(e.domNode,"component",e,h);l.targetShouldShowCaret=!0;l.returnCloneOnFailure=!1;var h={handles:[],context:c,node:h,ds:l,destroy:function(){delete this.context;C.each(this.handles,dojo.disconnect);delete this.handles;delete this.node.__vednd;delete this.node;delete this.ds}},r=h.handles;r.push(dojo.connect(l,"onDragStart",dojo.hitch(a,function(h){b(a,e,c,h,d,g,k)})));r.push(dojo.connect(l,"onDragEnd",dojo.hitch(a,function(a){K.curNode&&K.curNode.blur&&K.curNode.blur()})));
r.push(dojo.connect(e.domNode,"onmouseover",function(a){e._mouseover=!0}));r.push(dojo.connect(e.domNode,"onmouseout",function(a){e._mouseover=!1}));r.push(dojo.connect(e.domNode,"onmousedown",function(b){b=a.dragMananager;b.document=c.getDocument();var e=c.frameNode;if(e){var e=dojo.coords(e),d=c.getContainerNode();b.documentX=e.x-F.getScrollLeft(d);b.documentY=e.y-F.getScrollTop(d)}}));return h};this._showHeader(!1);var c=this.inherited(arguments);C.each(this.getRows(),function(a){this.expand(a,
!1)},this);W(this.domNode).addClass("blockPalette");this.subscribe([A.EVENTS.ON_APP_READY,A.EVENTS.ON_CONTEXT_DESTROYED]);var d=this;this._on("selectionChanged",function(a){if(a=(a=a.selection)&&1==a.length?a[0]:null){var b=d.row(a),c=b.element;if(!b.element.__vednd){c.__vednd=!0;var b={},g=d.editorContext,c={domNode:c};if(g){g.__veDNDDevHandles||(g.__veDNDDevHandles=[]);var k={properties:{},type:a.type,userData:{}};a.group||g.__veDNDDevHandles.push(e(this,c,g,k,a,b))}}}});this.onAppReady({context:J.currentEditor.getContext()});
return c}});H=q("m",null,[]);var T=function(){this._presetCreated={};this._presetSections={};this._userWidgetSection={id:"$$UserWidgets$$",name:"User Widgets",includes:[]}};T.prototype._prepareSectionItem=function(a,b,e){var c=U.getLibraryMetadataForType(a.type);a.$library=c;a.section=b;a._paletteItemGroup=e};T.prototype._createSectionItems=function(a,b,e){a.items=[];b=b.collections;for(var c=a.includes||[],d=0;d<c.length;d++){for(var g=c[d],k=C.isArray(g)?g:[g],g=[],h=0;h<k.length;h++){var l=k[h],
r=[];if("type:"===l.substr(0,5)){var n=U.getWidgetDescriptorForType(l.substr(5));n&&r.push(n)}else r=U.getWidgetsWithTag(l);for(l=0;l<r.length;l++)n=r[l],n=dojo.clone(n),this._prepareSectionItem(n,a,this._paletteItemGroupCount),g.push(n)}k=[];if(b&&b.length){for(r=0;r<b.length;r++)for(l=b[r],h=0;h<g.length;)n=g[h],n.collection==l.id?(k.push(n),g.splice(h,1)):h++;for(h=0;h<g.length;h++)k.push(g[h])}else k=g;for(h=0;h<k.length;h++)g=k[h],r=e.indexOf(g.type),0<=r&&e.splice(r,1),a.items.push(g);this._paletteItemGroupCount++}};
T.prototype.initMeta=function(a){var b=require.toUrl("xideve/metadata/");return U.init(a||window.sctx,b)};T.prototype.init=function(){var a=require.toUrl("xideve/metadata/");U.init(sctx,a);var b=U.getLibrary(),e={},a=[];(w.getUserLibs(h.getProject())||{}).forEach(function(a){var c;a:{c=a.id;a=a.version;for(var d in b)if(b.hasOwnProperty(d)){var g=b[d];if(g.name===c&&g.version===a){a={};a[c]=b[d];c=a;break a}}c=null}dojo.mixin(e,c)});var c={},d=new ba;a.push(d);w.getCustomWidgets().then(function(a){w.getCustomWidgetDescriptors();
d.resolve()});var g=[],k;for(k in e)if(e.hasOwnProperty(k)){var l=e[k].$wm;l&&l&&l.widgets&&l.widgets.forEach(function(a){"untested"==a.category||a.hidden||g.push(a.type)})}this._paletteItemGroupCount=0;this._widgetPalette=J.getSiteConfigData("widgetPalette");k=new ba;a.push(k);if(this._widgetPalette){var l=this._widgetPalette.presets||{},r;for(r in l){var n=g.concat();this._presetSections[r]=[];var m=l[r],y,t="string"==typeof m.sections?this._widgetPalette.defs?this._widgetPalette.defs[m.sections]:
void 0:m.sections;if(t&&t.length){var E=[],p;for(p in c){var u=c[p];u.descriptor&&E.push({name:p,value:u})}E.sort(function(a,b){a=a.name.split("/").pop().toLowerCase();b=b.name.split("/").pop().toLowerCase();return a<b?-1:a>b?1:0});for(var u=!1,D,x=0;x<E.length;x++){u||(p=dojo.clone(this._userWidgetSection),t=t.concat(p),u=!0,D=p.includes);var z=E[x].value.descriptor.widgets;for(p=0;p<z.length;p++)D.push("type:"+z[p].type)}for(E=0;E<t.length;E++){u=dojo.clone("string"==typeof t[E]?this._widgetPalette.defs?
this._widgetPalette.defs[t[E]]:void 0:t[E]);u.preset=m;u.presetId=r;if(u.subsections&&u.subsections.length)for(x=u.subsections,z=0;z<x.length;z++){if("string"==typeof x[z]){var q=this._widgetPalette.defs?this._widgetPalette.defs[x[z]]:void 0;q&&(x[z]=dojo.clone(q))}q=x[z];q.includes&&0<=q.includes.indexOf("$$AllOthers$$")&&(y=q);q.preset=m;q.presetId=r;this._createSectionItems(q,m,n)}else this._createSectionItems(u,m,n),u.includes&&0<=u.includes.indexOf("$$AllOthers$$")&&(y=u);this._presetSections[r].push(u)}}for(m=
0;m<n.length;m++)t=n[m],y&&(t=U.getWidgetDescriptorForType(t),t=dojo.clone(t),this._prepareSectionItem(t,y,this._paletteItemGroupCount),y.items.push(t),this._paletteItemGroupCount++)}k.resolve()}else console.error("widgetPalette.json not defined (in siteConfig folder)");return ca(a)};T.prototype.createRootItem=function(a){var b=this,e=this.store;a.group=a.subsections.length||a.items.length;a.title=a.name;a.parentId=a.parentId||".";a=e.putSync(a);if(a.subsections&&a.subsections.length)for(e=0;e<a.subsections.length;e++){var c=
a.subsections[e];c._id=c.id;c.id=a.id+"_"+c.name;c.parentId=a.id;c.section=a;c.subsections=c.subsections||[];c.items=c.items||[];c.items.forEach(function(a){b.createItem(a,c)});this.createRootItem(c)}};T.prototype.createItem=function(a,b){a.id=b.id+"_"+a.type;a.parentId=b.id;b=a.$library._maqGetString(a.type)||a.$library._maqGetString(a.name)||a.name;b=b.replace("\x3c","");b=b.replace("\x3e","");a.title=b;a.name=b;this.store.putSync(a)};T.prototype.createStore=function(){var a=new (q("paletteStore",
[O,M],{}))({data:[],idProperty:"id",parentProperty:"parentId",id:m.createUUID(),ctx:sctx,mayHaveChildren:function(){return!0}});this.store=a;this._presetCreated.delite=!0;var b=this._presetSections.delite;if(b)for(var e=0;e<b.length;e++){var c=b[e];c._created||(this.createRootItem(c),c._created=!0)}return a};H.create=function(){var a=new T;a.initMeta();setTimeout(function(){a.init();a.createStore()},2E3)};H.Palette=T;H.Grid=v;return H})},"xideve/tests/Reload":function(){define(["xdojo/declare","dojo/Deferred",
"xide/editor/Registry","xideve/views/VisualEditor"],function(q,A,m,n){var d=window.sctx;q=q("m",null,[]);q.reload=function(){m.getStore();m.unregisterEditor("Visual Editor");m.getEditors({path:"./index.dhtml"});var g=d.reloadModules("davinci/ve/PageEditor davinci/ve/views/SwitchingStyleView xideve/views/VisualEditorPalette xideve/views/VisualEditorSourceEditor xideve/views/VisualEditorLayout xideve/views/VisualEditorAction xideve/views/VisualEditorTools".split(" ")),l=new A;g.then(function(){setTimeout(function(){d.reloadModules(["xideve/views/VisualEditor"]).then(function(g){var h=
d.getApplication().getComponents().xideve;g[0].component=h;l.resolve({ve:g[0],component:h})})},100)});return l};return q})},"xideve/Embedded":function(){define("dojo/_base/declare davinci/davinci_ dojo/Deferred davinci/ve/metadata davinci/Runtime require dojo/_base/connect davinci/Workbench davinci/ve/metadata xideve/views/StyleView".split(" "),function(q,A,m,n,d,g,l,h,w,J){var C=function(a,c){401!=c.status&&403!=c.status&&!0===a.canceled&&(a=a.ioArgs.url,(new RegExp("(^|\\.\\/|"+document.baseURI+
"\\/)cmd\\/")).test(a)&&(0<=a.indexOf("getBluePageInfo")||d.handleError(c.message)))};return q("xideve/Embedded",null,{_loadActionClasses:function(){var a=[];d.getExtensions("davinci.editorActions",function(c){if("davinci.ve.HTMLPageEditor"==c.editorContribution.targetID)return a.push(c.editorContribution),!0});0==a.length&&d.getExtension("davinci.defaultEditorActions",function(c){a.push(c.editorContribution);return!0});var c=w.getLibraryActions("davinci.editorActions","davinci.ve.HTMLPageEditor"),
a=dojo.clone(a);0<a.length&&c.length&&dojo.forEach(c,function(c){var d=g("davinci/Workbench");c.action&&d._loadActionClass(c);if(c.menu)for(var k=0;k<c.menu.length;k++){var h=c.menu[0];h.action&&d._loadActionClass(h)}a[0].actions.push(c)});return a},started:function(){},onReady:function(a){this._loadActionClasses();var c=document.getElementById("focusContainer");c||(c=dojo.create("div",{"class":"focusContainer",id:"focusContainer"},document.body),h.focusContainer=c);h._state={activeEditor:null,editors:[],
nhfo:{project1:{device:"iphone",layout:"flow",themeSet:{name:"(none)",desktopTheme:"claro",mobileTheme:[{theme:"android",device:"Android"},{theme:"blackberry",device:"BlackBerry"},{theme:"ipad",device:"iPad"},{theme:"iphone",device:"iPhone"},{theme:"iphone",device:"other"}]}}},project:"project1",id:"",Fields:[]};h.run2();this.started();a.resolve(this)},start:function(a,c,q,w){var k=this,y=new m;d.cmdOffset=q||"";d.loadPlugins();d.initialPerspective="davinci.ve.pageDesign";if(!0===c)d.isLocalInstall=
!0,d.userName="none",d.userEmail="none",d.run(),h.ctx=a,k.onReady();else return a.getFileManager().callMethodEx("XApp_XIDE_Workbench_Service","getInfo",["nada"],function(c){d.userBaseUrl=w;d._initializationInfo=c;c=c.userInfo;d.isLocalInstall="maqettaUser"==c.userId;d.userName=c.userId;d.userEmail=c.email;c=g.toUrl("xideve/metadata/");n.init(a,c);d.run();h.ctx=a;k.onReady(y);d.subscribe("/davinci/states/state/changed",function(a){var b=d.currentEditor;"davinci.ve.themeEditor.ThemeEditor"!=b.declaredClass&&
"davinci.review.editor.ReviewEditor"!=b.declaredClass&&b.visualEditor.onContentChange.apply(b.visualEditor,arguments)});l.subscribe("/davinci/states/state/changed",function(a){var b=d.currentEditor&&"davinci.ve.PageEditor"==d.currentEditor.declaredClass&&d.currentEditor.visualEditor&&d.currentEditor.visualEditor.context;if(b){var e,c,b=b?b.getDijit():null,k=g("davinci/ve/widget");a.newState&&!a.newState.indexOf("_show:")&&(e=b.byId(a.newState.substring(6)),e=k.getWidget(e.domNode),(c=e.getHelper())&&
c.popup&&c.popup(e));a.oldState&&!a.oldState.indexOf("_show:")&&(e=b.byId(a.oldState.substring(6)),e=k.getWidget(e.domNode),(c=e.getHelper())&&c.tearDown&&c.tearDown(e))}});l.subscribe("/davinci/ui/repositionFocusContainer",function(a){h._repositionFocusContainer()})},!0),d.subscribe("/dojo/io/error",C),y}})})},"xideve/views/StyleView":function(){define("dojo/_base/declare dojo/_base/lang davinci/lang/ve dijit/lang/_common dijit/layout/TabContainer xide/layout/ContentPane xideve/widgets/WidgetLite xide/mixins/ReloadMixin davinci/ve/widgets/HTMLStringUtil xide/layout/_TabContainer davinci/ve/widgets/WidgetToolBar davinci/ve/widgets/Cascade davinci/ve/widgets/CommonProperties davinci/ve/widgets/WidgetProperties davinci/ve/widgets/EventSelection".split(" "),
function(q,A,m,n,d,g,l,h,w,J,C,a,c,I,v){return q("xideve/views/StyleView",[l,h],{showWidgetProperties:!0,_editor:null,_widget:null,_widgets:null,_subWidget:null,_titleBarDiv:"\x3cdiv class\x3d'palette_titleBarDiv'\x3e\x3cspan class\x3d'paletteCloseBox'\x3e\x3c/span\x3e\x3cspan class\x3d'titleBarDivTitle'\x3e\x3c/span\x3e\x3c/div\x3e",constructor:function(a,c){this.subscribe("/davinci/ui/editorSelected",dojo.hitch(this,this._editorSelected));this.subscribe("/davinci/ui/widgetSelected",dojo.hitch(this,
this._widgetSelectionChanged));this.subscribe("/davinci/states/state/changed",dojo.hitch(this,this._stateChanged));this.subscribe("/maqetta/appstates/state/changed",dojo.hitch(this,this._stateChanged));this.subscribe("/davinci/ui/initialPerspectiveReady",dojo.hitch(this,this._initialPerspectiveReady));this.subscribe("/davinci/workbench/ready",dojo.hitch(this,this._workbenchReady))},getPageTemplate:function(){return[{key:"widgetSpecific",className:"maqPropertySection page_editor_only",addCommonPropertiesAtTop:!1,
html:"\x3cdiv dojoType\x3d'davinci.ve.widgets.WidgetProperties'\x3e\x3c/div\x3e"},{key:"events",className:"maqPropertySection page_editor_only",addCommonPropertiesAtTop:!1,pageTemplate:{html:"\x3cdiv dojoType\x3d'davinci.ve.widgets.EventSelection'\x3e\x3c/div\x3e"}},{key:"layout",className:"maqPropertySection",addCommonPropertiesAtTop:!0,pageTemplate:[{display:"width",type:"multi",target:["width"],values:["","auto","100%","200px","10em"]},{display:"height",type:"multi",target:["height"],values:["",
"auto","100%","200px","10em"]},{html:"\x26nbsp;"},{key:"showMinMax",display:"\x26nbsp;\x26nbsp;\x26nbsp;",type:"toggleSection",pageTemplate:[{display:"min-height",type:"multi",target:["min-height"],rowClass:"propertiesSectionHidden"},{display:"max-height",type:"multi",target:["max-height"],rowClass:"propertiesSectionHidden"},{display:"min-width",type:"multi",target:["min-width"],rowClass:"propertiesSectionHidden"},{display:"max-width",type:"multi",target:["max-width"],rowClass:"propertiesSectionHidden"},
{html:"\x26nbsp;",rowClass:"propertiesSectionHidden"}]},{display:"position",type:"combo",target:["position"],values:["","absolute","fixed","relative","static"]},{display:"left",type:"multi",target:["left"],values:["","0px","1em"]},{display:"top",type:"multi",target:["top"],values:["","0px","1em"]},{display:"right",type:"multi",target:["right"],values:["","0px","1em"]},{display:"bottom",type:"multi",target:["bottom"],values:["","0px","1em"]},{display:"display",type:"combo",target:["display"],values:["",
"none","block","inline","inline-block"]},{display:"opacity",type:"multi",target:["opacity"],values:["0","0.5","1.0"]},{display:"box-shadow",type:"text",target:["box-shadow"],value:["","none","1px 1px rgba(0,0,0,.5)"]},{display:"float",type:"combo",target:["float"],values:["","none","left","right"]},{display:"clear",type:"combo",target:["clear"],values:["","none","left","right","both"]},{display:"overflow",type:"combo",target:["overflow"],values:["","visible","hidden","scroll","auto"]},{display:"z-index",
type:"multi",target:["z-index"],values:" auto 0 1 100 -1 -100".split(" ")},{display:"box-sizing",type:"combo",target:["box-sizing","-webkit-box-sizing","-ms-box-sizing","-moz-box-sizing"],values:["","content-box","border-box"]}]},{key:"padding",className:"maqPropertySection",addCommonPropertiesAtTop:!0,pageTemplate:[{display:"\x3cb\x3e(padding)\x3c/b\x3e",type:"multi",target:["padding"],values:["","0px","1em"]},{key:"showtrbl",display:"\x26nbsp;\x26nbsp;\x26nbsp;",type:"toggleSection",pageTemplate:[{display:"padding-top",
type:"multi",target:["padding-top"],values:["","0px","1em"],rowClass:"propertiesSectionHidden"},{display:"padding-right",type:"multi",target:["padding-right"],values:["","0px","1em"],rowClass:"propertiesSectionHidden"},{display:"padding-bottom",type:"multi",target:["padding-bottom"],values:["","0px","1em"],rowClass:"propertiesSectionHidden"},{display:"padding-left",type:"multi",target:["padding-left"],values:["","0px","1em"],rowClass:"propertiesSectionHidden"}]}]},{key:"margins",className:"maqPropertySection",
addCommonPropertiesAtTop:!0,pageTemplate:[{display:"\x3cb\x3e(margin)\x3c/b\x3e",type:"multi",target:["margin"],values:["","0px","1em"]},{key:"showtrbl",display:"\x26nbsp;\x26nbsp;\x26nbsp;",type:"toggleSection",pageTemplate:[{display:"margin-top",type:"multi",target:["margin-top"],values:["","0px","1em"],rowClass:"propertiesSectionHidden"},{display:"margin-right",type:"multi",target:["margin-right"],values:["","0px","1em"],rowClass:"propertiesSectionHidden"},{display:"margin-bottom",type:"multi",
target:["margin-bottom"],values:["","0px","1em"],rowClass:"propertiesSectionHidden"},{display:"margin-left",type:"multi",target:["margin-left"],values:["","0px","1em"],rowClass:"propertiesSectionHidden"}]}]},{key:"background",className:"maqPropertySection",addCommonPropertiesAtTop:!0,pageTemplate:[{display:"background-color",type:"background",target:["background-color"],colorswatch:!0},{display:"background-image",type:"background",target:["background-image"],values:["","none"]},{display:"background-repeat",
type:"background",values:["","repeat","repeat-x","repeat-y","no-repeat"],target:["background-repeat"]},{display:"background-position",type:"background",target:["background-position"],values:";0px 0px;0% 0%;left top;center center;right bottom".split(";")},{display:"background-size",type:"background",target:["background-size"],values:["","auto","contain","cover","100%"]},{display:"background-origin",type:"background",target:["background-origin"],values:["","border-box","padding-box","content-box"]},
{display:"background-clip",type:"background",target:["background-clip"],values:["","border-box","padding-box","content-box"]}]},{key:"border",className:"maqPropertySection",addCommonPropertiesAtTop:!0,pageTemplate:[{display:"\x3cb\x3e(border)\x3c/b\x3e",type:"multi",target:["border"],values:["","none","1px solid black"]},{display:"show",type:"combo",values:["none","props","sides","all"],id:"properties_show_select",onchange:function(a){if("number"==typeof a){var c=function(a,b,c,d,g){for(;b<=c;b++){var e=
dojo.byId(a[b].rowId);b>=d&&b<=g?dojo.removeClass(e,"propertiesSectionHidden"):dojo.addClass(e,"propertiesSectionHidden")}};if(this.pageTemplate){a=this.pageTemplate[a];var d;a&&a.id&&(d=dojo.byId(a.id).value);dojo.isString(d)&&("none"===d?c(this.pageTemplate,2,20,-1,-1):"sides"===d?c(this.pageTemplate,2,20,2,5):"props"===d?c(this.pageTemplate,2,20,6,8):"all"===d&&c(this.pageTemplate,2,20,9,20))}}}},{display:"border-top",type:"multi",target:["border-top"],values:["","none","1px solid black"],rowClass:"propertiesSectionHidden"},
{display:"border-right",type:"multi",target:["border-right"],values:["","none","1px solid black"],rowClass:"propertiesSectionHidden"},{display:"border-bottom",type:"multi",target:["border-bottom"],values:["","none","1px solid black"],rowClass:"propertiesSectionHidden"},{display:"border-left",type:"multi",target:["border-left"],values:["","none","1px solid black"],rowClass:"propertiesSectionHidden"},{display:"border-width",type:"multi",target:["border-width"],values:["","1px","1em"],rowClass:"propertiesSectionHidden"},
{display:"border-style",type:"multi",target:["border-style"],values:["","none","solid","dotted","dashed"],rowClass:"propertiesSectionHidden"},{display:"border-color",type:"color",target:["border-color"],rowClass:"propertiesSectionHidden"},{display:"border-top-width",type:"multi",target:["border-top-width"],values:["","1px","1em"],rowClass:"propertiesSectionHidden"},{display:"border-top-style",type:"multi",target:["border-top-style"],values:["","none","solid","dotted","dashed"],rowClass:"propertiesSectionHidden"},
{display:"border-top-color",type:"color",target:["border-top-color"],rowClass:"propertiesSectionHidden"},{display:"border-right-width",type:"multi",target:["border-right-width"],values:["","1px","1em"],rowClass:"propertiesSectionHidden"},{display:"border-right-style",type:"multi",target:["border-right-style"],values:["","none","solid","dotted","dashed"],rowClass:"propertiesSectionHidden"},{display:"border-right-color",type:"color",target:["border-right-color"],rowClass:"propertiesSectionHidden"},
{display:"border-bottom-width",type:"multi",target:["border-bottom-width"],values:["","1px","1em"],rowClass:"propertiesSectionHidden"},{display:"border-bottom-style",type:"multi",target:["border-bottom-style"],values:["","none","solid","dotted","dashed"],rowClass:"propertiesSectionHidden"},{display:"border-bottom-color",type:"color",target:["border-bottom-color"],rowClass:"propertiesSectionHidden"},{display:"border-left-width",type:"multi",target:["border-left-width"],values:["","1px","1em"],rowClass:"propertiesSectionHidden"},
{display:"border-left-style",type:"multi",target:["border-left-style"],values:["","none","solid","dotted","dashed"],rowClass:"propertiesSectionHidden"},{display:"border-left-color",type:"color",target:["border-left-color"],rowClass:"propertiesSectionHidden"},{display:"border-collapse",type:"combo",target:["border-collapse"],values:["","separate","collapse"]},{display:"\x3cb\x3e(border-radius)\x3c/b\x3e",type:"multi",target:["border-radius","-moz-border-radius"],values:["","0px","6px"]},{key:"showDetails",
display:"",type:"toggleSection",pageTemplate:[{display:"border-top-left-radius",type:"multi",target:["border-top-left-radius","-moz-border-radius-topleft"],values:["","0px","6px"],rowClass:"propertiesSectionHidden"},{display:"border-top-right-radius",type:"multi",target:["border-top-right-radius","-moz-border-radius-topright"],values:["","0px","6px"],rowClass:"propertiesSectionHidden"},{display:"border-bottom-right-radius",type:"multi",target:["border-bottom-right-radius","-moz-border-radius-bottomright"],
values:["","0px","6px"],rowClass:"propertiesSectionHidden"},{display:"border-bottom-left-radius",type:"multi",target:["border-bottom-left-radius","-moz-border-radius-bottomleft"],values:["","0px","6px"],rowClass:"propertiesSectionHidden"}]}]},{key:"fontsAndText",className:"maqPropertySection",addCommonPropertiesAtTop:!0,pageTemplate:[{display:"font",type:"text",target:["font"]},{display:"font-family",type:"font",target:["font-family"]},{display:"size",type:"multi",target:["font-size"],values:["",
"100%","1em","10px","10pt"]},{display:"color",type:"color",target:["color"]},{display:"font-weight",type:"combo",target:["font-weight"],values:["","normal","bold"]},{display:"font-style",type:"combo",target:["font-style"],values:["","normal","italic"]},{display:"text-decoration",type:"combo",target:["text-decoration"],values:["","none","underline","line-through"]},{display:"text-align",type:"combo",target:["text-align"],values:["","left","center","right","justify"]},{display:"vertical-align",type:"combo",
target:["vertical-align"],values:["","baseline","top","middle","bottom"]},{display:"white-space",type:"combo",target:["white-space"],values:" normal nowrap pre pre-line pre-wrap".split(" ")},{display:"text-indent",type:"multi",target:["text-indent"],values:["","0","1em","10px"]},{display:"line-height",type:"multi",target:["line-height"],values:["","normal","1.2","120%"]}]}]},buildRendering:function(){this.domNode=dojo.doc.createElement("div");dojo.addClass(this.domNode,"propertiesContent");var a;
a=""+this._titleBarDiv;a+="\x3cdiv class\x3d'propertiesToolBar' dojoType\x3d'davinci.ve.widgets.WidgetToolBar'\x3e\x3c/div\x3e\x3cdiv dojoType\x3d'davinci.ve.widgets.WidgetProperties'\x3e\x3c/div\x3e\x3cdiv class\x3d'propScrollableArea'\x3e\x3ctable class\x3d'propRootDetailsContainer'\x3e\x3ctr\x3e\x3ctd class\x3d'propPaletteRoot'\x3e";this.pageTemplate=this.getPageTemplate();for(var c=0;c<this.pageTemplate.length;c++)if(this.pageTemplate[c].title=m[this.pageTemplate[c].key]?m[this.pageTemplate[c].key]:
"Key not found",this.pageTemplate[c].pageTemplate)for(var d=0;d<this.pageTemplate[c].pageTemplate.length;d++)this.pageTemplate[c].pageTemplate[d].key&&(this.pageTemplate[c].pageTemplate[d].display+=m[this.pageTemplate[c].pageTemplate[d].key]?m[this.pageTemplate[c].pageTemplate[d].key]:"Key not found");this.domNode.innerHTML=a;this.inherited(arguments)},_widgetValuesChanged:function(a){var c=this._currentPropSection;if(c){for(var d=!1,e=0;e<this.pageTemplate.length;e++)if(this.pageTemplate[e].key==
c){d=!0;break}if(d)for(c=this._getVisibleCascade(e),d=0;d<c.length;d++)c[d]._widgetValuesChanged(a)}},_getVisibleCascade:function(a){if(a)return this.pageTemplate[a].cascade;a=[];var c=this._currentPropSection;if(c)for(var d=0;d<this.pageTemplate.length;d++)if(this.pageTemplate[d].key==c){a=a.concat(this.pageTemplate[d].cascade);break}return a},_updatePaletteValues:function(a){if(this._editor){A.isArray(a)||(a=[a]);var c=a[0];this._subwidget=(this._widget=c)&&c.subwidget;this.setReadOnly(!(this._widget||
this._subwidget));for(var c=this._getVisibleCascade(),d=0;d<c.length;d++)c[d]._widgetSelectionChanged(a)}else console.error("have no editor",a)},_widgetSelectionChanged:function(a){this._updatePaletteValues(a)},_stateChanged:function(){this._updatePaletteValues(this._widget?[this._widget]:[])},_widgetPropertiesChanged:function(a){this._widget||console.error("have no widget");this._widget&&this._widget.type!==a[0].type||this._updatePaletteValues(a)},_titlePaneOpen:function(a){a=this._getVisibleCascade(a);
for(var c=0;c<a.length;c++)a[c]._editorSelected({editor:this._editor})},startup:function(){this.domNode.style.height="100%";this.inherited(arguments);for(var a=0;a<this.pageTemplate.length;a++){var c=this.pageTemplate[a];if(c.pageTemplate)for(var d=0;d<c.pageTemplate.length;d++){var e=c.pageTemplate[d];e.onchange&&e.id&&dojo.connect(dojo.byId(e.id),"onchange",dojo.hitch(c,e.onchange,d))}}for(a=0;a<this.pageTemplate.length;a++)this.pageTemplate[a].cascade=[];this.setReadOnly(!0);this.onEditorSelected();
this.subscribe("/davinci/ui/widgetValuesChanged",dojo.hitch(this,this._widgetValuesChanged));this.subscribe("/davinci/ui/widgetPropertiesChanged",dojo.hitch(this,this._widgetPropertiesChanged));this.subscribe("/davinci/ui/widgetSelected",dojo.hitch(this,this._widgetSelectionChanged))},setReadOnly:function(a){for(var c=0;c<this.pageTemplate.length;c++){var d=this.pageTemplate[c].pageTemplate;if(d)for(var e=0;e<d.length;e++){var b=d[e].widget;b?b.set("readOnly",a):(b=d[e].domNode)&&dojo.attr(b,"disabled",
a)}}},_modelEntryById:function(a){for(var c=0;c<this.pageTemplate.length;c++){var d=this.pageTemplate[c].pageTemplate;if(d)for(var e=0;e<d.length;e++)if(a==d[e].id)return d[e]}},_editorSelected:function(a){this._editor=a.editor;this.onEditorSelected(this._editor);a=this.getParent();var c=a.selectedChildWidget,d=!1,e=dojo.query(".maqPropertySection",a.domNode);this._editor?"davinci.ve.PageEditor"!=this._editor.declaredClass&&"davinci.ve.themeEditor.ThemeEditor"!=this._editor.declaredClass?e.forEach(function(a){a=
dijit.byNode(a);a.controlButton&&(a.controlButton.domNode.style.display="none");a==c&&(d=!0)}):(e.forEach(function(a){a=dijit.byNode(a);a.controlButton&&(a.controlButton.domNode.style.display="")}),"davinci.ve.themeEditor.ThemeEditor"==this._editor.declaredClass&&dojo.query(".page_editor_only",a.domNode).forEach(function(a){a=dijit.byNode(a);a.controlButton&&(a.controlButton.domNode.style.display="none");a==c&&(d=!0)})):(e.forEach(function(a){dijit.byNode(a).controlButton.domNode.style.display=""}),
d=!0);d&&this._selectFirstVisibleTab()},onEditorSelected:function(){this._subWidget=this._widget=null;this._oldClassName&&(this.domNode?dojo.removeClass(this.domNode.parentNode.parentNode,this._oldClassName):console.error("have no dom node !"));if(this._editor)if(this._editor&&this._editor.editorID&&(this._oldClassName=this._editor.editorID.replace(/\./g,"_"),this.domNode?dojo.addClass(this.domNode.parentNode.parentNode,this._oldClassName):console.error("have no dom node !")),this.domNode){for(var a=
this._currentPropSection,c=dojo.query(".propSectionButton",this.domNode),d=0;d<c.length;d++){var e=c[d];this._editor&&this._editor.supports&&this._editor.supports("propsect_"+this.pageTemplate[d].key)?dojo.removeClass(e,"dijitHidden"):(dojo.addClass(e,"dijitHidden"),a==this.pageTemplate[d].key&&w.showRoot())}a=[];for(d=0;d<this.pageTemplate.length;d++)(c=this.pageTemplate[d].cascade)&&(a=a.concat(c));for(d=0;d<a.length;d++)c=a[d],c._editorSelected&&c._editorSelected({editor:this._editor})}else console.error("have no dom node !")},
destroy:function(){this.inherited(arguments)},_destroyContent:function(){var a=this.containerNode||this.domNode;for(dojo.forEach(dojo.query("[widgetId]",a).map(dijit.byNode),function(a){a.destroy()});a.firstChild;)dojo._destroyElement(a.firstChild);dojo.forEach(this._tooltips,function(a){a.destroy()});this._tooltips=void 0},sectionTitleFromKey:function(a){for(var c=0;c<this.pageTemplate.length;c++)if(this.pageTemplate[c].key==a)return this.pageTemplate[c].title},_initialPerspectiveReady:function(){if(!this._alreadySplitIntoMultipleTabs){var a=
this.tabContainer;dojo.addClass(a.domNode,"propRootDetailsContainer");dojo.addClass(a.domNode,"propertiesContent");for(var c=0;c<this.pageTemplate.length;c++){var d=this.pageTemplate[c].key,e=this.pageTemplate[c].title,b=this.pageTemplate[c].className;b||(b="");var h=this._titleBarDiv,h=h+"\x3cdiv class\x3d'propertiesToolBar' dojoType\x3d'davinci.ve.widgets.WidgetToolBar'\x3e\x3c/div\x3e",h=h+("\x3cdiv class\x3d'cascadeBackButtonDiv'\x3e\x3cbutton onclick\x3d'davinci.ve.widgets.HTMLStringUtil.showSection(\""+
d+'","'+e+"\")'\x3e"+e+" "+m.properties+"\x3c/button\x3e\x3c/div\x3e"),d=w.generateTemplate(this.pageTemplate[c]),h=h+d;0==c?(h=this,h.set("title",e),dojo.addClass(h.domNode,b)):h=a.createTab(e,null,null,null,{content:h,"class":b,delegate:this}).add(g,{title:e,content:h,"class":b,delegate:this},null,!0);h._maqPropGroup=this.pageTemplate[c].key;e=dojo.query(".paletteCloseBox",h.domNode);0<e.length&&dojo.connect(e[0],"click",this,function(a){davinci.Workbench.collapsePaletteContainer(a.currentTarget)})}for(e=
0;e<this.pageTemplate.length;e++)if(this.pageTemplate[e].cascade=[],b=this.pageTemplate[e].pageTemplate){for(c=0;c<b.length;c++)h=b[c].id,(d=dijit.byId(h))?b[c].widget=d:(d=dojo.byId(h))&&(b[c].domNode=d);dojo.query("#"+this.pageTemplate[e].id+" .CascadeTop").forEach(function(a){return function(b){b=dijit.byId(b.id);a.cascade.push(b)}}(this.pageTemplate[e]))}dojo.connect(a,"selectChild",this,function(a){"none"!=a.controlButton.domNode.style.display||this._recursiveSelectChildInProcess?a._maqPropGroup&&
(this._currentPropSection=a._maqPropGroup,a=(a=this._editor&&this._editor.getContext?this._editor.getContext():null)&&a.getSelection?a.getSelection():this._widgets,this._updatePaletteValues(a),w._initSection(this._currentPropSection)):(this._recursiveSelectChildInProcess=!0,this._selectFirstVisibleTab(),delete this._recursiveSelectChildInProcess)});this._alreadySplitIntoMultipleTabs=!0}},_workbenchReady:function(){this._updateToolBars()},_updateToolBars:function(){dojo.query(".propertiesToolBar").forEach(function(a){this._editor&&
"davinci.ve.PageEditor"==this._editor.declaredClass?(dojo.removeClass(a,"dijitHidden"),a.style.display=""):dojo.addClass(a,"dijitHidden")}.bind(this))},_selectFirstVisibleTab:function(){for(var a=this.getParent(),c=a.getChildren(),d=0;d<c.length;d++){var e=c[d];if("none"!=e.controlButton.domNode.style.display){a._maqDontExpandCollapse=!0;a.selectChild(e);delete a._maqDontExpandCollapse;break}}}})})},"xideve/widgets/WidgetLite":function(){define(["dojo/_base/declare","dijit/_WidgetBase","dojo/parser",
"xide/mixins/EventedMixin"],function(q,A,m,n){return q("xideve/widgets/WidgetLite",[A,n],{buildRendering:function(){this.inherited(arguments);/dojotype/i.test(this.domNode.innerHTML||"")&&(this._startupWidgets=dojo.parser.parse(this.domNode,{noStart:!this._earlyTemplatedStartup,inherited:{dir:this.dir,lang:this.lang}}))},_destroyContent:function(){var d=this.containerNode||this.domNode;for(dojo.forEach(dojo.query("[widgetId]",d).map(dijit.byNode),function(d){d.destroy()});d.firstChild;)dojo._destroyElement(d.firstChild);
dojo.forEach(this._tooltips,function(d){d.destroy()});delete this._tooltips},startup:function(){dojo.forEach(this._startupWidgets,function(d){d&&!d._started&&d.startup&&d.startup()});this.inherited(arguments)}})})},"xideve/manager/WidgetManager":function(){define("dcl/dcl dojo/_base/lang dojo/dom-construct xide/manager/ManagerBase xide/mixins/ReloadMixin xide/types xide/utils xide/factory xide/layout/ContentPane xide/widgets/_MenuMixin2 xide/mixins/ActionMixin xaction/Action ./WidgetManagerBlox ./WidgetManagerJS xide/mixins/VariableMixin davinci/ve/metadata xdojo/has!xtrack?xide/interface/Track xide/interface/Route xide/noob xide/data/Reference xide/data/ReferenceMapping xide/mixins/ActionProvider".split(" "),
function(q,A,m,n,d,g,l,h,w,J,C,a,c,I,v,k,y,D,e,b,r,G){q([b,r],{});w=null;y&&(w={track:function(){return!0},getTrackingCategory:function(){return l.capitalize(this.beanNamespace)},getTrackingEvent:function(){return g.ACTION.OPEN},getTrackingLabel:function(a){return this.getMetaValue(a,g.DRIVER_PROPERTY.CF_DRIVER_NAME)},getActionTrackingUrl:function(a){return A.replace(this.breanScheme+"?action\x3d{action}\x26"+this.beanUrlPattern,{action:a})},getTrackingUrl:function(a){return A.replace(this.breanScheme+
"{view}/"+this.beanUrlPattern,{id:a.id,view:"settings"})}});l.mixin(g.ACTION_VISIBILITY,{WIDGET_PROPERTY:"WIDGET_PROPERTY"});var N={onclick:null,ondblclick:null,onmousedown:null,onmouseup:null,onmouseover:null,onmousemove:null,onmouseout:null,onkeypress:null,onkeydown:null,onkeyup:null,onfocus:null,onblur:null,onchange:null};return q([D.dcl,G.dcl,n,d.dcl,c,I,J,v.dcl,y?q(y.dcl,w):e.dcl],{declaredClass:"xideve/manager/WidgetManager",currentContext:null,_currentWidget:null,visibility:g.ACTION_VISIBILITY.WIDGET_PROPERTY,
onReloaded:function(){},onLibraryContainerCreated:function(a){},onContextReady:function(a){},_completeEventInfo:function(a){var b=a.target||null,e=a.widget?a.target.getContext():null;a.editor=e.editor?e.editor:e._edit_context.editor;var c=e?e.getGlobal():null,e=e.appContext,d=e.application,g=b.domNode||b;b.isDijitWidget&&(g=b.dijitWidget.domNode);a.appSettings=d.settings;a.appContext=e;a.app=d;a.global=c;a.node=g;a.widgetContext=b;a.dijitWidget=b.isDijitWidget?b.dijitWidget:null;return a},onWidgetPropertyChanged:function(a){a=
this._completeEventInfo(a);var b=a.widgetProperty,e=a.node,c=a.dijitWidget,d=b in N,g=a.global;b&&e&&d&&c&&c.on&&(e.removeAttribute(b),e[b]&&e.removeEventListener(b,e[b]),e[b]=null,g.dojo.setAttr(a.node,a.widgetProperty,""),g.dojo.setAttr(a.node,a.widgetProperty,a.value))},onWidgetPropertyRendered:function(a){if(!a.wmHandled){a.wmHandled=!0;var b=a.row;switch(b.type){case "widgetState":this.onStatePropertyRendered(b,a.node,a.view,a.row);break;case "iconClass":this.onIconClassPropertyRendered(b,a.node,
a.view,a.row);break;case "state":this.onEventPropertyRendered2(b,a.node,a.view,a.row)}}},onEventPropertyRendered2:function(){},onIconClassPropertyRendered:function(a,b,e,c){if(!b.iconPicker){var d=$(b).iconpicker({selectedCustomClass:"label label-success",showFooter:!1});b.iconPicker=d;d.on("iconpickerSelected",function(a){var b={};b.iconClass="fa "+a.iconpickerValue;a=new davinci.ve.commands.ModifyCommand(d._widget,b,null);dojo.publish("/davinci/ui/widgetPropertiesChanges",[{source:d._context.editor_id,
command:a}])})}e._widget&&(l.getNode(e._widget),b.iconPicker._widget=e._widget,b.iconPicker._context=e.context)},onStatePropertyRendered:function(a,b,e,c){if(!b._selectize){var d=$(b).selectize({value:"",delimiter:",",persist:!1,maxItems:1,create:!0,sortField:"text"}).data().selectize;b._selectize=d;d.on("change",function(){var a=d.getValue();"None"===a&&(a="");var b={};b.state=a;a=new davinci.ve.commands.ModifyCommand(d._widget,b,null);dojo.publish("/davinci/ui/widgetPropertiesChanges",[{source:d._context.editor_id,
command:a}])})}b._selectize.setValue(["None"],!0);e._widget&&(a=l.getNode(e._widget))&&(a.getStates&&(c=a.getStates(),_.each(c,function(a){b._selectize.addOption({value:a.name,text:a.name})})),b._selectize.addOption({value:"None",text:"None"}),b._selectize.setValue(a.state,!0),b._selectize._widget=e._widget,b._selectize._context=e.context)},defaultNumberActions:function(b){var e=this,c=a.createDefault("Javascript","fa-code","Widget/Bind to Javascript","widgetPropertyAction",function(a,b,c,d,g){e.onJavascript(g.context)});
c.setVisibility(this.visibility,{});c.context=b;var d=a.createDefault("XBlox","fa-play-circle-o","Widget/Bind to XBlox","widgetPropertyAction",function(a,b,c,d,g){e.onXBlox(g.context)});d.setVisibility(g.ACTION_VISIBILITY.WIDGET_PROPERTY,{});d.context=b;return[c,d]},_showContextActions:function(a,b,e,c){},_createContextMenu:function(a,b,e,c){},doWidgetPropWizard:function(a,b,e,c,d){this._createContextMenu(c,b,e,d)},renderBlockWidget:function(a,b,e){},onNumberPropertyRendered:function(a,b,e,c){},onContextLoaded:function(a){this.currentContext=
a},onEventPropertyRendered:function(a,b,e){},onEventSelectionRendered:function(a){},onSelectionChanged:function(a){},onWidgetSelected:function(a){},renderFileWidget:function(a,b,e){var c=b;b.parentNode&&b.parentNode.nextSibling&&-1!=b.parentNode.nextSibling.className.indexOf("propertyExtra")&&(c=b.parentNode.nextSibling);var d=h.createButton(m.create("div"),"el-icon-folder-open","elusiveButton","","",function(){this.onSelectFile(b,a,e)}.bind(this),this);dojo.place(d.domNode,c,"after")},init:function(){this.subscribe("/davinci/ui/onSelectionChanged",
this.onSelectionChanged);this.subscribe("/davinci/ui/widgetSelected",this.onWidgetSelected);this.subscribe("/davinci/ui/context/loaded",this.onContextLoaded);this.subscribe([g.EVENTS.WIDGET_PROPERTY_RENDERED,g.EVENTS.ON_EVENT_SELECTION_RENDERED,g.EVENTS.ON_WIDGET_PROPERTY_CHANGED,g.EVENTS.ON_LIBRARY_CONTAINER_CREATED,g.EVENTS.ON_CONTEXT_READY,g.EVENTS.ON_RENDER_WELCOME_GRID_GROUP]);this.registerRoutes()},handleRoute:function(a){switch(a.parameters.view){case "settings":return this.openItemSettings(this.getDriverById(a.parameters.id))}},
registerRoutes:function(){this.getContext().registerRoute({id:"Scene",path:"scene://{view}/{id}",schemes:["scenes"],delegate:this});this.getContext().registerRoute({id:"New Scene",path:"File/New Scene",schemes:[""],delegate:this})},onRenderWelcomeGridGroup:function(a){var b=this.getContext(),e=b.getTrackingManager();b.getRouter();var c=a.store,d=this;switch(a.item.group){case "New":e=[];e.push(this.createAction({label:"New Scene",command:"File/New Scene",icon:"fa-magic",mixin:{addPermission:!0}}));
_.map(e,function(a){return c.putSync(l.mixin(a,{url:a.command,parent:"New",group:null,label:a.title,owner:d,runAction:function(a,b,e){return DriverTreeView.prototype.runAction.apply(DriverTreeView.prototype,[{command:this.url},b,e])}}))});break;case "Recent":e&&(c.putSync({group:"Scenes",label:"Scenes",url:"Scenes",parent:"Recent",directory:!0}),a=e.filterMin({category:"Driver"},"counter",1),a=e.most(null,a),e.last(a))}},getRouteRenderParams:function(a){return{icon:null}},routeToReference:function(a){return this.getDriverById(a?
a.parameters.id:null)},referenceToRoute:function(a){return A.replace(this.breanScheme+"{view}/"+this.beanUrlPattern,{id:a.id,view:"settings"})}})})},"xideve/manager/WidgetManagerBlox":function(){define(["dcl/dcl","xdojo/declare","xide/types","xide/utils","xide/views/CIActionDialog"],function(q,A,m,n,d){return q(null,{declaredClass:"xideve/manager/WidgetManagerBlox",_removeEventHandlers:function(d,l){},_setEventHandler:function(d,l,h){if(d._attachEvents){var g=l.replace("on","");_.each(d._attachEvents,
function(h){h.type===g&&h.remove();d._attachEvents.remove(h)});if(h){var n=new Function("{"+h+"; }");h=d.on(g,function(g){n.call(d,g)});h.type=l;d._attachEvents.push(h)}}},onModifiedXBLOX:function(d){},openBloxWizard:function(g){var l=this;g=this._completeEventInfo(g);var h="min.xblox",q="workspace";if(g.appSettings&&g.appSettings.xbloxScripts&&0<g.appSettings.xbloxScripts.length)var A=g.appSettings.xbloxScripts[0],h=A.path.replace("./",""),q=A.mount;var C=null;this.ctx.getBlockManager().load(q,h).then(function(a){l.ctx.blockManager.ignoreItemSelection=
!0;var c=dojo.subscribe("onItemSelected",function(a){C=a.item}),w=(""+g.value).split(","),v=n.replaceAll("'","",w[1]),w=dojo.fromJson(w[3]);C=a.getBlockById(v);(new d({title:"Select Block and override inputs",style:"width:800px;min-height:600px;",resizeable:!0,delegate:{onOk:function(a,d){a=n.getCIInputValueByName(d,"Settings");if(C){l.ctx.blockManager.ignoreItemSelection=!1;d=n.buildPath(q,h,!1);if(C){var k="";a&&(k=","+a);a="runBlox('"+d+"','"+C.id+"',this"+k+")";l._setEventHandler(g.dijitWidget||
g.node,g.widgetProperty,a);g.editor.setDirty(!0);g.widget.set("value",a);l.onModifiedXBLOX(g,C)}c.remove()}}},cis:[n.createCI("Block",m.ECIType.BLOCK_REFERENCE,"",{group:"Block",delegate:null,showDialog:!1,scope:a,block:C}),n.createCI("Settings",m.ECIType.BLOCK_SETTINGS,"",{group:"Settings",scope:a,block:C,settings:w})]})).show()})},onXBlox:function(d){var g=d.row.widget,h="";g||(g=dijit.byId(d.row.id))&&(h=g.get("value"));!g&&(g=dojo.byId(d.row.id))&&(h=g.value);this.openBloxWizard({owner:this,delegate:this,
widget:g,value:h,target:d.widget,widgetProperty:d.row.display,meta:{context:d}})}})})},"xideve/manager/WidgetManagerJS":function(){define(["dcl/dcl","xide/types","xide/utils","xide/views/CIActionDialog"],function(q,A,m,n){return q(null,{declaredClass:"xideve/manager/WidgetManagerJS",onReloaded:function(){console.error("reloadex2:")},onModifiedJS:function(d){},_createView:function(d,g){var l=this,h=g.target||null,q=g.widget?g.target.getContext():null,J=q?q.getGlobal():null;(new n({title:"Javascript",
style:"width:800px;min-height:600px;",resizeable:!0,delegate:{onOk:function(d,a){d=m.getCIInputValueByName(a,"Expression");q.editor.setDirty(!0);g.widget.set?g.widget.set("value",d):null!=g.widget.value&&(g.widget.value=d,g.widget.owner._onChange({target:g.widget.pageIndex}));l.onModifiedJS(d,g)}},cis:[m.createCI("Settings",A.ECIType.STRING,d,{group:"Settings"}),m.createCI("Expression",A.ECIType.EXPRESSION_EDITOR,d,{group:"Script",delegate:{runExpression:function(d,a,c){var g=null;if(J.runx)try{g=
J.runx(h,d)}catch(v){if(c){c(""+v);return}}else g=J.eval.call(h,d);a&&a("Expression "+d+" evaluates to; "+g)}}})]})).show()},openJSWizard:function(d){this._createView(d.value,d)},onJavascript:function(d){var g=d.row.widget,l="";g||(g=dijit.byId(d.row.id))&&(l=g.get("value"));!g&&(g=dojo.byId(d.row.id))&&(l=g.value);this.openJSWizard({owner:this,delegate:this,widget:g,value:l,target:d.widget,meta:{context:d}})}})})},"xideve/manager/ContextManager":function(){define("dcl/dcl dojo/Deferred xide/manager/ManagerBase xide/mixins/VariableMixin xide/mixins/ReloadMixin xide/types xide/utils xide/mixins/EventedMixin davinci/ve/widget xide/manager/ServerActionBase xide/encoding/SHA1 xdojo/has xide/widgets/ContextMenu xaction/ActionProvider xaction/DefaultActions xide/lodash xide/$ davinci/Workbench".split(" "),
function(q,A,m,n,d,g,l,h,w,J,C,a,c,I,v,k,y,D){return q([m,J,n.dcl,d.dcl,I.dcl],{declaredClass:"xideve/manager/ContextManager",serviceClass:"XIDE_VE_Service",singleton:!0,contexts:[],variableDelimiters:{begin:"%%",end:"%%"},onReloaded:function(){},getViewUrl:function(e,b,c){e||console.error("invalid item!");e=this.ctx.getResourceManager().getVariable("ROOT")+"xideve/preview/"+e.mount+"/"+e.path.replace("./","")+(a("debug")?"?debug\x3dtrue":"");e+=-1===e.indexOf("?")?"?":"\x26";return e+="userDirectory\x3d"+
encodeURIComponent(this.ctx.getUserDirectory())},viewFile:function(a){a={path:"delite.html",mount:"workspace"};this.getViewUrl(a)},onBuildDojoConfig:function(a){a&&a.data&&a.data&&(a=a.data,a.baseUrl&&(a.baseUrl=this.resolve(a.baseUrl)))},onSetDojoUrl:function(a){a&&a.data&&a.data&&a.data.dojoUrl&&(a.data.dojoUrl=this.resolve("%%XIDEVE_DOJO_URL%%"))},onSetSourceData:function(a){a.context.widgetsReadyDfd&&(delete a.context.widgetsReadyDfd,a.context.widgetsReadyDfd=null);a.context.widgetsReadyDfd=new A},
onGetLoaderPackages:function(a){var b=dojo.baseUrl,c=function(a,c,e,d){a.packages.push({name:c,location:!0!==d?b+"/"+(e||"")+c:b+"/"+c+"-release/"+c})};c(a,"xapp");c(a,"dijit");c(a,"dojox");c(a,"xblox");c(a,"dstore");c(a,"xide");c(a,"xfile");c(a,"xwire");c(a,"xlang");c(a,"xaction");c(a,"xgrid");c(a,"xnode");c(a,"delite","ibm-js/");c(a,"deliteful","ibm-js/");c(a,"decor","ibm-js/");c(a,"dpointer","ibm-js/");c(a,"dcl","ibm-js/");c(a,"requirejs-dplugins","ibm-js/");c(a,"requirejs-domready","ibm-js/");
c(a,"requirejs-text","ibm-js/");c(a,"jquery","ibm-js/")},onContextLoaded:function(a){this.currentContext=a;var b=a.global,c=this;b._=window._;b.Velocity=window.Velocity;b.delegate=this;b.bootx&&b.bootx({delegate:this},A).then(function(b){a.appContext=b.context;c.onContextReady(a,b.context,b.settings)},function(a){console.error("error global.bootx "+a,a)})},onContextReady:function(a,b,c){var e=a.global,d=a.getDocument(),h=this;b.fileManager=this.ctx.fileManager;b.resourceManager=this.ctx.resourceManager;
b.driverManager=h.ctx.driverManager;b.deviceManager=h.ctx.deviceManager;b.nodeServiceManager=h.ctx.nodeServiceManager;b.blockManager=h.ctx.blockManager;b.delegate={isDesignMode:function(){return a.isDesignMode()},getBlockSettings:function(){return a.getBlockSettings()},getEditorContext:function(){return a}};c.delegate=h;c.xbloxScripts=[];b.initVe();b.notifier.publish("onContextReady",b);b.notifier.publish("DevicesConnected");if(c.xbloxScripts){var k=function(){h.ctx.getBlockManager().loadFiles(c.xbloxScripts).then(function(k){c.didXBLOX=
!0;var l={context:a,appContext:b,appSettings:c,ctx:h.ctx,global:e,document:d,blockScopes:k};n.onSceneBlocksLoaded(l);var m=n.item._S,r=n.item.getParent();b.settings=c;b.onReady(c);m.resetQueryLog();m._loadPath(r.path,!0).then(function(){"."===r.path&&m.resetQueryLog();h.publish(g.EVENTS.ON_CONTEXT_READY,l);h.onSceneBlocksLoaded(l)});b.__didv||(b.__didv=!0)})},n=a.getVisualEditor();if(0==c.xbloxScripts.length){var m=a.getVisualEditor().item;if(m){var r=l.replaceAll("/","",m.mount),q=l.getFileExtension(m.path),
m=m.path.replace("."+q,".xblox");c.xbloxScripts.push({mount:r,path:m});this.ctx.getFileManager().mkfile(r,m,JSON.stringify({blocks:[],variables:[]},null,2)).then(function(){k()})}}}b.application.run(c);this.publish(g.EVENTS.ON_APP_READY,{context:a,application:b.application,delegate:this});for(r=0;r<this.contexts.length;r++)if(m=this.contexts[r],m.context==a)return;this.contexts.push({context:a,appContext:b,global:e,doc:d})},onBuildHeader:function(a){if(a&&a.data&&a.data.styleSheets)for(var b=a.data.styleSheets,
c=0;c<b.length;c++)a.data.styleSheets[c]=this.resolve(b[c])},onModuleUpdated:function(a){k.each(this.contexts,function(b){b.appContext.onModuleUpdated(a)},this)},onDriverVariableChanged:function(a){k.each(this.contexts,function(b){b.context.isDesignMode()||b.appContext.publish("onDriverVariableChanged",a)},this)},onContextDestroyed:function(a){var b=k.find(this.contexts,{context:a});b&&(a.systemEvents&&k.each(a.systemEvents,function(a){a&&a.remove?a.remove():console.error("have invalid handle!")}),
this.contexts.remove(b))},getVariable:function(a,b,c){b=this.ctx.getDeviceManager();var e=b.getDeviceById(a),d=null;if(!e)return null;(a=e.driver)&&a.blockScope&&(a=a.blockScope);!a&&e&&(b=b.getMetaValue(e,g.DEVICE_PROPERTY.CF_DEVICE_DRIVER),a=this.ctx.getBlockManager().getScope(b),d=a.getVariableById(b+"/"+c));return d},getBlock:function(a){return this.ctx.getDeviceManager().getBlock(a)},wireNode:function(a,b,c,d,n,m){var e=this,r=null,t=null;if(m&&b===g.EVENTS.ON_DRIVER_VARIABLE_CHANGED)var q=m.params[2],
r=function(a){a=a.item;var b=e.getBlock(q);return b&&a&&b.id===a.id||a.id===q?!1:!0},t=function(a,b){a.override={variables:{value:b.item.value}}};if(a)if(c)if(b)if(k.isString(b))if(d.systemEvents||(d.systemEvents=[]),"BODY"===a.tagName&&a._destroyHandles&&(a._destroyHandles(),delete a.__setup),a.__setup||(a.__setup={}),a.__setup[c.id])console.error("did wire "+c.name+" to "+a.id+"_"+a["wire id"],a);else{a.__setup[c.id]=!0;a["wire id"]||(a["wire id"]=l.createUUID());c&&a&&(c.context=a,c._targetReference=
a);var w=function(a,b,c,e){!("load"!==a&&d&&d.isDesignMode&&d.isDesignMode()||r&&r(b)||c._destroyed)&&c.enabled&&c&&e&&(c.context=e,c._targetReference=e,t&&t(c,b),c.solve(c.scope,{highlight:!0,args:[b]}))};a.subscribe||l.mixin(a,h.prototype);var x=a.domNode||a;n=b;m=a.declaredClass||a.startup;var v=null!=a.on&&null!=a["on"+l.capitalize(n)],u=null,y=null!=x.render&&null!=x.on;if(m&&a.baseClass&&-1!=a.baseClass.indexOf("dijitContentPane")||null!=a.render||null!=a.on)m=!1;x&&(y||v&&m?(x=a,y?l.isSystemEvent(b)?
u=x.subscribe(b,function(d){w(b,d,c,a)}.bind(this),a):(l.isNativeEvent(b)&&(b=b.replace("on","")),u=x.on(b,function(d){var e=d.target.value;"checked"in d.target&&(e=d.target.checked);w(b,e,c,a)}.bind(this))):(n="on"+l.capitalize(n),a[n]=function(a,c){!0!==x.ignore&&w(b,a)})):l.isSystemEvent(b)?(n=function(d){w(b,d,c,a)}.bind(this),u=a.subscribe(b,n),c._on("destroy",function(){console.error("block destroyed");u.remove()})):u=a.__on(x,b,function(d){w(b,d,c,a)}),u?(a.addHandle&&a.addHandle(b,u),c._widgetHandles||
(c._widgetHandles=[]),c._widgetHandles.push(u)):console.error("wire widget: have no handle",a))}else console.error("event not string ",b);else console.error("have no event");else console.error("have no block for event "+b);else console.error("have no widget for event "+b)},wireWidget:function(a,b,c,d,g,h,k,l,n){b=c.getBlocks({group:k});for(c=0;c<b.length;c++)this.wireNode(d.domNode,h,b[c],a,l,n)},wireWidget2:function(a,b,c,d,g){for(var e=c.allGroups(),h=[],k=0;k<e.length;k++){var n=e[k],m;var r=m=
null,q=(n||"").split("__"),v=[];1==q.length&&(m=q[0],r="body",a.rootWidget.domNode.runExpression=a.global.runExpression);if(2==q.length){var u=void 0;-1!==q[1].indexOf("://")?(m=q[0],r="body",u=q[1]):(m=q[1],r=q[0]);u&&(v=l.parse_url(u),v=l.urlArgs(v.host),v=[v.device.value,v.driver.value,u])}3==q.length&&(m=q[1],r=q[0],u=q[2],v=l.parse_url(u),v=l.urlArgs(v.host),v=[v.device.value,v.driver.value,u]);5==q.length&&(m=q[1],r=q[0],v=[q[2],q[3],q[4]]);m&&r?(q=w.byId(r),"body"===r&&(q=a.rootWidget),m={event:m,
widgetId:r,widget:q,params:v}):m=null;m?m.widget==g&&(this.wireWidget(a,b,c,m.widget,m.widget.domNode,m.event,n,d,m),m.widget&&-1==h.indexOf(m.widget)&&h.push(m.widget)):console.error("invalid params for group "+n)}for(k=0;k<h.length;k++){g=h[k];g.domNode&&(g=g.domNode);if(g.__didEmitLoad)break;g.__didEmitLoad=!0;g.emit&&g.emit("load",g)}},wireScope:function(a,b,c,d){for(var e=c.allGroups(),h=this,k=[],m=function(b){var c=null,d=null;b=(b||"").split("__");var e=[];1==b.length&&(c=b[0],d="body",a.rootWidget.domNode.runExpression=
a.global.runExpression);if(2==b.length){var g;-1!==b[1].indexOf("://")?(c=b[0],d="body",g=b[1]):(c=b[1],d=b[0]);g&&(e=l.parse_url(g),e=l.urlArgs(e.host),e=[e.device.value,e.driver.value,g])}3==b.length&&(c=b[1],d=b[0],g=b[2],e=l.parse_url(g),e=l.urlArgs(e.host),e=[e.device.value,e.driver.value,g]);5==b.length&&(c=b[1],d=b[0],e=[b[2],b[3],b[4]]);return c&&d?(b=w.byId(d),"body"===d&&(b=a.rootWidget),{event:c,widgetId:d,widget:b,params:e}):null},n=function(a){a._on(g.EVENTS.ON_ITEM_REMOVED,function(b){try{if(a._widgetHandles){var c=
a._widgetHandles;for(b=0;b<c.length;b++)c[b].remove&&c[b].remove();delete a._widgetHandles}}catch(B){console.error("troubble!"+B,B)}},this)},q=0;q<e.length;q++){var r=e[q],v=m(r);if(v){v.widget&&this.wireWidget(a,b,c,v.widget,v.widget.domNode,v.event,r,d,v);for(var r=c.getBlocks({group:r}),A=0;A<r.length;A++)n(r[A]);v.widget&&-1==k.indexOf(v.widget)&&k.push(v.widget)}else console.error("invalid params for group "+r)}for(q=0;q<k.length;q++){b=k[q];b.domNode&&(b=b.domNode);if(b.__didEmitLoad)return;
b.__didEmitLoad=!0;"BODY"===b.nodeName?y(b.nodeName).trigger("load"):b.emit&&b.emit("load",b)}c._on(g.EVENTS.ON_ITEM_REMOVED,function(a){});c._on(g.EVENTS.ON_ITEM_ADDED,function(b){var c=m(b.item.group);c&&c.widget&&(h.wireNode(c.widget.domNode,c.event,b.item,a,c),n(b.item))})},onSceneBlocksLoaded:function(a){var b=a.context,c=a.appContext,d=a.global,e=a.blockScopes,g=this;a.context.widgetsReadyDfd&&a.context.widgetsReadyDfd.then(function(){if(!c.didWireWidgets){c.didWireWidgets=!0;for(var a=0;a<
e.length;a++){var h=e[a];h.global=d;h.document=b.getDocument();h.editorContext=b;h.appContext=c;g.wireScope(b,g.ctx,h,c)}}})},onItemRemoved:function(a){},init:function(){this.subscribe("/davinci/ui/context/loaded",this.onContextLoaded);this.subscribe([g.EVENTS.ON_GET_LOADER_PACKAGES,g.EVENTS.ON_BUILD_HEADER,g.EVENTS.ON_BUILD_DOJO_CONFIG,g.EVENTS.ON_SET_SOURCE_DATA,g.EVENTS.ON_SET_DOJO_URL,g.EVENTS.ON_MODULE_UPDATED,g.EVENTS.ON_CONTEXT_DESTROYED,g.EVENTS.ON_DRIVER_VARIABLE_CHANGED,g.EVENTS.ON_ITEM_REMOVED])}})})}}});
define("xideve/xideve",["dojo","dijit","dojox"],function(q,A,m){});
//# sourceMappingURL=xideve.js.map