//>>built
require({cache:{"dgrid/main":function(){define("dgrid/Tree dgrid/Selection dgrid/OnDemandList dgrid/OnDemandGrid dgrid/extensions/ColumnReorder dgrid/extensions/ColumnResizer dgrid/extensions/CompoundColumns dgrid/extensions/Pagination dgrid/extensions/DnD dgrid/Editor dstore/Store dstore/Memory dstore/Tree dstore/Cache dstore/Trackable dstore/legacy/DstoreAdapter".split(" "),function(){})},"dgrid/Tree":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/aspect dojo/dom-construct dojo/dom-class dojo/on dojo/query dojo/when ./util/has-css3 ./Grid xdojo/has!touch?./util/touch".split(" "),
function(r,l,q,p,e,m,n,f,u,a,b,d){return r(null,{collapseOnRefresh:!1,enableTreeTransitions:!1,treeIndentWidth:9,constructor:function(){this._treeColumnListeners=[]},shouldExpand:function(a,b,c){return c},expand:function(b,h,c){if(this._treeColumn){var k=this,t=b.element?b:this.row(b),d=!!this._expanded[t.id],A=a("transitionend"),C;b=t.element;b=-1<b.className.indexOf("dgrid-expando-icon")?b:f(".dgrid-expando-icon",b)[0];c=c||!this.enableTreeTransitions;if(b&&b.mayHaveChildren&&(c||h!==d)){var B=
void 0===h?!this._expanded[t.id]:h;m.replace(b,"ui-icon-triangle-1-"+(B?"se":"e"),"ui-icon-triangle-1-"+(B?"e":"se"));m.toggle(t.element,"dgrid-row-expanded",B);h=t.element;var y=h.connected,v,q,w={};if(!y){var y=w.container=h.connected=e.create("div",{className:"dgrid-tree-container"},h,"after"),p=function(c){var a=k._renderedCollection.getChildren(t.data);k.sort&&(a=a.sort(k.sort));a.track&&k.shouldTrackCollection&&(y._rows=c.rows=[],a=a.track(),y._handles=[a.tracking,k._observeCollection(a,y,c)]);
return"start"in c?a.fetchRange({start:c.start,end:c.start+c.count}):a.fetch()};"level"in b&&(p.level=b.level);if(this.renderQuery)C=this.renderQuery(p,w);else{var r=e.create("div",null,y);C=this._trackError(function(){return k.renderQueryResults(p(w),r,l.mixin({rows:w.rows},"level"in p?{queryLevel:p.level}:null)).then(function(k){e.destroy(r);return k})})}A&&n(y,A,this._onTreeTransitionEnd)}y.hidden=!B;v=y.style;!A||c?(v.display=B?"block":"none",v.height=""):(B?(v.display="block",q=y.scrollHeight,
v.height="0px"):(m.add(y,"dgrid-tree-resetting"),v.height=y.scrollHeight+"px"),setTimeout(function(){m.remove(y,"dgrid-tree-resetting");v.height=B?q?q+"px":"auto":"0px"},0));B?this._expanded[t.id]=!0:delete this._expanded[t.id]}return u(C)}},_configColumns:function(){var a=this.inherited(arguments);this._expanded={};for(var b=0,c=a.length;b<c;b++)if(a[b].renderExpando){this._configureTreeColumn(a[b]);break}return a},insertRow:function(a){var b=this.inherited(arguments),c=this.row(b);(c=this.shouldExpand(c,
this._currentLevel,this._expanded[c.id]))&&this.expand(b,!0,!0);(c||!this.collection.mayHaveChildren||this.collection.mayHaveChildren(a))&&m.add(b,"dgrid-row-expandable");return b},removeRow:function(a,b){var c=a.connected,k={};c&&(c._handles&&(q.forEach(c._handles,function(k){k.remove()}),delete c._handles),c._rows&&(k.rows=c._rows),f("\x3e.dgrid-row",c).forEach(function(c){this.removeRow(c,!0,k)},this),c._rows&&(c._rows.length=0,delete c._rows),b||e.destroy(c));this.inherited(arguments)},_refreshCellFromItem:function(a,
b){if(!a.column.renderExpando)return this.inherited(arguments);this.inherited(arguments,[a,b,{queryLevel:f(".dgrid-expando-icon",a.element)[0].level-1}])},cleanup:function(){this.inherited(arguments);this.collapseOnRefresh&&(this._expanded={})},_destroyColumns:function(){this.inherited(arguments);for(var a=this._treeColumnListeners,b=a.length;b--;)a[b].remove();this._treeColumnListeners=[];this._treeColumn=null},_calcRowHeight:function(a){var b=a.connected;return this.inherited(arguments)+(b?b.offsetHeight:
0)},_configureTreeColumn:function(b){var h=this,c=this.collection,k=".dgrid-content .dgrid-column-"+b.id,t;this._treeColumn=b;if(!b._isConfiguredTreeColumn){var z=b.renderCell||this._defaultRenderCell;b._isConfiguredTreeColumn=!0;b.renderCell=function(k,a,t,d){if(c){var f=Number(d&&d.queryLevel)+1,e=!c.mayHaveChildren||c.mayHaveChildren(k),m,f=h._currentLevel=isNaN(f)?0:f;m=b.renderExpando(f,e,h._expanded[c.getIdentity(k)],k);m.level=f;m.mayHaveChildren=e;(k=z.call(b,k,a,t,d))&&k.nodeType?(t.appendChild(m),
t.appendChild(k)):t.insertBefore(m,t.firstChild)}};"function"!==typeof b.renderExpando&&(b.renderExpando=this._defaultRenderExpando)}var f=this._treeColumnListeners;0===f.length&&(f.push(this.on(b.expandOn||".dgrid-expando-icon:click,"+k+":dblclick,"+k+":keydown",function(k){var c=h.row(k);h.collection.mayHaveChildren&&!h.collection.mayHaveChildren(c.data)||"keydown"===k.type&&32!==k.keyCode||"dblclick"===k.type&&t&&1<t.count&&c.id===t.id&&-1<k.target.className.indexOf("dgrid-expando-icon")||h.expand(c);
-1<k.target.className.indexOf("dgrid-expando-icon")&&(t&&t.id===h.row(k).id?t.count++:t={id:h.row(k).id,count:1})})),a("touch")&&f.push(this.on(d.selector(k,d.dbltap),function(){h.expand(this)})))},_defaultRenderExpando:function(a,b,c){var k=this.grid.isRTL?"right":"left",t="dgrid-expando-icon";b&&(t+=" ui-icon ui-icon-triangle-1-"+(c?"se":"e"));return e.create("div",{className:t,innerHTML:"\x26nbsp;",style:"margin-"+k+": "+a*this.grid.treeIndentWidth+"px; float: "+k+";"})},_onNotification:function(a,
b){"delete"===b.type&&delete this._expanded[b.id];this.inherited(arguments)},_onTreeTransitionEnd:function(a){var b=this,c=this.style.height;c&&(this.style.display="0px"===c?"none":"block");a&&(m.add(this,"dgrid-tree-resetting"),setTimeout(function(){m.remove(b,"dgrid-tree-resetting")},0));this.style.height=""}})})},"dgrid/util/has-css3":function(){define(["dojo/has"],function(r){function l(l,e){var m=l.style,n;if(e in m)return!0;e=e.slice(0,1).toUpperCase()+e.slice(1);for(n=q.length;n--;)if(q[n]+
e in m)return q[n];return!1}var q=["ms","O","Moz","Webkit"];r.add("css-transitions",function(q,e,m){return l(m,"transitionProperty")});r.add("css-transforms",function(q,e,m){return l(m,"transform")});r.add("css-transforms3d",function(q,e,m){return l(m,"perspective")});r.add("transitionend",function(){var l=r("css-transitions");return l?!0===l?"transitionend":{ms:"MSTransitionEnd",O:"oTransitionEnd",Moz:"transitionend",Webkit:"webkitTransitionEnd"}[l]:!1});return r})},"dgrid/Grid":function(){define("dojo/_base/declare dojo/_base/lang dojo/dom-construct dojo/dom-class dojo/on dojo/has ./List ./util/misc dojo/_base/sniff".split(" "),
function(r,l,q,p,e,m,n,f){function u(a,b){b&&b.nodeType&&a.appendChild(b)}r=r(n,{columns:null,hasNeutralSort:!1,cellNavigation:!0,tabableHeader:!0,showHeader:!0,column:function(a){return"object"!==typeof a?this.columns[a]:this.cell(a).column},listType:"grid",cell:function(a,b){if(a.column&&a.element)return a;a.target&&a.target.nodeType&&(a=a.target);var d;if(a.nodeType){do{if(this._rowIdToObject[a.id])break;var g=a.columnId;if(g){b=g;d=a;break}a=a.parentNode}while(a&&a!==this.domNode)}if(!d&&"undefined"!==
typeof b){var h=this.row(a);if(g=h&&h.element)for(var g=g.getElementsByTagName("td"),c=0;c<g.length;c++)if(g[c].columnId===b){d=g[c];break}}if(null!=a)return{row:h||this.row(a),column:b&&this.column(b),element:d}},createRowCells:function(a,b,d,g,h){var c=q.create("table",{className:"dgrid-row-table",role:"presentation"}),k=9>m("ie")?q.create("tbody",null,c):c,t,z,e,n,u,y,v,l,w,p;d=d||this.subRows;z=0;for(e=d.length;z<e;z++)for(y=d[z],t=q.create("tr",null,k),y.className&&(t.className=y.className),
n=0,u=y.length;n<u;n++){v=y[n];l=v.id;w=v.field?" field-"+f.escapeCssIdentifier(v.field,"-"):"";(p="function"===typeof v.className?v.className(g):v.className)&&(w+=" "+p);w=q.create(a,{className:"dgrid-cell"+(l?" dgrid-column-"+f.escapeCssIdentifier(l,"-"):"")+w,role:"th"===a?"columnheader":"gridcell"});w.columnId=l;if(l=v.colSpan)w.colSpan=l;if(l=v.rowSpan)w.rowSpan=l;b(w,v,g,h);t.appendChild(w)}return c},_createBodyRowCell:function(a,b,d,g){var h=d;b.get?h=b.get(d):"field"in b&&"_item"!==b.field&&
(h=d[b.field]);b.renderCell?u(a,b.renderCell(d,h,a,g)):this._defaultRenderCell.call(b,d,h,a,g)},_createHeaderRowCell:function(a,b){var d=b.headerNode=a,g=b.field;g&&(a.field=g);b.renderHeaderCell?u(d,b.renderHeaderCell(d)):("label"in b||b.field)&&d.appendChild(document.createTextNode("label"in b?b.label:b.field));!1!==b.sortable&&g&&"_item"!==g&&(a.sortable=!0,a.className+=" dgrid-sortable")},left:function(a,b){a.element||(a=this.cell(a));return this.cell(this._move(a,-(b||1),"dgrid-cell"))},right:function(a,
b){a.element||(a=this.cell(a));return this.cell(this._move(a,b||1,"dgrid-cell"))},_defaultRenderCell:function(a,b,d){if(this.formatter){var g=this.formatter,h=this.grid.formatterScope;d.innerHTML="string"===typeof g&&h?h[g](b,a):this.formatter(b,a)}else null!=b&&d.appendChild(document.createTextNode(b))},renderRow:function(a,b){var d=this.createRowCells("td",l.hitch(this,"_createBodyRowCell"),b&&b.subRows,a,b),g=q.create("div",{role:"row"});g.appendChild(d);return g},renderHeader:function(){var a=
this,b=this.headerNode;b.setAttribute("role","row");q.empty(b);var d=this.createRowCells("th",l.hitch(this,"_createHeaderRowCell"),this.subRows&&this.subRows.headerRows);this._rowIdToObject[d.id=this.id+"-header"]=this.columns;b.appendChild(d);this._sortListener&&this._sortListener.remove();this._sortListener=e(d,"click,keydown",function(d){if("click"===d.type||32===d.keyCode||!m("opera")&&13===d.keyCode){var h=d.target,c,k;do if(h.sortable){c=h.field||h.columnId;k=a.sort[0];c=a.hasNeutralSort&&k&&
k.property===c&&k.descending?[]:[{property:c,descending:k&&k.property===c&&!k.descending}];k={bubbles:!0,cancelable:!0,grid:a,parentType:d.type,sort:c};e.emit(d.target,"dgrid-sort",k)&&(a._sortNode=h,a.set("sort",c));break}while((h=h.parentNode)&&h!==b)}})},resize:function(){if(this.headerNode){var a=this.headerNode.firstChild,b=this.contentNode,d;this.inherited(arguments);b.style.width="";b&&a&&(d=a.offsetWidth)>b.offsetWidth&&(b.style.width=d+"px")}},destroy:function(){this._destroyColumns();this._sortListener&&
this._sortListener.remove();this.inherited(arguments)},_setSort:function(){this.inherited(arguments);this.updateSortArrow(this.sort)},_findSortArrowParent:function(a){var b=this.columns,d;for(d in b){var g=b[d];if(g.field===a)return g.headerNode}},updateSortArrow:function(a,b){this._lastSortedArrow&&(p.remove(this._lastSortedArrow.parentNode,"dgrid-sort-up dgrid-sort-down"),q.destroy(this._lastSortedArrow),delete this._lastSortedArrow);b&&(this.sort=a);if(a[0]){var d=a[0].property,g=a[0].descending,
d=this._sortNode||this._findSortArrowParent(d);delete this._sortNode;d&&(d=d.contents||d,this._lastSortedArrow=q.create("div",{className:"dgrid-sort-arrow ui-icon",innerHTML:"\x26nbsp;",role:"presentation"},d,"first"),p.add(d,"dgrid-sort-"+(g?"down":"up")),this.resize())}},styleColumn:function(a,b){return this.addCssRule("#"+f.escapeCssIdentifier(this.domNode.id)+" .dgrid-column-"+f.escapeCssIdentifier(a,"-"),b)},_configColumns:function(a,b){var d=[],g=b instanceof Array;f.each(b,function(h,c){"string"===
typeof h&&(b[c]=h={label:h});g||h.field||(h.field=c);c=h.id=h.id||(isNaN(c)?c:a+c);this._configColumn&&(this._configColumn(h,b,a),c=h.id);g&&(this.columns[c]=h);h.grid=this;d.push(h)},this);return g?b:d},_destroyColumns:function(){this.cleanup()},configStructure:function(){var a=this.subRows,b=this._columns=this.columns;this.columns=!b||b instanceof Array?{}:b;if(a)for(b=0;b<a.length;b++)a[b]=this._configColumns(b+"-",a[b]);else this.subRows=[this._configColumns("",b)]},_getColumns:function(){return this._columns||
this.columns},_setColumns:function(a){this._destroyColumns();this.subRows=null;this.columns=a;this._updateColumns()},_setSubRows:function(a){this._destroyColumns();this.subRows=a;this._updateColumns()},_updateColumns:function(){this.configStructure();this.renderHeader();this.refresh();this._lastCollection&&this.renderArray(this._lastCollection);this._started&&(this.sort.length?(this._lastSortedArrow=null,this.updateSortArrow(this.sort)):this.resize())}});r.appendIfNode=u;return r})},"dgrid/List":function(){define("dojo/_base/declare dojo/dom-construct dojo/dom-class dojo/on dojo/has ./util/misc xide/$".split(" "),
function(r,l,q,p,e,m,n){function f(k,c){k.className="dgrid-scrollbar-measure";document.body.appendChild(k);var a=k["offset"+c]-k["client"+c];k.className="";k.parentNode&&document.body.removeChild(k);return a}function u(k){q.replace(this.domNode,k,this._class||"");this._class=k}function a(){return this._class}var b=[];e("mozilla")&&b.push("has-mozilla");e("touch")&&b.push("has-touch");q.add(document.documentElement,b);e.add("pointer",function(k){return"PointerEvent"in k?"pointer":"MSPointerEvent"in
k?"MSPointer":!1});var d,g;e.add("dom-scrollbar-width",function(k,c,a){return f(a,"Width")});e.add("dom-scrollbar-height",function(k,c,a){return f(a,"Height")});e.add("dom-rtl-scrollbar-left",function(k,c,a){k=document.createElement("div");a.className="dgrid-scrollbar-measure";a.setAttribute("dir","rtl");a.appendChild(k);document.body.appendChild(a);c=!!e("ie")||!!e("trident")||/\bEdge\//.test(navigator.userAgent)||k.offsetLeft>=e("dom-scrollbar-width");a.className="";a.parentNode&&document.body.removeChild(a);
l.destroy(k);a.removeAttribute("dir");return c});var h=0,c=r(null,{tabableHeader:!1,showHeader:!1,showFooter:!1,maintainOddEven:!0,cleanAddedRules:!0,addUiClasses:!1,highlightDuration:250,postscript:function(k,c){var a=this;(this._Row=function(k,c,a){this.id=k;this.data=c;this.element=a}).prototype.remove=function(){a.removeRow(this.element)};c&&(this.srcNodeRef=c=c.nodeType?c:document.getElementById(c));this.create(k,c)},listType:"list",create:function(k,a){var b=this.domNode=a||document.createElement("div"),
d;k&&(this.params=k,r.safeMixin(this,k),d=k["class"]||k.className||b.className);this.sort=this.sort||[];this._listeners=[];this._rowIdToObject={};this.postMixInProperties&&this.postMixInProperties();this.id=b.id=b.id||this.id||c.autoIdPrefix+h++;this.buildRendering();d&&u.call(this,d);this.postCreate();delete this.srcNodeRef},buildRendering:function(){var k=this.domNode,c=this.addUiClasses,a=this,b,d,g;g=this.isRTL="rtl"===(document.body.dir||document.documentElement.dir||document.body.style.direction).toLowerCase();
k.className="";k.setAttribute("role","grid");q.add(k,"dgrid dgrid-"+this.listType+(c?" ui-widget":""));b=this.headerNode=l.create("div",{tabIndex:-1,className:"dgrid-header dgrid-header-row"+(c?" ui-widget-header":"")+(this.showHeader?"":" dgrid-header-hidden")},k);d=this.bodyNode=l.create("div",{className:"dgrid-scroller"},k);e("ff")&&(d.tabIndex=-1);this.headerScrollNode=l.create("div",{className:"dgrid-header dgrid-header-scroll dgrid-scrollbar-width"+(c?" widget":"")},k);this.footerNode=l.create("div",
{className:"dgrid-footer"+(this.showFooter?"":" dgrid-footer-hidden")},k);g&&(k.className+=" dgrid-rtl"+(e("dom-rtl-scrollbar-left")?" dgrid-rtl-swap":""));p(d,"scroll",function(c){a.showHeader&&(b.scrollLeft=c.scrollLeft||d.scrollLeft);c.stopPropagation();p.emit(k,"scroll",{scrollTarget:d})});this.configStructure();this.renderHeader();this.contentNode=this.touchNode=l.create("div",{className:"dgrid-content"+(c?" widget":"")},this.bodyNode)},startup:function(){this._started||(this.inherited(arguments),
this._started=!0,this.set("sort",this.sort))},configStructure:function(){},resize:function(){var k=this.bodyNode,c=this.footerNode,c=this.showFooter?c.offsetHeight:0;this.headerScrollNode.style.height=k.style.marginTop=this.headerNode.offsetHeight+"px";k.style.marginBottom=c+"px";d||(d=e("dom-scrollbar-width"),g=e("dom-scrollbar-height"),e("ie")&&(d++,g++),17!==d&&m.addCssRule(".dgrid-rtl-swap .dgrid-header-row","left: "+d+"px"))},addCssRule:function(k,c){var a=m.addCssRule(k,c);this.cleanAddedRules&&
this._listeners.push(a);return a},on:function(k,c){var a=p(this.domNode,k,c);e("dom-addeventlistener")||this._listeners.push(a);return a},cleanup:function(){for(var k in this._rowIdToObject)if(this._rowIdToObject[k]!==this.columns){var c=document.getElementById(k);c&&this.removeRow(c,!0)}},destroy:function(){if(this._listeners){for(var k=this._listeners.length;k--;)this._listeners[k].remove();this._listeners=null}this._started=!1;this.cleanup();n(this.domNode).remove()},refresh:function(){this.cleanup();
this._rowIdToObject={};this._autoRowId=0;n(this.contentNode).empty()},adjustRowIndices:function(k){var c=k.rowIndex;if(-1<c){do-1<k.rowIndex&&(this.maintainOddEven&&q.contains(k,"dgrid-row")&&q.replace(k,1===c%2?"dgrid-row-odd":"dgrid-row-even",0===c%2?"dgrid-row-odd":"dgrid-row-even"),k.rowIndex=c++);while((k=k.nextSibling)&&k.rowIndex!==c)}},renderArray:function(k,c,a){a=a||{};var b=a.start||0,d=document.createDocumentFragment(),g=[],h=0,f=k.length;c||(this._lastCollection=k);for(;h<f;)g[h]=this.insertRow(k[h],
d,null,b++,a),h++;(k=c?c.parentNode:this.contentNode)&&k.parentNode&&(k!==this.contentNode||f)&&(k.insertBefore(d,c||null),f&&this.adjustRowIndices(g[f-1]));return g},renderHeader:function(){},_autoRowId:0,insertRow:function(k,c,a,b,d){var g=this.id+"-row-"+(this.collection&&this.collection.getIdentity?this.collection.getIdentity(k):this._autoRowId++),h=document.getElementById(g),f=h&&h.previousSibling;h&&(h===a&&(a=(a.connected||a).nextSibling),this.removeRow(h,!1,d));h=this.renderRow(k,d);h.className=
(h.className||"")+" dgrid-row "+(1===b%2?"dgrid-row-odd":"dgrid-row-even");this._rowIdToObject[h.id=g]=k;c.insertBefore(h,a||null);h.rowIndex=b;f&&f.rowIndex!==h.rowIndex-1&&this.adjustRowIndices(f);return h},renderRow:function(k){var c=document.createElement("div");c.appendChild(document.createTextNode(k));return c},removeRow:function(k,c){k=k.element||k;delete this._rowIdToObject[k.id];c||n(k).remove()},row:function(k){var c;if(k instanceof this._Row)return k;if(!k)return null;k.target&&k.target.nodeType&&
(k=k.target);if(k.nodeType){do{var a=k.id;if(c=this._rowIdToObject[a])return new this._Row(a.substring(this.id.length+5),c,k);k=k.parentNode}while(k&&k!==this.domNode)}else return"object"===typeof k?c=this.collection.getIdentity(k):(c=k,k=this._rowIdToObject[this.id+"-row-"+c]),new this._Row(c,k,document.getElementById(this.id+"-row-"+c))},cell:function(c){return{row:this.row(c)}},_move:function(c,a,b,d){var h,g;g=h=c.element;a=a||1;do if(c=h[0>a?"previousSibling":"nextSibling"]){do if((h=c)&&-1<
(h.className+" ").indexOf(b+" ")){g=h;a+=0>a?1:-1;break}while(c=(!d||!h.hidden)&&h[0>a?"lastChild":"firstChild"])}else if(h=h.parentNode,!h||h===this.bodyNode||h===this.headerNode)break;while(a);return g},up:function(c,a,b){c.element||(c=this.row(c));return this.row(this._move(c,-(a||1),"dgrid-row",b))},down:function(c,a,b){c.element||(c=this.row(c));return this.row(this._move(c,a||1,"dgrid-row",b))},scrollTo:function(c){"undefined"!==typeof c.x&&(this.bodyNode.scrollLeft=c.x);"undefined"!==typeof c.y&&
(this.bodyNode.scrollTop=c.y)},getScrollPosition:function(){return{x:this.bodyNode.scrollLeft,y:this.bodyNode.scrollTop}},get:function(c){var a="_get"+c.charAt(0).toUpperCase()+c.slice(1);return"function"===typeof this[a]?this[a].apply(this,[].slice.call(arguments,1)):this[c]},set:function(c,a){if("object"===typeof c)for(var b in c)this.set(b,c[b]);else b="_set"+c.charAt(0).toUpperCase()+c.slice(1),"function"===typeof this[b]?this[b].apply(this,[].slice.call(arguments,1)):this[c]=a;return this},_getClass:a,
_setClass:u,_getClassName:a,_setClassName:u,_setSort:function(c,a){this.sort="string"!==typeof c?c:[{property:c,descending:a}];this._applySort()},_applySort:function(){this.refresh();if(this._lastCollection){var c=this.sort;if(c&&0<c.length){var a=c[0].property,b=!!c[0].descending;this._lastCollection.sort(function(c,k){var d=c[a],h=k[a];void 0===d&&(d="");void 0===h&&(h="");return d===h?0:d>h!==b?1:-1})}this.renderArray(this._lastCollection)}},_setShowHeader:function(c){var a=this.headerNode;this.showHeader=
c;q.toggle(a,"dgrid-header-hidden",!c);this.renderHeader();this.resize();c&&(a.scrollLeft=this.getScrollPosition().x)},_setShowFooter:function(c){this.showFooter=c;q.toggle(this.footerNode,"dgrid-footer-hidden",!c);this.resize()}});c.autoIdPrefix="dgrid_";return c})},"dgrid/util/misc":function(){define(["dojo/has"],function(r){r.add("dom-contains",function(f,e,a){return!!a.contains});var l=[],q,p,e,m=/([^A-Za-z0-9_\u00A0-\uFFFF-])/g,n={defaultDelay:15,throttle:function(f,e,a){var b=!1;a=a||n.defaultDelay;
return function(){b||(b=!0,f.apply(e,arguments),setTimeout(function(){b=!1},a))}},throttleDelayed:function(f,e,a){var b=!1;a=a||n.defaultDelay;return function(){if(!b){b=!0;var d=arguments;setTimeout(function(){b=!1;f.apply(e,d)},a)}}},debounce:function(f,e,a){var b;a=a||n.defaultDelay;return function(){b&&(clearTimeout(b),b=null);var d=arguments;b=setTimeout(function(){f.apply(e,d)},a)}},each:function(f,e,a){var b,d;if(f)if("number"===typeof f.length)for(b=0,d=f.length;b<d;b++)e.call(a,f[b],b,f);
else for(b in f)e.call(a,f[b],b,f)},contains:function(f,e){return r("dom-contains")?f.contains(e):f.compareDocumentPosition(e)&8},addCssRule:function(f,m){q||(q=document.createElement("style"),document.getElementsByTagName("head")[0].appendChild(q),q=q.sheet||q.styleSheet,p=q.deleteRule?"deleteRule":"removeRule",e=q.cssRules?"cssRules":"rules");var a=l.length;l[a]=(q.cssRules||q.rules).length;q.addRule?q.addRule(f,m):q.insertRule(f+"{"+m+"}",l[a]);return{get:function(b){return q[e][l[a]].style[b]},
set:function(b,d){"undefined"!==typeof l[a]&&(q[e][l[a]].style[b]=d)},remove:function(){var b=l[a],d,g;if(void 0!==b)for(q[p](b),l[a]=void 0,d=a+1,g=l.length;d<g;d++)l[d]>b&&l[d]--}}},escapeCssIdentifier:function(f,e){return"string"===typeof f?f.replace(m,e||"\\$1"):f}};return n})},"dgrid/Selection":function(){define("dojo/_base/declare dojo/dom-class dojo/on dojo/has dojo/aspect ./List dgrid/util/touch dojo/query dojo/_base/sniff dojo/dom".split(" "),function(r,l,q,p,e,m,n){function f(c,a){for(var b=
c.unselectable=a?"on":"",d=c.getElementsByTagName("*"),h=d.length;--h;)"INPUT"!==d[h].tagName&&"TEXTAREA"!==d[h].tagName&&(d[h].unselectable=b)}function u(c,a){var d=c.bodyNode,h=a?"text":21>p("ff")?"-moz-none":"none";b&&"msUserSelect"!==b?d.style[b]=h:p("dom-selectstart")?a||c._selectstartHandle?a&&c._selectstartHandle&&(c._selectstartHandle.remove(),delete c._selectstartHandle):c._selectstartHandle=q(d,"selectstart",function(c){var a=c.target&&c.target.tagName;"INPUT"!==a&&"TEXTAREA"!==a&&c.preventDefault()}):
(f(d,!a),a||c._unselectableHandle)?a&&c._unselectableHandle&&(c._unselectableHandle.remove(),delete c._unselectableHandle):c._unselectableHandle=e.after(c,"renderRow",function(c){f(c,!0);return c})}p.add("dom-comparedocumentposition",function(c,a,b){return!!b.compareDocumentPosition});p.add("dom-selectstart","undefined"!==typeof document.onselectstart);var a=p("mac")?"metaKey":"ctrlKey",b=p("css-user-select"),d=(m=p("pointer"))&&"MS"===m.slice(0,2),g=m?m+(d?"Down":"down"):"mousedown",h=m?m+(d?"Up":
"up"):"mouseup";"WebkitUserSelect"===b&&"undefined"!==typeof document.documentElement.style.msUserSelect&&(b=!1);return r(null,{selectionDelegate:".dgrid-row",selectionEvents:g+","+h+",dgrid-cellfocusin",selectionTouchEvents:p("touch")?n.tap:null,deselectOnRefresh:!0,allowSelectAll:!1,selection:{},selectionMode:"extended",allowTextSelection:void 0,_selectionTargetType:"rows",create:function(){this.selection={};return this.inherited(arguments)},postCreate:function(){this.inherited(arguments);this._initSelectionEvents();
var c=this.selectionMode;this.selectionMode="";this._setSelectionMode(c)},destroy:function(){this.inherited(arguments);this._selectstartHandle&&this._selectstartHandle.remove();this._unselectableHandle&&this._unselectableHandle.remove();this._removeDeselectSignals&&this._removeDeselectSignals()},_setSelectionMode:function(c){c!==this.selectionMode&&(this.clearSelection(),this.selectionMode=c,this._selectionHandlerName="_"+c+"SelectionHandler",this._setAllowTextSelection(this.allowTextSelection))},
_setAllowTextSelection:function(c){"undefined"!==typeof c?u(this,c):u(this,"none"===this.selectionMode);this.allowTextSelection=c},_handleSelect:function(c,a){if(this[this._selectionHandlerName]&&this.allowSelect(this.row(a))&&("dgrid-cellfocusin"!==c.type||"mousedown"!==c.parentType)&&(c.type!==h||a===this._waitForMouseUp)){this._waitForMouseUp=null;this._selectionTriggerEvent=c;if(!c.keyCode||!c.ctrlKey||32===c.keyCode)if(!c.shiftKey&&c.type===g&&this.isSelected(a))this._waitForMouseUp=a;else this[this._selectionHandlerName](c,
a);this._selectionTriggerEvent=null}},_singleSelectionHandler:function(c,k){var b=c.keyCode?c.ctrlKey:c[a];this._lastSelected===k?this.select(k,null,!b||!this.isSelected(k)):(this.clearSelection(),this.select(k),this._lastSelected=k)},_multipleSelectionHandler:function(c,b){var d=this._lastSelected,h=c.keyCode?c.ctrlKey:c[a],g;c.shiftKey||(g=h?null:!0,d=null);this.select(b,d,g,null,-1!==c.type.indexOf("mouse")?"mouse":c.type);d||(this._lastSelected=b)},_extendedSelectionHandler:function(c,b){(2===
c.button?this.isSelected(b):c.keyCode?c.ctrlKey:c[a])||this.clearSelection(null,!0);this._multipleSelectionHandler(c,b)},_toggleSelectionHandler:function(c,a){this.select(a,null,null)},_initSelectionEvents:function(){var c=this,b=this.contentNode,d=this.selectionDelegate;this._selectionEventQueues={deselect:[],select:[]};p("touch")&&!p("pointer")&&this.selectionTouchEvents?(q(b,n.selector(d,this.selectionTouchEvents),function(a){c._handleSelect(a,this);c._ignoreMouseSelect=this}),q(b,q.selector(d,
this.selectionEvents),function(a){c._ignoreMouseSelect!==this?c._handleSelect(a,this):a.type===h&&(c._ignoreMouseSelect=null)})):q(b,q.selector(d,this.selectionEvents),function(a){c._handleSelect(a,this)});this.addKeyHandler&&this.addKeyHandler(32,function(a){c._handleSelect(a,a.target)});if(this.allowSelectAll)this.on("keydown",function(b){b[a]&&65===b.keyCode&&!/\bdgrid-input\b/.test(b.target.className)&&(b.preventDefault(),c[c.allSelected?"clearSelection":"selectAll"]())});this._setCollection&&
e.before(this,"_setCollection",function(a){c._updateDeselectionAspect(a)});this._updateDeselectionAspect()},_updateDeselectionAspect:function(c){function a(c,k,d){if((c=b.row(c))&&b.selection[c.id])b[k](c,null,!0,null,d)}var b=this,d;this._removeDeselectSignals&&this._removeDeselectSignals();d=c&&c.track&&this._observeCollection?[e.before(this,"_observeCollection",function(c){d.push(c.on("delete",function(c){"undefined"===typeof c.index&&a(c.id,"deselect")}))}),e.after(this,"_observeCollection",function(c){d.push(c.on("update",
function(b){"undefined"!==typeof b.index&&a(c.getIdentity(b.target),"select","update")}))},!0)]:[e.before(this,"removeRow",function(c,a){var b;a||(b=this.row(c))&&b.id in this.selection&&this.deselect(b)})];this._removeDeselectSignals=function(){for(var c=d.length;c--;)d[c].remove();d=[]}},allowSelect:function(){return!0},_fireSelectionEvent:function(c){var a=this._selectionEventQueues[c],b=this._selectionTriggerEvent,d;d={bubbles:!0,grid:this};b&&(d.parentType=b.type);d[this._selectionTargetType]=
a;this._selectionEventQueues[c]=[];q.emit(this.contentNode,"dgrid-"+c,d)},_fireSelectionEvents:function(){var c=this._selectionEventQueues,a;for(a in c)c[a].length&&this._fireSelectionEvent(a)},_select:function(c,a,b){var d,h,g;"undefined"===typeof b&&(b=!0);c.element||(c=this.row(c));if(!1===b||this.allowSelect(c))if(d=this.selection,h=!!d[c.id],null===b&&(b=!h),g=c.element,b||this.allSelected?d[c.id]=b:delete this.selection[c.id],g&&(b?l.add(g,"dgrid-selected"+(this.addUiClasses?" ui-state-active":
"")):l.remove(g,"dgrid-selected ui-state-active")),b!==h&&g&&this._selectionEventQueues[(b?"":"de")+"select"].push(c),a)if(a.element||(a=this.row(a)),a){if(a=a.element)for(d=this._determineSelectionDirection(g,a),d||(a=document.getElementById(a.id),d=this._determineSelectionDirection(g,a));c.element!==a&&(c=this[d](c));)this._select(c,null,b)}else this._lastSelected=g},_determineSelectionDirection:p("dom-comparedocumentposition")?function(c,a){var b=a.compareDocumentPosition(c);return b&1?!1:2===
b?"down":"up"}:function(c,a){return 1>a.sourceIndex?!1:a.sourceIndex>c.sourceIndex?"down":"up"},select:function(c,a,b){this._select(c,a,b);this._fireSelectionEvents()},deselect:function(c,a){this.select(c,a,!1)},clearSelection:function(c,a){this.allSelected=!1;for(var b in this.selection)c!==b&&this._select(b,null,!1);a||(this._lastSelected=null);this._fireSelectionEvents()},selectAll:function(){this.allSelected=!0;this.selection={};for(var c in this._rowIdToObject){var a=this.row(this._rowIdToObject[c]);
this._select(a.id,null,!0)}this._fireSelectionEvents()},isSelected:function(c){if("undefined"===typeof c||null===c)return!1;c.element||(c=this.row(c));return c.id in this.selection?!!this.selection[c.id]:this.allSelected&&(!c.data||this.allowSelect(c))},refresh:function(){this.deselectOnRefresh&&this.clearSelection();this._lastSelected=null;return this.inherited(arguments)},renderArray:function(){var c=this.inherited(arguments),a=this.selection,b,d,h;for(b=0;b<c.length;b++)d=this.row(c[b]),(h=d.id in
a?a[d.id]:this.allSelected)&&this.select(d,null,h,null,"renderArray");this._fireSelectionEvents();return c}})})},"dgrid/util/touch":function(){define(["dojo/on"],function(r,l){function q(e,m,n,f){if(!(1<n.targetTouches.length)){var u=n.changedTouches[0],a=u.screenX,b=u.screenY;f&&n.preventDefault();var d=r(e,"touchend",function(g){var h=g.changedTouches[0];g.targetTouches.length||(Math.abs(h.screenX-a)<p.tapRadius&&Math.abs(h.screenY-b)<p.tapRadius&&(f&&g.preventDefault(),m.call(this,g)),d.remove())})}}
var p={tapRadius:10,dbltapTime:250,selector:function(e,m,n){return function(f,u){var a=m.bubble;a?m=a:!1!==n&&(n=!0);return r(f,m,function(a){var d=a.target;3===d.nodeType&&(d=d.parentNode);for(;!l.matches(d,e,f);)if(d===f||!n||!(d=d.parentNode))return;return u.call(d,a)})}},countCurrentTouches:function(e,m){if(!("touches"in e))return-1;var n,f,u;for(f=n=0;u=e.touches[n];++n)m.contains(u.target)&&++f;return f},tap:function(e,m){return r(e,"touchstart",function(n){q(e,m,n)})},dbltap:function(e,m){var n,
f;return r(e,"touchstart",function(u){n?q(e,function(a){if(n){var b=a.changedTouches[0];Math.abs(b.screenX-n.screenX)<p.tapRadius&&Math.abs(b.screenY-n.screenY)<p.tapRadius&&(f&&clearTimeout(f),n=f=null,m.call(this,a))}},u,!0):q(e,function(a){n=a.changedTouches[0];f=setTimeout(function(){n=f=null},p.dbltapTime)},u)})}};return p})},"dgrid/OnDemandList":function(){define("./List ./_StoreMixin dojo/_base/declare dojo/_base/lang dojo/dom-construct dojo/on dojo/when ./util/misc".split(" "),function(r,
l,q,p,e,m,n,f){return q([r,l],{minRowsPerPage:2500,maxRowsPerPage:250,maxEmptySpace:Infinity,bufferRows:10,farOffRemoval:2E3,queryRowsOverlap:0,pagingMethod:"debounce",pagingDelay:f.defaultDelay,keepScrollPosition:!1,rowHeight:0,postCreate:function(){this.inherited(arguments);var e=this;m(this.bodyNode,"scroll",f[this.pagingMethod](function(a){e._processScroll(a)},null,this.pagingDelay))},destroy:function(){this.inherited(arguments);this._refreshTimeout&&clearTimeout(this._refreshTimeout)},renderQuery:function(f,
a){var b=this,d=a&&a.container||this.contentNode,g={query:f,count:0},h,c=this.preload,k={node:e.create("div",{className:"dgrid-preload",style:{height:"0"}},d),count:0,query:f,next:g};k.node.rowIndex=0;g.node=h=e.create("div",{className:"dgrid-preload"},d);g.previous=k;h.rowIndex=this.minRowsPerPage;c?((g.next=c.next)&&h.offsetTop>=c.node.offsetTop?g.previous=c:(g.next=c,g.previous=c.previous),g.previous.next=g,g.next.previous=g):this.preload=g;var t=e.create("div",{className:"dgrid-loading"},h,"before");
e.create("div",{className:"dgrid-below"},t).innerHTML=this.loadingMessage;a=p.mixin({start:0,count:this.minRowsPerPage},"level"in f?{queryLevel:f.level}:null);return this._trackError(function(){var c=f(a);return b.renderQueryResults(c,h,a).then(function(k){return c.totalLength.then(function(c){var d=k.length,f=h.parentNode,m=b.noDataNode;b._rows&&(b._rows.min=0,b._rows.max=d===c?Infinity:d-1);e.destroy(t);"queryLevel"in a||(b._total=c);0===c&&f&&(m&&(e.destroy(m),delete b.noDataNode),b.noDataNode=
m=e.create("div",{className:"dgrid-no-data",innerHTML:b.noDataMessage}),b._emit("noData"),f.insertBefore(m,b._getFirstRowSibling(f)));for(m=f=0;m<d;m++)f+=b._calcRowHeight(k[m]);d&&f&&(b.rowHeight=f/d);c-=d;g.count=c;h.rowIndex=d;c?h.style.height=Math.min(c*b.rowHeight,b.maxEmptySpace)+"px":h.style.display="none";b._previousScrollPosition&&(b.scrollTo(b._previousScrollPosition),delete b._previousScrollPosition);return n(b._processScroll()).then(function(){return k})})}).otherwise(function(c){e.destroy(t);
throw c;})})},refresh:function(f){var a=this,b=f&&f.keepScrollPosition;"undefined"===typeof b&&(b=this.keepScrollPosition);b&&(this._previousScrollPosition=this.getScrollPosition());this.inherited(arguments);if(this._renderedCollection)return this.renderQuery(function(b){return a._renderedCollection.fetchRange({start:b.start,end:b.start+b.count})}).then(function(){a._refreshTimeout=setTimeout(function(){m.emit(a.domNode,"dgrid-refresh-complete",{bubbles:!0,cancelable:!1,grid:a});a._refreshTimeout=
null},0)})},resize:function(){this.inherited(arguments);this._processScroll()},cleanup:function(){this.inherited(arguments);this.preload=null},renderQueryResults:function(f){var a=this.inherited(arguments),b=this._renderedCollection;b&&b.releaseRange&&a.then(function(a){a[0]&&!a[0].parentNode.tagName&&f.totalLength.then(function(){b.releaseRange(a[0].rowIndex,a[a.length-1].rowIndex+1)})});return a},_getFirstRowSibling:function(f){return f.lastChild},_calcRowHeight:function(f){var a=f.nextSibling;
return a&&!/\bdgrid-preload\b/.test(a.className)?a.offsetTop-f.offsetTop:f.offsetHeight},lastScrollTop:0,_processScroll:function(f){function a(c,a,k,d){var h=g.farOffRemoval,f=c.node;if(a>2*h){for(var t,m=f[k],n=0,z=0,u=[],v=m&&m.rowIndex,l;t=m;){var A=g._calcRowHeight(t);if(n+A+h>a||0>m.className.indexOf("dgrid-row")&&0>m.className.indexOf("dgrid-loading"))break;m=t[k];n+=A;z+=t.count||1;g.removeRow(t,!0);u.push(t);"rowIndex"in t&&(l=t.rowIndex)}g._renderedCollection.releaseRange&&"number"===typeof v&&
"number"===typeof l&&(d?g._renderedCollection.releaseRange(l,v+1):g._renderedCollection.releaseRange(v,l+1),g._rows[d?"max":"min"]=l,g._rows.max>=g._total-1&&(g._rows.max=Infinity));c.count+=z;d?(f.rowIndex-=z,b(c)):f.style.height=f.offsetHeight+n+"px";var p=document.createElement("div");for(c=u.length;c--;)p.appendChild(u[c]);setTimeout(function(){e.destroy(p)},1)}}function b(c,a){c.node.style.height=Math.min(c.count*g.rowHeight,a?Infinity:g.maxEmptySpace)+"px"}function d(c,a){do c=a?c.next:c.previous;
while(c&&!c.node.offsetWidth);return c}if(this.rowHeight){var g=this,h=g.bodyNode;f=f&&f.scrollTop||this.getScrollPosition().y;var h=h.offsetHeight+f,c,k,t=g.preload,m=g.lastScrollTop,n=g.bufferRows*g.rowHeight,l=n-g.rowHeight,q,y=!0;for(g.lastScrollTop=f;t&&!t.node.offsetWidth;)t=t.previous;for(;t&&t!==c;){c=g.preload;g.preload=t;k=t.node;var v=k.offsetTop;if(h+1+l<v)t=d(t,y=!1);else if(f-1-l>v+k.offsetHeight)t=d(t,y=!0);else{var v=((k.rowIndex?f-n:h)-v)/g.rowHeight,p=(h-f+2*n)/g.rowHeight,w=Math.max(Math.min((f-
m)*g.rowHeight,g.maxRowsPerPage/2),g.maxRowsPerPage/-2),p=p+Math.min(Math.abs(w),10);0===k.rowIndex&&(v-=p);v=Math.max(v,0);10>v&&0<v&&p+v<g.maxRowsPerPage&&(p+=Math.max(0,v),v=0);p=Math.min(Math.max(p,g.minRowsPerPage),g.maxRowsPerPage,t.count);if(0===p)t=d(t,y);else{var p=Math.ceil(p),v=Math.min(Math.floor(v),t.count-p),x={};t.count-=p;var r=k,F,w=g.queryRowsOverlap,G=(0<k.rowIndex||k.offsetTop>f)&&t;if(G){var D=t.previous;D&&(a(D,f-(D.node.offsetTop+D.node.offsetHeight),"nextSibling"),0<v&&D.node===
k.previousSibling?(v=Math.min(t.count,v),t.previous.count+=v,b(t.previous,!0),k.rowIndex+=v,w=0):p+=v,t.count-=v);x.start=k.rowIndex-w;x.count=Math.min(p+w,g.maxRowsPerPage);k.rowIndex=x.start+x.count}else t.next&&(a(t.next,t.next.node.offsetTop-h,"previousSibling",!0),r=k.nextSibling,r===t.next.node?(t.next.count+=t.count-v,t.next.node.rowIndex=v+p,b(t.next),t.count=v,w=0):F=!0),x.start=t.count,x.count=Math.min(p+w,g.maxRowsPerPage);F&&r&&r.offsetWidth&&(F=r.offsetTop);b(t);"level"in t.query&&(x.queryLevel=
t.query.level);if("queryLevel"in x||!(x.start>g._total||0>x.count)){var E=e.create("div",{className:"dgrid-loading",style:{height:p*g.rowHeight+"px"}},r,"before");e.create("div",{className:"dgrid-"+(G?"below":"above"),innerHTML:g.loadingMessage},E);E.count=p;g._trackError(function(){(function(c,a,k){var d=t.query(x);q=g.renderQueryResults(d,c,x).then(function(h){var f=g._rows;!f||"queryLevel"in x||!h.length||(a?(f.max<=f.min&&(f.min=h[0].rowIndex),f.max=h[h.length-1].rowIndex):(f.max<=f.min&&(f.max=
h[h.length-1].rowIndex),f.min=h[0].rowIndex));r=c.nextSibling;e.destroy(c);k&&r&&r.offsetWidth&&(f=g.getScrollPosition(),g.scrollTo({x:f.x,y:f.y+r.offsetTop-k,preserveMomentum:!0}));d.totalLength.then(function(c){"queryLevel"in x||(g._total=c,g._rows&&g._rows.max>=g._total-1&&(g._rows.max=Infinity));a&&(a.count=c-a.node.rowIndex,b(a))});g._processScroll();return h},function(a){e.destroy(c);throw a;})})(E,G,F)});t=t.previous}}}}return q}}})})},"dgrid/_StoreMixin":function(){define("dojo/_base/declare dojo/_base/lang dojo/Deferred dojo/aspect dojo/dom-construct dojo/has dojo/on dojo/when".split(" "),
function(r,l,q,p,e,m,n,f){function u(a){if("object"!==typeof a)a=Error(a);else if("cancel"===a.dojoType)return;n.emit(this.domNode,"dgrid-error",{grid:this,error:a,cancelable:!0,bubbles:!0})&&console.error(a)}return r(null,{collection:null,_renderedCollection:null,_rows:null,_observerHandle:null,shouldTrackCollection:!1,getBeforePut:!0,noDataMessage:"",loadingMessage:"",_total:0,constructor:function(){this.dirty={};this._updating={};this._columnsWithSet={};p.before(this,"configStructure",l.hitch(this,
function(){this._columnsWithSet={}}))},destroy:function(){this.inherited(arguments);this._renderedCollection&&this._cleanupCollection()},_configColumn:function(a){a.set&&(this._columnsWithSet[a.field]=a);this.inherited(arguments)},_setCollection:function(a){this._renderedCollection&&(this.cleanup(),this._cleanupCollection({shouldRevert:!a||a.storage!==this._renderedCollection.storage}));this.collection=a;if(this._started){if(a){var b=a;this.sort&&0<this.sort.length&&(b=a.sort(this.sort));b.track&&
this.shouldTrackCollection&&(b=b.track(),this._rows=[],this._observerHandle=this._observeCollection(b,this.contentNode,{rows:this._rows}));this._renderedCollection=b}this.refresh()}},_setStore:function(){},_getTotal:function(){return this._total},_cleanupCollection:function(a){a=a||{};this._renderedCollection.tracking&&this._renderedCollection.tracking.remove();this._observerHandle&&(this._observerHandle.remove(),this._observerHandle=this._rows=null);!1!==a.shouldRevert&&(this.dirty={});this._renderedCollection=
this.collection=null},_applySort:function(){this.collection&&this.set("collection",this.collection)},row:function(){var a=this.inherited(arguments);a&&a.data&&"undefined"!==typeof a.id&&(this.collection?a.id=this.collection.getIdentity(a.data):console.error("_StoreMixin:have no collection!"));return a},refresh:function(){var a=this.inherited(arguments);this.collection||(this.noDataNode=e.create("div",{className:"dgrid-no-data",innerHTML:this.noDataMessage},this.contentNode),this._emit("noData"));
return a},refreshCell:function(a){if(!this.collection||!this._createBodyRowCell)return!1;if(a.column){if(a.column&&a.column.selector)return(new q).resolve();this.inherited(arguments);return this.collection.get(a.row.id).then(l.hitch(this,"_refreshCellFromItem",a))}},_refreshCellFromItem:function(a,b,d){if(a&&a.element){var g=a.element;g.widget&&g.widget.destroyRecursive();e.empty(g);var h=this.dirty&&this.dirty[a.row.id];h&&(b=l.delegate(b,h));this._createBodyRowCell(g,a.column,b,d)}},renderArray:function(){var a=
this.inherited(arguments);this.collection||a.length&&this.noDataNode&&e.destroy(this.noDataNode);return a},insertRow:function(a,b,d,g,h){var c=this.collection,k=this.dirty,c=c&&c.getIdentity(a),f;c in k&&!(c in this._updating)&&(f=k[c]);f&&(a=l.delegate(a,f));k=this.inherited(arguments);h&&h.rows&&(h.rows[g]=k);this.noDataNode&&(e.destroy(this.noDataNode),this.noDataNode=null);return k},updateDirty:function(a,b,d){var g=this.dirty,h=g[a];h||(h=g[a]={});h[b]=d},save:function(){function a(a,k){return function(h){var f=
b._columnsWithSet,t=b._updating,e,m;if("function"===typeof h.set)h.set(k);else for(e in k)h[e]=k[e];for(e in f)m=f[e].set(h),void 0!==m&&(h[e]=m);t[a]=!0;return d.put(h).then(function(b){delete g[a];delete t[a];c[a]=b;return c})}}var b=this,d=this.collection,g=this.dirty,h=new q,c={},k=function(c){var a;return b.getBeforePut||!(a=b.row(c).data)?function(){return d.get(c)}:function(){return a}},f=h.then(function(){return c}),e;for(e in g)var m=a(e,g[e]),f=f.then(k(e)).then(m);h.resolve();return f},
revert:function(){this.dirty={};this.refresh()},_trackError:function(a){"string"===typeof a&&(a=l.hitch(this,a));var b=this,d;try{d=f(a())}catch(g){a=new q,a.reject(g),d=a.promise}d.otherwise(function(a){u.call(b,a)});return d},removeRow:function(a,b,d){var g={element:a};!b&&this.noDataMessage&&this.up(g).element===a&&this.down(g).element===a&&(this.noDataNode=e.create("div",{className:"dgrid-no-data",innerHTML:this.noDataMessage},this.contentNode),this._emit("noData"));(g=d&&d.rows||this._rows)&&
delete g[a.rowIndex];return this.inherited(arguments)},renderQueryResults:function(a,b,d){d=l.mixin({rows:this._rows},d);var g=this;return a.then(function(a){a=g.renderArray(a,b,d);delete g._lastCollection;return a})},_observeCollection:function(a,b,d){var g=this,h=d.rows,c,k=[a.on("delete, update",function(a){var k=a.previousIndex,f=a.index;void 0!==k&&h[k]&&("max"in h&&(void 0===f||f<h.min||f>h.max)&&h.max--,c=h[k],c.parentNode===b&&g.removeRow(c,!1,d),h.splice(k,1),("delete"===a.type||"update"===
a.type&&(k<f||void 0===f))&&h[k]&&h[k].rowIndex--);"delete"===a.type&&(c=null)}),a.on("add, update",function(a){var k=a.previousIndex,f=a.index;if(void 0!==f&&(!("max"in h)||f>=h.min&&f<=h.max)){"max"in h&&(void 0===k||k<h.min||k>h.max)&&h.max++;if(h.length){if(k=h[f],!k&&(k=h[f-1]))k=(k.connected||k).nextSibling}else k=g._getFirstRowSibling&&g._getFirstRowSibling(b);c&&k&&c.id===k.id&&(k=(k.connected||k).nextSibling);k&&!k.parentNode&&(k=document.getElementById(k.id));h.splice(f,0,void 0);c=g.insertRow(a.target,
b,k,f,d);g.highlightRow(c)}c=null}),a.on("add, delete, update",function(c){var b="undefined"!==typeof c.previousIndex?c.previousIndex:Infinity,k="undefined"!==typeof c.index?c.index:Infinity,d=Math.min(b,k);b!==k&&h[d]&&g.adjustRowIndices(h[d]);Infinity!==b&&g._processScroll&&(h[b]||h[b-1])&&g._processScroll();g._onNotification(h,c,a);a===g._renderedCollection&&"totalLength"in c&&(g._total=c.totalLength)})];return{remove:function(){for(;0<k.length;)k.pop().remove()}}},_onNotification:function(){}})})},
"dgrid/OnDemandGrid":function(){define(["dojo/_base/declare","./Grid","./OnDemandList"],function(r,l,q){return r([l,q],{})})},"dgrid/extensions/ColumnReorder":function(){define("dojo/_base/lang dojo/_base/declare dojo/_base/array dojo/dom-class dojo/on dojo/query dojo/dnd/Source".split(" "),function(r,l,q,p,e,m){function n(a,d){var g=d[2],h=a[g?"columnSets":"subRows"][d[1]];return g?h[d[2]]:h}function f(a,d,g){d[2]?a.columnSets[d[1]][d[2]]=g:a.subRows[d[1]]=g}function u(a,d){return d.slice(("dgrid-"+
a+"-").length)}var a=/(\d+)(?:-(\d+))?$/;r=l(m,{copyState:function(){return!1},checkAcceptance:function(a){return a===this},_legalMouseDown:function(a){return-1<a.target.className.indexOf("dgrid-resize-handle")?!1:this.inherited(arguments)},onDropInternal:function(b){var d=this.grid,g=a.exec(u(d.id,b[0].getAttribute("dndType"))),h=g[2]?"columnSets":"subRows",c=n(d,g),k=d.columns;this.inherited(arguments);g&&setTimeout(function(){var a=q.map(b[0].parentNode.childNodes,function(a){return k[a.columnId]});
f(d,g,a);a={grid:d,subRow:a,column:k[b[0].columnId],bubbles:!0,cancelable:!0,parentType:"dnd"};a[h]=d[h];e.emit(d.domNode,"dgrid-columnreorder",a)?d.set(h,d[h]):(f(d,g,c),d.renderHeader(),d.sort.length&&d.updateSortArrow(d.sort))},0)}});l=l("dgrid.ColumnReorder",null,{columnDndConstructor:r,_initSubRowDnd:function(a,d){var g,h,c,k;h=0;for(c=a.length;h<c;h++)k=a[h],!1!==k.reorderable&&(k=k.headerNode,p.add(k,"dojoDndItem"),k.setAttribute("dndType",d),g||(g=k.parentNode));g&&this._columnDndSources.push(new this.columnDndConstructor(g,
{horizontal:!0,grid:this}))},renderHeader:function(){var a="dgrid-"+this.id+"-",d,g;this.inherited(arguments);this._columnDndSources=[];if(this.columnSets)for(g=0,d=this.columnSets.length;g<d;g++)q.forEach(this.columnSets[g],function(d,c){this._initSubRowDnd(d,a+g+"-"+c)},this);else q.forEach(this.subRows,function(d,c){this._initSubRowDnd(d,a+c)},this)},_destroyColumns:function(){this._columnDndSources&&q.forEach(this._columnDndSources,function(a){a&&a.destroy&&a.destroy()});this.inherited(arguments)}});
l.ColumnDndSource=r;return l})},"dgrid/extensions/ColumnResizer":function(){define("dojo/_base/declare dojo/on dojo/query dojo/_base/lang dojo/dom dojo/dom-construct dojo/dom-geometry dojo/has ../util/misc dojo/_base/html".split(" "),function(r,l,q,p,e,m,n,f,u){function a(a){for(var b=a.length,d=b,h=a[0].length,g=Array(b);b--;)g[b]=Array(h);for(var f={},b=0;b<d;b++)for(var e=g[b],m=a[b],n=0,u=0;n<h;n++){var l=m[u],p;if("undefined"===typeof e[n]){e[n]=l.id;if(l.rowSpan&&1<l.rowSpan){p=g;for(var q=
l.rowSpan,r=b,G=n,D=l.id,E=1;E<q;E++)p[r+E][G]=D}if(0<b&&l.colSpan&&1<l.colSpan)for(p=1;p<l.colSpan;p++)if(e[++n]=l.id,l.rowSpan&&1<l.rowSpan)for(var q=g,r=l.rowSpan,G=b,D=n,E=l.id,I=1;I<r;I++)q[G+I][D]=E;f[l.id]=a[0][n].id;u++}}return f}function b(a,b,d,h,g){if(!(0>=d)){var f=a.columns[b],e;if(f&&(e={grid:a,columnId:b,width:d,bubbles:!0,cancelable:!0},h&&(e.parentType=h),!a._resizedColumns||l.emit(a.headerNode,"dgrid-columnresize",e)))return"auto"===d?delete f.width:(f.width=d,d+="px"),(h=a._columnSizes[b])?
h.set("width",d):h=u.addCssRule("#"+u.escapeCssIdentifier(a.domNode.id)+" .dgrid-column-"+u.escapeCssIdentifier(b,"-"),"width: "+d+";"),a._columnSizes[b]=h,!1!==g&&a.resize(),!0}}var d,g=0,h={create:function(){d=m.create("div",{className:"dgrid-column-resizer"})},destroy:function(){m.destroy(d);d=null},show:function(a){a=n.position(a.domNode,!0);d.style.top=a.y+"px";d.style.height=a.h+"px";document.body.appendChild(d)},move:function(a){d.style.left=a+"px"},hide:function(){d.parentNode.removeChild(d)}};
return r("dgrid.ColumnResizer",null,{resizeNode:null,minWidth:40,adjustLastColumn:!0,_resizedColumns:!1,buildRendering:function(){this.inherited(arguments);g||h.create();g++},destroy:function(){this.inherited(arguments);for(var a in this._columnSizes)this._columnSizes[a].remove();--g||h.destroy()},resizeColumnWidth:function(a,k){return b(this,a,k)},configStructure:function(){var a=this._oldColumnSizes=p.mixin({},this._columnSizes),b;this._resizedColumns=!1;this._columnSizes={};this.inherited(arguments);
for(b in a)b in this._columnSizes||a[b].remove();delete this._oldColumnSizes},_configColumn:function(a){this.inherited(arguments);var b=a.id,d;"width"in a&&((d=this._oldColumnSizes[b])?d.set("width",a.width+"px"):d=u.addCssRule("#"+u.escapeCssIdentifier(this.domNode.id)+" .dgrid-column-"+u.escapeCssIdentifier(b,"-"),"width: "+a.width+"px;"),this._columnSizes[b]=d)},renderHeader:function(){this.inherited(arguments);var c=this,b;if(this.columnSets&&this.columnSets.length)for(var d=this.columnSets.length;d--;)b=
p.mixin(b||{},a(this.columnSets[d]));else this.subRows&&1<this.subRows.length&&(b=a(this.subRows));for(var d=q(".dgrid-cell",c.headerNode),h=d.length;h--;){var g=d[h],e=g.columnId,n=c.columns[e],r=g.childNodes;if(n&&!1!==n.resizable){n=m.create("div",{className:"dgrid-resize-header-container"});for(g.contents=n;0<r.length;)n.appendChild(r[0]);r=m.create("div",{className:"dgrid-resize-handle resizeNode-"+u.escapeCssIdentifier(e,"-")},n);g.appendChild(n);r.columnId=b&&b[e]||e}}c.mouseMoveListen||(l(c.headerNode,
".dgrid-resize-handle:mousedown"+(f("touch")?",.dgrid-resize-handle:touchstart":""),function(a){c._resizeMouseDown(a,this);c.mouseMoveListen.resume();c.mouseUpListen.resume()}),c._listeners.push(c.mouseMoveListen=l.pausable(document,"mousemove"+(f("touch")?",touchmove":""),u.throttleDelayed(function(a){c._updateResizerPosition(a)}))),c._listeners.push(c.mouseUpListen=l.pausable(document,"mouseup"+(f("touch")?",touchend":""),function(a){c._resizeMouseUp(a);c.mouseMoveListen.pause();c.mouseUpListen.pause()})),
c.mouseMoveListen.pause(),c.mouseUpListen.pause())},_resizeMouseDown:function(a,b){a.preventDefault();e.setSelectable(this.domNode,!1);this._startX=this._getResizeMouseLocation(a);this._targetCell=q(".dgrid-column-"+u.escapeCssIdentifier(b.columnId,"-"),this.headerNode)[0];this._updateResizerPosition(a);h.show(this)},_resizeMouseUp:function(a){var k=this._columnSizes,d,g,f;this.adjustLastColumn&&(f=this.headerNode.clientWidth-1);this._resizedColumns||(d=q(".dgrid-cell",this.headerNode),this.columnSets&&
this.columnSets.length?d=d.filter(function(a){return"0"===a.columnId.split("-")[0]&&!(a.columnId in k)}):this.subRows&&1<this.subRows.length&&(d=d.filter(function(a){return"0"===a.columnId.charAt(0)&&!(a.columnId in k)})),g=d.map(function(a){return a.offsetWidth}),d.forEach(function(a,c){b(this,a.columnId,g[c],null,!1)},this),this._resizedColumns=!0);e.setSelectable(this.domNode,!0);d=this._targetCell;var m=this._getResizeMouseLocation(a)-this._startX,n=d.offsetWidth+m,l=this._getResizedColumnWidths(),
p=l.totalWidth,l=l.lastColId,r=q(".dgrid-column-"+u.escapeCssIdentifier(l,"-"),this.headerNode)[0].offsetWidth;n<this.minWidth&&(n=this.minWidth);b(this,d.columnId,n,a.type)&&d.columnId!==l&&this.adjustLastColumn&&(p+m<f?b(this,l,"auto",a.type):r-m<=this.minWidth&&b(this,l,this.minWidth,a.type));h.hide();delete this._startX;delete this._targetCell},_updateResizerPosition:function(a){if(this._targetCell){a=this._getResizeMouseLocation(a);var b=this._targetCell.offsetWidth,d=a;b+(a-this._startX)<this.minWidth&&
(d=this._startX-(b-this.minWidth));h.move(d)}},_getResizeMouseLocation:function(a){var b=0;a.pageX?b=a.pageX:a.clientX&&(b=a.clientX+document.body.scrollLeft+document.documentElement.scrollLeft);return b},_getResizedColumnWidths:function(){var a=0,b=q((this.columnSets?".dgrid-column-set-cell ":"")+"tr:first-child .dgrid-cell",this.headerNode),d=b.length;if(!d)return{};for(var h=b[d-1].columnId;d--;)a+=b[d].offsetWidth;return{totalWidth:a,lastColId:h}}})})},"dgrid/extensions/CompoundColumns":function(){define(["dojo/_base/lang",
"dojo/_base/declare","dojo/sniff","dojo/query","../util/misc"],function(r,l,q,p,e){return l(null,{configStructure:function(){function m(c,b,d,h){var g=0,n=function(){},p,q;e.each(c,function(e,J){"string"===typeof e&&(e={label:e});c instanceof Array||e.field||(e.field=J);q=(p=e.children)&&!1!==e.showChildHeaders;e.parentColumn=h;p?null==e.id?e.id=(h&&h.id||b-1)+"-"+l.length:h&&h.id&&(e.id=h.id+"-"+e.id):(a.push(e),l.push(r.delegate(e,{renderHeaderCell:n})),g++);q||(e=r.delegate(e,{rowSpan:-b}));p&&
(g+=e.colSpan=m(p,b+1,q,e));d&&(f[b]||(f[b]=[])).push(e)},this);return g}var n=this.subRows&&this.subRows[0]||this.columns,f=[[]],l=f[0],a=[];f[0].className="dgrid-spacer-row";m(n,1,!0);var n=f.length,b,d,g,h;for(b=0;b<n;b++)for(g=f[b],d=0;d<g.length;d++)h=g[d],1>h.rowSpan&&(h.rowSpan+=n);a=[a];a.headerRows=f;this.subRows=a;this.inherited(arguments)},renderHeader:function(){var e,n=this.subRows[0],f=this.subRows.headerRows[0];this.inherited(arguments);for(e=n.length;e--;)n[e].headerNode=f[e].headerNode},
_findSortArrowParent:function(){var m=this.inherited(arguments);if(m&&e.contains(p(".dgrid-spacer-row",this.headerNode)[0],m))return m=m.columnId||m.parentNode.columnId,m=p(".dgrid-column-"+m,this.headerNode),m[m.length-1]},_configColumn:function(e,n,f){var l=e.parentColumn,a=e.id;l&&(a=0===a.indexOf(f)?a.substring(f.length):a,f=l.id+"-",e.id=f+a);this.inherited(arguments,[e,n,f])},cell:function(e,n){if("object"!==typeof n){var f=this.column(n);f&&(n=f.id)}return this.inherited(arguments,[e,n])},
column:function(e){var n=this.inherited(arguments);if(null==n&&"object"!==typeof e){var f="-"+e,l=f.length,a;for(a in this.columns)if(-1!==a.indexOf(f,a.length-l))return this.columns[a]}return n},_updateCompoundHiddenStates:function(e,n){var f=this.columns[e],l;if(!f||f.hidden!==n)for(;f&&f.parentColumn;){f=f.parentColumn;if(l=f.colSpan+=n?-1:1)f.headerNode.colSpan=l;1!==l||n?!l&&n&&this._hideColumn(f.id):this._showColumn(f.id)}},_hideColumn:function(e){var n=this;this._updateCompoundHiddenStates(e,
!0);this.inherited(arguments);q("ff")&&(this.headerNode.style.display="none",setTimeout(function(){n.headerNode.style.display="";n.resize()},0))},_showColumn:function(e){this._updateCompoundHiddenStates(e,!1);this.inherited(arguments)},_getResizedColumnWidths:function(){var e=0,n=this.columns,f;for(f in n)e+=n[f].headerNode.offsetWidth;return{totalWidth:e,lastColId:this.subRows[0][this.subRows[0].length-1].id}}})})},"dgrid/extensions/Pagination":function(){define("../_StoreMixin dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/dom-construct dojo/dom-class dojo/on dojo/query dojo/string dojo/has dojo/when ../util/misc dojo/_base/sniff".split(" "),
function(r,l,q,p,e,m,n,f,u,a,b,d){function g(a){a.noDataNode?(e.destroy(a.noDataNode),delete a.noDataNode):a.cleanup();a.contentNode.innerHTML=""}function h(a){if(a.loadingNode)e.destroy(a.loadingNode),delete a.loadingNode;else if(a._oldPageNodes){for(var b in a._oldPageNodes)a.removeRow(a._oldPageNodes[b]);delete a._oldPageNodes}delete a._isLoading}return l(r,{rowsPerPage:10,pagingTextBox:!1,previousNextArrows:!0,firstLastArrows:!1,pagingLinks:2,pageSizeOptions:null,showLoadingMessage:!0,i18nPagination:{status:"${start} - ${end} of ${total} results",
gotoFirst:"Go to first page",gotoNext:"Go to next page",gotoPrev:"Go to previous page",gotoLast:"Go to last page",gotoPage:"Go to page",jumpPage:"Jump to page",rowsPerPage:"Number of rows per page"},showFooter:!0,_currentPage:1,buildRendering:function(){this.inherited(arguments);var a=this,b=this.paginationNode=e.create("div",{className:"dgrid-pagination"},this.footerNode),d=this.paginationStatusNode=e.create("div",{className:"dgrid-status"},b),h=this.i18nPagination;d.tabIndex=0;this.addUiClasses&&
m.add(this.footerNode,"ui-widget-content");this._updatePaginationSizeSelect();this._updateRowsPerPageOption();this._updatePaginationStatus(this._total);b=this.paginationNavigationNode=e.create("div",{className:"dgrid-navigation"},b);this.firstLastArrows&&(this.paginationFirstNode=e.create("span",{"aria-label":h.gotoFirst,className:"dgrid-first dgrid-page-link",innerHTML:"\u00ab",tabIndex:0},b));this.previousNextArrows&&(this.paginationPreviousNode=e.create("span",{"aria-label":h.gotoPrev,className:"dgrid-previous dgrid-page-link",
innerHTML:"\u2039",tabIndex:0},b));this.paginationLinksNode=e.create("span",{className:"dgrid-pagination-links"},b);this.previousNextArrows&&(this.paginationNextNode=e.create("span",{"aria-label":h.gotoNext,className:"dgrid-next dgrid-page-link",innerHTML:"\u203a",tabIndex:0},b));this.firstLastArrows&&(this.paginationLastNode=e.create("span",{"aria-label":h.gotoLast,className:"dgrid-last dgrid-page-link",innerHTML:"\u00bb",tabIndex:0},b));this._listeners.push(n(b,".dgrid-page-link:click,.dgrid-page-link:keydown",
function(b){if("keydown"!==b.type||13===b.keyCode){b=this.className;var d,k;a._isLoading||-1<b.indexOf("dgrid-page-disabled")||(d=a._currentPage,k=Math.ceil(a._total/a.rowsPerPage),this===a.paginationPreviousNode?a.gotoPage(d-1):this===a.paginationNextNode?a.gotoPage(d+1):this===a.paginationFirstNode?a.gotoPage(1):this===a.paginationLastNode?a.gotoPage(k):"dgrid-page-link"===b&&a.gotoPage(+this.innerHTML))}}))},destroy:function(){this.inherited(arguments);this._pagingTextBoxHandle&&this._pagingTextBoxHandle.remove()},
_updatePaginationSizeSelect:function(){var a=this.pageSizeOptions,b=this.paginationSizeSelect,d;if(a&&a.length){b||(b=this.paginationSizeSelect=e.create("select",{"aria-label":this.i18nPagination.rowsPerPage,className:"dgrid-page-size"},this.paginationNode),d=this._paginationSizeChangeHandle=n(b,"change",p.hitch(this,function(){this.set("rowsPerPage",+this.paginationSizeSelect.value)})),this._listeners.push(d));for(d=b.options.length=0;d<a.length;d++)e.create("option",{innerHTML:a[d],selected:this.rowsPerPage===
a[d],value:a[d]},b);this._updateRowsPerPageOption()}else a&&a.length||!b||(e.destroy(b),this.paginationSizeSelect=null,this._paginationSizeChangeHandle.remove())},_setPageSizeOptions:function(a){this.pageSizeOptions=a&&a.sort(function(a,b){return a-b});this._updatePaginationSizeSelect()},_updateRowsPerPageOption:function(){var a=this.rowsPerPage,b=this.pageSizeOptions,d=this.paginationSizeSelect;d&&(0>q.indexOf(b,a)?this._setPageSizeOptions(b.concat([a])):d.value=""+a)},_setRowsPerPage:function(a){this.rowsPerPage=
a;this._updateRowsPerPageOption();this.gotoPage(1)},_updateNavigation:function(a){function b(a,c){var d,k;l.pagingTextBox&&a===q&&1<w?(d=e.create("input",{"aria-label":p.jumpPage,className:"dgrid-page-input",type:"text",value:q},u),l._pagingTextBoxHandle=n(d,"change",function(){var a=+this.value;!isNaN(a)&&0<a&&a<=w&&l.gotoPage(+this.value)}),x&&"INPUT"===x.tagName&&d.focus()):(k=a===q,d=e.create("span",{"aria-label":p.gotoPage,className:"dgrid-page-link"+(k?" dgrid-page-disabled":""),innerHTML:a+
(c?" ":""),tabIndex:k?-1:0},u),H===a&&(k?a<w?H++:F.focus():d.focus()),k||(F=d))}function h(a,b){m.toggle(a,"dgrid-page-disabled",b);a.tabIndex=b?-1:0}function g(){e.create("span",{className:"dgrid-page-skip",innerHTML:"..."},u)}var l=this,p=this.i18nPagination,u=this.paginationLinksNode,q=this._currentPage,v=this.pagingLinks,r=this.paginationNavigationNode,w=Math.ceil(a/this.rowsPerPage);a=this._pagingTextBoxHandle;var x=document.activeElement,H,F;x&&d.contains(this.paginationNavigationNode,x)?"dgrid-page-link"===
x.className&&(H=+x.innerHTML):x=null;a&&a.remove();u.innerHTML="";f(".dgrid-first, .dgrid-previous",r).forEach(function(a){h(a,1===q)});f(".dgrid-last, .dgrid-next",r).forEach(function(a){h(a,q>=w)});if(v&&0<w){b(1,!0);r=q-v;for(2<r?g():r=2;r<Math.min(q+v+1,w);r++)b(r,!0);q+v+1<w&&g();1<w&&b(w)}else l.pagingTextBox&&b(q);x&&-1===x.tabIndex&&(v=f('[tabindex\x3d"0"]',this.paginationNavigationNode),x===this.paginationPreviousNode||x===this.paginationFirstNode?x=v[0]:v.length&&(x=v[v.length-1]),x&&x.focus())},
_updatePaginationStatus:function(a){var b=this.rowsPerPage,d=Math.min(a,(this._currentPage-1)*b+1);this.paginationStatusNode.innerHTML=u.substitute(this.i18nPagination.status,{start:d,end:Math.min(a,d+b-1),total:a})},refresh:function(a){var b=this,d=a&&a.keepCurrentPage?Math.min(this._currentPage,Math.ceil(this._total/this.rowsPerPage)):1;this.inherited(arguments);return this.gotoPage(d).then(function(a){setTimeout(function(){n.emit(b.domNode,"dgrid-refresh-complete",{bubbles:!0,cancelable:!1,grid:b})},
0);return a})},_onNotification:function(a,b,d){a=this.rowsPerPage;var h=this._currentPage*a;"add"===b.type&&b.index<h||"delete"===b.type&&b.previousIndex<h||"update"===b.type&&Math.floor(b.index/a)!==Math.floor(b.previousIndex/a)?this.gotoPage(Math.min(this._currentPage,Math.ceil(b.totalLength/this.rowsPerPage))):d===this._renderedCollection&&b.totalLength!==this._total&&(this._updatePaginationStatus(b.totalLength),this._updateNavigation(b.totalLength))},renderQueryResults:function(a,b){var d=this,
h=this.inherited(arguments);b||(this._topLevelRequest&&(this._topLevelRequest.cancel(),delete this._topLevelRequest),"function"===typeof h.cancel&&(this._topLevelRequest=h),h.then(function(){d._topLevelRequest&&delete d._topLevelRequest}));return h},insertRow:function(){var a=this._oldPageNodes,b=this.inherited(arguments);a&&b===a[b.id]&&delete a[b.id];return b},gotoPage:function(a){var d=this,f=(this._currentPage-1)*this.rowsPerPage;if(!this._renderedCollection)return b([]);this._renderedCollection.releaseRange&&
this._renderedCollection.releaseRange(f,f+this.rowsPerPage);return this._trackError(function(){var b=d.rowsPerPage,f=(a-1)*b,n={start:f,count:b},m,l=d.contentNode,t,u,p;if(d.showLoadingMessage)g(d),d.loadingNode=e.create("div",{className:"dgrid-loading",innerHTML:d.loadingMessage},l);else for(d._oldPageNodes=t={},l=l.children,u=0,p=l.length;u<p;u++)t[l[u].id]=l[u];d._isLoading=!0;m=d._renderedCollection.fetchRange({start:f,end:f+b});return d.renderQueryResults(m,null,n).then(function(g){h(d);d.scrollTo({y:0});
d._rows&&(d._rows.min=f,d._rows.max=f+b-1);m.totalLength.then(function(b){b||(d.noDataNode&&(e.destroy(d.noDataNode),delete d.noDataNode),d.noDataNode=e.create("div",{className:"dgrid-no-data",innerHTML:d.noDataMessage},d.contentNode));d._total=b;d._currentPage=a;d._rowsOnPage=g.length;d._updatePaginationStatus(b);d._updateNavigation(b)});return m},function(a){h(d);throw a;})})}})})},"dgrid/extensions/DnD":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/aspect dojo/dom-class dojo/on dojo/topic dojo/has dojo/when dojo/dnd/Source dojo/dnd/Manager dojo/_base/NodeList ../Selection dojo/has!touch?../util/touch dojo/has!touch?./_DnD-touch-autoscroll".split(" "),
function(r,l,q,p,e,m,n,f,u,a,b,d,g,h){var c=r(a,{grid:null,getObject:function(a){var b=this.grid;return b.collection.get(a.id.slice(b.id.length+5))},_legalMouseDown:function(a){return this.inherited(arguments)&&a.target!==this.grid.bodyNode},onDrop:function(a,b,c){var d=this,h=this._targetAnchor=this.targetAnchor,g=this.grid,f=g.collection;!this.before&&h&&(h=h.nextSibling);h=h&&g.row(h);u(h&&f.get(h.id),function(h){if(d!==a)d.onDropExternal(a,b,c,h);else d.onDropInternal(b,c,h)})},onDropInternal:function(a,
b,c){var d=this.grid,h=d.collection,g=this,f=g._targetAnchor,e;f&&(e=this.before?f.previousSibling:f.nextSibling);f=d.row(a[0]);(b||e!==a[0]&&(c||!f||d.down(f).element!==a[0]))&&a.forEach(function(a){u(g.getObject(a),function(a){var k=h.getIdentity(a);h[b&&h.copy?"copy":"put"](a,{beforeId:c?h.getIdentity(c):null});g._selectedNodes[k]&&(g._selectedNodes[k]=d.row(k).element)})})},onDropExternal:function(a,b,c,d){var h=this.grid.collection,g=a.grid;b.forEach(function(b,f){u(a.getObject(b),function(e){c||
(g?u(g.collection.getIdentity(e),function(c){!f&&a.selectNone();a.delItem(b.id);g.collection.remove(c)}):a.deleteSelectedNodes());h[h.copy?"copy":"put"](e,{beforeId:d?h.getIdentity(d):null})})})},onDndStart:function(a){this.inherited(arguments);a===this&&(this.grid.cancelTouchScroll&&this.grid.cancelTouchScroll(),b.manager().avatar.node.style.width=this.grid.domNode.offsetWidth/2+"px")},onMouseDown:function(a){f("touch")&&this.isDragging&&1<h.countCurrentTouches(a,this.grid.touchNode)?(n.publish("/dnd/cancel"),
b.manager().stopDrag()):this.inherited(arguments)},onMouseMove:function(a){(!f("touch")||1>=h.countCurrentTouches(a,this.grid.touchNode))&&this.inherited(arguments)},checkAcceptance:function(b){return b.getObject&&a.prototype.checkAcceptance.apply(this,arguments)},getSelectedNodes:function(){if(!this.grid.selection)return this.inherited(arguments);var a=new d,b;for(b in this.grid.selection)a.push(this._selectedNodes[b]);return a}});r=r(g,{dndSourceType:"dgrid-row",dndParams:null,dndConstructor:c,
postMixInProperties:function(){this.inherited(arguments);this.dndParams=l.mixin({accept:[this.dndSourceType]},this.dndParams)},postCreate:function(){function a(b){d[b.id]=b.element}function b(a){delete d[a.id];e.remove(a.element,"dojoDndItemSelected dojoDndItemAnchor")}this.inherited(arguments);this.dndSource=new (this.dndConstructor||c)(this.bodyNode,l.mixin(this.dndParams,{grid:this,dropParent:this.contentNode}));var d=this.dndSource._selectedNodes={};this.on("dgrid-select",function(b){q.forEach(b.rows,
a)});this.on("dgrid-deselect",function(a){q.forEach(a.rows,b)});p.after(this,"destroy",function(){delete this.dndSource._selectedNodes;d=null;this.dndSource.destroy()},!0)},insertRow:function(a){var b=this.inherited(arguments),c="function"===typeof this.getObjectDndType?this.getObjectDndType(a):[this.dndSourceType];e.add(b,"dojoDndItem");this.dndSource.setItem(b.id,{data:a,type:c instanceof Array?c:[c]});return b},removeRow:function(a){this.dndSource.delItem(this.row(a));this.inherited(arguments)}});
r.GridSource=c;return r})},"dgrid/Editor":function(){define("dojo/_base/declare dojo/_base/lang dojo/Deferred dojo/dom-construct dojo/dom-class dojo/on dojo/has dojo/query ./Grid dojo/_base/sniff".split(" "),function(r,l,q,p,e,m,n,f,u){return r(null,{constructor:function(){this._editorInstances={};this._editorColumnListeners=[];this._editorCellListeners={};this._editorsPendingStartup=[]},postCreate:function(){var a=this;this.inherited(arguments);this.on(".dgrid-input:focusin",function(){a._focusedEditorCell=
a.cell(this)});this._editorFocusoutHandle=m.pausable(this.domNode,".dgrid-input:focusout",function(){a._focusedEditorCell=null});this._listeners.push(this._editorFocusoutHandle)},insertRow:function(){this._editorRowListeners={};var a=this.inherited(arguments),b=this.row(a),d=this._editorCellListeners[a.id]=this._editorCellListeners[a.id]||{},g;for(g in this._editorRowListeners)d[g]=this._editorRowListeners[g];this._editorRowListeners=null;(d=this._previouslyFocusedEditorCell)&&d.row.id===b.id&&this.edit(this.cell(b,
d.column.id));return a},refresh:function(){for(var a in this._editorInstances){var b=this._editorInstances[a].domNode;b&&b.parentNode&&b.parentNode.removeChild(b)}this.inherited(arguments)},removeRow:function(a){var b=this,d=this._focusedEditorCell;d&&d.row.id===this.row(a).id&&(this._previouslyFocusedEditorCell=d,this._editorFocusoutHandle.pause(),setTimeout(function(){b._editorFocusoutHandle.resume();b._previouslyFocusedEditorCell=null},0));if(this._editorCellListeners[a.id]){for(var g in this._editorCellListeners[a.id])this._editorCellListeners[a.id][g].remove();
delete this._editorCellListeners[a.id]}for(d=this._alwaysOnWidgetColumns.length;d--;)if(g=(g=this.cell(a,this._alwaysOnWidgetColumns[d].id).element)&&(g.contents||g).widget)this._editorFocusoutHandle.pause(),g.destroyRecursive();return this.inherited(arguments)},renderArray:function(){var a=this.inherited(arguments);a.length?this._startupPendingEditors():this._editorsPendingStartup=[];return a},_onNotification:function(){this.inherited(arguments);this._startupPendingEditors()},_destroyColumns:function(){this._editorStructureCleanup();
this.inherited(arguments)},_editorStructureCleanup:function(){var a=this._editorInstances,b=this._editorColumnListeners;this._editTimer&&clearTimeout(this._editTimer);for(var d in a){var g=a[d];g.domNode&&g.destroyRecursive()}this._editorInstances={};for(a=b.length;a--;)b[a].remove();for(var h in this._editorCellListeners)for(d in this._editorCellListeners[h])this._editorCellListeners[h][d].remove();for(a=0;a<this._editorColumnListeners.length;a++)this._editorColumnListeners[a].remove();this._editorCellListeners=
{};this._editorColumnListeners=[];this._editorsPendingStartup=[]},_configColumns:function(){var a=this.inherited(arguments);this._alwaysOnWidgetColumns=[];for(var b=0,d=a.length;b<d;b++)a[b].editor&&this._configureEditorColumn(a[b]);return a},_configureEditorColumn:function(a){var b=this,d=a.renderCell||this._defaultRenderCell,g=a.editOn,h="string"!==typeof a.editor;g?this._editorInstances[a.id]=this._createSharedEditor(a,d):h&&this._alwaysOnWidgetColumns.push(a);a.renderCell=g?function(c,h,f,e){if(!e||
!e.alreadyHooked){var n=m(f,g,function(){b._activeOptions=e;b.edit(this)});if(b._editorRowListeners)b._editorRowListeners[a.id]=n;else{var l=b.row(c);b._editorCellListeners[l.element.id][a.id]=n}}return d.call(a,c,h,f,e)}:function(c,g,f,e){if(!a.canEdit||a.canEdit(c,g))e=b._createEditor(a),e.object=c,b._showEditor(e,a,f,g),f[h?"widget":"input"]=e;else return d.call(a,c,g,f,e)}},edit:function(a){function b(a){d._activeCell=h;d._showEditor(n,g,h,e);d._editTimer=setTimeout(function(){n.focus&&n.focus();
g._editorBlurHandle&&g._editorBlurHandle.resume();d._editTimer=null;a.resolve(n)},0)}var d=this,g,h,c,f,e,n,m;a.column||(a=this.cell(a));if(!a||!a.element)return null;g=a.column;f=g.field;h=a.element.contents||a.element;if(n=this._editorInstances[g.id]){if(this._activeCell!==h){var l=a.row;e=(c=this.dirty&&this.dirty[l.id])&&f in c?c[f]:g.get?g.get(l.data):l.data[f];if(!g.canEdit||g.canEdit(a.row.data,e))return m=new q,a=n.domNode||n,a.offsetWidth?(a.blur(),setTimeout(function(){b(m)},0)):b(m),m.promise}}else if(g.editor&&
(n=h.widget||h.input))return m=new q,n.focus&&n.focus(),m.resolve(n),m.promise;return null},refreshCell:function(a){var b=a.row.element.id,d=a.column.id;this._editorCellListeners[b]&&this._editorCellListeners[b][d]&&(this._editorCellListeners[b][d].remove(),this._editorCellListeners[b][d]=null);return this.inherited(arguments)},_showEditor:function(a,b,d,g){var h=a.domNode;h||this._updateInputValue(a,g);d.innerHTML="";e.add(d,"dgrid-cell-editing");h&&b.editOn&&a.validate&&a.reset&&a.reset();d.appendChild(a.domNode||
a);h&&!b.editOn?this._editorsPendingStartup.push([a,b,d,g]):this._startupEditor(a,b,d,g)},_startupEditor:function(a,b,d,g){a.domNode&&(a._started||a.startup(),a._dgridIgnoreChange=!0,a.set("value",g),setTimeout(function(){a._dgridIgnoreChange=!1},0));a._dgridLastValue=g;this._activeCell&&(this._activeValue=g,m.emit(d,"dgrid-editor-show",{grid:this,cell:this.cell(d),column:b,editor:a,bubbles:!0,cancelable:!1}))},_startupPendingEditors:function(){for(var a=this._editorsPendingStartup,b=a.length;b--;)this._startupEditor.apply(this,
a[b]);this._editorsPendingStartup=[]},_handleEditorChange:function(a,b){var d=a.target;"_dgridLastValue"in d&&-1<d.className.indexOf("dgrid-input")&&this._updatePropertyFromEditor(b||this.cell(d).column,d,a)},_createEditor:function(a){var b=a.editor,d=a.editOn,g=this,h="string"!==typeof b&&b,c,f,e={};c=a.editorArgs||{};"function"===typeof c&&(c=c.call(this,a));h?(f=new h(c),c=f.focusNode||f.domNode,c.className+=" dgrid-input",f.on(d?"blur":"change",function(){f._dgridIgnoreChange||g._updatePropertyFromEditor(a,
this,{type:"widget"})})):(this._hasInputListener||(this._hasInputListener=!0,this.on("change",function(a){g._handleEditorChange(a)})),"textarea"===b?h="textarea":(h="input",e.type=b),f=c=p.create(h,l.mixin(e,{className:"dgrid-input",name:a.field,tabIndex:isNaN(a.tabIndex)?-1:a.tabIndex},c)),9>n("ie")&&(b="radio"===b||"checkbox"===b?m(f,"click",function(b){g._handleEditorChange(b,a)}):m(f,"change",function(b){g._handleEditorChange(b,a)}),d?this._editorColumnListeners.push(b):this._editorRowListeners?
this._editorRowListeners[a.id]=b:this._editorCellListeners[this.row(object).element.id][a.id]=b));if(a.autoSelect){var u=f.focusNode||f;u.select&&m(u,"focus",function(){setTimeout(function(){u.select()},0)})}return f},_createSharedEditor:function(a){function b(){var a=g._activeCell;f.blur();"function"===typeof g.focus&&setTimeout(function(){g.focus(a)},h&&9>n("ie")?15:0)}var d=this._createEditor(a),g=this,h=d.domNode,c=d.domNode||d,f=d.focusNode||c,q=h?function(){d.set("value",d._dgridLastValue)}:
function(){g._updateInputValue(d,d._dgridLastValue);g._updatePropertyFromEditor(a,d)};this._editorColumnListeners.push(m(f,"keydown",function(c){c=c.keyCode||c.which;27===c?(q(),g._activeValue=d._dgridLastValue,b()):13===c&&!1!==a.dismissOnEnter&&b()}));(a._editorBlurHandle=m.pausable(d,"blur",function(){var b=c.parentNode,h={alreadyHooked:!0},f=g.cell(c);m.emit(f.element,"dgrid-editor-hide",{grid:g,cell:f,column:a,editor:d,bubbles:!0,cancelable:!1});a._editorBlurHandle.pause();b.removeChild(c);f.row&&
(e.remove(f.element,"dgrid-cell-editing"),p.empty(b),u.appendIfNode(b,a.renderCell(f.row.data,g._activeValue,b,g._activeOptions?l.delegate(h,g._activeOptions):h)));g._focusedEditorCell=g._activeCell=g._activeValue=g._activeOptions=null})).pause();this._editorColumnListeners.push(a._editorBlurHandle);return d},_updatePropertyFromEditor:function(a,b,d){var g;if(!b.isValid||b.isValid())if(d=this._updateProperty((b.domNode||b).parentNode,this._activeCell?this._activeValue:b._dgridLastValue,this._retrieveEditorValue(a,
b),d),this._activeCell?this._activeValue=d:b._dgridLastValue=d,"radio"===b.type&&b.name&&!a.editOn&&a.field)for(g in d=this.row(b),f("input[type\x3dradio][name\x3d"+b.name+"]",this.contentNode).forEach(function(d){var c=this.row(d);d!==b&&d._dgridLastValue&&(d._dgridLastValue=!1,this.updateDirty?this.updateDirty(c.id,a.field,!1):c.data[a.field]=!1)},this),this.dirty)d.id.toString()!==g&&this.dirty[g][a.field]&&this.updateDirty(g,a.field,!1)},_updateProperty:function(a,b,d,f){var h=this;if((b&&b.valueOf())!==
(d&&d.valueOf())){var c=this.cell(a),e=c.row,n=c.column;a=c.element;if(n.field&&e)if(c={grid:this,cell:c,oldValue:b,value:d,bubbles:!0,cancelable:!0},f&&f.type&&(c.parentType=f.type),m.emit(a,"dgrid-datachange",c))this.updateDirty?(this.updateDirty(e.id,n.field,d),n.autoSave&&setTimeout(function(){h._trackError("save")},0)):e.data[n.field]=d;else{var l;(l=a.widget)?(l._dgridIgnoreChange=!0,l.set("value",b),setTimeout(function(){l._dgridIgnoreChange=!1},0)):(l=a.input)&&this._updateInputValue(l,b);
return b}}return d},_updateInputValue:function(a,b){a.value=b;if("radio"===a.type||"checkbox"===a.type)a.checked=a.defaultChecked=!!b},_retrieveEditorValue:function(a,b){return"function"===typeof b.get?this._convertEditorValue(b.get("value")):this._convertEditorValue(b["checkbox"===b.type||"radio"===b.type?"checked":"value"])},_convertEditorValue:function(a,b){if("number"===typeof b)a=isNaN(a)?a:parseFloat(a);else if("boolean"===typeof b)a="true"===a?!0:"false"===a?!1:a;else if(b instanceof Date){var d=
new Date(a);a=isNaN(d.getTime())?a:d}return a}})})},"dstore/Store":function(){define("dojo/_base/lang dojo/_base/array dojo/aspect dojo/has dojo/when dojo/Deferred dojo/_base/declare dstore/QueryMethod dstore/Filter dojo/Evented dcl/dcl".split(" "),function(r,l,q,p,e,m,n,f,u,a,b){function d(a){return function(b,d){var f=this;e(b,function(b){b={target:b};var c=d[1]||{};"beforeId"in c&&(b.beforeId=c.beforeId);f.emit(a,b)});return b}}p.add("object-proto",!!{}.__proto__&&!{}.watch);var g=p("object-proto");
return n(a,{constructor:function(b){b&&n.safeMixin(this,b);this.Model&&this.Model.createSubclass&&(this.Model=this.Model.createSubclass([],{}).extend({_store:this}));this.storage=new a;var c=this;this.autoEmitEvents&&(q.after(this,"add",d("add")),q.after(this,"put",d("update")),q.after(this,"remove",function(a,b){e(a,function(){c.emit("delete",{id:b[0]})});return a}))},autoEmitEvents:!0,idProperty:"id",queryAccessors:!0,getIdentity:function(a){return a.get?a.get(this.idProperty):a[this.idProperty]},
_setIdentity:function(a,b){a.set?a.set(this.idProperty,b):a[this.idProperty]=b},forEach:function(a,b){var d=this;return e(this.fetch(),function(f){for(var g=0,e;void 0!==(e=f[g]);g++)a.call(b,e,g,d);return f})},on:function(a,b){return this.storage.on(a,b)},emit:function(a,b){b=b||{};b.type=a;try{return this.storage.emit(a,b)}finally{return b.cancelable}},parse:null,stringify:null,Model:null,_restore:function(a,b){var d=this.Model;if(d&&a){var f=d.prototype,e=f._restore;e?a=e.call(a,d,b):g&&b?a.__proto__=
f:a=r.delegate(f,a)}return a},create:function(a){return new this.Model(a)},_createSubCollection:function(a){var b=r.delegate(this.constructor.prototype),d;for(d in this)this._includePropertyInSubCollection(d,b)&&(b[d]=this[d]);return n.safeMixin(b,a)},_includePropertyInSubCollection:function(a,b){return!(a in b)||b[a]!==this[a]},queryLog:[],filter:new f({type:"filter",normalizeArguments:function(a){var b=this.Filter;return a instanceof b?[a]:[new b(a)]}}),Filter:u,sort:new f({type:"sort",normalizeArguments:function(a,
b){var d;"function"===typeof a?d=[a]:(d=a instanceof Array?a.slice():"object"===typeof a?[].slice.call(arguments):[{property:a,descending:b}],d=l.map(d,function(a){a=r.mixin({},a);a.descending=!!a.descending;return a}),d=[d]);return d}}),select:new f({type:"select"}),_getQuerierFactory:function(a){return this["_create"+(a[0].toUpperCase()+a.substr(1))+"Querier"]}})})},"dstore/QueryMethod":function(){define([],function(){return function(r){var l=r.type,q=r.normalizeArguments,p=r.applyQuery,e=r.querierFactory;
return function(){var m=Array.prototype.slice.call(arguments),n=q?q.apply(this,m):m,m={type:l,arguments:m,normalizedArguments:n},f=this._getQuerierFactory(l)||e;f&&(m.querier=f.apply(this,n));n=this._createSubCollection({queryLog:this.queryLog.concat(m)});return p?p.call(this,n,m):n}}})},"dstore/Filter":function(){define(["dojo/_base/declare"],function(r){function l(p){return function(){var e=this.constructor,m=new e;m.type=p;m.args=Array.prototype.slice.call(arguments);return this.type?l("and").call(e.prototype,
this,m):m}}function q(l){return function(){for(var e=this.constructor,m=[],n=0;n<arguments.length;n++){var f=arguments[n];m.push(f instanceof e?f:new e(f))}e=new e;e.type=l;e.args=m;this.type===l?e.args=this.args.concat(m):this.type?m.unshift(this):1===m.length&&(e.type=m[0].type,e.args=m[0].args.slice());return e}}r=r(null,{constructor:function(l){var e=typeof l;switch(e){case "object":var e=this,m;for(m in l)var n=l[m],e=n instanceof this.constructor?e[n.type](m,n.args[0]):n&&n.test?e.match(m,n):
e.eq(m,n);this.type=e.type;this.args=e.args;break;case "function":case "string":this.type=e,this.args=[l]}},and:q("and"),or:q("or"),eq:l("eq"),ne:l("ne"),lt:l("lt"),lte:l("lte"),gt:l("gt"),gte:l("gte"),contains:l("contains"),"in":l("in"),match:l("match")});r.filterCreator=l;r.logicalOperatorCreator=q;return r})},"dstore/Memory":function(){define("dojo/_base/declare dojo/_base/array ./Store ./Promised ./SimpleQuery ./QueryResults".split(" "),function(r,l,q,p,e,m){return r([q,p,e],{constructor:function(){this.storage.version=
0},postscript:function(){this.inherited(arguments);this.setData(this.data||[])},data:null,autoEmitEvents:!1,getSync:function(e){return this.storage.fullData[this.storage.index[e]]},putSync:function(e,f){f=f||{};var m=this.storage,a=m.index,b=m.fullData,d=this.Model;!d||e instanceof d||(e=this._restore(e));var g=this.getIdentity(e);null==g&&(this._setIdentity(e,"id"in f?f.id:Math.random()),g=this.getIdentity(e));m.version++;var m=g in a?"update":"add",d={target:e},h;if("update"===m){if(!1===f.overwrite)throw Error("Object already exists");
b.splice(h=a[g],1);g=h}else g=this.defaultNewToStart?0:b.length;var c;if("beforeId"in f){var k=f.beforeId;null===k?c=b.length:(c=a[k],h<c&&--c);void 0!==c?d.beforeId=k:(console.error("options.beforeId was specified but no corresponding index was found"),c=g)}else c=g;b.splice(c,0,e);h=isFinite(h)?Math.min(h,c):c;for(g=b.length;h<g;++h)a[this.getIdentity(b[h])]=h;this.emit(m,d);return e},addSync:function(e,f){(f=f||{}).overwrite=!1;return this.putSync(e,f)},removeSync:function(e){var f=this.storage,
m=f.index,f=f.fullData;if(e in m)return m=f.splice(m[e],1)[0],this._reindex(),!0!==this._ignoreChangeEvents&&this.emit("delete",{id:e,target:m}),!0},setData:function(e){this.parse&&(e=this.parse(e));e.items&&(this.idProperty=e.identifier||this.idProperty,e=e.items);this.storage.fullData=this.data=e;this._reindex()},_reindex:function(){for(var e=this.storage,f=e.index={},m=e.fullData,a=this.Model,b=Object.prototype,d=0,g=m.length;d<g;d++){var h=m[d];if(a&&!(h instanceof a)){var c=this._restore(h,h.__proto__===
b);h!==c&&(m[d]=h=c)}f[this.getIdentity(h)]=d}e.version++},fetchSync:function(){var e=this.data;if(!e||e._version!==this.storage.version){for(var e=this.storage.fullData,f=this.queryLog,l=0,a=f.length;l<a;l++)e=f[l].querier(e);e._version=this.storage.version;this.data=e}return new m(e)},fetchRangeSync:function(e){var f=this.fetchSync();return new m(f.slice(e.start,e.end),{totalLength:f.length})},_includePropertyInSubCollection:function(e){return"data"!==e&&this.inherited(arguments)}})})},"dstore/Promised":function(){define(["dojo/_base/declare",
"dojo/Deferred","./QueryResults","dojo/when"],function(r,l,q,p){function e(e,n){return function(){var f=new l;try{f.resolve(this[e].apply(this,arguments))}catch(u){f.reject(u)}return n?(f=new q(f.promise),f.totalLength=p(f.totalLength),f):f.promise}}return r(null,{get:e("getSync"),put:e("putSync"),add:e("addSync"),remove:e("removeSync"),fetch:e("fetchSync",!0),fetchRange:e("fetchRangeSync",!0)})})},"dstore/QueryResults":function(){define(["dojo/_base/lang","dojo/when"],function(r,l){function q(p,
e){return l(this,function(m){for(var l=0,f=m.length;l<f;l++)p.call(e,m[l],l,m)})}return function(l,e){var m=e&&"totalLength"in e;if(l.then){l=r.delegate(l);var n=l.then(function(f){var l=m?e.totalLength:f.totalLength||f.length;f.totalLength=l;return!m&&l});l.totalLength=m?e.totalLength:n;l.response=e&&e.response}else l.totalLength=m?e.totalLength:l.length;l.forEach=q;return l}})},"dstore/SimpleQuery":function(){define(["dojo/_base/declare","dojo/_base/array"],function(r,l){function q(e,m){if(-1<e.indexOf(".")){var l=
e.split("."),f=l.length;return function(e){for(var a=0;a<f;a++)e=e&&(m&&e.get?e.get(l[a]):e[l[a]]);return e}}return function(f){return f.get?f.get(e):f[e]}}var p={eq:function(e,m){return e===m},"in":function(e,m){return-1<l.indexOf(m.data||m,e)},ne:function(e,m){return e!==m},lt:function(e,m){return e<m},lte:function(e,m){return e<=m},gt:function(e,m){return e>m},gte:function(e,m){return e>=m},match:function(e,m,l){return m.test(e,l)},contains:function(e,m,n,f){var q=this;return l.every(m.data||m,
function(a){if("object"===typeof a&&a.type){var b=q._getFilterComparator(a.type);return l.some(e,function(d){return b.call(q,d,a.args[1],n,f)})}return-1<l.indexOf(e,a)})}};return r(null,{_createFilterQuerier:function(e){function m(a){var b=a.type;a=a.args;var d=f._getFilterComparator(b);if(d){var e=a[0],h=q(e,n),c=a[1];c&&c.fetchSync&&(c=c.fetchSync());return function(a){return d.call(f,h(a),c,a,e)}}switch(b){case "and":case "or":for(var k=0,l=a.length;k<l;k++){var r=m(a[k]);p=p?function(a,c){return"and"===
b?function(b){return a(b)&&c(b)}:function(b){return a(b)||c(b)}}(p,r):r}return p;case "function":return a[0];case "string":k=f[a[0]];if(!k)throw Error("No filter function "+a[0]+" was found in the collection");return k;case void 0:return function(){return!0};default:throw Error('Unknown filter operation "'+b+'"');}}var n=this.queryAccessors,f=this,p=m(e);return function(a){return l.filter(a,p)}},_getFilterComparator:function(e){return p[e]||this.inherited(arguments)},_createSelectQuerier:function(e){return function(m){var n=
e.length;return l.map(m,e instanceof Array?function(f){for(var m={},a=0;a<n;a++){var b=e[a];m[b]=f[b]}return m}:function(f){return f[e]})}},_createSortQuerier:function(e){var m=this.queryAccessors;return function(l){l=l.slice();l.sort("function"==typeof e?e:function(f,l){for(var a=0;a<e.length;a++){var b,d=e[a];if("function"==typeof d)b=d(f,l);else{b=d.get||(d.get=q(d.property,m));var d=d.descending,g=b(f);b=b(l);null!=g&&(g=g.valueOf());null!=b&&(b=b.valueOf());b=g===b?0:!!d===(null===g||g>b&&null!==
b)?-1:1}if(0!==b)return b}return 0});return l}}})})},"dstore/Tree":function(){define(["dojo/_base/declare"],function(r){return r(null,{constructor:function(){this.root=this},mayHaveChildren:function(l){return"hasChildren"in l?l.hasChildren:!0},getRootCollection:function(){return this.root.filter({parent:null})},getChildren:function(l){return this.root.filter({parent:this.getIdentity(l)})}})})},"dstore/Cache":function(){define("dojo/_base/array dojo/when dojo/_base/declare dojo/_base/lang ./Store ./Memory ./QueryResults".split(" "),
function(r,l,q,p,e,m,n){function f(a){return function(){var d=this.inherited(arguments),f=this.cachingCollection||this.cachingStore;d.cachingCollection=f[a].apply(f,arguments);d.isValidFetchCache=!0===this.canCacheQuery||this.canCacheQuery(a,arguments);return d}}function u(a){a.cachingStore||(a.cachingStore=new m);a.cachingStore.Model=a.Model;a.cachingStore.idProperty=a.idProperty}var a={cachingStore:null,constructor:function(){u(this)},canCacheQuery:function(a,d){return!1},isAvailableInCache:function(){return this.isValidFetchCache&&
(this.allLoaded||this.fetchRequest)||this._parent&&this._parent.isAvailableInCache()},fetch:function(){return this._fetch(arguments)},fetchRange:function(){return this._fetch(arguments,!0)},_fetch:function(a,d){var f=this.cachingStore,e=this.cachingCollection||f,c=this,k=this.isAvailableInCache();if(k)return new n(l(k,function(){return c.isAvailableInCache()?d?e.fetchRange(a[0]):e.fetch():c.inherited(a)}));k=this.fetchRequest=this.inherited(a);l(k,function(a){var b=!d;c.fetchRequest=null;r.forEach(a,
function(a){!c.isLoaded||c.isLoaded(a)?f.put(a):b=!1});b&&(c.allLoaded=!0);return a});return k},isValidFetchCache:!1,get:function(a,d){var f=this.cachingStore,e=this.getInherited(arguments),c=this;return l(this.fetchRequest,function(){return l(f.get(a),function(k){if(void 0!==k)return k;if(e)return l(e.call(c,a,d),function(c){c&&f.put(c,{id:a});return c})})})},add:function(a,d){var f=this.cachingStore;return l(this.inherited(arguments),function(e){var c=f.put(e&&"object"===typeof e?e:a,d);return e||
c})},put:function(a,d){var f=this.cachingStore;f.remove(d&&d.id||this.getIdentity(a));return l(this.inherited(arguments),function(e){var c=f.put(e&&"object"===typeof e?e:a,d);return e||c})},remove:function(a,d){var e=this.cachingStore;return l(this.inherited(arguments),function(f){return l(e.remove(a,d),function(){return f})})},evict:function(a){this.allLoaded=!1;return this.cachingStore.remove(a)},invalidate:function(){this.allLoaded=!1},_createSubCollection:function(){var a=this.inherited(arguments);
a._parent=this;return a},sort:f("sort"),filter:f("filter"),select:f("select"),_getQuerierFactory:function(a){var d=this.cachingStore;return this.inherited(arguments)||p.hitch(d,d._getQuerierFactory(a))}};e=q(null,a);e.create=function(b,d){b=q.safeMixin(p.delegate(b),a);q.safeMixin(b,d);u(b);return b};return e})},"dstore/Trackable":function(){define("dojo/_base/lang dojo/_base/declare dojo/aspect dojo/when dojo/promise/all dojo/_base/array dojo/on".split(" "),function(r,l,q,p,e,m,n){function f(a,d,
e){for(var f=a.length-1;0<=f;--f){var c=a[f],k=c.start,c=k+c.count;if(d>c){a.splice(f+1,0,{start:d,count:e-d});return}e>=k&&(d=Math.min(d,k),e=Math.max(e,c),a.splice(f,1))}a.unshift({start:d,count:e-d})}var u=0,a={track:function(){function a(){return function(){var a=this,b=this.inherited(arguments);p(b,function(b){b=a._results=b.slice();a._partialResults&&(a._partialResults=null);a._ranges=[];f(a._ranges,0,b.length)});return b}}function d(){return function(a){var b=this,c=a.start,d=a.end,e=this.inherited(arguments);
this._results||p(e,function(a){return p(a.totalLength,function(e){var h=b._partialResults||(b._partialResults=[]);d=Math.min(d,c+a.length);h.length=e;e=[c,d-c].concat(a);h.splice.apply(h,e);f(b._ranges,c,d);return a})});return e}}function e(a,b){u++;var c=b.target;b=r.delegate(b,C[a]);p(z._results||z._partialResults,function(d){if(d){var e,f,g,k=z._ranges,l,n="id"in b?b.id:h.getIdentity(c),q=-1,p=-1,r=-1,u=-1;if("delete"===a||"update"===a)for(e=0;-1===q&&e<k.length;++e)for(l=k[e],f=l.start,g=f+l.count;f<
g;++f)if(h.getIdentity(d[f])==n){q=b.previousIndex=f;p=e;d.splice(q,1);l.count--;for(f=e+1;f<k.length;++f)k[f].start--;break}if("add"===a||"update"===a){if(A){if(A([c]).length){var t=0;g=k.length-1;f=-1;for(var C;t<=g&&-1===r;)e=t+Math.round((g-t)/2),l=k[e],p=d.slice(l.start,l.start+l.count),"beforeId"in b&&(f=null===b.beforeId?p.length:B(p,b.beforeId)),-1===f&&(f=q>=Math.max(0,l.start-1)&&q<=l.start+l.count?q:h.defaultNewToStart?0:p.length),p.splice(f,0,c),n=m.indexOf(A(p),c),C=l.start+n,0===n&&
0!==l.start?g=e-1:n>=p.length-1&&C<d.length?t=e+1:(r=C,u=e);if(-1===r&&0<t&&t<k.length)var K=!0}}else{f=-1;if("beforeId"in b)if(null===b.beforeId)r=d.length,f=k.length-1;else for(e=0,g=k.length;-1===u&&e<g;++e)l=k[e],r=B(d,b.beforeId,l.start,l.start+l.count),-1!==r&&(u=e);else"update"===a?(r=q,u=p):h.defaultNewToStart?f=r=0:(r=d.length,f=k.length-1);-1!==f&&-1===u&&(l=k[f])&&l.start<=r&&r<=l.start+l.count&&(u=f)}if(-1<r&&-1<u)for(b.index=r,d.splice(r,0,c),k[u].count++,e=u+1;e<k.length;++e)k[e].start++;
else if(K)for(b.beforeIndex=k[t].start,e=t;e<k.length;++e)k[e].start++}b.totalLength=d.length}(d=z["on_tracked"+a])&&d.call(z,b)})}var h=this.store||this,c=[],k={add:1,update:1,"delete":1},t;for(t in k)c.push(this.on(t,function(a){return function(b){e(a,b)}}(t)));var z=l.safeMixin(r.delegate(this),{_ranges:[],fetch:a(),fetchRange:d(),releaseRange:function(a,b){if(this._partialResults){a:for(var c=this._ranges,d=0,e;e=c[d];++d){var f=e.start,g=f+e.count;if(a<=f)if(b>=g)c.splice(d,1);else{e.start=b;
e.count=g-e.start;break a}else if(a<g)if(b>f){c.splice(d,1,{start:f,count:a-f},{start:b,count:g-b});break a}else e.count=a-e.start}for(c=a;c<b;++c)delete this._partialResults[c]}},on:function(a,b){var c=this,d=this.getInherited(arguments);return n.parse(z,a,b,function(a,e){return e in k?q.after(z,"on_tracked"+e,b,!0):d.call(c,e,b)})},tracking:{remove:function(){for(;0<c.length;)c.pop().remove();this.remove=function(){}}},track:null});this.fetchSync&&(l.safeMixin(z,{fetchSync:a(),fetchRangeSync:d()}),
z.fetchSync());var A;m.forEach(this.queryLog,function(a){var b=A,c=a.querier;c&&(A=b?function(a){return c(b(a))}:c)});var C={add:{index:void 0},update:{previousIndex:void 0,index:void 0},"delete":{previousIndex:void 0}},B=function(a,b,c,d){d=void 0!==d?d:a.length;for(c=void 0!==c?c:0;c<d;++c)if(h.getIdentity(a[c])===b)return c;return-1};return z}};e=l(null,a);e.create=function(b,d){b=l.safeMixin(r.delegate(b),a);l.safeMixin(b,d);return b};return e})},"dstore/legacy/DstoreAdapter":function(){define(["dojo/_base/declare",
"dojo/_base/array","dojo/store/util/QueryResults"],function(r,l,q){function p(e){return e}var e={store:null,constructor:function(e){this.store=e;if(e._getQuerierFactory("filter")||e._getQuerierFactory("sort"))this.queryEngine=function(f,n){n=n||{};var a=e._getQuerierFactory("filter"),b=a?a(f):p,a=e._getQuerierFactory("sort"),d=p;a&&(d=a(l.map(n.sort,function(a){return{property:a.attribute,descending:a.descending}})));var g=p;isNaN(n.start)&&isNaN(n.count)||(g=function(a){var b=n.start||0,b=a.slice(b,
b+(n.count||Infinity));b.total=a.length;return b});return function(a){return g(d(b(a)))}};var n=this;e.on("add,update,delete",function(f){var l=f.type,a=f.target;n.notify("add"===l||"update"===l?a:void 0,"delete"===l||"update"===l?"id"in f?f.id:e.getIdentity(a):void 0)})},labelAttr:"title",getLabel:function(e){return this.store.getLabel(e)},query:function(e,l){l=l||{};var f=this.store.filter(e),p,a,b;if(b=l.sort)if("[object Array]"===Object.prototype.toString.call(b))for(var d;d=b.pop();)f=f.sort(d.attribute,
d.descending);else f=f.sort(b);f.track&&!f.tracking&&(f=f.track(),a=!0);"start"in l&&(p=l.start||0,p=f[f.fetchRangeSync?"fetchRangeSync":"fetchRange"]({start:p,end:l.count?p+l.count:Infinity}));p=p||f[f.fetchSync?"fetchSync":"fetch"]();b=p.totalLength;p=new q(p);p.total=b;p.observe=function(b,d){function c(b){return void 0===b&&a?-1:b}var e=f.on("add",function(a){b(a.target,-1,c(a.index))}),l=f.on("update",function(a){!d&&a.previousIndex===a.index&&isFinite(a.index)||b(a.target,c(a.previousIndex),
c(a.index))}),m=f.on("delete",function(a){b(a.target,c(a.previousIndex),-1)}),n={remove:function(){e.remove();l.remove();m.remove()}};n.cancel=n.remove;return n};return p},notify:function(){}};l.forEach(["get","put","add","remove","getIdentity"],function(l){e[l]=function(){var e=this.store;return(e[l+"Sync"]||e[l]).apply(e,arguments)}});return r(null,e)})}}});
//# sourceMappingURL=dgrid.js.map