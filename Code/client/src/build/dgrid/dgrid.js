//>>built
require({cache:{"dgrid/main":function(){define("dgrid/Tree dgrid/Selection dgrid/OnDemandList dgrid/OnDemandGrid dgrid/extensions/ColumnReorder dgrid/extensions/ColumnResizer dgrid/extensions/CompoundColumns dgrid/extensions/Pagination dgrid/extensions/DnD dgrid/Editor dstore/Store dstore/Memory dstore/Tree dstore/Cache dstore/Trackable dstore/legacy/DstoreAdapter".split(" "),function(){})},"dgrid/Tree":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/aspect dojo/dom-construct dojo/dom-class dojo/on dojo/query dojo/when ./util/has-css3 ./Grid ./util/touch".split(" "),
function(t,p,n,m,h,e,l,k,u,a,b,d){return t(null,{collapseOnRefresh:!1,enableTreeTransitions:!1,treeIndentWidth:9,constructor:function(){this._treeColumnListeners=[]},shouldExpand:function(a,b,c){return c},expand:function(b,d,c){function f(f){!0===C.spin&&f.mayHaveChildren&&(e.remove(f,"fa-spin fa-spinner dgrid-cell-loading"),e.replace(f,"ui-icon-triangle-1-"+(v?"se":"e"),"ui-icon-triangle-1-"+(v?"e":"se")))}if(this._treeColumn){var q=this,g=b.element?b:this.row(b),r=!!this._expanded[g.id],G=a("transitionend"),
n,C=this.collection;if(b=g.element){b=-1<b.className.indexOf("dgrid-expando-icon")?b:k(".dgrid-expando-icon",b)[0];c=c||!this.enableTreeTransitions;if(b&&b.mayHaveChildren&&(c||d!==r)){var v=void 0===d?!this._expanded[g.id]:d;!0===C.spin&&d?(e.remove(b,"ui-icon-triangle-1-e"),e.remove(b,"ui-icon-triangle-1-se"),e.add(b,"fa fa-spinner fa-spin dgrid-cell-loading")):e.replace(b,"ui-icon-triangle-1-"+(v?"se":"e"),"ui-icon-triangle-1-"+(v?"e":"se"));e.toggle(g.element,"dgrid-row-expanded",v);d=g.element;
var m=d.connected,w,y,t={};if(!m){var m=t.container=d.connected=h.create("div",{className:"dgrid-tree-container"},d,"after"),z=function(f){var c=q._renderedCollection.getChildren(g.data);q.sort&&(c=c.sort(q.sort));c.track&&q.shouldTrackCollection&&(m._rows=f.rows=[],c=c.track(),m._handles=[c.tracking,q._observeCollection(c,m,f)]);return"start"in f?c.fetchRange({start:f.start,end:f.start+f.count}):c.fetch()};"level"in b&&(z.level=b.level);if(this.renderQuery)n=this.renderQuery(z,t);else{var E=h.create("div",
null,m);n=this._trackError(function(){return q.renderQueryResults(z(t),E,p.mixin({rows:t.rows},"level"in z?{queryLevel:z.level}:null)).then(function(f){h.destroy(E);return f})})}G&&l(m,G,this._onTreeTransitionEnd)}m.hidden=!v;w=m.style;!G||c?(w.display=v?"block":"none",w.height=""):(v?(w.display="block",y=m.scrollHeight,w.height="0px"):(e.add(m,"dgrid-tree-resetting"),w.height=m.scrollHeight+"px"),setTimeout(function(){e.remove(m,"dgrid-tree-resetting");w.height=v?y?y+"px":"auto":"0px"},0));v?this._expanded[g.id]=
!0:delete this._expanded[g.id]}n&&n.then?n.then(function(){f(b)}):f(b);return u(n)}}},_configColumns:function(){var a=this.inherited(arguments);this._expanded={};for(var b=0,c=a.length;b<c;b++)if(a[b].renderExpando){this._configureTreeColumn(a[b]);break}return a},insertRow:function(a){var b=this.inherited(arguments),c=this.row(b);(c=this.shouldExpand(c,this._currentLevel,this._expanded[c.id]))&&this.expand(b,!0,!0);(c||!this.collection.mayHaveChildren||this.collection.mayHaveChildren(a))&&e.add(b,
"dgrid-row-expandable");return b},removeRow:function(a,b){var c=a.connected,f={};c&&(c._handles&&(n.forEach(c._handles,function(f){f.remove()}),delete c._handles),c._rows&&(f.rows=c._rows),k("\x3e.dgrid-row",c).forEach(function(c){this.removeRow(c,!0,f)},this),c._rows&&(c._rows.length=0,delete c._rows),b||h.destroy(c));this.inherited(arguments)},_refreshCellFromItem:function(a,b){if(!a.column.renderExpando)return this.inherited(arguments);this.inherited(arguments,[a,b,{queryLevel:k(".dgrid-expando-icon",
a.element)[0].level-1}])},cleanup:function(){this.inherited(arguments);this.collapseOnRefresh&&(this._expanded={})},_destroyColumns:function(){this.inherited(arguments);for(var a=this._treeColumnListeners,b=a.length;b--;)a[b].remove();this._treeColumnListeners=[];this._treeColumn=null},_calcRowHeight:function(a){var b=a.connected;return this.inherited(arguments)+(b?b.offsetHeight:0)},_configureTreeColumn:function(b){var g=this,c=this.collection,f=".dgrid-content .dgrid-column-"+b.id,q;this._treeColumn=
b;if(!b._isConfiguredTreeColumn){var x=b.renderCell||this._defaultRenderCell;b._isConfiguredTreeColumn=!0;b.renderCell=function(f,a,q,d){if(c){var r=Number(d&&d.queryLevel)+1,k=!c.mayHaveChildren||c.mayHaveChildren(f),e,r=g._currentLevel=isNaN(r)?0:r;e=b.renderExpando(r,k,g._expanded[c.getIdentity(f)],f);e.level=r;e.mayHaveChildren=k;(f=x.call(b,f,a,q,d))&&f.nodeType?(q.appendChild(e),q.appendChild(f)):q.insertBefore(e,q.firstChild)}};"function"!==typeof b.renderExpando&&(b.renderExpando=this._defaultRenderExpando)}var k=
this._treeColumnListeners;0===k.length&&(k.push(this.on(b.expandOn||".dgrid-expando-icon:click,"+f+":dblclick,"+f+":keydown",function(f){var c=g.row(f);g.collection.mayHaveChildren&&!g.collection.mayHaveChildren(c.data)||"keydown"===f.type&&32!==f.keyCode||"dblclick"===f.type&&q&&1<q.count&&c.id===q.id&&-1<f.target.className.indexOf("dgrid-expando-icon")||g.expand(c);-1<f.target.className.indexOf("dgrid-expando-icon")&&(q&&q.id===g.row(f).id?q.count++:q={id:g.row(f).id,count:1})})),a("touch")&&k.push(this.on(d.selector(f,
d.dbltap),function(){g.expand(this)})))},_defaultRenderExpando:function(a,b,c){var f=this.grid.isRTL?"right":"left",q="dgrid-expando-icon";b&&(q+=" ui-icon ui-icon-triangle-1-"+(c?"se":"e"));return h.create("div",{className:q,innerHTML:"\x26nbsp;",style:"margin-"+f+": "+a*this.grid.treeIndentWidth+"px; float: "+f+";"})},_onNotification:function(a,b){"delete"===b.type&&delete this._expanded[b.id];this.inherited(arguments)},_onTreeTransitionEnd:function(a){var b=this,c=this.style.height;c&&(this.style.display=
"0px"===c?"none":"block");a&&(e.add(this,"dgrid-tree-resetting"),setTimeout(function(){e.remove(b,"dgrid-tree-resetting")},0));this.style.height=""}})})},"dgrid/util/has-css3":function(){define(["dojo/has"],function(t){function p(m,h){m=m.style;var e;if(h in m)return!0;h=h.slice(0,1).toUpperCase()+h.slice(1);for(e=n.length;e--;)if(n[e]+h in m)return n[e];return!1}var n=["ms","O","Moz","Webkit"];t.add("css-transitions",function(m,h,e){return p(e,"transitionProperty")});t.add("css-transforms",function(m,
h,e){return p(e,"transform")});t.add("css-transforms3d",function(m,h,e){return p(e,"perspective")});t.add("transitionend",function(){var m=t("css-transitions");return m?!0===m?"transitionend":{ms:"MSTransitionEnd",O:"oTransitionEnd",Moz:"transitionend",Webkit:"webkitTransitionEnd"}[m]:!1});return t})},"dgrid/Grid":function(){define("dojo/_base/declare dojo/_base/lang dojo/dom-construct dojo/dom-class dojo/on dojo/has ./List ./util/misc dojo/_base/sniff".split(" "),function(t,p,n,m,h,e,l,k){function u(a,
b){b&&b.nodeType&&a.appendChild(b)}t=t(l,{columns:null,hasNeutralSort:!1,cellNavigation:!0,tabableHeader:!0,showHeader:!0,column:function(a){return"object"!==typeof a?this.columns[a]:this.cell(a).column},listType:"grid",cell:function(a,b){if(a.column&&a.element)return a;a.target&&a.target.nodeType&&(a=a.target);var d;if(a.nodeType){do{if(this._rowIdToObject[a.id])break;var g=a.columnId;if(g){b=g;d=a;break}a=a.parentNode}while(a&&a!==this.domNode)}if(!d&&"undefined"!==typeof b){var r=this.row(a);if(g=
r&&r.element)for(var g=g.getElementsByTagName("td"),c=0;c<g.length;c++)if(g[c].columnId===b){d=g[c];break}}if(null!=a)return{row:r||this.row(a),column:b&&this.column(b),element:d}},createRowCells:function(a,b,d,g,r){var c=n.create("table",{className:"dgrid-row-table",role:"presentation"}),f=9>e("ie")?n.create("tbody",null,c):c,q,x,h,u,l,C,v,m,p,t;d=d||this.subRows;x=0;for(h=d.length;x<h;x++)for(C=d[x],q=n.create("tr",null,f),C.className&&(q.className=C.className),u=0,l=C.length;u<l;u++){v=C[u];m=
v.id;p=v.field?" field-"+k.escapeCssIdentifier(v.field,"-"):"";(t="function"===typeof v.className?v.className(g):v.className)&&(p+=" "+t);p=n.create(a,{className:"dgrid-cell"+(m?" dgrid-column-"+k.escapeCssIdentifier(m,"-"):"")+p,role:"th"===a?"columnheader":"gridcell"});p.columnId=m;if(m=v.colSpan)p.colSpan=m;if(m=v.rowSpan)p.rowSpan=m;b(p,v,g,r);q.appendChild(p)}return c},_createBodyRowCell:function(a,b,d,g){var r=d;b.get?r=b.get(d):"field"in b&&"_item"!==b.field&&(r=d[b.field]);b.renderCell?u(a,
b.renderCell(d,r,a,g)):this._defaultRenderCell.call(b,d,r,a,g)},_createHeaderRowCell:function(a,b){var d=b.headerNode=a,g=b.field;g&&(a.field=g);b.renderHeaderCell?u(d,b.renderHeaderCell(d)):("label"in b||b.field)&&d.appendChild(document.createTextNode("label"in b?b.label:b.field));!1!==b.sortable&&g&&"_item"!==g&&(a.sortable=!0,a.className+=" dgrid-sortable")},left:function(a,b){a.element||(a=this.cell(a));return this.cell(this._move(a,-(b||1),"dgrid-cell"))},right:function(a,b){a.element||(a=this.cell(a));
return this.cell(this._move(a,b||1,"dgrid-cell"))},_defaultRenderCell:function(a,b,d){if(this.formatter){var g=this.formatter,r=this.grid.formatterScope;d.innerHTML="string"===typeof g&&r?r[g](b,a):this.formatter(b,a)}else null!=b&&d.appendChild(document.createTextNode(b))},renderRow:function(a,b){a=this.createRowCells("td",p.hitch(this,"_createBodyRowCell"),b&&b.subRows,a,b);b=n.create("div",{role:"row"});b.appendChild(a);return b},renderHeader:function(){var a=this,b=this.headerNode;b.setAttribute("role",
"row");n.empty(b);var d=this.createRowCells("th",p.hitch(this,"_createHeaderRowCell"),this.subRows&&this.subRows.headerRows);this._rowIdToObject[d.id=this.id+"-header"]=this.columns;b.appendChild(d);this._sortListener&&this._sortListener.remove();this._sortListener=h(d,"click,keydown",function(d){if("click"===d.type||32===d.keyCode||!e("opera")&&13===d.keyCode){var g=d.target,c,f;do if(g.sortable){c=g.field||g.columnId;f=a.sort[0];c=a.hasNeutralSort&&f&&f.property===c&&f.descending?[]:[{property:c,
descending:f&&f.property===c&&!f.descending}];f={bubbles:!0,cancelable:!0,grid:a,parentType:d.type,sort:c};h.emit(d.target,"dgrid-sort",f)&&(a._sortNode=g,a.set("sort",c));break}while((g=g.parentNode)&&g!==b)}})},resize:function(){if(this.headerNode){var a=this.headerNode.firstChild,b=this.contentNode,d;this.inherited(arguments);b.style.width="";b&&a&&(d=a.offsetWidth)>b.offsetWidth&&(b.style.width=d+"px")}},destroy:function(){this._destroyColumns();this._sortListener&&this._sortListener.remove();
this.inherited(arguments)},_setSort:function(){this.inherited(arguments);this.updateSortArrow(this.sort)},_findSortArrowParent:function(a){var b=this.columns,d;for(d in b){var g=b[d];if(g.field===a)return g.headerNode}},updateSortArrow:function(a,b){this._lastSortedArrow&&(m.remove(this._lastSortedArrow.parentNode,"dgrid-sort-up dgrid-sort-down"),n.destroy(this._lastSortedArrow),delete this._lastSortedArrow);b&&(this.sort=a);a[0]&&(b=a[0].property,a=a[0].descending,b=this._sortNode||this._findSortArrowParent(b),
delete this._sortNode,b&&(b=b.contents||b,this._lastSortedArrow=n.create("div",{className:"dgrid-sort-arrow ui-icon",innerHTML:"\x26nbsp;",role:"presentation"},b,"first"),m.add(b,"dgrid-sort-"+(a?"down":"up")),this.resize()))},styleColumn:function(a,b){return this.addCssRule("#"+k.escapeCssIdentifier(this.domNode.id)+" .dgrid-column-"+k.escapeCssIdentifier(a,"-"),b)},_configColumns:function(a,b){var d=[],g=b instanceof Array;k.each(b,function(r,c){"string"===typeof r&&(b[c]=r={label:r});g||r.field||
(r.field=c);c=r.id=r.id||(isNaN(c)?c:a+c);this._configColumn&&(this._configColumn(r,b,a),c=r.id);g&&(this.columns[c]=r);r.grid=this;d.push(r)},this);return g?b:d},_destroyColumns:function(){this.cleanup()},configStructure:function(){var a=this.subRows,b=this._columns=this.columns;this.columns=!b||b instanceof Array?{}:b;if(a)for(b=0;b<a.length;b++)a[b]=this._configColumns(b+"-",a[b]);else this.subRows=[this._configColumns("",b)]},_getColumns:function(){return this._columns||this.columns},_setColumns:function(a){this._destroyColumns();
this.subRows=null;this.columns=a;this._updateColumns()},_setSubRows:function(a){this._destroyColumns();this.subRows=a;this._updateColumns()},_updateColumns:function(){this.configStructure();this.renderHeader();this.refresh();this._lastCollection&&this.renderArray(this._lastCollection);this._started&&(this.sort.length?(this._lastSortedArrow=null,this.updateSortArrow(this.sort)):this.resize())}});t.appendIfNode=u;return t})},"dgrid/List":function(){define("dojo/_base/declare dojo/dom-construct dojo/dom-class dojo/on dojo/has ./util/misc xide/$".split(" "),
function(t,p,n,m,h,e,l){function k(f,a){f.className="dgrid-scrollbar-measure";document.body.appendChild(f);a=f["offset"+a]-f["client"+a];f.className="";f.parentNode&&document.body.removeChild(f);return a}function u(f){n.replace(this.domNode,f,this._class||"");this._class=f}function a(){return this._class}var b=[];h("mozilla")&&b.push("has-mozilla");h("touch")&&b.push("has-touch");n.add(document.documentElement,b);h.add("pointer",function(f){return"PointerEvent"in f?"pointer":"MSPointerEvent"in f?
"MSPointer":!1});var d,g;h.add("dom-scrollbar-width",function(f,a,c){return k(c,"Width")});h.add("dom-scrollbar-height",function(f,a,c){return k(c,"Height")});h.add("dom-rtl-scrollbar-left",function(f,a,c){f=document.createElement("div");c.className="dgrid-scrollbar-measure";c.setAttribute("dir","rtl");c.appendChild(f);document.body.appendChild(c);a=!!h("ie")||!!h("trident")||/\bEdge\//.test(navigator.userAgent)||f.offsetLeft>=h("dom-scrollbar-width");c.className="";c.parentNode&&document.body.removeChild(c);
p.destroy(f);c.removeAttribute("dir");return a});var r=0,c=t(null,{tabableHeader:!1,showHeader:!1,showFooter:!1,maintainOddEven:!0,cleanAddedRules:!0,addUiClasses:!1,highlightDuration:250,postscript:function(f,c){var a=this;(this._Row=function(f,c,a){this.id=f;this.data=c;this.element=a}).prototype.remove=function(){a.removeRow(this.element)};c&&(this.srcNodeRef=c=c.nodeType?c:document.getElementById(c));this.create(f,c)},listType:"list",create:function(f,a){a=this.domNode=a||document.createElement("div");
var b;f&&(this.params=f,t.safeMixin(this,f),b=f["class"]||f.className||a.className);this.sort=this.sort||[];this._listeners=[];this._rowIdToObject={};this.postMixInProperties&&this.postMixInProperties();this.id=a.id=a.id||this.id||c.autoIdPrefix+r++;this.buildRendering();b&&u.call(this,b);this.postCreate();delete this.srcNodeRef},buildRendering:function(){var f=this.domNode,c=this.addUiClasses,a=this,b,d,g;g=this.isRTL="rtl"===(document.body.dir||document.documentElement.dir||document.body.style.direction).toLowerCase();
f.className="";f.setAttribute("role","grid");n.add(f,"dgrid dgrid-"+this.listType+(c?" ui-widget":""));b=this.headerNode=p.create("div",{tabIndex:-1,className:"dgrid-header dgrid-header-row"+(c?" ui-widget-header":"")+(this.showHeader?"":" dgrid-header-hidden")},f);d=this.bodyNode=p.create("div",{className:"dgrid-scroller"},f);h("ff")&&(d.tabIndex=-1);this.headerScrollNode=p.create("div",{className:"dgrid-header dgrid-header-scroll dgrid-scrollbar-width"+(c?" widget":"")},f);this.footerNode=p.create("div",
{className:"dgrid-footer"+(this.showFooter?"":" dgrid-footer-hidden")},f);g&&(f.className+=" dgrid-rtl"+(h("dom-rtl-scrollbar-left")?" dgrid-rtl-swap":""));m(d,"scroll",function(c){a.showHeader&&(b.scrollLeft=c.scrollLeft||d.scrollLeft);c.stopPropagation();m.emit(f,"scroll",{scrollTarget:d})});this.configStructure();this.renderHeader();this.contentNode=this.touchNode=p.create("div",{className:"dgrid-content"+(c?" widget":"")},this.bodyNode)},startup:function(){this._started||(this.inherited(arguments),
this._started=!0,this.set("sort",this.sort))},configStructure:function(){},resize:function(){var f=this.bodyNode,c=this.footerNode,c=this.showFooter?c.offsetHeight:0;this.headerScrollNode.style.height=f.style.marginTop=this.headerNode.offsetHeight+"px";f.style.marginBottom=c+"px";d||(d=h("dom-scrollbar-width"),g=h("dom-scrollbar-height"),h("ie")&&(d++,g++),17!==d&&e.addCssRule(".dgrid-rtl-swap .dgrid-header-row","left: "+d+"px"))},addCssRule:function(f,c){f=e.addCssRule(f,c);this.cleanAddedRules&&
this._listeners.push(f);return f},on:function(f,c){f=m(this.domNode,f,c);h("dom-addeventlistener")||this._listeners.push(f);return f},cleanup:function(){for(var f in this._rowIdToObject)if(this._rowIdToObject[f]!==this.columns){var c=document.getElementById(f);c&&this.removeRow(c,!0)}},destroy:function(){if(this._listeners){for(var f=this._listeners.length;f--;)this._listeners[f].remove();this._listeners=null}this._started=!1;this.cleanup();l(this.domNode).remove()},refresh:function(){this.cleanup();
this._rowIdToObject={};this._autoRowId=0;l(this.contentNode).empty()},adjustRowIndices:function(f){var c=f.rowIndex;if(-1<c){do-1<f.rowIndex&&(this.maintainOddEven&&n.contains(f,"dgrid-row")&&n.replace(f,1===c%2?"dgrid-row-odd":"dgrid-row-even",0===c%2?"dgrid-row-odd":"dgrid-row-even"),f.rowIndex=c++);while((f=f.nextSibling)&&f.rowIndex!==c)}},renderArray:function(f,c,a){a=a||{};var b=a.start||0,d=document.createDocumentFragment(),g=[],q=0,r=f.length;c||(this._lastCollection=f);for(;q<r;)g[q]=this.insertRow(f[q],
d,null,b++,a),q++;(f=c?c.parentNode:this.contentNode)&&f.parentNode&&(f!==this.contentNode||r)&&(f.insertBefore(d,c||null),r&&this.adjustRowIndices(g[r-1]));return g},renderHeader:function(){},_autoRowId:0,insertRow:function(f,c,a,b,d){var g=this.id+"-row-"+(this.collection&&this.collection.getIdentity?this.collection.getIdentity(f):this._autoRowId++),q=document.getElementById(g),r=q&&q.previousSibling;q&&(q===a&&(a=(a.connected||a).nextSibling),this.removeRow(q,!1,d));q=this.renderRow(f,d);q.className=
(q.className||"")+" dgrid-row "+(1===b%2?"dgrid-row-odd":"dgrid-row-even");this._rowIdToObject[q.id=g]=f;c.insertBefore(q,a||null);q.rowIndex=b;r&&r.rowIndex!==q.rowIndex-1&&this.adjustRowIndices(r);return q},renderRow:function(f){var c=document.createElement("div");c.appendChild(document.createTextNode(f));return c},removeRow:function(f,c){f=f.element||f;delete this._rowIdToObject[f.id];c||l(f).remove()},row:function(f){var c;if(f instanceof this._Row)return f;if(!f)return null;f.target&&f.target.nodeType&&
(f=f.target);if(f.nodeType){do{var a=f.id;if(c=this._rowIdToObject[a])return new this._Row(a.substring(this.id.length+5),c,f);f=f.parentNode}while(f&&f!==this.domNode)}else return"object"===typeof f?c=this.collection.getIdentity(f):(c=f,f=this._rowIdToObject[this.id+"-row-"+c]),new this._Row(c,f,document.getElementById(this.id+"-row-"+c))},cell:function(f){return{row:this.row(f)}},_move:function(f,c,a,b){var d,g;g=d=f.element;c=c||1;do if(f=d[0>c?"previousSibling":"nextSibling"]){do if((d=f)&&-1<
(d.className+" ").indexOf(a+" ")){g=d;c+=0>c?1:-1;break}while(f=(!b||!d.hidden)&&d[0>c?"lastChild":"firstChild"])}else if(d=d.parentNode,!d||d===this.bodyNode||d===this.headerNode)break;while(c);return g},up:function(c,a,b){c.element||(c=this.row(c));return this.row(this._move(c,-(a||1),"dgrid-row",b))},down:function(c,a,b){c.element||(c=this.row(c));return this.row(this._move(c,a||1,"dgrid-row",b))},scrollTo:function(c){"undefined"!==typeof c.x&&(this.bodyNode.scrollLeft=c.x);"undefined"!==typeof c.y&&
(this.bodyNode.scrollTop=c.y)},getScrollPosition:function(){return{x:this.bodyNode.scrollLeft,y:this.bodyNode.scrollTop}},get:function(c){var f="_get"+c.charAt(0).toUpperCase()+c.slice(1);return"function"===typeof this[f]?this[f].apply(this,[].slice.call(arguments,1)):this[c]},set:function(c,a){if("object"===typeof c)for(var f in c)this.set(f,c[f]);else f="_set"+c.charAt(0).toUpperCase()+c.slice(1),"function"===typeof this[f]?this[f].apply(this,[].slice.call(arguments,1)):this[c]=a;return this},_getClass:a,
_setClass:u,_getClassName:a,_setClassName:u,_setSort:function(c,a){this.sort="string"!==typeof c?c:[{property:c,descending:a}];this._applySort()},_applySort:function(){this.refresh();if(this._lastCollection){var c=this.sort;if(c&&0<c.length){var a=c[0].property,b=!!c[0].descending;this._lastCollection.sort(function(c,f){c=c[a];f=f[a];void 0===c&&(c="");void 0===f&&(f="");return c===f?0:c>f!==b?1:-1})}this.renderArray(this._lastCollection)}},_setShowHeader:function(c){var a=this.headerNode;this.showHeader=
c;n.toggle(a,"dgrid-header-hidden",!c);this.renderHeader();this.resize();c&&(a.scrollLeft=this.getScrollPosition().x)},_setShowFooter:function(c){this.showFooter=c;n.toggle(this.footerNode,"dgrid-footer-hidden",!c);this.resize()}});c.autoIdPrefix="dgrid_";return c})},"dgrid/util/misc":function(){define(["dojo/has"],function(t){t.add("dom-contains",function(k,e,a){return!!a.contains});var p=[],n,m,h,e=/([^A-Za-z0-9_\u00A0-\uFFFF-])/g,l={defaultDelay:15,throttle:function(k,e,a){var b=!1;a=a||l.defaultDelay;
return function(){b||(b=!0,k.apply(e,arguments),setTimeout(function(){b=!1},a))}},throttleDelayed:function(k,e,a){var b=!1;a=a||l.defaultDelay;return function(){if(!b){b=!0;var d=arguments;setTimeout(function(){b=!1;k.apply(e,d)},a)}}},debounce:function(e,h,a){var b;a=a||l.defaultDelay;return function(){b&&(clearTimeout(b),b=null);var d=arguments;b=setTimeout(function(){e.apply(h,d)},a)}},each:function(e,h,a){var b,d;if(e)if("number"===typeof e.length)for(b=0,d=e.length;b<d;b++)h.call(a,e[b],b,e);
else for(b in e)h.call(a,e[b],b,e)},contains:function(e,h){return t("dom-contains")?e.contains(h):e.compareDocumentPosition(h)&8},addCssRule:function(e,l){n||(n=document.createElement("style"),document.getElementsByTagName("head")[0].appendChild(n),n=n.sheet||n.styleSheet,m=n.deleteRule?"deleteRule":"removeRule",h=n.cssRules?"cssRules":"rules");var a=p.length;p[a]=(n.cssRules||n.rules).length;n.addRule?n.addRule(e,l):n.insertRule(e+"{"+l+"}",p[a]);return{get:function(b){return n[h][p[a]].style[b]},
set:function(b,d){"undefined"!==typeof p[a]&&(n[h][p[a]].style[b]=d)},remove:function(){var b=p[a],d,g;if(void 0!==b)for(n[m](b),p[a]=void 0,d=a+1,g=p.length;d<g;d++)p[d]>b&&p[d]--}}},escapeCssIdentifier:function(k,h){return"string"===typeof k?k.replace(e,h||"\\$1"):k}};return l})},"dgrid/util/touch":function(){define(["dojo/on"],function(t,p){function n(h,e,l,k){if(!(1<l.targetTouches.length)){var u=l.changedTouches[0],a=u.screenX,b=u.screenY;k&&l.preventDefault();var d=t(h,"touchend",function(g){var r=
g.changedTouches[0];g.targetTouches.length||(Math.abs(r.screenX-a)<m.tapRadius&&Math.abs(r.screenY-b)<m.tapRadius&&(k&&g.preventDefault(),e.call(this,g)),d.remove())})}}var m={tapRadius:10,dbltapTime:250,selector:function(h,e,l){return function(k,u){var a=e.bubble;a?e=a:!1!==l&&(l=!0);return t(k,e,function(a){var b=a.target;3===b.nodeType&&(b=b.parentNode);for(;!p.matches(b,h,k);)if(b===k||!l||!(b=b.parentNode))return;return u.call(b,a)})}},countCurrentTouches:function(h,e){if(!("touches"in h))return-1;
var l,k,u;for(k=l=0;u=h.touches[l];++l)e.contains(u.target)&&++k;return k},tap:function(h,e){return t(h,"touchstart",function(l){n(h,e,l)})},dbltap:function(h,e){var l,k;return t(h,"touchstart",function(u){l?n(h,function(a){if(l){var b=a.changedTouches[0];Math.abs(b.screenX-l.screenX)<m.tapRadius&&Math.abs(b.screenY-l.screenY)<m.tapRadius&&(k&&clearTimeout(k),l=k=null,e.call(this,a))}},u,!0):n(h,function(a){l=a.changedTouches[0];k=setTimeout(function(){l=k=null},m.dbltapTime)},u)})}};return m})},
"dgrid/Selection":function(){define("dojo/_base/declare dojo/dom-class dojo/on dojo/has dojo/aspect ./List dgrid/util/touch dojo/query dojo/_base/sniff dojo/dom".split(" "),function(t,p,n,m,h,e,l){function k(c,a){a=c.unselectable=a?"on":"";c=c.getElementsByTagName("*");for(var f=c.length;--f;)"INPUT"!==c[f].tagName&&"TEXTAREA"!==c[f].tagName&&(c[f].unselectable=a)}function u(c,a){var f=c.bodyNode,d=a?"text":21>m("ff")?"-moz-none":"none";b&&"msUserSelect"!==b?f.style[b]=d:m("dom-selectstart")?a||c._selectstartHandle?
a&&c._selectstartHandle&&(c._selectstartHandle.remove(),delete c._selectstartHandle):c._selectstartHandle=n(f,"selectstart",function(c){var a=c.target&&c.target.tagName;"INPUT"!==a&&"TEXTAREA"!==a&&c.preventDefault()}):(k(f,!a),a||c._unselectableHandle)?a&&c._unselectableHandle&&(c._unselectableHandle.remove(),delete c._unselectableHandle):c._unselectableHandle=h.after(c,"renderRow",function(c){k(c,!0);return c})}m.add("dom-comparedocumentposition",function(c,a,b){return!!b.compareDocumentPosition});
m.add("dom-selectstart","undefined"!==typeof document.onselectstart);var a=m("mac")?"metaKey":"ctrlKey",b=m("css-user-select"),d=(e=m("pointer"))&&"MS"===e.slice(0,2),g=e?e+(d?"Down":"down"):"mousedown",r=e?e+(d?"Up":"up"):"mouseup";"WebkitUserSelect"===b&&"undefined"!==typeof document.documentElement.style.msUserSelect&&(b=!1);return t(null,{selectionDelegate:".dgrid-row",selectionEvents:g+","+r+",dgrid-cellfocusin",selectionTouchEvents:m("touch")?l.tap:null,deselectOnRefresh:!0,allowSelectAll:!1,
selection:{},selectionMode:"extended",allowTextSelection:void 0,_selectionTargetType:"rows",create:function(){this.selection={};return this.inherited(arguments)},postCreate:function(){this.inherited(arguments);this._initSelectionEvents();var c=this.selectionMode;this.selectionMode="";this._setSelectionMode(c)},destroy:function(){this.inherited(arguments);this._selectstartHandle&&this._selectstartHandle.remove();this._unselectableHandle&&this._unselectableHandle.remove();this._removeDeselectSignals&&
this._removeDeselectSignals()},_setSelectionMode:function(c){c!==this.selectionMode&&(this.clearSelection(),this.selectionMode=c,this._selectionHandlerName="_"+c+"SelectionHandler",this._setAllowTextSelection(this.allowTextSelection))},_setAllowTextSelection:function(c){"undefined"!==typeof c?u(this,c):u(this,"none"===this.selectionMode);this.allowTextSelection=c},_handleSelect:function(c,a){if(this[this._selectionHandlerName]&&this.allowSelect(this.row(a))&&("dgrid-cellfocusin"!==c.type||"mousedown"!==
c.parentType)&&(c.type!==r||a===this._waitForMouseUp)){this._waitForMouseUp=null;this._selectionTriggerEvent=c;if(!c.keyCode||!c.ctrlKey||32===c.keyCode)if(!c.shiftKey&&c.type===g&&this.isSelected(a))this._waitForMouseUp=a;else this[this._selectionHandlerName](c,a);this._selectionTriggerEvent=null}},_singleSelectionHandler:function(c,f){c=c.keyCode?c.ctrlKey:c[a];this._lastSelected===f?this.select(f,null,!c||!this.isSelected(f)):(this.clearSelection(),this.select(f),this._lastSelected=f)},_multipleSelectionHandler:function(c,
f){var b=this._lastSelected,d=c.keyCode?c.ctrlKey:c[a],g;c.shiftKey||(g=d?null:!0,b=null);this.select(f,b,g,null,-1!==c.type.indexOf("mouse")?"mouse":c.type);b||(this._lastSelected=f)},_extendedSelectionHandler:function(c,f){(2===c.button?this.isSelected(f):c.keyCode?c.ctrlKey:c[a])||this.clearSelection(null,!0);this._multipleSelectionHandler(c,f)},_toggleSelectionHandler:function(c,a){this.select(a,null,null)},_initSelectionEvents:function(){var c=this,f=this.contentNode,b=this.selectionDelegate;
this._selectionEventQueues={deselect:[],select:[]};m("touch")&&!m("pointer")&&this.selectionTouchEvents?(n(f,l.selector(b,this.selectionTouchEvents),function(a){c._handleSelect(a,this);c._ignoreMouseSelect=this}),n(f,n.selector(b,this.selectionEvents),function(a){c._ignoreMouseSelect!==this?c._handleSelect(a,this):a.type===r&&(c._ignoreMouseSelect=null)})):n(f,n.selector(b,this.selectionEvents),function(a){c._handleSelect(a,this)});this.addKeyHandler&&this.addKeyHandler(32,function(a){c._handleSelect(a,
a.target)});if(this.allowSelectAll)this.on("keydown",function(f){f[a]&&65===f.keyCode&&!/\bdgrid-input\b/.test(f.target.className)&&(f.preventDefault(),c[c.allSelected?"clearSelection":"selectAll"]())});this._setCollection&&h.before(this,"_setCollection",function(a){c._updateDeselectionAspect(a)});this._updateDeselectionAspect()},_updateDeselectionAspect:function(c){function a(c,a,f){if((c=b.row(c))&&b.selection[c.id])b[a](c,null,!0,null,f)}var b=this,d;this._removeDeselectSignals&&this._removeDeselectSignals();
d=c&&c.track&&this._observeCollection?[h.before(this,"_observeCollection",function(c){d.push(c.on("delete",function(c){"undefined"===typeof c.index&&a(c.id,"deselect")}))}),h.after(this,"_observeCollection",function(c){d.push(c.on("update",function(f){"undefined"!==typeof f.index&&a(c.getIdentity(f.target),"select","update")}))},!0)]:[h.before(this,"removeRow",function(c,a){a||(c=this.row(c))&&c.id in this.selection&&this.deselect(c)})];this._removeDeselectSignals=function(){for(var c=d.length;c--;)d[c].remove();
d=[]}},allowSelect:function(){return!0},_fireSelectionEvent:function(c){var a=this._selectionEventQueues[c],b=this._selectionTriggerEvent,d;d={bubbles:!0,grid:this};b&&(d.parentType=b.type);d[this._selectionTargetType]=a;this._selectionEventQueues[c]=[];n.emit(this.contentNode,"dgrid-"+c,d)},_fireSelectionEvents:function(){var c=this._selectionEventQueues,a;for(a in c)c[a].length&&this._fireSelectionEvent(a)},_select:function(c,a,b){var f,d,g;"undefined"===typeof b&&(b=!0);c.element||(c=this.row(c));
if(!1===b||this.allowSelect(c))if(f=this.selection,d=!!f[c.id],null===b&&(b=!d),g=c.element,b||this.allSelected?f[c.id]=b:delete this.selection[c.id],g&&(b?p.add(g,"dgrid-selected"+(this.addUiClasses?" ui-state-active":"")):p.remove(g,"dgrid-selected ui-state-active")),b!==d&&g&&this._selectionEventQueues[(b?"":"de")+"select"].push(c),a)if(a.element||(a=this.row(a)),a){if(a=a.element)for(f=this._determineSelectionDirection(g,a),f||(a=document.getElementById(a.id),f=this._determineSelectionDirection(g,
a));c.element!==a&&(c=this[f](c));)this._select(c,null,b)}else this._lastSelected=g},_determineSelectionDirection:m("dom-comparedocumentposition")?function(c,a){c=a.compareDocumentPosition(c);return c&1?!1:2===c?"down":"up"}:function(c,a){return 1>a.sourceIndex?!1:a.sourceIndex>c.sourceIndex?"down":"up"},select:function(c,a,b){this._select(c,a,b);this._fireSelectionEvents()},deselect:function(c,a){this.select(c,a,!1)},clearSelection:function(c,a){this.allSelected=!1;for(var b in this.selection)c!==
b&&this._select(b,null,!1);a||(this._lastSelected=null);this._fireSelectionEvents()},selectAll:function(){this.allSelected=!0;this.selection={};for(var c in this._rowIdToObject){var a=this.row(this._rowIdToObject[c]);this._select(a.id,null,!0)}this._fireSelectionEvents()},isSelected:function(c){if("undefined"===typeof c||null===c)return!1;c.element||(c=this.row(c));return c.id in this.selection?!!this.selection[c.id]:this.allSelected&&(!c.data||this.allowSelect(c))},refresh:function(){this.deselectOnRefresh&&
this.clearSelection();this._lastSelected=null;return this.inherited(arguments)},renderArray:function(){var c=this.inherited(arguments),a=this.selection,b,d,g;for(b=0;b<c.length;b++)d=this.row(c[b]),(g=d.id in a?a[d.id]:this.allSelected)&&this.select(d,null,g,null,"renderArray");this._fireSelectionEvents();return c}})})},"dgrid/OnDemandList":function(){define("./List ./_StoreMixin dojo/_base/declare dojo/_base/lang dojo/dom-construct dojo/on dojo/when ./util/misc".split(" "),function(t,p,n,m,h,e,l,
k){return n([t,p],{minRowsPerPage:2500,maxRowsPerPage:250,maxEmptySpace:Infinity,bufferRows:10,farOffRemoval:2E3,queryRowsOverlap:0,pagingMethod:"debounce",pagingDelay:k.defaultDelay,keepScrollPosition:!0,rowHeight:0,postCreate:function(){this.inherited(arguments);var h=this;e(this.bodyNode,"scroll",k[this.pagingMethod](function(a){h._processScroll(a)},null,this.pagingDelay))},destroy:function(){this.inherited(arguments);this._refreshTimeout&&clearTimeout(this._refreshTimeout)},renderQuery:function(e,
a){var b=this,d=a&&a.container||this.contentNode,g={query:e,count:0},r,c=this.preload,f={node:h.create("div",{className:"dgrid-preload",style:{height:"0"}},d),count:0,query:e,next:g};f.node.rowIndex=0;g.node=r=h.create("div",{className:"dgrid-preload"},d);g.previous=f;r.rowIndex=this.minRowsPerPage;c?((g.next=c.next)&&r.offsetTop>=c.node.offsetTop?g.previous=c:(g.next=c,g.previous=c.previous),g.previous.next=g,g.next.previous=g):this.preload=g;var q=h.create("div",{className:"dgrid-loading"},r,"before");
h.create("div",{className:"dgrid-below"},q).innerHTML=this.loadingMessage;a=m.mixin({start:0,count:this.minRowsPerPage},"level"in e?{queryLevel:e.level}:null);return this._trackError(function(){var c=e(a);return b.renderQueryResults(c,r,a).then(function(f){return c.totalLength.then(function(c){var d=f.length,e=r.parentNode,k=b.noDataNode;b._rows&&(b._rows.min=0,b._rows.max=d===c?Infinity:d-1);h.destroy(q);"queryLevel"in a||(b._total=c);0===c&&e&&(k&&(h.destroy(k),delete b.noDataNode),b.noDataNode=
k=h.create("div",{className:"dgrid-no-data",innerHTML:b.noDataMessage}),b._emit("noData"),e.insertBefore(k,b._getFirstRowSibling(e)));for(k=e=0;k<d;k++)e+=b._calcRowHeight(f[k]);d&&e&&(b.rowHeight=e/d);c-=d;g.count=c;r.rowIndex=d;c?r.style.height=Math.min(c*b.rowHeight,b.maxEmptySpace)+"px":r.style.display="none";b._previousScrollPosition&&(b.scrollTo(b._previousScrollPosition),delete b._previousScrollPosition);return l(b._processScroll()).then(function(){return f})})}).otherwise(function(c){h.destroy(q);
throw c;})})},refresh:function(k){var a=this;k&&k.keepScrollPosition&&(this._previousScrollPosition=this.getScrollPosition());this.inherited(arguments);if(this._renderedCollection)return this.renderQuery(function(b){return a._renderedCollection.fetchRange({start:b.start,end:b.start+b.count})}).then(function(){a._refreshTimeout=setTimeout(function(){e.emit(a.domNode,"dgrid-refresh-complete",{bubbles:!0,cancelable:!1,grid:a});a._refreshTimeout=null},0)})},resize:function(){this.inherited(arguments);
this._processScroll()},cleanup:function(){this.inherited(arguments);this.preload=null},renderQueryResults:function(e){var a=this.inherited(arguments),b=this._renderedCollection;b&&b.releaseRange&&a.then(function(a){a[0]&&!a[0].parentNode.tagName&&e.totalLength.then(function(){b.releaseRange(a[0].rowIndex,a[a.length-1].rowIndex+1)})});return a},_getFirstRowSibling:function(e){return e.lastChild},_calcRowHeight:function(e){var a=e.nextSibling;return a&&!/\bdgrid-preload\b/.test(a.className)?a.offsetTop-
e.offsetTop:e.offsetHeight},lastScrollTop:0,_processScroll:function(e){function a(c,a,f,d){var e=g.farOffRemoval,r=c.node;if(a>2*e){for(var q,k=r[f],l=0,x=0,u=[],v=k&&k.rowIndex,n;q=k;){var m=g._calcRowHeight(q);if(l+m+e>a||0>k.className.indexOf("dgrid-row")&&0>k.className.indexOf("dgrid-loading"))break;k=q[f];l+=m;x+=q.count||1;g.removeRow(q,!0);u.push(q);"rowIndex"in q&&(n=q.rowIndex)}g._renderedCollection.releaseRange&&"number"===typeof v&&"number"===typeof n&&(d?g._renderedCollection.releaseRange(n,
v+1):g._renderedCollection.releaseRange(v,n+1),g._rows[d?"max":"min"]=n,g._rows.max>=g._total-1&&(g._rows.max=Infinity));c.count+=x;d?(r.rowIndex-=x,b(c)):r.style.height=r.offsetHeight+l+"px";var p=document.createElement("div");for(c=u.length;c--;)p.appendChild(u[c]);setTimeout(function(){h.destroy(p)},1)}}function b(c,a){c.node.style.height=Math.min(c.count*g.rowHeight,a?Infinity:g.maxEmptySpace)+"px"}function d(c,a){do c=a?c.next:c.previous;while(c&&!c.node.offsetWidth);return c}if(this.rowHeight){var g=
this,r=g.bodyNode;e=e&&e.scrollTop||this.getScrollPosition().y;var r=r.offsetHeight+e,c,f,q=g.preload,k=g.lastScrollTop,l=g.bufferRows*g.rowHeight,u=l-g.rowHeight,m,p=!0;for(g.lastScrollTop=e;q&&!q.node.offsetWidth;)q=q.previous;for(;q&&q!==c;){c=g.preload;g.preload=q;f=q.node;var v=f.offsetTop;if(r+1+u<v)q=d(q,p=!1);else if(e-1-u>v+f.offsetHeight)q=d(q,p=!0);else{var v=((f.rowIndex?e-l:r)-v)/g.rowHeight,n=(r-e+2*l)/g.rowHeight,n=n+Math.min(Math.abs(Math.max(Math.min((e-k)*g.rowHeight,g.maxRowsPerPage/
2),g.maxRowsPerPage/-2)),10);0===f.rowIndex&&(v-=n);v=Math.max(v,0);10>v&&0<v&&n+v<g.maxRowsPerPage&&(n+=Math.max(0,v),v=0);n=Math.min(Math.max(n,g.minRowsPerPage),g.maxRowsPerPage,q.count);if(0===n)q=d(q,p);else{var n=Math.ceil(n),v=Math.min(Math.floor(v),q.count-n),w={};q.count-=n;var t=f,D,z=g.queryRowsOverlap,E=(0<f.rowIndex||f.offsetTop>e)&&q;if(E){var A=q.previous;A&&(a(A,e-(A.node.offsetTop+A.node.offsetHeight),"nextSibling"),0<v&&A.node===f.previousSibling?(v=Math.min(q.count,v),q.previous.count+=
v,b(q.previous,!0),f.rowIndex+=v,z=0):n+=v,q.count-=v);w.start=f.rowIndex-z;w.count=Math.min(n+z,g.maxRowsPerPage);f.rowIndex=w.start+w.count}else q.next&&(a(q.next,q.next.node.offsetTop-r,"previousSibling",!0),t=f.nextSibling,t===q.next.node?(q.next.count+=q.count-v,q.next.node.rowIndex=v+n,b(q.next),q.count=v,z=0):D=!0),w.start=q.count,w.count=Math.min(n+z,g.maxRowsPerPage);D&&t&&t.offsetWidth&&(D=t.offsetTop);b(q);"level"in q.query&&(w.queryLevel=q.query.level);if("queryLevel"in w||!(w.start>g._total||
0>w.count)){var B=h.create("div",{className:"dgrid-loading",style:{height:n*g.rowHeight+"px"}},t,"before");h.create("div",{className:"dgrid-"+(E?"below":"above"),innerHTML:g.loadingMessage},B);B.count=n;g._trackError(function(){(function(c,a,f){var d=q.query(w);m=g.renderQueryResults(d,c,w).then(function(e){var r=g._rows;!r||"queryLevel"in w||!e.length||(a?(r.max<=r.min&&(r.min=e[0].rowIndex),r.max=e[e.length-1].rowIndex):(r.max<=r.min&&(r.max=e[e.length-1].rowIndex),r.min=e[0].rowIndex));t=c.nextSibling;
h.destroy(c);f&&t&&t.offsetWidth&&(r=g.getScrollPosition(),g.scrollTo({x:r.x,y:r.y+t.offsetTop-f,preserveMomentum:!0}));d.totalLength.then(function(c){"queryLevel"in w||(g._total=c,g._rows&&g._rows.max>=g._total-1&&(g._rows.max=Infinity));a&&(a.count=c-a.node.rowIndex,b(a))});g._processScroll();return e},function(a){h.destroy(c);throw a;})})(B,E,D)});q=q.previous}}}}return m}}})})},"dgrid/_StoreMixin":function(){define("dojo/_base/declare dojo/_base/lang dojo/Deferred dojo/aspect dojo/dom-construct dojo/has dojo/on dojo/when".split(" "),
function(t,p,n,m,h,e,l,k){function u(a){if("object"!==typeof a)a=Error(a);else if("cancel"===a.dojoType)return;l.emit(this.domNode,"dgrid-error",{grid:this,error:a,cancelable:!0,bubbles:!0})&&console.error(a)}return t(null,{collection:null,_renderedCollection:null,_rows:null,_observerHandle:null,shouldTrackCollection:!1,getBeforePut:!0,noDataMessage:"",loadingMessage:"",_total:0,constructor:function(){this.dirty={};this._updating={};this._columnsWithSet={};m.before(this,"configStructure",p.hitch(this,
function(){this._columnsWithSet={}}))},destroy:function(){this.inherited(arguments);this._renderedCollection&&this._cleanupCollection()},_configColumn:function(a){a.set&&(this._columnsWithSet[a.field]=a);this.inherited(arguments)},_setCollection:function(a){this._renderedCollection&&(this.cleanup(),this._cleanupCollection({shouldRevert:!a||a.storage!==this._renderedCollection.storage}));this.collection=a;if(this._started){if(a){var b=a;this.sort&&0<this.sort.length&&(b=a.sort(this.sort));b.track&&
this.shouldTrackCollection&&(b=b.track(),this._rows=[],this._observerHandle=this._observeCollection(b,this.contentNode,{rows:this._rows}));this._renderedCollection=b}this.refresh()}},_setStore:function(){},_getTotal:function(){return this._total},_cleanupCollection:function(a){a=a||{};this._renderedCollection.tracking&&this._renderedCollection.tracking.remove();this._observerHandle&&(this._observerHandle.remove(),this._observerHandle=this._rows=null);!1!==a.shouldRevert&&(this.dirty={});this._renderedCollection=
this.collection=null},_applySort:function(){this.collection&&this.set("collection",this.collection)},row:function(){var a=this.inherited(arguments);a&&a.data&&"undefined"!==typeof a.id&&(this.collection?a.id=this.collection.getIdentity(a.data):console.error("_StoreMixin:have no collection!"));return a},refresh:function(){var a=this.inherited(arguments);this.collection||(this.noDataNode=h.create("div",{className:"dgrid-no-data",innerHTML:this.noDataMessage},this.contentNode),this._emit("noData"));
return a},refreshCell:function(a){if(!this.collection||!this._createBodyRowCell)return!1;if(a.column){if(a.column&&a.column.selector)return(new n).resolve();this.inherited(arguments);return this.collection.get(a.row.id).then(p.hitch(this,"_refreshCellFromItem",a))}},_refreshCellFromItem:function(a,b,d){if(a&&a.element){var g=a.element;g.widget&&g.widget.destroyRecursive();h.empty(g);var e=this.dirty&&this.dirty[a.row.id];e&&(b=p.delegate(b,e));this._createBodyRowCell(g,a.column,b,d)}},renderArray:function(){var a=
this.inherited(arguments);this.collection||a.length&&this.noDataNode&&h.destroy(this.noDataNode);return a},insertRow:function(a,b,d,g,e){var c=this.collection,f=this.dirty,c=c&&c.getIdentity(a),r;c in f&&!(c in this._updating)&&(r=f[c]);r&&(a=p.delegate(a,r));f=this.inherited(arguments);e&&e.rows&&(e.rows[g]=f);this.noDataNode&&(h.destroy(this.noDataNode),this.noDataNode=null);return f},updateDirty:function(a,b,d){var g=this.dirty,e=g[a];e||(e=g[a]={});e[b]=d},save:function(){function a(a,f){return function(e){var r=
b._columnsWithSet,q=b._updating,k,h;if("function"===typeof e.set)e.set(f);else for(k in f)e[k]=f[k];for(k in r)h=r[k].set(e),void 0!==h&&(e[k]=h);q[a]=!0;return d.put(e).then(function(b){delete g[a];delete q[a];c[a]=b;return c})}}var b=this,d=this.collection,g=this.dirty,e=new n,c={},f=function(c){var a;return b.getBeforePut||!(a=b.row(c).data)?function(){return d.get(c)}:function(){return a}},q=e.then(function(){return c}),k;for(k in g)var h=a(k,g[k]),q=q.then(f(k)).then(h);e.resolve();return q},
revert:function(){this.dirty={};this.refresh()},_trackError:function(a){"string"===typeof a&&(a=p.hitch(this,a));var b=this,d;try{d=k(a())}catch(g){a=new n,a.reject(g),d=a.promise}d.otherwise(function(a){u.call(b,a)});return d},removeRow:function(a,b,d){var g={element:a};!b&&this.noDataMessage&&this.up(g).element===a&&this.down(g).element===a&&(this.noDataNode=h.create("div",{className:"dgrid-no-data",innerHTML:this.noDataMessage},this.contentNode),this._emit("noData"));(g=d&&d.rows||this._rows)&&
delete g[a.rowIndex];return this.inherited(arguments)},renderQueryResults:function(a,b,d){d=p.mixin({rows:this._rows},d);var g=this;return a.then(function(a){a=g.renderArray(a,b,d);delete g._lastCollection;return a})},_observeCollection:function(a,b,d){var g=this,e=d.rows,c,f=[a.on("delete, update",function(a){var f=a.previousIndex,q=a.index;void 0!==f&&e[f]&&("max"in e&&(void 0===q||q<e.min||q>e.max)&&e.max--,c=e[f],c.parentNode===b&&g.removeRow(c,!1,d),e.splice(f,1),("delete"===a.type||"update"===
a.type&&(f<q||void 0===q))&&e[f]&&e[f].rowIndex--);"delete"===a.type&&(c=null)}),a.on("add, update",function(a){var f=a.previousIndex,q=a.index;if(void 0!==q&&(!("max"in e)||q>=e.min&&q<=e.max)){"max"in e&&(void 0===f||f<e.min||f>e.max)&&e.max++;if(e.length){if(f=e[q],!f&&(f=e[q-1]))f=(f.connected||f).nextSibling}else f=g._getFirstRowSibling&&g._getFirstRowSibling(b);c&&f&&c.id===f.id&&(f=(f.connected||f).nextSibling);f&&!f.parentNode&&(f=document.getElementById(f.id));e.splice(q,0,void 0);c=g.insertRow(a.target,
b,f,q,d);g.highlightRow(c)}c=null}),a.on("add, delete, update",function(c){var b="undefined"!==typeof c.previousIndex?c.previousIndex:Infinity,f="undefined"!==typeof c.index?c.index:Infinity,d=Math.min(b,f);b!==f&&e[d]&&g.adjustRowIndices(e[d]);Infinity!==b&&g._processScroll&&(e[b]||e[b-1])&&g._processScroll();g._onNotification(e,c,a);a===g._renderedCollection&&"totalLength"in c&&(g._total=c.totalLength)})];return{remove:function(){for(;0<f.length;)f.pop().remove()}}},_onNotification:function(){}})})},
"dgrid/OnDemandGrid":function(){define(["dojo/_base/declare","./Grid","./OnDemandList"],function(t,p,n){return t([p,n],{})})},"dgrid/extensions/ColumnReorder":function(){define("dojo/_base/lang dojo/_base/declare dojo/_base/array dojo/dom-class dojo/on dojo/query dojo/dnd/Source".split(" "),function(t,p,n,m,h,e){function l(a,d){var b=d[2];a=a[b?"columnSets":"subRows"][d[1]];return b?a[d[2]]:a}function k(a,d,g){d[2]?a.columnSets[d[1]][d[2]]=g:a.subRows[d[1]]=g}function u(a,d){return d.slice(("dgrid-"+
a+"-").length)}var a=/(\d+)(?:-(\d+))?$/;t=p(e,{copyState:function(){return!1},checkAcceptance:function(a){return a===this},_legalMouseDown:function(a){return-1<a.target.className.indexOf("dgrid-resize-handle")?!1:this.inherited(arguments)},onDropInternal:function(b){var d=this.grid,g=a.exec(u(d.id,b[0].getAttribute("dndType"))),e=g[2]?"columnSets":"subRows",c=l(d,g),f=d.columns;this.inherited(arguments);g&&setTimeout(function(){var a=n.map(b[0].parentNode.childNodes,function(c){return f[c.columnId]});
k(d,g,a);a={grid:d,subRow:a,column:f[b[0].columnId],bubbles:!0,cancelable:!0,parentType:"dnd"};a[e]=d[e];h.emit(d.domNode,"dgrid-columnreorder",a)?d.set(e,d[e]):(k(d,g,c),d.renderHeader(),d.sort.length&&d.updateSortArrow(d.sort))},0)}});p=p("dgrid.ColumnReorder",null,{columnDndConstructor:t,_initSubRowDnd:function(a,d){var b,e,c,f;e=0;for(c=a.length;e<c;e++)f=a[e],!1!==f.reorderable&&(f=f.headerNode,m.add(f,"dojoDndItem"),f.setAttribute("dndType",d),b||(b=f.parentNode));b&&this._columnDndSources.push(new this.columnDndConstructor(b,
{horizontal:!0,grid:this}))},renderHeader:function(){var a="dgrid-"+this.id+"-",d,g;this.inherited(arguments);this._columnDndSources=[];if(this.columnSets)for(g=0,d=this.columnSets.length;g<d;g++)n.forEach(this.columnSets[g],function(b,c){this._initSubRowDnd(b,a+g+"-"+c)},this);else n.forEach(this.subRows,function(b,c){this._initSubRowDnd(b,a+c)},this)},_destroyColumns:function(){this._columnDndSources&&n.forEach(this._columnDndSources,function(a){a&&a.destroy&&a.destroy()});this.inherited(arguments)}});
p.ColumnDndSource=t;return p})},"dgrid/extensions/ColumnResizer":function(){define("dojo/_base/declare dojo/on dojo/query dojo/_base/lang dojo/dom dojo/dom-construct dojo/dom-geometry dojo/has ../util/misc dojo/_base/html".split(" "),function(t,p,n,m,h,e,l,k,u){function a(a){for(var c=a.length,b=c,d=a[0].length,g=Array(c);c--;)g[c]=Array(d);for(var e={},c=0;c<b;c++)for(var k=g[c],r=a[c],h=0,l=0;h<d;h++){var u=r[l],n;if("undefined"===typeof k[h]){k[h]=u.id;if(u.rowSpan&&1<u.rowSpan){n=g;for(var m=
u.rowSpan,p=c,t=h,A=u.id,B=1;B<m;B++)n[p+B][t]=A}if(0<c&&u.colSpan&&1<u.colSpan)for(n=1;n<u.colSpan;n++)if(k[++h]=u.id,u.rowSpan&&1<u.rowSpan)for(var m=g,p=u.rowSpan,t=c,A=h,B=u.id,H=1;H<p;H++)m[t+H][A]=B;e[u.id]=a[0][h].id;l++}}return e}function b(a,b,d,g,e){if(!(0>=d)){var c=a.columns[b],f;if(c&&(f={grid:a,columnId:b,width:d,bubbles:!0,cancelable:!0},g&&(f.parentType=g),!a._resizedColumns||p.emit(a.headerNode,"dgrid-columnresize",f)))return"auto"===d?delete c.width:(c.width=d,d+="px"),(g=a._columnSizes[b])?
g.set("width",d):g=u.addCssRule("#"+u.escapeCssIdentifier(a.domNode.id)+" .dgrid-column-"+u.escapeCssIdentifier(b,"-"),"width: "+d+";"),a._columnSizes[b]=g,!1!==e&&a.resize(),!0}}var d,g=0,r={create:function(){d=e.create("div",{className:"dgrid-column-resizer"})},destroy:function(){e.destroy(d);d=null},show:function(a){a=l.position(a.domNode,!0);d.style.top=a.y+"px";d.style.height=a.h+"px";document.body.appendChild(d)},move:function(a){d.style.left=a+"px"},hide:function(){d.parentNode.removeChild(d)}};
return t("dgrid.ColumnResizer",null,{resizeNode:null,minWidth:40,adjustLastColumn:!0,_resizedColumns:!1,buildRendering:function(){this.inherited(arguments);g||r.create();g++},destroy:function(){this.inherited(arguments);for(var a in this._columnSizes)this._columnSizes[a].remove();--g||r.destroy()},resizeColumnWidth:function(a,f){return b(this,a,f)},configStructure:function(){var a=this._oldColumnSizes=m.mixin({},this._columnSizes),b;this._resizedColumns=!1;this._columnSizes={};this.inherited(arguments);
for(b in a)b in this._columnSizes||a[b].remove();delete this._oldColumnSizes},_configColumn:function(a){this.inherited(arguments);var c=a.id,b;"width"in a&&((b=this._oldColumnSizes[c])?b.set("width",a.width+"px"):b=u.addCssRule("#"+u.escapeCssIdentifier(this.domNode.id)+" .dgrid-column-"+u.escapeCssIdentifier(c,"-"),"width: "+a.width+"px;"),this._columnSizes[c]=b)},renderHeader:function(){this.inherited(arguments);var c=this,b;if(this.columnSets&&this.columnSets.length)for(var d=this.columnSets.length;d--;)b=
m.mixin(b||{},a(this.columnSets[d]));else this.subRows&&1<this.subRows.length&&(b=a(this.subRows));for(var d=n(".dgrid-cell",c.headerNode),g=d.length;g--;){var h=d[g],r=h.columnId,l=c.columns[r],t=h.childNodes;if(l&&!1!==l.resizable){l=e.create("div",{className:"dgrid-resize-header-container"});for(h.contents=l;0<t.length;)l.appendChild(t[0]);t=e.create("div",{className:"dgrid-resize-handle resizeNode-"+u.escapeCssIdentifier(r,"-")},l);h.appendChild(l);t.columnId=b&&b[r]||r}}c.mouseMoveListen||(p(c.headerNode,
".dgrid-resize-handle:mousedown"+(k("touch")?",.dgrid-resize-handle:touchstart":""),function(a){c._resizeMouseDown(a,this);c.mouseMoveListen.resume();c.mouseUpListen.resume()}),c._listeners.push(c.mouseMoveListen=p.pausable(document,"mousemove"+(k("touch")?",touchmove":""),u.throttleDelayed(function(a){c._updateResizerPosition(a)}))),c._listeners.push(c.mouseUpListen=p.pausable(document,"mouseup"+(k("touch")?",touchend":""),function(a){c._resizeMouseUp(a);c.mouseMoveListen.pause();c.mouseUpListen.pause()})),
c.mouseMoveListen.pause(),c.mouseUpListen.pause())},_resizeMouseDown:function(a,b){a.preventDefault();h.setSelectable(this.domNode,!1);this._startX=this._getResizeMouseLocation(a);this._targetCell=n(".dgrid-column-"+u.escapeCssIdentifier(b.columnId,"-"),this.headerNode)[0];this._updateResizerPosition(a);r.show(this)},_resizeMouseUp:function(a){var c=this._columnSizes,d,g,e;this.adjustLastColumn&&(e=this.headerNode.clientWidth-1);this._resizedColumns||(d=n(".dgrid-cell",this.headerNode),this.columnSets&&
this.columnSets.length?d=d.filter(function(a){return"0"===a.columnId.split("-")[0]&&!(a.columnId in c)}):this.subRows&&1<this.subRows.length&&(d=d.filter(function(a){return"0"===a.columnId.charAt(0)&&!(a.columnId in c)})),g=d.map(function(a){return a.offsetWidth}),d.forEach(function(a,c){b(this,a.columnId,g[c],null,!1)},this),this._resizedColumns=!0);h.setSelectable(this.domNode,!0);d=this._targetCell;var k=this._getResizeMouseLocation(a)-this._startX,l=d.offsetWidth+k,m=this._getResizedColumnWidths(),
p=m.totalWidth,m=m.lastColId,t=n(".dgrid-column-"+u.escapeCssIdentifier(m,"-"),this.headerNode)[0].offsetWidth;l<this.minWidth&&(l=this.minWidth);b(this,d.columnId,l,a.type)&&d.columnId!==m&&this.adjustLastColumn&&(p+k<e?b(this,m,"auto",a.type):t-k<=this.minWidth&&b(this,m,this.minWidth,a.type));r.hide();delete this._startX;delete this._targetCell},_updateResizerPosition:function(a){if(this._targetCell){a=this._getResizeMouseLocation(a);var c=this._targetCell.offsetWidth,b=a;c+(a-this._startX)<this.minWidth&&
(b=this._startX-(c-this.minWidth));r.move(b)}},_getResizeMouseLocation:function(a){var c=0;a.pageX?c=a.pageX:a.clientX&&(c=a.clientX+document.body.scrollLeft+document.documentElement.scrollLeft);return c},_getResizedColumnWidths:function(){var a=0,b=n((this.columnSets?".dgrid-column-set-cell ":"")+"tr:first-child .dgrid-cell",this.headerNode),d=b.length;if(!d)return{};for(var g=b[d-1].columnId;d--;)a+=b[d].offsetWidth;return{totalWidth:a,lastColId:g}}})})},"dgrid/extensions/CompoundColumns":function(){define(["dojo/_base/lang",
"dojo/_base/declare","dojo/sniff","dojo/query","../util/misc"],function(t,p,n,m,h){return p(null,{configStructure:function(){function e(c,b,d,g){var f=0,r=function(){},l,q;h.each(c,function(h,n){"string"===typeof h&&(h={label:h});c instanceof Array||h.field||(h.field=n);q=(l=h.children)&&!1!==h.showChildHeaders;h.parentColumn=g;l?null==h.id?h.id=(g&&g.id||b-1)+"-"+u.length:g&&g.id&&(h.id=g.id+"-"+h.id):(a.push(h),u.push(t.delegate(h,{renderHeaderCell:r})),f++);q||(h=t.delegate(h,{rowSpan:-b}));l&&
(f+=h.colSpan=e(l,b+1,q,h));d&&(k[b]||(k[b]=[])).push(h)},this);return f}var l=this.subRows&&this.subRows[0]||this.columns,k=[[]],u=k[0],a=[];k[0].className="dgrid-spacer-row";e(l,1,!0);var l=k.length,b,d,g,r;for(b=0;b<l;b++)for(g=k[b],d=0;d<g.length;d++)r=g[d],1>r.rowSpan&&(r.rowSpan+=l);a=[a];a.headerRows=k;this.subRows=a;this.inherited(arguments)},renderHeader:function(){var e,h=this.subRows[0],k=this.subRows.headerRows[0];this.inherited(arguments);for(e=h.length;e--;)h[e].headerNode=k[e].headerNode},
_findSortArrowParent:function(){var e=this.inherited(arguments);if(e&&h.contains(m(".dgrid-spacer-row",this.headerNode)[0],e))return e=e.columnId||e.parentNode.columnId,e=m(".dgrid-column-"+e,this.headerNode),e[e.length-1]},_configColumn:function(e,h,k){var l=e.parentColumn,a=e.id;l&&(a=0===a.indexOf(k)?a.substring(k.length):a,k=l.id+"-",a=e.id=k+a);this.inherited(arguments,[e,h,k])},cell:function(e,h){if("object"!==typeof h){var k=this.column(h);k&&(h=k.id)}return this.inherited(arguments,[e,h])},
column:function(e){var h=this.inherited(arguments);if(null==h&&"object"!==typeof e){var k="-"+e,u=k.length,a;for(a in this.columns)if(-1!==a.indexOf(k,a.length-u))return this.columns[a]}return h},_updateCompoundHiddenStates:function(e,h){e=this.columns[e];var k;if(!e||e.hidden!==h)for(;e&&e.parentColumn;){e=e.parentColumn;if(k=e.colSpan+=h?-1:1)e.headerNode.colSpan=k;1!==k||h?!k&&h&&this._hideColumn(e.id):this._showColumn(e.id)}},_hideColumn:function(e){var h=this;this._updateCompoundHiddenStates(e,
!0);this.inherited(arguments);n("ff")&&(this.headerNode.style.display="none",setTimeout(function(){h.headerNode.style.display="";h.resize()},0))},_showColumn:function(e){this._updateCompoundHiddenStates(e,!1);this.inherited(arguments)},_getResizedColumnWidths:function(){var e=0,h=this.columns,k;for(k in h)e+=h[k].headerNode.offsetWidth;return{totalWidth:e,lastColId:this.subRows[0][this.subRows[0].length-1].id}}})})},"dgrid/extensions/Pagination":function(){define("../_StoreMixin dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/dom-construct dojo/dom-class dojo/on dojo/query dojo/string dojo/has dojo/when ../util/misc dojo/_base/sniff".split(" "),
function(t,p,n,m,h,e,l,k,u,a,b,d){function g(a){a.noDataNode?(h.destroy(a.noDataNode),delete a.noDataNode):a.cleanup();a.contentNode.innerHTML=""}function r(a){if(a.loadingNode)h.destroy(a.loadingNode),delete a.loadingNode;else if(a._oldPageNodes){for(var c in a._oldPageNodes)a.removeRow(a._oldPageNodes[c]);delete a._oldPageNodes}delete a._isLoading}return p(t,{rowsPerPage:10,pagingTextBox:!1,previousNextArrows:!0,firstLastArrows:!1,pagingLinks:2,pageSizeOptions:null,showLoadingMessage:!0,i18nPagination:{status:"${start} - ${end} of ${total} results",
gotoFirst:"Go to first page",gotoNext:"Go to next page",gotoPrev:"Go to previous page",gotoLast:"Go to last page",gotoPage:"Go to page",jumpPage:"Jump to page",rowsPerPage:"Number of rows per page"},showFooter:!0,_currentPage:1,buildRendering:function(){this.inherited(arguments);var a=this,b=this.paginationNode=h.create("div",{className:"dgrid-pagination"},this.footerNode),d=this.paginationStatusNode=h.create("div",{className:"dgrid-status"},b),g=this.i18nPagination;d.tabIndex=0;this.addUiClasses&&
e.add(this.footerNode,"ui-widget-content");this._updatePaginationSizeSelect();this._updateRowsPerPageOption();this._updatePaginationStatus(this._total);b=this.paginationNavigationNode=h.create("div",{className:"dgrid-navigation"},b);this.firstLastArrows&&(this.paginationFirstNode=h.create("span",{"aria-label":g.gotoFirst,className:"dgrid-first dgrid-page-link",innerHTML:"\u00ab",tabIndex:0},b));this.previousNextArrows&&(this.paginationPreviousNode=h.create("span",{"aria-label":g.gotoPrev,className:"dgrid-previous dgrid-page-link",
innerHTML:"\u2039",tabIndex:0},b));this.paginationLinksNode=h.create("span",{className:"dgrid-pagination-links"},b);this.previousNextArrows&&(this.paginationNextNode=h.create("span",{"aria-label":g.gotoNext,className:"dgrid-next dgrid-page-link",innerHTML:"\u203a",tabIndex:0},b));this.firstLastArrows&&(this.paginationLastNode=h.create("span",{"aria-label":g.gotoLast,className:"dgrid-last dgrid-page-link",innerHTML:"\u00bb",tabIndex:0},b));this._listeners.push(l(b,".dgrid-page-link:click,.dgrid-page-link:keydown",
function(c){if("keydown"!==c.type||13===c.keyCode){c=this.className;var b,f;a._isLoading||-1<c.indexOf("dgrid-page-disabled")||(b=a._currentPage,f=Math.ceil(a._total/a.rowsPerPage),this===a.paginationPreviousNode?a.gotoPage(b-1):this===a.paginationNextNode?a.gotoPage(b+1):this===a.paginationFirstNode?a.gotoPage(1):this===a.paginationLastNode?a.gotoPage(f):"dgrid-page-link"===c&&a.gotoPage(+this.innerHTML))}}))},destroy:function(){this.inherited(arguments);this._pagingTextBoxHandle&&this._pagingTextBoxHandle.remove()},
_updatePaginationSizeSelect:function(){var a=this.pageSizeOptions,b=this.paginationSizeSelect,d;if(a&&a.length){b||(b=this.paginationSizeSelect=h.create("select",{"aria-label":this.i18nPagination.rowsPerPage,className:"dgrid-page-size"},this.paginationNode),d=this._paginationSizeChangeHandle=l(b,"change",m.hitch(this,function(){this.set("rowsPerPage",+this.paginationSizeSelect.value)})),this._listeners.push(d));for(d=b.options.length=0;d<a.length;d++)h.create("option",{innerHTML:a[d],selected:this.rowsPerPage===
a[d],value:a[d]},b);this._updateRowsPerPageOption()}else a&&a.length||!b||(h.destroy(b),this.paginationSizeSelect=null,this._paginationSizeChangeHandle.remove())},_setPageSizeOptions:function(a){this.pageSizeOptions=a&&a.sort(function(a,c){return a-c});this._updatePaginationSizeSelect()},_updateRowsPerPageOption:function(){var a=this.rowsPerPage,b=this.pageSizeOptions,d=this.paginationSizeSelect;d&&(0>n.indexOf(b,a)?this._setPageSizeOptions(b.concat([a])):d.value=""+a)},_setRowsPerPage:function(a){this.rowsPerPage=
a;this._updateRowsPerPageOption();this.gotoPage(1)},_updateNavigation:function(a){function c(a,c){var b;r.pagingTextBox&&a===m&&1<w?(c=h.create("input",{"aria-label":u.jumpPage,className:"dgrid-page-input",type:"text",value:m},n),r._pagingTextBoxHandle=l(c,"change",function(){var a=+this.value;!isNaN(a)&&0<a&&a<=w&&r.gotoPage(+this.value)}),y&&"INPUT"===y.tagName&&c.focus()):(b=a===m,c=h.create("span",{"aria-label":u.gotoPage,className:"dgrid-page-link"+(b?" dgrid-page-disabled":""),innerHTML:a+(c?
" ":""),tabIndex:b?-1:0},n),D===a&&(b?a<w?D++:z.focus():c.focus()),b||(z=c))}function b(a,c){e.toggle(a,"dgrid-page-disabled",c);a.tabIndex=c?-1:0}function g(){h.create("span",{className:"dgrid-page-skip",innerHTML:"..."},n)}var r=this,u=this.i18nPagination,n=this.paginationLinksNode,m=this._currentPage,p=this.pagingLinks,t=this.paginationNavigationNode,w=Math.ceil(a/this.rowsPerPage);a=this._pagingTextBoxHandle;var y=document.activeElement,D,z;y&&d.contains(this.paginationNavigationNode,y)?"dgrid-page-link"===
y.className&&(D=+y.innerHTML):y=null;a&&a.remove();n.innerHTML="";k(".dgrid-first, .dgrid-previous",t).forEach(function(a){b(a,1===m)});k(".dgrid-last, .dgrid-next",t).forEach(function(a){b(a,m>=w)});if(p&&0<w){c(1,!0);t=m-p;for(2<t?g():t=2;t<Math.min(m+p+1,w);t++)c(t,!0);m+p+1<w&&g();1<w&&c(w)}else r.pagingTextBox&&c(m);y&&-1===y.tabIndex&&(p=k('[tabindex\x3d"0"]',this.paginationNavigationNode),y===this.paginationPreviousNode||y===this.paginationFirstNode?y=p[0]:p.length&&(y=p[p.length-1]),y&&y.focus())},
_updatePaginationStatus:function(a){var c=this.rowsPerPage,b=Math.min(a,(this._currentPage-1)*c+1);this.paginationStatusNode.innerHTML=u.substitute(this.i18nPagination.status,{start:b,end:Math.min(a,b+c-1),total:a})},refresh:function(a){var c=this,b=a&&a.keepCurrentPage?Math.min(this._currentPage,Math.ceil(this._total/this.rowsPerPage)):1;this.inherited(arguments);return this.gotoPage(b).then(function(a){setTimeout(function(){l.emit(c.domNode,"dgrid-refresh-complete",{bubbles:!0,cancelable:!1,grid:c})},
0);return a})},_onNotification:function(a,b,d){a=this.rowsPerPage;var c=this._currentPage*a;"add"===b.type&&b.index<c||"delete"===b.type&&b.previousIndex<c||"update"===b.type&&Math.floor(b.index/a)!==Math.floor(b.previousIndex/a)?this.gotoPage(Math.min(this._currentPage,Math.ceil(b.totalLength/this.rowsPerPage))):d===this._renderedCollection&&b.totalLength!==this._total&&(this._updatePaginationStatus(b.totalLength),this._updateNavigation(b.totalLength))},renderQueryResults:function(a,b){var c=this,
d=this.inherited(arguments);b||(this._topLevelRequest&&(this._topLevelRequest.cancel(),delete this._topLevelRequest),"function"===typeof d.cancel&&(this._topLevelRequest=d),d.then(function(){c._topLevelRequest&&delete c._topLevelRequest}));return d},insertRow:function(){var a=this._oldPageNodes,b=this.inherited(arguments);a&&b===a[b.id]&&delete a[b.id];return b},gotoPage:function(a){var c=this,d=(this._currentPage-1)*this.rowsPerPage;if(!this._renderedCollection)return b([]);this._renderedCollection.releaseRange&&
this._renderedCollection.releaseRange(d,d+this.rowsPerPage);return this._trackError(function(){var b=c.rowsPerPage,d=(a-1)*b,f={start:d,count:b},e,k=c.contentNode,l,q,u;if(c.showLoadingMessage)g(c),c.loadingNode=h.create("div",{className:"dgrid-loading",innerHTML:c.loadingMessage},k);else for(c._oldPageNodes=l={},k=k.children,q=0,u=k.length;q<u;q++)l[k[q].id]=k[q];c._isLoading=!0;e=c._renderedCollection.fetchRange({start:d,end:d+b});return c.renderQueryResults(e,null,f).then(function(f){r(c);c.scrollTo({y:0});
c._rows&&(c._rows.min=d,c._rows.max=d+b-1);e.totalLength.then(function(b){b||(c.noDataNode&&(h.destroy(c.noDataNode),delete c.noDataNode),c.noDataNode=h.create("div",{className:"dgrid-no-data",innerHTML:c.noDataMessage},c.contentNode));c._total=b;c._currentPage=a;c._rowsOnPage=f.length;c._updatePaginationStatus(b);c._updateNavigation(b)});return e},function(a){r(c);throw a;})})}})})},"dgrid/extensions/DnD":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/aspect dojo/dom-class dojo/on dojo/topic dojo/has dojo/when dojo/dnd/Source dojo/dnd/Manager dojo/_base/NodeList ../Selection ./util/touch ./_DnD-touch-autoscroll".split(" "),
function(t,p,n,m,h,e,l,k,u,a,b,d,g,r){var c=t(a,{grid:null,getObject:function(a){var c=this.grid;return c.collection.get(a.id.slice(c.id.length+5))},_legalMouseDown:function(a){return this.inherited(arguments)&&a.target!==this.grid.bodyNode},onDrop:function(a,c,b){var d=this,f=this._targetAnchor=this.targetAnchor,g=this.grid,e=g.collection;!this.before&&f&&(f=f.nextSibling);f=f&&g.row(f);u(f&&e.get(f.id),function(f){if(d!==a)d.onDropExternal(a,c,b,f);else d.onDropInternal(c,b,f)})},onDropInternal:function(a,
c,b){var d=this.grid,f=d.collection,g=this,e=g._targetAnchor,h;e&&(h=this.before?e.previousSibling:e.nextSibling);e=d.row(a[0]);(c||h!==a[0]&&(b||!e||d.down(e).element!==a[0]))&&a.forEach(function(a){u(g.getObject(a),function(a){var e=f.getIdentity(a);f[c&&f.copy?"copy":"put"](a,{beforeId:b?f.getIdentity(b):null});g._selectedNodes[e]&&(g._selectedNodes[e]=d.row(e).element)})})},onDropExternal:function(a,c,b,d){var f=this.grid.collection,g=a.grid;c.forEach(function(c,e){u(a.getObject(c),function(h){b||
(g?u(g.collection.getIdentity(h),function(b){!e&&a.selectNone();a.delItem(c.id);g.collection.remove(b)}):a.deleteSelectedNodes());f[f.copy?"copy":"put"](h,{beforeId:d?f.getIdentity(d):null})})})},onDndStart:function(a){this.inherited(arguments);a===this&&(this.grid.cancelTouchScroll&&this.grid.cancelTouchScroll(),b.manager().avatar.node.style.width=this.grid.domNode.offsetWidth/2+"px")},onMouseDown:function(a){k("touch")&&this.isDragging&&1<r.countCurrentTouches(a,this.grid.touchNode)?(l.publish("/dnd/cancel"),
b.manager().stopDrag()):this.inherited(arguments)},onMouseMove:function(a){(!k("touch")||1>=r.countCurrentTouches(a,this.grid.touchNode))&&this.inherited(arguments)},checkAcceptance:function(c){return c.getObject&&a.prototype.checkAcceptance.apply(this,arguments)},getSelectedNodes:function(){if(!this.grid.selection)return this.inherited(arguments);var a=new d,c;for(c in this.grid.selection)a.push(this._selectedNodes[c]);return a}});t=t(g,{dndSourceType:"dgrid-row",dndParams:null,dndConstructor:c,
postMixInProperties:function(){this.inherited(arguments);this.dndParams=p.mixin({accept:[this.dndSourceType]},this.dndParams)},postCreate:function(){function a(a){d[a.id]=a.element}function b(a){delete d[a.id];h.remove(a.element,"dojoDndItemSelected dojoDndItemAnchor")}this.inherited(arguments);this.dndSource=new (this.dndConstructor||c)(this.bodyNode,p.mixin(this.dndParams,{grid:this,dropParent:this.contentNode}));var d=this.dndSource._selectedNodes={};this.on("dgrid-select",function(c){n.forEach(c.rows,
a)});this.on("dgrid-deselect",function(a){n.forEach(a.rows,b)});m.after(this,"destroy",function(){delete this.dndSource._selectedNodes;d=null;this.dndSource.destroy()},!0)},insertRow:function(a){var c=this.inherited(arguments),b="function"===typeof this.getObjectDndType?this.getObjectDndType(a):[this.dndSourceType];h.add(c,"dojoDndItem");this.dndSource.setItem(c.id,{data:a,type:b instanceof Array?b:[b]});return c},removeRow:function(a){this.dndSource.delItem(this.row(a));this.inherited(arguments)}});
t.GridSource=c;return t})},"dgrid/extensions/_DnD-touch-autoscroll":function(){define(["dojo/aspect","dojo/dom-geometry","dojo/dnd/autoscroll","../List"],function(t,p,n,m){var h=n.autoScrollNodes,e,l;e={};t.after(m.prototype,"postCreate",function(h){e[this.id]=this;return h});t.after(m.prototype,"destroy",function(h){delete e[this.id];return h});l=function(h){for(var k,a;h;){if((k=h.id)&&(a=e[k]))return a;h=h.parentNode}};n.autoScrollNodes=function(e){var k=e.target,a=l(k),b,d,g,r,c,f;if(a&&(k=a.touchNode.parentNode,
k=p.position(k,!0),b=e.pageX-k.x,d=e.pageY-k.y,g=Math.min(n.H_TRIGGER_AUTOSCROLL,k.w/2),r=Math.min(n.V_TRIGGER_AUTOSCROLL,k.h/2),b<g?c=-g:b>k.w-g&&(c=g),d<r?f=-r:d>k.h-r&&(f=r),c||f)){e=a.getScrollPosition();k={};c&&(k.x=e.x+c);f&&(k.y=e.y+f);a.scrollTo(k);return}h.call(this,e)};return n})},"dgrid/Editor":function(){define("dojo/_base/declare dojo/_base/lang dojo/Deferred dojo/dom-construct dojo/dom-class dojo/on dojo/has dojo/query ./Grid dojo/_base/sniff".split(" "),function(t,p,n,m,h,e,l,k,u){return t(null,
{constructor:function(){this._editorInstances={};this._editorColumnListeners=[];this._editorCellListeners={};this._editorsPendingStartup=[]},postCreate:function(){var a=this;this.inherited(arguments);this.on(".dgrid-input:focusin",function(){a._focusedEditorCell=a.cell(this)});this._editorFocusoutHandle=e.pausable(this.domNode,".dgrid-input:focusout",function(){a._focusedEditorCell=null});this._listeners.push(this._editorFocusoutHandle)},insertRow:function(){this._editorRowListeners={};var a=this.inherited(arguments),
b=this.row(a),d=this._editorCellListeners[a.id]=this._editorCellListeners[a.id]||{},g;for(g in this._editorRowListeners)d[g]=this._editorRowListeners[g];this._editorRowListeners=null;(d=this._previouslyFocusedEditorCell)&&d.row.id===b.id&&this.edit(this.cell(b,d.column.id));return a},refresh:function(){for(var a in this._editorInstances){var b=this._editorInstances[a].domNode;b&&b.parentNode&&b.parentNode.removeChild(b)}this.inherited(arguments)},removeRow:function(a){var b=this,d=this._focusedEditorCell;
d&&d.row.id===this.row(a).id&&(this._previouslyFocusedEditorCell=d,this._editorFocusoutHandle.pause(),setTimeout(function(){b._editorFocusoutHandle.resume();b._previouslyFocusedEditorCell=null},0));if(this._editorCellListeners[a.id]){for(var g in this._editorCellListeners[a.id])this._editorCellListeners[a.id][g].remove();delete this._editorCellListeners[a.id]}for(d=this._alwaysOnWidgetColumns.length;d--;)if(g=(g=this.cell(a,this._alwaysOnWidgetColumns[d].id).element)&&(g.contents||g).widget)this._editorFocusoutHandle.pause(),
g.destroyRecursive();return this.inherited(arguments)},renderArray:function(){var a=this.inherited(arguments);a.length?this._startupPendingEditors():this._editorsPendingStartup=[];return a},_onNotification:function(){this.inherited(arguments);this._startupPendingEditors()},_destroyColumns:function(){this._editorStructureCleanup();this.inherited(arguments)},_editorStructureCleanup:function(){var a=this._editorInstances,b=this._editorColumnListeners;this._editTimer&&clearTimeout(this._editTimer);for(var d in a){var g=
a[d];g.domNode&&g.destroyRecursive()}this._editorInstances={};for(a=b.length;a--;)b[a].remove();for(var e in this._editorCellListeners)for(d in this._editorCellListeners[e])this._editorCellListeners[e][d].remove();for(a=0;a<this._editorColumnListeners.length;a++)this._editorColumnListeners[a].remove();this._editorCellListeners={};this._editorColumnListeners=[];this._editorsPendingStartup=[]},_configColumns:function(){var a=this.inherited(arguments);this._alwaysOnWidgetColumns=[];for(var b=0,d=a.length;b<
d;b++)a[b].editor&&this._configureEditorColumn(a[b]);return a},_configureEditorColumn:function(a){var b=this,d=a.renderCell||this._defaultRenderCell,g=a.editOn,h="string"!==typeof a.editor;g?this._editorInstances[a.id]=this._createSharedEditor(a,d):h&&this._alwaysOnWidgetColumns.push(a);a.renderCell=g?function(c,f,h,k){if(!k||!k.alreadyHooked){var r=e(h,g,function(){b._activeOptions=k;b.edit(this)});if(b._editorRowListeners)b._editorRowListeners[a.id]=r;else{var l=b.row(c);b._editorCellListeners[l.element.id][a.id]=
r}}return d.call(a,c,f,h,k)}:function(c,f,g,e){if(!a.canEdit||a.canEdit(c,f))e=b._createEditor(a),e.object=c,b._showEditor(e,a,g,f),g[h?"widget":"input"]=e;else return d.call(a,c,f,g,e)}},edit:function(a){function b(a){d._activeCell=e;d._showEditor(k,g,e,h);d._editTimer=setTimeout(function(){k.focus&&k.focus();g._editorBlurHandle&&g._editorBlurHandle.resume();d._editTimer=null;a.resolve(k)},0)}var d=this,g,e,c,f,h,k,l;a.column||(a=this.cell(a));if(!a||!a.element)return null;g=a.column;f=g.field;e=
a.element.contents||a.element;if(k=this._editorInstances[g.id]){if(this._activeCell!==e){var u=a.row;h=(c=this.dirty&&this.dirty[u.id])&&f in c?c[f]:g.get?g.get(u.data):u.data[f];if(!g.canEdit||g.canEdit(a.row.data,h))return l=new n,a=k.domNode||k,a.offsetWidth?(a.blur(),setTimeout(function(){b(l)},0)):b(l),l.promise}}else if(g.editor&&(k=e.widget||e.input))return l=new n,k.focus&&k.focus(),l.resolve(k),l.promise;return null},refreshCell:function(a){var b=a.row.element.id,d=a.column.id;this._editorCellListeners[b]&&
this._editorCellListeners[b][d]&&(this._editorCellListeners[b][d].remove(),this._editorCellListeners[b][d]=null);return this.inherited(arguments)},_showEditor:function(a,b,d,g){var e=a.domNode;e||this._updateInputValue(a,g);d.innerHTML="";h.add(d,"dgrid-cell-editing");e&&b.editOn&&a.validate&&a.reset&&a.reset();d.appendChild(a.domNode||a);e&&!b.editOn?this._editorsPendingStartup.push([a,b,d,g]):this._startupEditor(a,b,d,g)},_startupEditor:function(a,b,d,g){a.domNode&&(a._started||a.startup(),a._dgridIgnoreChange=
!0,a.set("value",g),setTimeout(function(){a._dgridIgnoreChange=!1},0));a._dgridLastValue=g;this._activeCell&&(this._activeValue=g,e.emit(d,"dgrid-editor-show",{grid:this,cell:this.cell(d),column:b,editor:a,bubbles:!0,cancelable:!1}))},_startupPendingEditors:function(){for(var a=this._editorsPendingStartup,b=a.length;b--;)this._startupEditor.apply(this,a[b]);this._editorsPendingStartup=[]},_handleEditorChange:function(a,b){var d=a.target;"_dgridLastValue"in d&&-1<d.className.indexOf("dgrid-input")&&
this._updatePropertyFromEditor(b||this.cell(d).column,d,a)},_createEditor:function(a){var b=a.editor,d=a.editOn,g=this,h="string"!==typeof b&&b,c,f,k={};c=a.editorArgs||{};"function"===typeof c&&(c=c.call(this,a));h?(f=new h(c),c=f.focusNode||f.domNode,c.className+=" dgrid-input",f.on(d?"blur":"change",function(){f._dgridIgnoreChange||g._updatePropertyFromEditor(a,this,{type:"widget"})})):(this._hasInputListener||(this._hasInputListener=!0,this.on("change",function(a){g._handleEditorChange(a)})),
"textarea"===b?h="textarea":(h="input",k.type=b),f=c=m.create(h,p.mixin(k,{className:"dgrid-input",name:a.field,tabIndex:isNaN(a.tabIndex)?-1:a.tabIndex},c)),9>l("ie")&&(b="radio"===b||"checkbox"===b?e(f,"click",function(c){g._handleEditorChange(c,a)}):e(f,"change",function(c){g._handleEditorChange(c,a)}),d?this._editorColumnListeners.push(b):this._editorRowListeners?this._editorRowListeners[a.id]=b:this._editorCellListeners[this.row(object).element.id][a.id]=b));if(a.autoSelect){var u=f.focusNode||
f;u.select&&e(u,"focus",function(){setTimeout(function(){u.select()},0)})}return f},_createSharedEditor:function(a){function b(){var a=g._activeCell;f.blur();"function"===typeof g.focus&&setTimeout(function(){g.focus(a)},k&&9>l("ie")?15:0)}var d=this._createEditor(a),g=this,k=d.domNode,c=d.domNode||d,f=d.focusNode||c,q=k?function(){d.set("value",d._dgridLastValue)}:function(){g._updateInputValue(d,d._dgridLastValue);g._updatePropertyFromEditor(a,d)};this._editorColumnListeners.push(e(f,"keydown",
function(c){c=c.keyCode||c.which;27===c?(q(),g._activeValue=d._dgridLastValue,b()):13===c&&!1!==a.dismissOnEnter&&b()}));(a._editorBlurHandle=e.pausable(d,"blur",function(){var b=c.parentNode,f={alreadyHooked:!0},k=g.cell(c);e.emit(k.element,"dgrid-editor-hide",{grid:g,cell:k,column:a,editor:d,bubbles:!0,cancelable:!1});a._editorBlurHandle.pause();b.removeChild(c);k.row&&(h.remove(k.element,"dgrid-cell-editing"),m.empty(b),u.appendIfNode(b,a.renderCell(k.row.data,g._activeValue,b,g._activeOptions?
p.delegate(f,g._activeOptions):f)));g._focusedEditorCell=g._activeCell=g._activeValue=g._activeOptions=null})).pause();this._editorColumnListeners.push(a._editorBlurHandle);return d},_updatePropertyFromEditor:function(a,b,d){var g;if(!b.isValid||b.isValid())if(d=this._updateProperty((b.domNode||b).parentNode,this._activeCell?this._activeValue:b._dgridLastValue,this._retrieveEditorValue(a,b),d),this._activeCell?this._activeValue=d:b._dgridLastValue=d,"radio"===b.type&&b.name&&!a.editOn&&a.field)for(g in d=
this.row(b),k("input[type\x3dradio][name\x3d"+b.name+"]",this.contentNode).forEach(function(d){var c=this.row(d);d!==b&&d._dgridLastValue&&(d._dgridLastValue=!1,this.updateDirty?this.updateDirty(c.id,a.field,!1):c.data[a.field]=!1)},this),this.dirty)d.id.toString()!==g&&this.dirty[g][a.field]&&this.updateDirty(g,a.field,!1)},_updateProperty:function(a,b,d,g){var h=this;if((b&&b.valueOf())!==(d&&d.valueOf())){var c=this.cell(a),f=c.row,k=c.column;a=c.element;if(k.field&&f)if(c={grid:this,cell:c,oldValue:b,
value:d,bubbles:!0,cancelable:!0},g&&g.type&&(c.parentType=g.type),e.emit(a,"dgrid-datachange",c))this.updateDirty?(this.updateDirty(f.id,k.field,d),k.autoSave&&setTimeout(function(){h._trackError("save")},0)):f.data[k.field]=d;else{var l;(l=a.widget)?(l._dgridIgnoreChange=!0,l.set("value",b),setTimeout(function(){l._dgridIgnoreChange=!1},0)):(l=a.input)&&this._updateInputValue(l,b);return b}}return d},_updateInputValue:function(a,b){a.value=b;if("radio"===a.type||"checkbox"===a.type)a.checked=a.defaultChecked=
!!b},_retrieveEditorValue:function(a,b){return"function"===typeof b.get?this._convertEditorValue(b.get("value")):this._convertEditorValue(b["checkbox"===b.type||"radio"===b.type?"checked":"value"])},_convertEditorValue:function(a,b){"number"===typeof b?a=isNaN(a)?a:parseFloat(a):"boolean"===typeof b?a="true"===a?!0:"false"===a?!1:a:b instanceof Date&&(b=new Date(a),a=isNaN(b.getTime())?a:b);return a}})})},"dstore/Store":function(){define("dojo/_base/lang dojo/_base/array dojo/aspect dojo/has dojo/when dojo/_base/declare dstore/QueryMethod dstore/Filter dojo/Evented".split(" "),
function(t,p,n,m,h,e,l,k,u){function a(a){return function(b,d){var c=this;h(b,function(b){b={target:b};var g=d[1]||{};"beforeId"in g&&(b.beforeId=g.beforeId);c.emit(a,b)});return b}}m.add("object-proto",!!{}.__proto__&&!{}.watch);var b=m("object-proto");return e(u,{constructor:function(b){b&&e.safeMixin(this,b);this.Model&&this.Model.createSubclass&&(this.Model=this.Model.createSubclass([],{}).extend({_store:this}));this.storage=new u;var d=this;this.autoEmitEvents&&(n.after(this,"add",a("add")),
n.after(this,"put",a("update")),n.after(this,"remove",function(a,c){h(a,function(){d.emit("delete",{id:c[0]})});return a}))},autoEmitEvents:!0,idProperty:"id",queryAccessors:!0,getIdentity:function(a){return a.get?a.get(this.idProperty):a[this.idProperty]},_setIdentity:function(a,b){a.set?a.set(this.idProperty,b):a[this.idProperty]=b},forEach:function(a,b){var d=this;return h(this.fetch(),function(c){for(var f=0,g;void 0!==(g=c[f]);f++)a.call(b,g,f,d);return c})},on:function(a,b){return this.storage.on(a,
b)},emit:function(a,b){b=b||{};b.type=a;try{return this.storage.emit(a,b)}finally{return b.cancelable}},parse:null,stringify:null,Model:null,_restore:function(a,g){var d=this.Model;if(d&&a){var c=d.prototype,f=c._restore;f?a=f.call(a,d,g):b&&g?a.__proto__=c:a=t.delegate(c,a)}return a},create:function(a){return new this.Model(a)},_createSubCollection:function(a){var b=t.delegate(this.constructor.prototype),d;for(d in this)this._includePropertyInSubCollection(d,b)&&(b[d]=this[d]);return e.safeMixin(b,
a)},_includePropertyInSubCollection:function(a,b){return!(a in b)||b[a]!==this[a]},queryLog:[],filter:new l({type:"filter",normalizeArguments:function(a){var b=this.Filter;return a instanceof b?[a]:[new b(a)]}}),Filter:k,sort:new l({type:"sort",normalizeArguments:function(a,b){var d;"function"===typeof a?d=[a]:(d=a instanceof Array?a.slice():"object"===typeof a?[].slice.call(arguments):[{property:a,descending:b}],d=p.map(d,function(a){a=t.mixin({},a);a.descending=!!a.descending;return a}),d=[d]);
return d}}),select:new l({type:"select"}),_getQuerierFactory:function(a){return this["_create"+(a[0].toUpperCase()+a.substr(1))+"Querier"]}})})},"dstore/QueryMethod":function(){define([],function(){return function(t){var p=t.type,n=t.normalizeArguments,m=t.applyQuery,h=t.querierFactory;return function(){var e=Array.prototype.slice.call(arguments),l=n?n.apply(this,e):e,e={type:p,arguments:e,normalizedArguments:l},k=this._getQuerierFactory(p)||h;k&&(e.querier=k.apply(this,l));l=this._createSubCollection({queryLog:this.queryLog.concat(e)});
return m?m.call(this,l,e):l}}})},"dstore/Filter":function(){define(["dojo/_base/declare"],function(t){function p(m){return function(){var h=this.constructor,e=new h;e.type=m;e.args=Array.prototype.slice.call(arguments);return this.type?p("and").call(h.prototype,this,e):e}}function n(m){return function(){for(var h=this.constructor,e=[],l=0;l<arguments.length;l++){var k=arguments[l];e.push(k instanceof h?k:new h(k))}h=new h;h.type=m;h.args=e;this.type===m?h.args=this.args.concat(e):this.type?e.unshift(this):
1===e.length&&(h.type=e[0].type,h.args=e[0].args.slice());return h}}t=t(null,{constructor:function(m){var h=typeof m;switch(h){case "object":var h=this,e;for(e in m)var l=m[e],h=l instanceof this.constructor?h[l.type](e,l.args[0]):l&&l.test?h.match(e,l):h.eq(e,l);this.type=h.type;this.args=h.args;break;case "function":case "string":this.type=h,this.args=[m]}},and:n("and"),or:n("or"),eq:p("eq"),ne:p("ne"),lt:p("lt"),lte:p("lte"),gt:p("gt"),gte:p("gte"),contains:p("contains"),"in":p("in"),match:p("match")});
t.filterCreator=p;t.logicalOperatorCreator=n;return t})},"dstore/Memory":function(){define("dojo/_base/declare dojo/_base/array ./Store ./Promised ./SimpleQuery ./QueryResults".split(" "),function(t,p,n,m,h,e){return t([n,m,h],{constructor:function(){this.storage.version=0},postscript:function(){this.inherited(arguments);this.setData(this.data||[])},data:null,autoEmitEvents:!1,getSync:function(e){return this.storage.fullData[this.storage.index[e]]},putSync:function(e,h){h=h||{};var k=this.storage,
a=k.index,b=k.fullData,d=this.Model;!d||e instanceof d||(e=this._restore(e));var g=this.getIdentity(e);null==g&&(this._setIdentity(e,"id"in h?h.id:Math.random()),g=this.getIdentity(e));k.version++;var k=g in a?"update":"add",d={target:e},l;if("update"===k){if(!1===h.overwrite)throw Error("Object already exists");b.splice(l=a[g],1);g=l}else g=this.defaultNewToStart?0:b.length;if("beforeId"in h){var c=h.beforeId;null===c?h=b.length:(h=a[c],l<h&&--h);void 0!==h?d.beforeId=c:(console.error("options.beforeId was specified but no corresponding index was found"),
h=g)}else h=g;b.splice(h,0,e);l=isFinite(l)?Math.min(l,h):h;for(h=b.length;l<h;++l)a[this.getIdentity(b[l])]=l;this.emit(k,d);return e},addSync:function(e,h){(h=h||{}).overwrite=!1;return this.putSync(e,h)},removeSync:function(e){var h=this.storage,l=h.index,h=h.fullData;if(e in l)return l=h.splice(l[e],1)[0],this._reindex(),!0!==this._ignoreChangeEvents&&this.emit("delete",{id:e,target:l}),!0},setData:function(e){this.parse&&(e=this.parse(e));e.items&&(this.idProperty=e.identifier||this.idProperty,
e=e.items);this.storage.fullData=this.data=e;this._reindex()},_reindex:function(){for(var e=this.storage,h=e.index={},u=e.fullData,a=this.Model,b=Object.prototype,d=0,g=u.length;d<g;d++){var r=u[d];if(a&&!(r instanceof a)){var c=this._restore(r,r.__proto__===b);r!==c&&(u[d]=r=c)}h[this.getIdentity(r)]=d}e.version++},fetchSync:function(){var h=this.data;if(!h||h._version!==this.storage.version){for(var h=this.storage.fullData,k=this.queryLog,u=0,a=k.length;u<a;u++)h=k[u].querier(h);h._version=this.storage.version;
this.data=h}return new e(h)},fetchRangeSync:function(h){var k=this.fetchSync();return new e(k.slice(h.start,h.end),{totalLength:k.length})},_includePropertyInSubCollection:function(e){return"data"!==e&&this.inherited(arguments)}})})},"dstore/Promised":function(){define(["dojo/_base/declare","dojo/Deferred","./QueryResults","dojo/when"],function(t,p,n,m){function h(e,h){return function(){var k=new p;try{k.resolve(this[e].apply(this,arguments))}catch(u){k.reject(u)}return h?(k=new n(k.promise),k.totalLength=
m(k.totalLength),k):k.promise}}return t(null,{get:h("getSync"),put:h("putSync"),add:h("addSync"),remove:h("removeSync"),fetch:h("fetchSync",!0),fetchRange:h("fetchRangeSync",!0)})})},"dstore/QueryResults":function(){define(["dojo/_base/lang","dojo/when"],function(t,p){function n(m,h){return p(this,function(e){for(var l=0,k=e.length;l<k;l++)m.call(h,e[l],l,e)})}return function(m,h){var e=h&&"totalLength"in h;if(m.then){m=t.delegate(m);var l=m.then(function(k){var l=e?h.totalLength:k.totalLength||k.length;
k.totalLength=l;return!e&&l});m.totalLength=e?h.totalLength:l;m.response=h&&h.response}else m.totalLength=e?h.totalLength:m.length;m.forEach=n;return m}})},"dstore/SimpleQuery":function(){define(["dojo/_base/declare","dojo/_base/array"],function(t,p){function n(h,e){if(-1<h.indexOf(".")){var l=h.split("."),k=l.length;return function(h){for(var a=0;a<k;a++)h=h&&(e&&h.get?h.get(l[a]):h[l[a]]);return h}}return function(e){return e.get?e.get(h):e[h]}}var m={eq:function(h,e){return h===e},"in":function(h,
e){return-1<p.indexOf(e.data||e,h)},ne:function(h,e){return h!==e},lt:function(h,e){return h<e},lte:function(h,e){return h<=e},gt:function(h,e){return h>e},gte:function(h,e){return h>=e},match:function(h,e,l){return e.test(h,l)},contains:function(h,e,l,k){var m=this;return p.every(e.data||e,function(a){if("object"===typeof a&&a.type){var b=m._getFilterComparator(a.type);return p.some(h,function(d){return b.call(m,d,a.args[1],l,k)})}return-1<p.indexOf(h,a)})}};return t(null,{_createFilterQuerier:function(h){function e(a){var b=
a.type;a=a.args;var d=k._getFilterComparator(b);if(d){var g=a[0],h=n(g,l),c=a[1];c&&c.fetchSync&&(c=c.fetchSync());return function(a){return d.call(k,h(a),c,a,g)}}switch(b){case "and":case "or":for(var f=0,p=a.length;f<p;f++){var u=e(a[f]);m=m?function(a,c){return"and"===b?function(b){return a(b)&&c(b)}:function(b){return a(b)||c(b)}}(m,u):u}return m;case "function":return a[0];case "string":f=k[a[0]];if(!f)throw Error("No filter function "+a[0]+" was found in the collection");return f;case void 0:return function(){return!0};
default:throw Error('Unknown filter operation "'+b+'"');}}var l=this.queryAccessors,k=this,m=e(h);return function(a){return p.filter(a,m)}},_getFilterComparator:function(h){return m[h]||this.inherited(arguments)},_createSelectQuerier:function(h){return function(e){var l=h.length;return p.map(e,h instanceof Array?function(e){for(var k={},a=0;a<l;a++){var b=h[a];k[b]=e[b]}return k}:function(e){return e[h]})}},_createSortQuerier:function(h){var e=this.queryAccessors;return function(l){l=l.slice();l.sort("function"==
typeof h?h:function(k,l){for(var a=0;a<h.length;a++){var b,d=h[a];if("function"==typeof d)b=d(k,l);else{b=d.get||(d.get=n(d.property,e));var d=d.descending,g=b(k);b=b(l);null!=g&&(g=g.valueOf());null!=b&&(b=b.valueOf());b=g===b?0:!!d===(null===g||g>b&&null!==b)?-1:1}if(0!==b)return b}return 0});return l}}})})},"dstore/Tree":function(){define(["dojo/_base/declare"],function(t){return t(null,{constructor:function(){this.root=this},mayHaveChildren:function(p){return"hasChildren"in p?p.hasChildren:!0},
getRootCollection:function(){return this.root.filter({parent:null})},getChildren:function(p){return this.root.filter({parent:this.getIdentity(p)})}})})},"dstore/Cache":function(){define("dojo/_base/array dojo/when dojo/_base/declare dojo/_base/lang ./Store ./Memory ./QueryResults".split(" "),function(t,p,n,m,h,e,l){function k(a){return function(){var b=this.inherited(arguments),e=this.cachingCollection||this.cachingStore;b.cachingCollection=e[a].apply(e,arguments);b.isValidFetchCache=!0===this.canCacheQuery||
this.canCacheQuery(a,arguments);return b}}function u(a){a.cachingStore||(a.cachingStore=new e);a.cachingStore.Model=a.Model;a.cachingStore.idProperty=a.idProperty}var a={cachingStore:null,constructor:function(){u(this)},canCacheQuery:function(a,d){return!1},isAvailableInCache:function(){return this.isValidFetchCache&&(this.allLoaded||this.fetchRequest)||this._parent&&this._parent.isAvailableInCache()},fetch:function(){return this._fetch(arguments)},fetchRange:function(){return this._fetch(arguments,
!0)},_fetch:function(a,d){var b=this.cachingStore,e=this.cachingCollection||b,c=this,f=this.isAvailableInCache();if(f)return new l(p(f,function(){return c.isAvailableInCache()?d?e.fetchRange(a[0]):e.fetch():c.inherited(a)}));f=this.fetchRequest=this.inherited(a);p(f,function(a){var e=!d;c.fetchRequest=null;t.forEach(a,function(a){!c.isLoaded||c.isLoaded(a)?b.put(a):e=!1});e&&(c.allLoaded=!0);return a});return f},isValidFetchCache:!1,get:function(a,d){var b=this.cachingStore,e=this.getInherited(arguments),
c=this;return p(this.fetchRequest,function(){return p(b.get(a),function(f){if(void 0!==f)return f;if(e)return p(e.call(c,a,d),function(c){c&&b.put(c,{id:a});return c})})})},add:function(a,d){var b=this.cachingStore;return p(this.inherited(arguments),function(e){var c=b.put(e&&"object"===typeof e?e:a,d);return e||c})},put:function(a,d){var b=this.cachingStore;b.remove(d&&d.id||this.getIdentity(a));return p(this.inherited(arguments),function(e){var c=b.put(e&&"object"===typeof e?e:a,d);return e||c})},
remove:function(a,d){var b=this.cachingStore;return p(this.inherited(arguments),function(e){return p(b.remove(a,d),function(){return e})})},evict:function(a){this.allLoaded=!1;return this.cachingStore.remove(a)},invalidate:function(){this.allLoaded=!1},_createSubCollection:function(){var a=this.inherited(arguments);a._parent=this;return a},sort:k("sort"),filter:k("filter"),select:k("select"),_getQuerierFactory:function(a){var b=this.cachingStore;return this.inherited(arguments)||m.hitch(b,b._getQuerierFactory(a))}};
h=n(null,a);h.create=function(b,d){b=n.safeMixin(m.delegate(b),a);n.safeMixin(b,d);u(b);return b};return h})},"dstore/Trackable":function(){define("dojo/_base/lang dojo/_base/declare dojo/aspect dojo/when dojo/promise/all dojo/_base/array dojo/on".split(" "),function(t,p,n,m,h,e,l){function k(a,d,e){for(var b=a.length-1;0<=b;--b){var c=a[b],f=c.start,c=f+c.count;if(d>c){a.splice(b+1,0,{start:d,count:e-d});return}e>=f&&(d=Math.min(d,f),e=Math.max(e,c),a.splice(b,1))}a.unshift({start:d,count:e-d})}
var u=0,a={track:function(){function a(){return function(){var a=this,b=this.inherited(arguments);m(b,function(b){b=a._results=b.slice();a._partialResults&&(a._partialResults=null);a._ranges=[];k(a._ranges,0,b.length)});return b}}function d(){return function(a){var b=this,c=a.start,e=a.end,d=this.inherited(arguments);this._results||m(d,function(a){return m(a.totalLength,function(d){var f=b._partialResults||(b._partialResults=[]);e=Math.min(e,c+a.length);f.length=d;d=[c,e-c].concat(a);f.splice.apply(f,
d);k(b._ranges,c,e);return a})});return d}}function g(a,b){u++;var c=b.target;b=t.delegate(b,G[a]);m(x._results||x._partialResults,function(d){if(d){var f,g,k,l=x._ranges,m,n="id"in b?b.id:h.getIdentity(c),r=-1,p=-1,q=-1,u=-1;if("delete"===a||"update"===a)for(f=0;-1===r&&f<l.length;++f)for(m=l[f],g=m.start,k=g+m.count;g<k;++g)if(h.getIdentity(d[g])==n){r=b.previousIndex=g;p=f;d.splice(r,1);m.count--;for(g=f+1;g<l.length;++g)l[g].start--;break}if("add"===a||"update"===a){if(F){if(F([c]).length){var t=
0;k=l.length-1;g=-1;for(var v;t<=k&&-1===q;)f=t+Math.round((k-t)/2),m=l[f],p=d.slice(m.start,m.start+m.count),"beforeId"in b&&(g=null===b.beforeId?p.length:I(p,b.beforeId)),-1===g&&(g=r>=Math.max(0,m.start-1)&&r<=m.start+m.count?r:h.defaultNewToStart?0:p.length),p.splice(g,0,c),n=e.indexOf(F(p),c),v=m.start+n,0===n&&0!==m.start?k=f-1:n>=p.length-1&&v<d.length?t=f+1:(q=v,u=f);if(-1===q&&0<t&&t<l.length)var w=!0}}else{g=-1;if("beforeId"in b)if(null===b.beforeId)q=d.length,g=l.length-1;else for(f=0,
k=l.length;-1===u&&f<k;++f)m=l[f],q=I(d,b.beforeId,m.start,m.start+m.count),-1!==q&&(u=f);else"update"===a?(q=r,u=p):h.defaultNewToStart?g=q=0:(q=d.length,g=l.length-1);-1!==g&&-1===u&&(m=l[g])&&m.start<=q&&q<=m.start+m.count&&(u=g)}if(-1<q&&-1<u)for(b.index=q,d.splice(q,0,c),l[u].count++,f=u+1;f<l.length;++f)l[f].start++;else if(w)for(b.beforeIndex=l[t].start,f=t;f<l.length;++f)l[f].start++}b.totalLength=d.length}(d=x["on_tracked"+a])&&d.call(x,b)})}var h=this.store||this,c=[],f={add:1,update:1,
"delete":1},q;for(q in f)c.push(this.on(q,function(a){return function(b){g(a,b)}}(q)));var x=p.safeMixin(t.delegate(this),{_ranges:[],fetch:a(),fetchRange:d(),releaseRange:function(a,b){if(this._partialResults){a:for(var c=this._ranges,d=0,e;e=c[d];++d){var f=e.start,g=f+e.count;if(a<=f)if(b>=g)c.splice(d,1);else{e.start=b;e.count=g-e.start;break a}else if(a<g)if(b>f){c.splice(d,1,{start:f,count:a-f},{start:b,count:g-b});break a}else e.count=a-e.start}for(;a<b;++a)delete this._partialResults[a]}},
on:function(a,b){var c=this,d=this.getInherited(arguments);return l.parse(x,a,b,function(a,e){return e in f?n.after(x,"on_tracked"+e,b,!0):d.call(c,e,b)})},tracking:{remove:function(){for(;0<c.length;)c.pop().remove();this.remove=function(){}}},track:null});this.fetchSync&&(p.safeMixin(x,{fetchSync:a(),fetchRangeSync:d()}),x.fetchSync());var F;e.forEach(this.queryLog,function(a){var b=F,c=a.querier;c&&(F=b?function(a){return c(b(a))}:c)});var G={add:{index:void 0},update:{previousIndex:void 0,index:void 0},
"delete":{previousIndex:void 0}},I=function(a,b,c,d){d=void 0!==d?d:a.length;for(c=void 0!==c?c:0;c<d;++c)if(h.getIdentity(a[c])===b)return c;return-1};return x}};h=p(null,a);h.create=function(b,d){b=p.safeMixin(t.delegate(b),a);p.safeMixin(b,d);return b};return h})},"dstore/legacy/DstoreAdapter":function(){define(["dojo/_base/declare","dojo/_base/array","dojo/store/util/QueryResults"],function(t,p,n){function m(e){return e}var h={store:null,constructor:function(e){this.store=e;if(e._getQuerierFactory("filter")||
e._getQuerierFactory("sort"))this.queryEngine=function(h,l){l=l||{};var a=e._getQuerierFactory("filter"),b=a?a(h):m;h=e._getQuerierFactory("sort");var d=m;h&&(d=h(p.map(l.sort,function(a){return{property:a.attribute,descending:a.descending}})));var g=m;isNaN(l.start)&&isNaN(l.count)||(g=function(a){var b=l.start||0,b=a.slice(b,b+(l.count||Infinity));b.total=a.length;return b});return function(a){return g(d(b(a)))}};var h=this;e.on("add,update,delete",function(k){var l=k.type,a=k.target;h.notify("add"===
l||"update"===l?a:void 0,"delete"===l||"update"===l?"id"in k?k.id:e.getIdentity(a):void 0)})},labelAttr:"title",getLabel:function(e){return this.store.getLabel(e)},query:function(e,h){h=h||{};var k=this.store.filter(e),l,a;if(e=h.sort)if("[object Array]"===Object.prototype.toString.call(e))for(var b;b=e.pop();)k=k.sort(b.attribute,b.descending);else k=k.sort(e);k.track&&!k.tracking&&(k=k.track(),a=!0);"start"in h&&(l=h.start||0,l=k[k.fetchRangeSync?"fetchRangeSync":"fetchRange"]({start:l,end:h.count?
l+h.count:Infinity}));l=l||k[k.fetchSync?"fetchSync":"fetch"]();h=l.totalLength;l=new n(l);l.total=h;l.observe=function(b,e){function d(b){return void 0===b&&a?-1:b}var c=k.on("add",function(a){b(a.target,-1,d(a.index))}),f=k.on("update",function(a){!e&&a.previousIndex===a.index&&isFinite(a.index)||b(a.target,d(a.previousIndex),d(a.index))}),g=k.on("delete",function(a){b(a.target,d(a.previousIndex),-1)}),h={remove:function(){c.remove();f.remove();g.remove()}};h.cancel=h.remove;return h};return l},
notify:function(){}};p.forEach(["get","put","add","remove","getIdentity"],function(e){h[e]=function(){var h=this.store;return(h[e+"Sync"]||h[e]).apply(h,arguments)}});return t(null,h)})}}});
//# sourceMappingURL=dgrid.js.map