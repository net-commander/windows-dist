//>>built
require({cache:{"dgrid/main":function(){define("dgrid/Tree dgrid/Selection dgrid/OnDemandList dgrid/OnDemandGrid dgrid/extensions/ColumnReorder dgrid/extensions/ColumnResizer dgrid/extensions/CompoundColumns dgrid/extensions/Pagination dgrid/extensions/DnD dgrid/Editor dstore/Store dstore/Memory dstore/Tree dstore/Cache dstore/Trackable dstore/legacy/DstoreAdapter".split(" "),function(){})},"dgrid/Tree":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/aspect dojo/dom-construct dojo/dom-class dojo/on dojo/query dojo/when ./util/has-css3 ./Grid ./util/touch".split(" "),
function(t,p,n,m,g,d,l,k,u,a,b,e){return t(null,{collapseOnRefresh:!1,enableTreeTransitions:!1,treeIndentWidth:9,constructor:function(){this._treeColumnListeners=[]},shouldExpand:function(a,b,c){return c},expand:function(b,e,c){function f(f){!0===C.spin&&f.mayHaveChildren&&(d.remove(f,"fa-spin fa-spinner dgrid-cell-loading"),d.replace(f,"ui-icon-triangle-1-"+(v?"se":"e"),"ui-icon-triangle-1-"+(v?"e":"se")))}if(this._treeColumn){var q=this,h=b.element?b:this.row(b),r=!!this._expanded[h.id],G=a("transitionend"),
n,C=this.collection;if(b=h.element){b=-1<b.className.indexOf("dgrid-expando-icon")?b:k(".dgrid-expando-icon",b)[0];c=c||!this.enableTreeTransitions;if(b&&b.mayHaveChildren&&(c||e!==r)){var v=void 0===e?!this._expanded[h.id]:e;!0===C.spin&&e?(d.remove(b,"ui-icon-triangle-1-e"),d.remove(b,"ui-icon-triangle-1-se"),d.add(b,"fa fa-spinner fa-spin dgrid-cell-loading")):d.replace(b,"ui-icon-triangle-1-"+(v?"se":"e"),"ui-icon-triangle-1-"+(v?"e":"se"));d.toggle(h.element,"dgrid-row-expanded",v);e=h.element;
var m=e.connected,w,y,t={};if(!m){var m=t.container=e.connected=g.create("div",{className:"dgrid-tree-container"},e,"after"),z=function(f){var c=q._renderedCollection.getChildren(h.data);q.sort&&(c=c.sort(q.sort));c.track&&q.shouldTrackCollection&&(m._rows=f.rows=[],c=c.track(),m._handles=[c.tracking,q._observeCollection(c,m,f)]);return"start"in f?c.fetchRange({start:f.start,end:f.start+f.count}):c.fetch()};"level"in b&&(z.level=b.level);if(this.renderQuery)n=this.renderQuery(z,t);else{var E=g.create("div",
null,m);n=this._trackError(function(){return q.renderQueryResults(z(t),E,p.mixin({rows:t.rows},"level"in z?{queryLevel:z.level}:null)).then(function(f){g.destroy(E);return f})})}G&&l(m,G,this._onTreeTransitionEnd)}m.hidden=!v;w=m.style;!G||c?(w.display=v?"block":"none",w.height=""):(v?(w.display="block",y=m.scrollHeight,w.height="0px"):(d.add(m,"dgrid-tree-resetting"),w.height=m.scrollHeight+"px"),setTimeout(function(){d.remove(m,"dgrid-tree-resetting");w.height=v?y?y+"px":"auto":"0px"},0));v?this._expanded[h.id]=
!0:delete this._expanded[h.id]}n&&n.then?n.then(function(){f(b)}):f(b);return u(n)}}},_configColumns:function(){var a=this.inherited(arguments);this._expanded={};for(var b=0,c=a.length;b<c;b++)if(a[b].renderExpando){this._configureTreeColumn(a[b]);break}return a},insertRow:function(a){var b=this.inherited(arguments),c=this.row(b);(c=this.shouldExpand(c,this._currentLevel,this._expanded[c.id]))&&this.expand(b,!0,!0);(c||!this.collection.mayHaveChildren||this.collection.mayHaveChildren(a))&&d.add(b,
"dgrid-row-expandable");return b},removeRow:function(a,b){var c=a.connected,f={};c&&(c._handles&&(n.forEach(c._handles,function(f){f.remove()}),delete c._handles),c._rows&&(f.rows=c._rows),k("\x3e.dgrid-row",c).forEach(function(c){this.removeRow(c,!0,f)},this),c._rows&&(c._rows.length=0,delete c._rows),b||g.destroy(c));this.inherited(arguments)},_refreshCellFromItem:function(a,b){if(!a.column.renderExpando)return this.inherited(arguments);this.inherited(arguments,[a,b,{queryLevel:k(".dgrid-expando-icon",
a.element)[0].level-1}])},cleanup:function(){this.inherited(arguments);this.collapseOnRefresh&&(this._expanded={})},_destroyColumns:function(){this.inherited(arguments);for(var a=this._treeColumnListeners,b=a.length;b--;)a[b].remove();this._treeColumnListeners=[];this._treeColumn=null},_calcRowHeight:function(a){var b=a.connected;return this.inherited(arguments)+(b?b.offsetHeight:0)},_configureTreeColumn:function(b){var h=this,c=this.collection,f=".dgrid-content .dgrid-column-"+b.id,q;this._treeColumn=
b;if(!b._isConfiguredTreeColumn){var x=b.renderCell||this._defaultRenderCell;b._isConfiguredTreeColumn=!0;b.renderCell=function(f,a,q,e){if(c){var r=Number(e&&e.queryLevel)+1,k=!c.mayHaveChildren||c.mayHaveChildren(f),d,r=h._currentLevel=isNaN(r)?0:r;d=b.renderExpando(r,k,h._expanded[c.getIdentity(f)],f);d.level=r;d.mayHaveChildren=k;(f=x.call(b,f,a,q,e))&&f.nodeType?(q.appendChild(d),q.appendChild(f)):q.insertBefore(d,q.firstChild)}};"function"!==typeof b.renderExpando&&(b.renderExpando=this._defaultRenderExpando)}var k=
this._treeColumnListeners;0===k.length&&(k.push(this.on(b.expandOn||".dgrid-expando-icon:click,"+f+":dblclick,"+f+":keydown",function(f){var c=h.row(f);h.collection.mayHaveChildren&&!h.collection.mayHaveChildren(c.data)||"keydown"===f.type&&32!==f.keyCode||"dblclick"===f.type&&q&&1<q.count&&c.id===q.id&&-1<f.target.className.indexOf("dgrid-expando-icon")||h.expand(c);-1<f.target.className.indexOf("dgrid-expando-icon")&&(q&&q.id===h.row(f).id?q.count++:q={id:h.row(f).id,count:1})})),a("touch")&&k.push(this.on(e.selector(f,
e.dbltap),function(){h.expand(this)})))},_defaultRenderExpando:function(a,b,c){var f=this.grid.isRTL?"right":"left",q="dgrid-expando-icon";b&&(q+=" ui-icon ui-icon-triangle-1-"+(c?"se":"e"));return g.create("div",{className:q,innerHTML:"\x26nbsp;",style:"margin-"+f+": "+a*this.grid.treeIndentWidth+"px; float: "+f+";"})},_onNotification:function(a,b){"delete"===b.type&&delete this._expanded[b.id];this.inherited(arguments)},_onTreeTransitionEnd:function(a){var b=this,c=this.style.height;c&&(this.style.display=
"0px"===c?"none":"block");a&&(d.add(this,"dgrid-tree-resetting"),setTimeout(function(){d.remove(b,"dgrid-tree-resetting")},0));this.style.height=""}})})},"dgrid/util/has-css3":function(){define(["dojo/has"],function(t){function p(m,g){m=m.style;var d;if(g in m)return!0;g=g.slice(0,1).toUpperCase()+g.slice(1);for(d=n.length;d--;)if(n[d]+g in m)return n[d];return!1}var n=["ms","O","Moz","Webkit"];t.add("css-transitions",function(m,g,d){return p(d,"transitionProperty")});t.add("css-transforms",function(m,
g,d){return p(d,"transform")});t.add("css-transforms3d",function(m,g,d){return p(d,"perspective")});t.add("transitionend",function(){var m=t("css-transitions");return m?!0===m?"transitionend":{ms:"MSTransitionEnd",O:"oTransitionEnd",Moz:"transitionend",Webkit:"webkitTransitionEnd"}[m]:!1});return t})},"dgrid/Grid":function(){define("dojo/_base/declare dojo/_base/lang dojo/dom-construct dojo/dom-class dojo/on dojo/has ./List ./util/misc dojo/_base/sniff".split(" "),function(t,p,n,m,g,d,l,k){function u(a,
b){b&&b.nodeType&&a.appendChild(b)}t=t(l,{columns:null,hasNeutralSort:!1,cellNavigation:!0,tabableHeader:!0,showHeader:!0,column:function(a){return"object"!==typeof a?this.columns[a]:this.cell(a).column},listType:"grid",cell:function(a,b){if(a.column&&a.element)return a;a.target&&a.target.nodeType&&(a=a.target);var e;if(a.nodeType){do{if(this._rowIdToObject[a.id])break;var h=a.columnId;if(h){b=h;e=a;break}a=a.parentNode}while(a&&a!==this.domNode)}if(!e&&"undefined"!==typeof b){var r=this.row(a);if(h=
r&&r.element)for(var h=h.getElementsByTagName("td"),c=0;c<h.length;c++)if(h[c].columnId===b){e=h[c];break}}if(null!=a)return{row:r||this.row(a),column:b&&this.column(b),element:e}},createRowCells:function(a,b,e,h,r){var c=n.create("table",{className:"dgrid-row-table",role:"presentation"}),f=9>d("ie")?n.create("tbody",null,c):c,q,x,g,u,l,C,v,m,p,t;e=e||this.subRows;x=0;for(g=e.length;x<g;x++)for(C=e[x],q=n.create("tr",null,f),C.className&&(q.className=C.className),u=0,l=C.length;u<l;u++){v=C[u];m=
v.id;p=v.field?" field-"+k.escapeCssIdentifier(v.field,"-"):"";(t="function"===typeof v.className?v.className(h):v.className)&&(p+=" "+t);p=n.create(a,{className:"dgrid-cell"+(m?" dgrid-column-"+k.escapeCssIdentifier(m,"-"):"")+p,role:"th"===a?"columnheader":"gridcell"});p.columnId=m;if(m=v.colSpan)p.colSpan=m;if(m=v.rowSpan)p.rowSpan=m;b(p,v,h,r);q.appendChild(p)}return c},_createBodyRowCell:function(a,b,e,h){var r=e;b.get?r=b.get(e):"field"in b&&"_item"!==b.field&&(r=e[b.field]);b.renderCell?u(a,
b.renderCell(e,r,a,h)):this._defaultRenderCell.call(b,e,r,a,h)},_createHeaderRowCell:function(a,b){var e=b.headerNode=a,h=b.field;h&&(a.field=h);b.renderHeaderCell?u(e,b.renderHeaderCell(e)):("label"in b||b.field)&&e.appendChild(document.createTextNode("label"in b?b.label:b.field));!1!==b.sortable&&h&&"_item"!==h&&(a.sortable=!0,a.className+=" dgrid-sortable")},left:function(a,b){a.element||(a=this.cell(a));return this.cell(this._move(a,-(b||1),"dgrid-cell"))},right:function(a,b){a.element||(a=this.cell(a));
return this.cell(this._move(a,b||1,"dgrid-cell"))},_defaultRenderCell:function(a,b,e){if(this.formatter){var h=this.formatter,r=this.grid.formatterScope;e.innerHTML="string"===typeof h&&r?r[h](b,a):this.formatter(b,a)}else null!=b&&e.appendChild(document.createTextNode(b))},renderRow:function(a,b){a=this.createRowCells("td",p.hitch(this,"_createBodyRowCell"),b&&b.subRows,a,b);b=n.create("div",{role:"row"});b.appendChild(a);return b},renderHeader:function(){var a=this,b=this.headerNode;b.setAttribute("role",
"row");n.empty(b);var e=this.createRowCells("th",p.hitch(this,"_createHeaderRowCell"),this.subRows&&this.subRows.headerRows);this._rowIdToObject[e.id=this.id+"-header"]=this.columns;b.appendChild(e);this._sortListener&&this._sortListener.remove();this._sortListener=g(e,"click,keydown",function(e){if("click"===e.type||32===e.keyCode||!d("opera")&&13===e.keyCode){var h=e.target,c,f;do if(h.sortable){c=h.field||h.columnId;f=a.sort[0];c=a.hasNeutralSort&&f&&f.property===c&&f.descending?[]:[{property:c,
descending:f&&f.property===c&&!f.descending}];f={bubbles:!0,cancelable:!0,grid:a,parentType:e.type,sort:c};g.emit(e.target,"dgrid-sort",f)&&(a._sortNode=h,a.set("sort",c));break}while((h=h.parentNode)&&h!==b)}})},resize:function(){if(this.headerNode){var a=this.headerNode.firstChild,b=this.contentNode,e;this.inherited(arguments);b.style.width="";b&&a&&(e=a.offsetWidth)>b.offsetWidth&&(b.style.width=e+"px")}},destroy:function(){this._destroyColumns();this._sortListener&&this._sortListener.remove();
this.inherited(arguments)},_setSort:function(){this.inherited(arguments);this.updateSortArrow(this.sort)},_findSortArrowParent:function(a){var b=this.columns,e;for(e in b){var h=b[e];if(h.field===a)return h.headerNode}},updateSortArrow:function(a,b){this._lastSortedArrow&&(m.remove(this._lastSortedArrow.parentNode,"dgrid-sort-up dgrid-sort-down"),n.destroy(this._lastSortedArrow),delete this._lastSortedArrow);b&&(this.sort=a);a[0]&&(b=a[0].property,a=a[0].descending,b=this._sortNode||this._findSortArrowParent(b),
delete this._sortNode,b&&(b=b.contents||b,this._lastSortedArrow=n.create("div",{className:"dgrid-sort-arrow ui-icon",innerHTML:"\x26nbsp;",role:"presentation"},b,"first"),m.add(b,"dgrid-sort-"+(a?"down":"up")),this.resize()))},styleColumn:function(a,b){return this.addCssRule("#"+k.escapeCssIdentifier(this.domNode.id)+" .dgrid-column-"+k.escapeCssIdentifier(a,"-"),b)},_configColumns:function(a,b){var e=[],h=b instanceof Array;k.each(b,function(r,c){"string"===typeof r&&(b[c]=r={label:r});h||r.field||
(r.field=c);c=r.id=r.id||(isNaN(c)?c:a+c);this._configColumn&&(this._configColumn(r,b,a),c=r.id);h&&(this.columns[c]=r);r.grid=this;e.push(r)},this);return h?b:e},_destroyColumns:function(){this.cleanup()},configStructure:function(){var a=this.subRows,b=this._columns=this.columns;this.columns=!b||b instanceof Array?{}:b;if(a)for(b=0;b<a.length;b++)a[b]=this._configColumns(b+"-",a[b]);else this.subRows=[this._configColumns("",b)]},_getColumns:function(){return this._columns||this.columns},_setColumns:function(a){this._destroyColumns();
this.subRows=null;this.columns=a;this._updateColumns()},_setSubRows:function(a){this._destroyColumns();this.subRows=a;this._updateColumns()},_updateColumns:function(){this.configStructure();this.renderHeader();this.refresh();this._lastCollection&&this.renderArray(this._lastCollection);this._started&&(this.sort.length?(this._lastSortedArrow=null,this.updateSortArrow(this.sort)):this.resize())}});t.appendIfNode=u;return t})},"dgrid/List":function(){define("dojo/_base/declare dojo/dom-construct dojo/dom-class dojo/on dojo/has ./util/misc xide/$".split(" "),
function(t,p,n,m,g,d,l){function k(f,a){f.className="dgrid-scrollbar-measure";document.body.appendChild(f);a=f["offset"+a]-f["client"+a];f.className="";f.parentNode&&document.body.removeChild(f);return a}function u(f){n.replace(this.domNode,f,this._class||"");this._class=f}function a(){return this._class}var b=[];g("mozilla")&&b.push("has-mozilla");g("touch")&&b.push("has-touch");n.add(document.documentElement,b);g.add("pointer",function(f){return"PointerEvent"in f?"pointer":"MSPointerEvent"in f?
"MSPointer":!1});var e,h;g.add("dom-scrollbar-width",function(f,a,c){return k(c,"Width")});g.add("dom-scrollbar-height",function(f,a,c){return k(c,"Height")});g.add("dom-rtl-scrollbar-left",function(f,a,c){f=document.createElement("div");c.className="dgrid-scrollbar-measure";c.setAttribute("dir","rtl");c.appendChild(f);document.body.appendChild(c);a=!!g("ie")||!!g("trident")||/\bEdge\//.test(navigator.userAgent)||f.offsetLeft>=g("dom-scrollbar-width");c.className="";c.parentNode&&document.body.removeChild(c);
p.destroy(f);c.removeAttribute("dir");return a});var r=0,c=t(null,{tabableHeader:!1,showHeader:!1,showFooter:!1,maintainOddEven:!0,cleanAddedRules:!0,addUiClasses:!1,highlightDuration:250,postscript:function(f,c){var a=this;(this._Row=function(f,c,a){this.id=f;this.data=c;this.element=a}).prototype.remove=function(){a.removeRow(this.element)};c&&(this.srcNodeRef=c=c.nodeType?c:document.getElementById(c));this.create(f,c)},listType:"list",create:function(f,a){a=this.domNode=a||document.createElement("div");
var b;f&&(this.params=f,t.safeMixin(this,f),b=f["class"]||f.className||a.className);this.sort=this.sort||[];this._listeners=[];this._rowIdToObject={};this.postMixInProperties&&this.postMixInProperties();this.id=a.id=a.id||this.id||c.autoIdPrefix+r++;this.buildRendering();b&&u.call(this,b);this.postCreate();delete this.srcNodeRef},buildRendering:function(){var f=this.domNode,c=this.addUiClasses,a=this,b,e,h;h=this.isRTL="rtl"===(document.body.dir||document.documentElement.dir||document.body.style.direction).toLowerCase();
f.className="";f.setAttribute("role","grid");n.add(f,"dgrid dgrid-"+this.listType+(c?" ui-widget":""));b=this.headerNode=p.create("div",{tabIndex:-1,className:"dgrid-header dgrid-header-row"+(c?" ui-widget-header":"")+(this.showHeader?"":" dgrid-header-hidden")},f);e=this.bodyNode=p.create("div",{className:"dgrid-scroller"},f);g("ff")&&(e.tabIndex=-1);this.headerScrollNode=p.create("div",{className:"dgrid-header dgrid-header-scroll dgrid-scrollbar-width"+(c?" widget":"")},f);this.footerNode=p.create("div",
{className:"dgrid-footer"+(this.showFooter?"":" dgrid-footer-hidden")},f);h&&(f.className+=" dgrid-rtl"+(g("dom-rtl-scrollbar-left")?" dgrid-rtl-swap":""));m(e,"scroll",function(c){a.showHeader&&(b.scrollLeft=c.scrollLeft||e.scrollLeft);c.stopPropagation();m.emit(f,"scroll",{scrollTarget:e})});this.configStructure();this.renderHeader();this.contentNode=this.touchNode=p.create("div",{className:"dgrid-content"+(c?" widget":"")},this.bodyNode)},startup:function(){this._started||(this.inherited(arguments),
this._started=!0,this.set("sort",this.sort))},configStructure:function(){},resize:function(){var f=this.bodyNode,c=this.footerNode,c=this.showFooter?c.offsetHeight:0;this.headerScrollNode.style.height=f.style.marginTop=this.headerNode.offsetHeight+"px";f.style.marginBottom=c+"px";e||(e=g("dom-scrollbar-width"),h=g("dom-scrollbar-height"),g("ie")&&(e++,h++),17!==e&&d.addCssRule(".dgrid-rtl-swap .dgrid-header-row","left: "+e+"px"))},addCssRule:function(f,c){f=d.addCssRule(f,c);this.cleanAddedRules&&
this._listeners.push(f);return f},on:function(f,c){f=m(this.domNode,f,c);g("dom-addeventlistener")||this._listeners.push(f);return f},cleanup:function(){for(var f in this._rowIdToObject)if(this._rowIdToObject[f]!==this.columns){var c=document.getElementById(f);c&&this.removeRow(c,!0)}},destroy:function(){if(this._listeners){for(var f=this._listeners.length;f--;)this._listeners[f].remove();this._listeners=null}this._started=!1;this.cleanup();l(this.domNode).remove()},refresh:function(){this.cleanup();
this._rowIdToObject={};this._autoRowId=0;l(this.contentNode).empty()},adjustRowIndices:function(f){var c=f.rowIndex;if(-1<c){do-1<f.rowIndex&&(this.maintainOddEven&&n.contains(f,"dgrid-row")&&n.replace(f,1===c%2?"dgrid-row-odd":"dgrid-row-even",0===c%2?"dgrid-row-odd":"dgrid-row-even"),f.rowIndex=c++);while((f=f.nextSibling)&&f.rowIndex!==c)}},renderArray:function(f,c,a){a=a||{};var b=a.start||0,e=document.createDocumentFragment(),h=[],q=0,r=f.length;c||(this._lastCollection=f);for(;q<r;)h[q]=this.insertRow(f[q],
e,null,b++,a),q++;(f=c?c.parentNode:this.contentNode)&&f.parentNode&&(f!==this.contentNode||r)&&(f.insertBefore(e,c||null),r&&this.adjustRowIndices(h[r-1]));return h},renderHeader:function(){},_autoRowId:0,insertRow:function(f,c,a,b,e){var h=this.id+"-row-"+(this.collection&&this.collection.getIdentity?this.collection.getIdentity(f):this._autoRowId++),q=document.getElementById(h),r=q&&q.previousSibling;q&&(q===a&&(a=(a.connected||a).nextSibling),this.removeRow(q,!1,e));q=this.renderRow(f,e);q.className=
(q.className||"")+" dgrid-row "+(1===b%2?"dgrid-row-odd":"dgrid-row-even");this._rowIdToObject[q.id=h]=f;c.insertBefore(q,a||null);q.rowIndex=b;r&&r.rowIndex!==q.rowIndex-1&&this.adjustRowIndices(r);return q},renderRow:function(f){var c=document.createElement("div");c.appendChild(document.createTextNode(f));return c},removeRow:function(f,c){f=f.element||f;delete this._rowIdToObject[f.id];c||l(f).remove()},row:function(f){var c;if(f instanceof this._Row)return f;if(!f)return null;f.target&&f.target.nodeType&&
(f=f.target);if(f.nodeType){do{var a=f.id;if(c=this._rowIdToObject[a])return new this._Row(a.substring(this.id.length+5),c,f);f=f.parentNode}while(f&&f!==this.domNode)}else return"object"===typeof f?c=this.collection.getIdentity(f):(c=f,f=this._rowIdToObject[this.id+"-row-"+c]),new this._Row(c,f,document.getElementById(this.id+"-row-"+c))},cell:function(f){return{row:this.row(f)}},_move:function(f,c,a,b){var e,h;h=e=f.element;c=c||1;do if(f=e[0>c?"previousSibling":"nextSibling"]){do if((e=f)&&-1<
(e.className+" ").indexOf(a+" ")){h=e;c+=0>c?1:-1;break}while(f=(!b||!e.hidden)&&e[0>c?"lastChild":"firstChild"])}else if(e=e.parentNode,!e||e===this.bodyNode||e===this.headerNode)break;while(c);return h},up:function(c,a,b){c.element||(c=this.row(c));return this.row(this._move(c,-(a||1),"dgrid-row",b))},down:function(c,a,b){c.element||(c=this.row(c));return this.row(this._move(c,a||1,"dgrid-row",b))},scrollTo:function(c){"undefined"!==typeof c.x&&(this.bodyNode.scrollLeft=c.x);"undefined"!==typeof c.y&&
(this.bodyNode.scrollTop=c.y)},getScrollPosition:function(){return{x:this.bodyNode.scrollLeft,y:this.bodyNode.scrollTop}},get:function(c){var f="_get"+c.charAt(0).toUpperCase()+c.slice(1);return"function"===typeof this[f]?this[f].apply(this,[].slice.call(arguments,1)):this[c]},set:function(c,a){if("object"===typeof c)for(var f in c)this.set(f,c[f]);else f="_set"+c.charAt(0).toUpperCase()+c.slice(1),"function"===typeof this[f]?this[f].apply(this,[].slice.call(arguments,1)):this[c]=a;return this},_getClass:a,
_setClass:u,_getClassName:a,_setClassName:u,_setSort:function(c,a){this.sort="string"!==typeof c?c:[{property:c,descending:a}];this._applySort()},_applySort:function(){this.refresh();if(this._lastCollection){var c=this.sort;if(c&&0<c.length){var a=c[0].property,b=!!c[0].descending;this._lastCollection.sort(function(c,f){c=c[a];f=f[a];void 0===c&&(c="");void 0===f&&(f="");return c===f?0:c>f!==b?1:-1})}this.renderArray(this._lastCollection)}},_setShowHeader:function(c){var f=this.headerNode;this.showHeader=
c;n.toggle(f,"dgrid-header-hidden",!c);this.renderHeader();this.resize();c&&(f.scrollLeft=this.getScrollPosition().x)},_setShowFooter:function(c){this.showFooter=c;n.toggle(this.footerNode,"dgrid-footer-hidden",!c);this.resize()}});c.autoIdPrefix="dgrid_";return c})},"dgrid/util/misc":function(){define(["dojo/has"],function(t){t.add("dom-contains",function(k,d,a){return!!a.contains});var p=[],n,m,g,d=/([^A-Za-z0-9_\u00A0-\uFFFF-])/g,l={defaultDelay:15,throttle:function(k,d,a){var b=!1;a=a||l.defaultDelay;
return function(){b||(b=!0,k.apply(d,arguments),setTimeout(function(){b=!1},a))}},throttleDelayed:function(k,d,a){var b=!1;a=a||l.defaultDelay;return function(){if(!b){b=!0;var e=arguments;setTimeout(function(){b=!1;k.apply(d,e)},a)}}},debounce:function(k,d,a){var b;a=a||l.defaultDelay;return function(){b&&(clearTimeout(b),b=null);var e=arguments;b=setTimeout(function(){k.apply(d,e)},a)}},each:function(d,g,a){var b,e;if(d)if("number"===typeof d.length)for(b=0,e=d.length;b<e;b++)g.call(a,d[b],b,d);
else for(b in d)g.call(a,d[b],b,d)},contains:function(d,g){return t("dom-contains")?d.contains(g):d.compareDocumentPosition(g)&8},addCssRule:function(d,l){n||(n=document.createElement("style"),document.getElementsByTagName("head")[0].appendChild(n),n=n.sheet||n.styleSheet,m=n.deleteRule?"deleteRule":"removeRule",g=n.cssRules?"cssRules":"rules");var a=p.length;p[a]=(n.cssRules||n.rules).length;n.addRule?n.addRule(d,l):n.insertRule(d+"{"+l+"}",p[a]);return{get:function(b){return n[g][p[a]].style[b]},
set:function(b,e){"undefined"!==typeof p[a]&&(n[g][p[a]].style[b]=e)},remove:function(){var b=p[a],e,h;if(void 0!==b)for(n[m](b),p[a]=void 0,e=a+1,h=p.length;e<h;e++)p[e]>b&&p[e]--}}},escapeCssIdentifier:function(k,g){return"string"===typeof k?k.replace(d,g||"\\$1"):k}};return l})},"dgrid/util/touch":function(){define(["dojo/on"],function(t,p){function n(g,d,l,k){if(!(1<l.targetTouches.length)){var u=l.changedTouches[0],a=u.screenX,b=u.screenY;k&&l.preventDefault();var e=t(g,"touchend",function(h){var r=
h.changedTouches[0];h.targetTouches.length||(Math.abs(r.screenX-a)<m.tapRadius&&Math.abs(r.screenY-b)<m.tapRadius&&(k&&h.preventDefault(),d.call(this,h)),e.remove())})}}var m={tapRadius:10,dbltapTime:250,selector:function(g,d,l){return function(k,u){var a=d.bubble;a?d=a:!1!==l&&(l=!0);return t(k,d,function(a){var b=a.target;3===b.nodeType&&(b=b.parentNode);for(;!p.matches(b,g,k);)if(b===k||!l||!(b=b.parentNode))return;return u.call(b,a)})}},countCurrentTouches:function(g,d){if(!("touches"in g))return-1;
var l,k,u;for(k=l=0;u=g.touches[l];++l)d.contains(u.target)&&++k;return k},tap:function(g,d){return t(g,"touchstart",function(l){n(g,d,l)})},dbltap:function(g,d){var l,k;return t(g,"touchstart",function(u){l?n(g,function(a){if(l){var b=a.changedTouches[0];Math.abs(b.screenX-l.screenX)<m.tapRadius&&Math.abs(b.screenY-l.screenY)<m.tapRadius&&(k&&clearTimeout(k),l=k=null,d.call(this,a))}},u,!0):n(g,function(a){l=a.changedTouches[0];k=setTimeout(function(){l=k=null},m.dbltapTime)},u)})}};return m})},
"dgrid/Selection":function(){define("dojo/_base/declare dojo/dom-class dojo/on dojo/has dojo/aspect ./List dgrid/util/touch dojo/query dojo/_base/sniff dojo/dom".split(" "),function(t,p,n,m,g,d,l){function k(c,a){a=c.unselectable=a?"on":"";c=c.getElementsByTagName("*");for(var f=c.length;--f;)"INPUT"!==c[f].tagName&&"TEXTAREA"!==c[f].tagName&&(c[f].unselectable=a)}function u(c,a){var f=c.bodyNode,e=a?"text":21>m("ff")?"-moz-none":"none";b&&"msUserSelect"!==b?f.style[b]=e:m("dom-selectstart")?a||c._selectstartHandle?
a&&c._selectstartHandle&&(c._selectstartHandle.remove(),delete c._selectstartHandle):c._selectstartHandle=n(f,"selectstart",function(c){var a=c.target&&c.target.tagName;"INPUT"!==a&&"TEXTAREA"!==a&&c.preventDefault()}):(k(f,!a),a||c._unselectableHandle)?a&&c._unselectableHandle&&(c._unselectableHandle.remove(),delete c._unselectableHandle):c._unselectableHandle=g.after(c,"renderRow",function(c){k(c,!0);return c})}m.add("dom-comparedocumentposition",function(c,a,b){return!!b.compareDocumentPosition});
m.add("dom-selectstart","undefined"!==typeof document.onselectstart);var a=m("mac")?"metaKey":"ctrlKey",b=m("css-user-select"),e=(d=m("pointer"))&&"MS"===d.slice(0,2),h=d?d+(e?"Down":"down"):"mousedown",r=d?d+(e?"Up":"up"):"mouseup";"WebkitUserSelect"===b&&"undefined"!==typeof document.documentElement.style.msUserSelect&&(b=!1);return t(null,{selectionDelegate:".dgrid-row",selectionEvents:h+","+r+",dgrid-cellfocusin",selectionTouchEvents:m("touch")?l.tap:null,deselectOnRefresh:!0,allowSelectAll:!1,
selection:{},selectionMode:"extended",allowTextSelection:void 0,_selectionTargetType:"rows",create:function(){this.selection={};return this.inherited(arguments)},postCreate:function(){this.inherited(arguments);this._initSelectionEvents();var c=this.selectionMode;this.selectionMode="";this._setSelectionMode(c)},destroy:function(){this.inherited(arguments);this._selectstartHandle&&this._selectstartHandle.remove();this._unselectableHandle&&this._unselectableHandle.remove();this._removeDeselectSignals&&
this._removeDeselectSignals()},_setSelectionMode:function(c){c!==this.selectionMode&&(this.clearSelection(),this.selectionMode=c,this._selectionHandlerName="_"+c+"SelectionHandler",this._setAllowTextSelection(this.allowTextSelection))},_setAllowTextSelection:function(c){"undefined"!==typeof c?u(this,c):u(this,"none"===this.selectionMode);this.allowTextSelection=c},_handleSelect:function(c,a){if(this[this._selectionHandlerName]&&this.allowSelect(this.row(a))&&("dgrid-cellfocusin"!==c.type||"mousedown"!==
c.parentType)&&(c.type!==r||a===this._waitForMouseUp)){this._waitForMouseUp=null;this._selectionTriggerEvent=c;if(!c.keyCode||!c.ctrlKey||32===c.keyCode)if(!c.shiftKey&&c.type===h&&this.isSelected(a))this._waitForMouseUp=a;else this[this._selectionHandlerName](c,a);this._selectionTriggerEvent=null}},_singleSelectionHandler:function(c,f){c=c.keyCode?c.ctrlKey:c[a];this._lastSelected===f?this.select(f,null,!c||!this.isSelected(f)):(this.clearSelection(),this.select(f),this._lastSelected=f)},_multipleSelectionHandler:function(c,
f){var b=this._lastSelected,e=c.keyCode?c.ctrlKey:c[a],h;c.shiftKey||(h=e?null:!0,b=null);this.select(f,b,h,null,-1!==c.type.indexOf("mouse")?"mouse":c.type);b||(this._lastSelected=f)},_extendedSelectionHandler:function(c,f){(2===c.button?this.isSelected(f):c.keyCode?c.ctrlKey:c[a])||this.clearSelection(null,!0);this._multipleSelectionHandler(c,f)},_toggleSelectionHandler:function(c,a){this.select(a,null,null)},_initSelectionEvents:function(){var c=this,f=this.contentNode,b=this.selectionDelegate;
this._selectionEventQueues={deselect:[],select:[]};m("touch")&&!m("pointer")&&this.selectionTouchEvents?(n(f,l.selector(b,this.selectionTouchEvents),function(a){c._handleSelect(a,this);c._ignoreMouseSelect=this}),n(f,n.selector(b,this.selectionEvents),function(a){c._ignoreMouseSelect!==this?c._handleSelect(a,this):a.type===r&&(c._ignoreMouseSelect=null)})):n(f,n.selector(b,this.selectionEvents),function(a){c._handleSelect(a,this)});this.addKeyHandler&&this.addKeyHandler(32,function(a){c._handleSelect(a,
a.target)});if(this.allowSelectAll)this.on("keydown",function(f){f[a]&&65===f.keyCode&&!/\bdgrid-input\b/.test(f.target.className)&&(f.preventDefault(),c[c.allSelected?"clearSelection":"selectAll"]())});this._setCollection&&g.before(this,"_setCollection",function(a){c._updateDeselectionAspect(a)});this._updateDeselectionAspect()},_updateDeselectionAspect:function(c){function a(c,a,f){if((c=b.row(c))&&b.selection[c.id])b[a](c,null,!0,null,f)}var b=this,e;this._removeDeselectSignals&&this._removeDeselectSignals();
e=c&&c.track&&this._observeCollection?[g.before(this,"_observeCollection",function(c){e.push(c.on("delete",function(c){"undefined"===typeof c.index&&a(c.id,"deselect")}))}),g.after(this,"_observeCollection",function(c){e.push(c.on("update",function(f){"undefined"!==typeof f.index&&a(c.getIdentity(f.target),"select","update")}))},!0)]:[g.before(this,"removeRow",function(c,a){a||(c=this.row(c))&&c.id in this.selection&&this.deselect(c)})];this._removeDeselectSignals=function(){for(var c=e.length;c--;)e[c].remove();
e=[]}},allowSelect:function(){return!0},_fireSelectionEvent:function(c){var a=this._selectionEventQueues[c],b=this._selectionTriggerEvent,e;e={bubbles:!0,grid:this};b&&(e.parentType=b.type);e[this._selectionTargetType]=a;this._selectionEventQueues[c]=[];n.emit(this.contentNode,"dgrid-"+c,e)},_fireSelectionEvents:function(){var c=this._selectionEventQueues,a;for(a in c)c[a].length&&this._fireSelectionEvent(a)},_select:function(c,a,b){var f,e,h;"undefined"===typeof b&&(b=!0);c.element||(c=this.row(c));
if(!1===b||this.allowSelect(c))if(f=this.selection,e=!!f[c.id],null===b&&(b=!e),h=c.element,b||this.allSelected?f[c.id]=b:delete this.selection[c.id],h&&(b?p.add(h,"dgrid-selected"+(this.addUiClasses?" ui-state-active":"")):p.remove(h,"dgrid-selected ui-state-active")),b!==e&&h&&this._selectionEventQueues[(b?"":"de")+"select"].push(c),a)if(a.element||(a=this.row(a)),a){if(a=a.element)for(f=this._determineSelectionDirection(h,a),f||(a=document.getElementById(a.id),f=this._determineSelectionDirection(h,
a));c.element!==a&&(c=this[f](c));)this._select(c,null,b)}else this._lastSelected=h},_determineSelectionDirection:m("dom-comparedocumentposition")?function(c,a){c=a.compareDocumentPosition(c);return c&1?!1:2===c?"down":"up"}:function(c,a){return 1>a.sourceIndex?!1:a.sourceIndex>c.sourceIndex?"down":"up"},select:function(c,a,b){this._select(c,a,b);this._fireSelectionEvents()},deselect:function(c,a){this.select(c,a,!1)},clearSelection:function(c,a){this.allSelected=!1;for(var b in this.selection)c!==
b&&this._select(b,null,!1);a||(this._lastSelected=null);this._fireSelectionEvents()},selectAll:function(){this.allSelected=!0;this.selection={};for(var c in this._rowIdToObject){var a=this.row(this._rowIdToObject[c]);this._select(a.id,null,!0)}this._fireSelectionEvents()},isSelected:function(c){if("undefined"===typeof c||null===c)return!1;c.element||(c=this.row(c));return c.id in this.selection?!!this.selection[c.id]:this.allSelected&&(!c.data||this.allowSelect(c))},refresh:function(){this.deselectOnRefresh&&
this.clearSelection();this._lastSelected=null;return this.inherited(arguments)},renderArray:function(){var c=this.inherited(arguments),a=this.selection,b,e,h;for(b=0;b<c.length;b++)e=this.row(c[b]),(h=e.id in a?a[e.id]:this.allSelected)&&this.select(e,null,h,null,"renderArray");this._fireSelectionEvents();return c}})})},"dgrid/OnDemandList":function(){define("./List ./_StoreMixin dojo/_base/declare dojo/_base/lang dojo/dom-construct dojo/on dojo/when ./util/misc".split(" "),function(t,p,n,m,g,d,l,
k){return n([t,p],{minRowsPerPage:2500,maxRowsPerPage:250,maxEmptySpace:Infinity,bufferRows:10,farOffRemoval:2E3,queryRowsOverlap:0,pagingMethod:"debounce",pagingDelay:k.defaultDelay,keepScrollPosition:!0,rowHeight:0,postCreate:function(){this.inherited(arguments);var g=this;d(this.bodyNode,"scroll",k[this.pagingMethod](function(a){g._processScroll(a)},null,this.pagingDelay))},destroy:function(){this.inherited(arguments);this._refreshTimeout&&clearTimeout(this._refreshTimeout)},renderQuery:function(d,
a){var b=this,e=a&&a.container||this.contentNode,h={query:d,count:0},r,c=this.preload,f={node:g.create("div",{className:"dgrid-preload",style:{height:"0"}},e),count:0,query:d,next:h};f.node.rowIndex=0;h.node=r=g.create("div",{className:"dgrid-preload"},e);h.previous=f;r.rowIndex=this.minRowsPerPage;c?((h.next=c.next)&&r.offsetTop>=c.node.offsetTop?h.previous=c:(h.next=c,h.previous=c.previous),h.previous.next=h,h.next.previous=h):this.preload=h;var q=g.create("div",{className:"dgrid-loading"},r,"before");
g.create("div",{className:"dgrid-below"},q).innerHTML=this.loadingMessage;a=m.mixin({start:0,count:this.minRowsPerPage},"level"in d?{queryLevel:d.level}:null);return this._trackError(function(){var c=d(a);return b.renderQueryResults(c,r,a).then(function(f){return c.totalLength.then(function(c){var e=f.length,d=r.parentNode,k=b.noDataNode;b._rows&&(b._rows.min=0,b._rows.max=e===c?Infinity:e-1);g.destroy(q);"queryLevel"in a||(b._total=c);0===c&&d&&(k&&(g.destroy(k),delete b.noDataNode),b.noDataNode=
k=g.create("div",{className:"dgrid-no-data",innerHTML:b.noDataMessage}),b._emit("noData"),d.insertBefore(k,b._getFirstRowSibling(d)));for(k=d=0;k<e;k++)d+=b._calcRowHeight(f[k]);e&&d&&(b.rowHeight=d/e);c-=e;h.count=c;r.rowIndex=e;c?r.style.height=Math.min(c*b.rowHeight,b.maxEmptySpace)+"px":r.style.display="none";b._previousScrollPosition&&(b.scrollTo(b._previousScrollPosition),delete b._previousScrollPosition);return l(b._processScroll()).then(function(){return f})})}).otherwise(function(c){g.destroy(q);
throw c;})})},refresh:function(k){var a=this;k&&k.keepScrollPosition&&(this._previousScrollPosition=this.getScrollPosition());this.inherited(arguments);if(this._renderedCollection)return this.renderQuery(function(b){return a._renderedCollection.fetchRange({start:b.start,end:b.start+b.count})}).then(function(){a._refreshTimeout=setTimeout(function(){d.emit(a.domNode,"dgrid-refresh-complete",{bubbles:!0,cancelable:!1,grid:a});a._refreshTimeout=null},0)})},resize:function(){this.inherited(arguments);
this._processScroll()},cleanup:function(){this.inherited(arguments);this.preload=null},renderQueryResults:function(d){var a=this.inherited(arguments),b=this._renderedCollection;b&&b.releaseRange&&a.then(function(a){a[0]&&!a[0].parentNode.tagName&&d.totalLength.then(function(){b.releaseRange(a[0].rowIndex,a[a.length-1].rowIndex+1)})});return a},_getFirstRowSibling:function(d){return d.lastChild},_calcRowHeight:function(d){var a=d.nextSibling;return a&&!/\bdgrid-preload\b/.test(a.className)?a.offsetTop-
d.offsetTop:d.offsetHeight},lastScrollTop:0,_processScroll:function(d){function a(c,a,f,e){var d=h.farOffRemoval,r=c.node;if(a>2*d){for(var q,k=r[f],l=0,x=0,u=[],v=k&&k.rowIndex,n;q=k;){var m=h._calcRowHeight(q);if(l+m+d>a||0>k.className.indexOf("dgrid-row")&&0>k.className.indexOf("dgrid-loading"))break;k=q[f];l+=m;x+=q.count||1;h.removeRow(q,!0);u.push(q);"rowIndex"in q&&(n=q.rowIndex)}h._renderedCollection.releaseRange&&"number"===typeof v&&"number"===typeof n&&(e?h._renderedCollection.releaseRange(n,
v+1):h._renderedCollection.releaseRange(v,n+1),h._rows[e?"max":"min"]=n,h._rows.max>=h._total-1&&(h._rows.max=Infinity));c.count+=x;e?(r.rowIndex-=x,b(c)):r.style.height=r.offsetHeight+l+"px";var p=document.createElement("div");for(c=u.length;c--;)p.appendChild(u[c]);setTimeout(function(){g.destroy(p)},1)}}function b(c,a){c.node.style.height=Math.min(c.count*h.rowHeight,a?Infinity:h.maxEmptySpace)+"px"}function e(c,a){do c=a?c.next:c.previous;while(c&&!c.node.offsetWidth);return c}if(this.rowHeight){var h=
this,r=h.bodyNode;d=d&&d.scrollTop||this.getScrollPosition().y;var r=r.offsetHeight+d,c,f,q=h.preload,k=h.lastScrollTop,l=h.bufferRows*h.rowHeight,u=l-h.rowHeight,m,p=!0;for(h.lastScrollTop=d;q&&!q.node.offsetWidth;)q=q.previous;for(;q&&q!==c;){c=h.preload;h.preload=q;f=q.node;var v=f.offsetTop;if(r+1+u<v)q=e(q,p=!1);else if(d-1-u>v+f.offsetHeight)q=e(q,p=!0);else{var v=((f.rowIndex?d-l:r)-v)/h.rowHeight,n=(r-d+2*l)/h.rowHeight,n=n+Math.min(Math.abs(Math.max(Math.min((d-k)*h.rowHeight,h.maxRowsPerPage/
2),h.maxRowsPerPage/-2)),10);0===f.rowIndex&&(v-=n);v=Math.max(v,0);10>v&&0<v&&n+v<h.maxRowsPerPage&&(n+=Math.max(0,v),v=0);n=Math.min(Math.max(n,h.minRowsPerPage),h.maxRowsPerPage,q.count);if(0===n)q=e(q,p);else{var n=Math.ceil(n),v=Math.min(Math.floor(v),q.count-n),w={};q.count-=n;var t=f,D,z=h.queryRowsOverlap,E=(0<f.rowIndex||f.offsetTop>d)&&q;if(E){var A=q.previous;A&&(a(A,d-(A.node.offsetTop+A.node.offsetHeight),"nextSibling"),0<v&&A.node===f.previousSibling?(v=Math.min(q.count,v),q.previous.count+=
v,b(q.previous,!0),f.rowIndex+=v,z=0):n+=v,q.count-=v);w.start=f.rowIndex-z;w.count=Math.min(n+z,h.maxRowsPerPage);f.rowIndex=w.start+w.count}else q.next&&(a(q.next,q.next.node.offsetTop-r,"previousSibling",!0),t=f.nextSibling,t===q.next.node?(q.next.count+=q.count-v,q.next.node.rowIndex=v+n,b(q.next),q.count=v,z=0):D=!0),w.start=q.count,w.count=Math.min(n+z,h.maxRowsPerPage);D&&t&&t.offsetWidth&&(D=t.offsetTop);b(q);"level"in q.query&&(w.queryLevel=q.query.level);if("queryLevel"in w||!(w.start>h._total||
0>w.count)){var B=g.create("div",{className:"dgrid-loading",style:{height:n*h.rowHeight+"px"}},t,"before");g.create("div",{className:"dgrid-"+(E?"below":"above"),innerHTML:h.loadingMessage},B);B.count=n;h._trackError(function(){(function(c,a,f){var e=q.query(w);m=h.renderQueryResults(e,c,w).then(function(d){var r=h._rows;!r||"queryLevel"in w||!d.length||(a?(r.max<=r.min&&(r.min=d[0].rowIndex),r.max=d[d.length-1].rowIndex):(r.max<=r.min&&(r.max=d[d.length-1].rowIndex),r.min=d[0].rowIndex));t=c.nextSibling;
g.destroy(c);f&&t&&t.offsetWidth&&(r=h.getScrollPosition(),h.scrollTo({x:r.x,y:r.y+t.offsetTop-f,preserveMomentum:!0}));e.totalLength.then(function(c){"queryLevel"in w||(h._total=c,h._rows&&h._rows.max>=h._total-1&&(h._rows.max=Infinity));a&&(a.count=c-a.node.rowIndex,b(a))});h._processScroll();return d},function(a){g.destroy(c);throw a;})})(B,E,D)});q=q.previous}}}}return m}}})})},"dgrid/_StoreMixin":function(){define("dojo/_base/declare dojo/_base/lang dojo/Deferred dojo/aspect dojo/dom-construct dojo/has dojo/on dojo/when".split(" "),
function(t,p,n,m,g,d,l,k){function u(a){if("object"!==typeof a)a=Error(a);else if("cancel"===a.dojoType)return;l.emit(this.domNode,"dgrid-error",{grid:this,error:a,cancelable:!0,bubbles:!0})&&console.error(a)}return t(null,{collection:null,_renderedCollection:null,_rows:null,_observerHandle:null,shouldTrackCollection:!1,getBeforePut:!0,noDataMessage:"",loadingMessage:"",_total:0,constructor:function(){this.dirty={};this._updating={};this._columnsWithSet={};m.before(this,"configStructure",p.hitch(this,
function(){this._columnsWithSet={}}))},destroy:function(){this.inherited(arguments);this._renderedCollection&&this._cleanupCollection()},_configColumn:function(a){a.set&&(this._columnsWithSet[a.field]=a);this.inherited(arguments)},_setCollection:function(a){this._renderedCollection&&(this.cleanup(),this._cleanupCollection({shouldRevert:!a||a.storage!==this._renderedCollection.storage}));this.collection=a;if(this._started){if(a){var b=a;this.sort&&0<this.sort.length&&(b=a.sort(this.sort));b.track&&
this.shouldTrackCollection&&(b=b.track(),this._rows=[],this._observerHandle=this._observeCollection(b,this.contentNode,{rows:this._rows}));this._renderedCollection=b}this.refresh()}},_setStore:function(){},_getTotal:function(){return this._total},_cleanupCollection:function(a){a=a||{};this._renderedCollection.tracking&&this._renderedCollection.tracking.remove();this._observerHandle&&(this._observerHandle.remove(),this._observerHandle=this._rows=null);!1!==a.shouldRevert&&(this.dirty={});this._renderedCollection=
this.collection=null},_applySort:function(){this.collection&&this.set("collection",this.collection)},row:function(){var a=this.inherited(arguments);a&&a.data&&"undefined"!==typeof a.id&&(this.collection?a.id=this.collection.getIdentity(a.data):console.error("_StoreMixin:have no collection!"));return a},refresh:function(){var a=this.inherited(arguments);this.collection||(this.noDataNode=g.create("div",{className:"dgrid-no-data",innerHTML:this.noDataMessage},this.contentNode),this._emit("noData"));
return a},refreshCell:function(a){if(!this.collection||!this._createBodyRowCell)return!1;if(a.column){if(a.column&&a.column.selector)return(new n).resolve();this.inherited(arguments);return this.collection.get(a.row.id).then(p.hitch(this,"_refreshCellFromItem",a))}},_refreshCellFromItem:function(a,b,e){if(a&&a.element){var h=a.element;h.widget&&h.widget.destroyRecursive();g.empty(h);var d=this.dirty&&this.dirty[a.row.id];d&&(b=p.delegate(b,d));this._createBodyRowCell(h,a.column,b,e)}},renderArray:function(){var a=
this.inherited(arguments);this.collection||a.length&&this.noDataNode&&g.destroy(this.noDataNode);return a},insertRow:function(a,b,e,h,d){var c=this.collection,f=this.dirty,c=c&&c.getIdentity(a),r;c in f&&!(c in this._updating)&&(r=f[c]);r&&(a=p.delegate(a,r));f=this.inherited(arguments);d&&d.rows&&(d.rows[h]=f);this.noDataNode&&(g.destroy(this.noDataNode),this.noDataNode=null);return f},updateDirty:function(a,b,e){var h=this.dirty,d=h[a];d||(d=h[a]={});d[b]=e},save:function(){function a(a,f){return function(d){var r=
b._columnsWithSet,q=b._updating,k,g;if("function"===typeof d.set)d.set(f);else for(k in f)d[k]=f[k];for(k in r)g=r[k].set(d),void 0!==g&&(d[k]=g);q[a]=!0;return e.put(d).then(function(b){delete h[a];delete q[a];c[a]=b;return c})}}var b=this,e=this.collection,h=this.dirty,d=new n,c={},f=function(c){var a;return b.getBeforePut||!(a=b.row(c).data)?function(){return e.get(c)}:function(){return a}},q=d.then(function(){return c}),k;for(k in h)var g=a(k,h[k]),q=q.then(f(k)).then(g);d.resolve();return q},
revert:function(){this.dirty={};this.refresh()},_trackError:function(a){"string"===typeof a&&(a=p.hitch(this,a));var b=this,e;try{e=k(a())}catch(h){a=new n,a.reject(h),e=a.promise}e.otherwise(function(a){u.call(b,a)});return e},removeRow:function(a,b,e){var h={element:a};!b&&this.noDataMessage&&this.up(h).element===a&&this.down(h).element===a&&(this.noDataNode=g.create("div",{className:"dgrid-no-data",innerHTML:this.noDataMessage},this.contentNode),this._emit("noData"));(h=e&&e.rows||this._rows)&&
delete h[a.rowIndex];return this.inherited(arguments)},renderQueryResults:function(a,b,e){e=p.mixin({rows:this._rows},e);var h=this;return a.then(function(a){a=h.renderArray(a,b,e);delete h._lastCollection;return a})},_observeCollection:function(a,b,e){var h=this,d=e.rows,c,f=[a.on("delete, update",function(a){var f=a.previousIndex,q=a.index;void 0!==f&&d[f]&&("max"in d&&(void 0===q||q<d.min||q>d.max)&&d.max--,c=d[f],c.parentNode===b&&h.removeRow(c,!1,e),d.splice(f,1),("delete"===a.type||"update"===
a.type&&(f<q||void 0===q))&&d[f]&&d[f].rowIndex--);"delete"===a.type&&(c=null)}),a.on("add, update",function(a){var f=a.previousIndex,q=a.index;if(void 0!==q&&(!("max"in d)||q>=d.min&&q<=d.max)){"max"in d&&(void 0===f||f<d.min||f>d.max)&&d.max++;if(d.length){if(f=d[q],!f&&(f=d[q-1]))f=(f.connected||f).nextSibling}else f=h._getFirstRowSibling&&h._getFirstRowSibling(b);c&&f&&c.id===f.id&&(f=(f.connected||f).nextSibling);f&&!f.parentNode&&(f=document.getElementById(f.id));d.splice(q,0,void 0);c=h.insertRow(a.target,
b,f,q,e);h.highlightRow(c)}c=null}),a.on("add, delete, update",function(c){var b="undefined"!==typeof c.previousIndex?c.previousIndex:Infinity,f="undefined"!==typeof c.index?c.index:Infinity,e=Math.min(b,f);b!==f&&d[e]&&h.adjustRowIndices(d[e]);Infinity!==b&&h._processScroll&&(d[b]||d[b-1])&&h._processScroll();h._onNotification(d,c,a);a===h._renderedCollection&&"totalLength"in c&&(h._total=c.totalLength)})];return{remove:function(){for(;0<f.length;)f.pop().remove()}}},_onNotification:function(){}})})},
"dgrid/OnDemandGrid":function(){define(["dojo/_base/declare","./Grid","./OnDemandList"],function(t,p,n){return t([p,n],{})})},"dgrid/extensions/ColumnReorder":function(){define("dojo/_base/lang dojo/_base/declare dojo/_base/array dojo/dom-class dojo/on dojo/query dojo/dnd/Source".split(" "),function(t,p,n,m,g,d){function l(a,e){var b=e[2];a=a[b?"columnSets":"subRows"][e[1]];return b?a[e[2]]:a}function k(a,e,h){e[2]?a.columnSets[e[1]][e[2]]=h:a.subRows[e[1]]=h}function u(a,e){return e.slice(("dgrid-"+
a+"-").length)}var a=/(\d+)(?:-(\d+))?$/;t=p(d,{copyState:function(){return!1},checkAcceptance:function(a){return a===this},_legalMouseDown:function(a){return-1<a.target.className.indexOf("dgrid-resize-handle")?!1:this.inherited(arguments)},onDropInternal:function(b){var e=this.grid,h=a.exec(u(e.id,b[0].getAttribute("dndType"))),d=h[2]?"columnSets":"subRows",c=l(e,h),f=e.columns;this.inherited(arguments);h&&setTimeout(function(){var a=n.map(b[0].parentNode.childNodes,function(c){return f[c.columnId]});
k(e,h,a);a={grid:e,subRow:a,column:f[b[0].columnId],bubbles:!0,cancelable:!0,parentType:"dnd"};a[d]=e[d];g.emit(e.domNode,"dgrid-columnreorder",a)?e.set(d,e[d]):(k(e,h,c),e.renderHeader(),e.sort.length&&e.updateSortArrow(e.sort))},0)}});p=p("dgrid.ColumnReorder",null,{columnDndConstructor:t,_initSubRowDnd:function(a,e){var b,d,c,f;d=0;for(c=a.length;d<c;d++)f=a[d],!1!==f.reorderable&&(f=f.headerNode,m.add(f,"dojoDndItem"),f.setAttribute("dndType",e),b||(b=f.parentNode));b&&this._columnDndSources.push(new this.columnDndConstructor(b,
{horizontal:!0,grid:this}))},renderHeader:function(){var a="dgrid-"+this.id+"-",e,h;this.inherited(arguments);this._columnDndSources=[];if(this.columnSets)for(h=0,e=this.columnSets.length;h<e;h++)n.forEach(this.columnSets[h],function(b,c){this._initSubRowDnd(b,a+h+"-"+c)},this);else n.forEach(this.subRows,function(b,c){this._initSubRowDnd(b,a+c)},this)},_destroyColumns:function(){this._columnDndSources&&n.forEach(this._columnDndSources,function(a){a&&a.destroy&&a.destroy()});this.inherited(arguments)}});
p.ColumnDndSource=t;return p})},"dgrid/extensions/ColumnResizer":function(){define("dojo/_base/declare dojo/on dojo/query dojo/_base/lang dojo/dom dojo/dom-construct dojo/dom-geometry dojo/has ../util/misc dojo/_base/html".split(" "),function(t,p,n,m,g,d,l,k,u){function a(a){for(var c=a.length,b=c,e=a[0].length,h=Array(c);c--;)h[c]=Array(e);for(var d={},c=0;c<b;c++)for(var k=h[c],r=a[c],g=0,l=0;g<e;g++){var u=r[l],n;if("undefined"===typeof k[g]){k[g]=u.id;if(u.rowSpan&&1<u.rowSpan){n=h;for(var m=
u.rowSpan,p=c,t=g,A=u.id,B=1;B<m;B++)n[p+B][t]=A}if(0<c&&u.colSpan&&1<u.colSpan)for(n=1;n<u.colSpan;n++)if(k[++g]=u.id,u.rowSpan&&1<u.rowSpan)for(var m=h,p=u.rowSpan,t=c,A=g,B=u.id,H=1;H<p;H++)m[t+H][A]=B;d[u.id]=a[0][g].id;l++}}return d}function b(c,a,b,e,h){if(!(0>=b)){var f=c.columns[a],d;if(f&&(d={grid:c,columnId:a,width:b,bubbles:!0,cancelable:!0},e&&(d.parentType=e),!c._resizedColumns||p.emit(c.headerNode,"dgrid-columnresize",d)))return"auto"===b?delete f.width:(f.width=b,b+="px"),(e=c._columnSizes[a])?
e.set("width",b):e=u.addCssRule("#"+u.escapeCssIdentifier(c.domNode.id)+" .dgrid-column-"+u.escapeCssIdentifier(a,"-"),"width: "+b+";"),c._columnSizes[a]=e,!1!==h&&c.resize(),!0}}var e,h=0,r={create:function(){e=d.create("div",{className:"dgrid-column-resizer"})},destroy:function(){d.destroy(e);e=null},show:function(a){a=l.position(a.domNode,!0);e.style.top=a.y+"px";e.style.height=a.h+"px";document.body.appendChild(e)},move:function(a){e.style.left=a+"px"},hide:function(){e.parentNode.removeChild(e)}};
return t("dgrid.ColumnResizer",null,{resizeNode:null,minWidth:40,adjustLastColumn:!0,_resizedColumns:!1,buildRendering:function(){this.inherited(arguments);h||r.create();h++},destroy:function(){this.inherited(arguments);for(var a in this._columnSizes)this._columnSizes[a].remove();--h||r.destroy()},resizeColumnWidth:function(a,f){return b(this,a,f)},configStructure:function(){var a=this._oldColumnSizes=m.mixin({},this._columnSizes),b;this._resizedColumns=!1;this._columnSizes={};this.inherited(arguments);
for(b in a)b in this._columnSizes||a[b].remove();delete this._oldColumnSizes},_configColumn:function(a){this.inherited(arguments);var c=a.id,b;"width"in a&&((b=this._oldColumnSizes[c])?b.set("width",a.width+"px"):b=u.addCssRule("#"+u.escapeCssIdentifier(this.domNode.id)+" .dgrid-column-"+u.escapeCssIdentifier(c,"-"),"width: "+a.width+"px;"),this._columnSizes[c]=b)},renderHeader:function(){this.inherited(arguments);var c=this,b;if(this.columnSets&&this.columnSets.length)for(var e=this.columnSets.length;e--;)b=
m.mixin(b||{},a(this.columnSets[e]));else this.subRows&&1<this.subRows.length&&(b=a(this.subRows));for(var e=n(".dgrid-cell",c.headerNode),h=e.length;h--;){var g=e[h],r=g.columnId,l=c.columns[r],t=g.childNodes;if(l&&!1!==l.resizable){l=d.create("div",{className:"dgrid-resize-header-container"});for(g.contents=l;0<t.length;)l.appendChild(t[0]);t=d.create("div",{className:"dgrid-resize-handle resizeNode-"+u.escapeCssIdentifier(r,"-")},l);g.appendChild(l);t.columnId=b&&b[r]||r}}c.mouseMoveListen||(p(c.headerNode,
".dgrid-resize-handle:mousedown"+(k("touch")?",.dgrid-resize-handle:touchstart":""),function(a){c._resizeMouseDown(a,this);c.mouseMoveListen.resume();c.mouseUpListen.resume()}),c._listeners.push(c.mouseMoveListen=p.pausable(document,"mousemove"+(k("touch")?",touchmove":""),u.throttleDelayed(function(a){c._updateResizerPosition(a)}))),c._listeners.push(c.mouseUpListen=p.pausable(document,"mouseup"+(k("touch")?",touchend":""),function(a){c._resizeMouseUp(a);c.mouseMoveListen.pause();c.mouseUpListen.pause()})),
c.mouseMoveListen.pause(),c.mouseUpListen.pause())},_resizeMouseDown:function(a,b){a.preventDefault();g.setSelectable(this.domNode,!1);this._startX=this._getResizeMouseLocation(a);this._targetCell=n(".dgrid-column-"+u.escapeCssIdentifier(b.columnId,"-"),this.headerNode)[0];this._updateResizerPosition(a);r.show(this)},_resizeMouseUp:function(a){var c=this._columnSizes,e,h,d;this.adjustLastColumn&&(d=this.headerNode.clientWidth-1);this._resizedColumns||(e=n(".dgrid-cell",this.headerNode),this.columnSets&&
this.columnSets.length?e=e.filter(function(a){return"0"===a.columnId.split("-")[0]&&!(a.columnId in c)}):this.subRows&&1<this.subRows.length&&(e=e.filter(function(a){return"0"===a.columnId.charAt(0)&&!(a.columnId in c)})),h=e.map(function(a){return a.offsetWidth}),e.forEach(function(a,c){b(this,a.columnId,h[c],null,!1)},this),this._resizedColumns=!0);g.setSelectable(this.domNode,!0);e=this._targetCell;var k=this._getResizeMouseLocation(a)-this._startX,l=e.offsetWidth+k,m=this._getResizedColumnWidths(),
p=m.totalWidth,m=m.lastColId,t=n(".dgrid-column-"+u.escapeCssIdentifier(m,"-"),this.headerNode)[0].offsetWidth;l<this.minWidth&&(l=this.minWidth);b(this,e.columnId,l,a.type)&&e.columnId!==m&&this.adjustLastColumn&&(p+k<d?b(this,m,"auto",a.type):t-k<=this.minWidth&&b(this,m,this.minWidth,a.type));r.hide();delete this._startX;delete this._targetCell},_updateResizerPosition:function(a){if(this._targetCell){a=this._getResizeMouseLocation(a);var c=this._targetCell.offsetWidth,b=a;c+(a-this._startX)<this.minWidth&&
(b=this._startX-(c-this.minWidth));r.move(b)}},_getResizeMouseLocation:function(a){var c=0;a.pageX?c=a.pageX:a.clientX&&(c=a.clientX+document.body.scrollLeft+document.documentElement.scrollLeft);return c},_getResizedColumnWidths:function(){var a=0,b=n((this.columnSets?".dgrid-column-set-cell ":"")+"tr:first-child .dgrid-cell",this.headerNode),e=b.length;if(!e)return{};for(var h=b[e-1].columnId;e--;)a+=b[e].offsetWidth;return{totalWidth:a,lastColId:h}}})})},"dgrid/extensions/CompoundColumns":function(){define(["dojo/_base/lang",
"dojo/_base/declare","dojo/sniff","dojo/query","../util/misc"],function(t,p,n,m,g){return p(null,{configStructure:function(){function d(c,b,e,h){var f=0,r=function(){},l,q;g.each(c,function(g,n){"string"===typeof g&&(g={label:g});c instanceof Array||g.field||(g.field=n);q=(l=g.children)&&!1!==g.showChildHeaders;g.parentColumn=h;l?null==g.id?g.id=(h&&h.id||b-1)+"-"+u.length:h&&h.id&&(g.id=h.id+"-"+g.id):(a.push(g),u.push(t.delegate(g,{renderHeaderCell:r})),f++);q||(g=t.delegate(g,{rowSpan:-b}));l&&
(f+=g.colSpan=d(l,b+1,q,g));e&&(k[b]||(k[b]=[])).push(g)},this);return f}var l=this.subRows&&this.subRows[0]||this.columns,k=[[]],u=k[0],a=[];k[0].className="dgrid-spacer-row";d(l,1,!0);var l=k.length,b,e,h,r;for(b=0;b<l;b++)for(h=k[b],e=0;e<h.length;e++)r=h[e],1>r.rowSpan&&(r.rowSpan+=l);a=[a];a.headerRows=k;this.subRows=a;this.inherited(arguments)},renderHeader:function(){var d,g=this.subRows[0],k=this.subRows.headerRows[0];this.inherited(arguments);for(d=g.length;d--;)g[d].headerNode=k[d].headerNode},
_findSortArrowParent:function(){var d=this.inherited(arguments);if(d&&g.contains(m(".dgrid-spacer-row",this.headerNode)[0],d))return d=d.columnId||d.parentNode.columnId,d=m(".dgrid-column-"+d,this.headerNode),d[d.length-1]},_configColumn:function(d,g,k){var l=d.parentColumn,a=d.id;l&&(a=0===a.indexOf(k)?a.substring(k.length):a,k=l.id+"-",a=d.id=k+a);this.inherited(arguments,[d,g,k])},cell:function(d,g){if("object"!==typeof g){var k=this.column(g);k&&(g=k.id)}return this.inherited(arguments,[d,g])},
column:function(d){var g=this.inherited(arguments);if(null==g&&"object"!==typeof d){var k="-"+d,u=k.length,a;for(a in this.columns)if(-1!==a.indexOf(k,a.length-u))return this.columns[a]}return g},_updateCompoundHiddenStates:function(d,g){d=this.columns[d];var k;if(!d||d.hidden!==g)for(;d&&d.parentColumn;){d=d.parentColumn;if(k=d.colSpan+=g?-1:1)d.headerNode.colSpan=k;1!==k||g?!k&&g&&this._hideColumn(d.id):this._showColumn(d.id)}},_hideColumn:function(d){var g=this;this._updateCompoundHiddenStates(d,
!0);this.inherited(arguments);n("ff")&&(this.headerNode.style.display="none",setTimeout(function(){g.headerNode.style.display="";g.resize()},0))},_showColumn:function(d){this._updateCompoundHiddenStates(d,!1);this.inherited(arguments)},_getResizedColumnWidths:function(){var d=0,g=this.columns,k;for(k in g)d+=g[k].headerNode.offsetWidth;return{totalWidth:d,lastColId:this.subRows[0][this.subRows[0].length-1].id}}})})},"dgrid/extensions/Pagination":function(){define("../_StoreMixin dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/dom-construct dojo/dom-class dojo/on dojo/query dojo/string dojo/has dojo/when ../util/misc dojo/_base/sniff".split(" "),
function(t,p,n,m,g,d,l,k,u,a,b,e){function h(a){a.noDataNode?(g.destroy(a.noDataNode),delete a.noDataNode):a.cleanup();a.contentNode.innerHTML=""}function r(a){if(a.loadingNode)g.destroy(a.loadingNode),delete a.loadingNode;else if(a._oldPageNodes){for(var c in a._oldPageNodes)a.removeRow(a._oldPageNodes[c]);delete a._oldPageNodes}delete a._isLoading}return p(t,{rowsPerPage:10,pagingTextBox:!1,previousNextArrows:!0,firstLastArrows:!1,pagingLinks:2,pageSizeOptions:null,showLoadingMessage:!0,i18nPagination:{status:"${start} - ${end} of ${total} results",
gotoFirst:"Go to first page",gotoNext:"Go to next page",gotoPrev:"Go to previous page",gotoLast:"Go to last page",gotoPage:"Go to page",jumpPage:"Jump to page",rowsPerPage:"Number of rows per page"},showFooter:!0,_currentPage:1,buildRendering:function(){this.inherited(arguments);var a=this,b=this.paginationNode=g.create("div",{className:"dgrid-pagination"},this.footerNode),e=this.paginationStatusNode=g.create("div",{className:"dgrid-status"},b),h=this.i18nPagination;e.tabIndex=0;this.addUiClasses&&
d.add(this.footerNode,"ui-widget-content");this._updatePaginationSizeSelect();this._updateRowsPerPageOption();this._updatePaginationStatus(this._total);b=this.paginationNavigationNode=g.create("div",{className:"dgrid-navigation"},b);this.firstLastArrows&&(this.paginationFirstNode=g.create("span",{"aria-label":h.gotoFirst,className:"dgrid-first dgrid-page-link",innerHTML:"\u00ab",tabIndex:0},b));this.previousNextArrows&&(this.paginationPreviousNode=g.create("span",{"aria-label":h.gotoPrev,className:"dgrid-previous dgrid-page-link",
innerHTML:"\u2039",tabIndex:0},b));this.paginationLinksNode=g.create("span",{className:"dgrid-pagination-links"},b);this.previousNextArrows&&(this.paginationNextNode=g.create("span",{"aria-label":h.gotoNext,className:"dgrid-next dgrid-page-link",innerHTML:"\u203a",tabIndex:0},b));this.firstLastArrows&&(this.paginationLastNode=g.create("span",{"aria-label":h.gotoLast,className:"dgrid-last dgrid-page-link",innerHTML:"\u00bb",tabIndex:0},b));this._listeners.push(l(b,".dgrid-page-link:click,.dgrid-page-link:keydown",
function(c){if("keydown"!==c.type||13===c.keyCode){c=this.className;var b,f;a._isLoading||-1<c.indexOf("dgrid-page-disabled")||(b=a._currentPage,f=Math.ceil(a._total/a.rowsPerPage),this===a.paginationPreviousNode?a.gotoPage(b-1):this===a.paginationNextNode?a.gotoPage(b+1):this===a.paginationFirstNode?a.gotoPage(1):this===a.paginationLastNode?a.gotoPage(f):"dgrid-page-link"===c&&a.gotoPage(+this.innerHTML))}}))},destroy:function(){this.inherited(arguments);this._pagingTextBoxHandle&&this._pagingTextBoxHandle.remove()},
_updatePaginationSizeSelect:function(){var a=this.pageSizeOptions,b=this.paginationSizeSelect,e;if(a&&a.length){b||(b=this.paginationSizeSelect=g.create("select",{"aria-label":this.i18nPagination.rowsPerPage,className:"dgrid-page-size"},this.paginationNode),e=this._paginationSizeChangeHandle=l(b,"change",m.hitch(this,function(){this.set("rowsPerPage",+this.paginationSizeSelect.value)})),this._listeners.push(e));for(e=b.options.length=0;e<a.length;e++)g.create("option",{innerHTML:a[e],selected:this.rowsPerPage===
a[e],value:a[e]},b);this._updateRowsPerPageOption()}else a&&a.length||!b||(g.destroy(b),this.paginationSizeSelect=null,this._paginationSizeChangeHandle.remove())},_setPageSizeOptions:function(a){this.pageSizeOptions=a&&a.sort(function(a,c){return a-c});this._updatePaginationSizeSelect()},_updateRowsPerPageOption:function(){var a=this.rowsPerPage,b=this.pageSizeOptions,e=this.paginationSizeSelect;e&&(0>n.indexOf(b,a)?this._setPageSizeOptions(b.concat([a])):e.value=""+a)},_setRowsPerPage:function(a){this.rowsPerPage=
a;this._updateRowsPerPageOption();this.gotoPage(1)},_updateNavigation:function(a){function c(a,c){var b;r.pagingTextBox&&a===m&&1<w?(c=g.create("input",{"aria-label":u.jumpPage,className:"dgrid-page-input",type:"text",value:m},n),r._pagingTextBoxHandle=l(c,"change",function(){var a=+this.value;!isNaN(a)&&0<a&&a<=w&&r.gotoPage(+this.value)}),y&&"INPUT"===y.tagName&&c.focus()):(b=a===m,c=g.create("span",{"aria-label":u.gotoPage,className:"dgrid-page-link"+(b?" dgrid-page-disabled":""),innerHTML:a+(c?
" ":""),tabIndex:b?-1:0},n),D===a&&(b?a<w?D++:z.focus():c.focus()),b||(z=c))}function b(a,c){d.toggle(a,"dgrid-page-disabled",c);a.tabIndex=c?-1:0}function h(){g.create("span",{className:"dgrid-page-skip",innerHTML:"..."},n)}var r=this,u=this.i18nPagination,n=this.paginationLinksNode,m=this._currentPage,p=this.pagingLinks,t=this.paginationNavigationNode,w=Math.ceil(a/this.rowsPerPage);a=this._pagingTextBoxHandle;var y=document.activeElement,D,z;y&&e.contains(this.paginationNavigationNode,y)?"dgrid-page-link"===
y.className&&(D=+y.innerHTML):y=null;a&&a.remove();n.innerHTML="";k(".dgrid-first, .dgrid-previous",t).forEach(function(a){b(a,1===m)});k(".dgrid-last, .dgrid-next",t).forEach(function(a){b(a,m>=w)});if(p&&0<w){c(1,!0);t=m-p;for(2<t?h():t=2;t<Math.min(m+p+1,w);t++)c(t,!0);m+p+1<w&&h();1<w&&c(w)}else r.pagingTextBox&&c(m);y&&-1===y.tabIndex&&(p=k('[tabindex\x3d"0"]',this.paginationNavigationNode),y===this.paginationPreviousNode||y===this.paginationFirstNode?y=p[0]:p.length&&(y=p[p.length-1]),y&&y.focus())},
_updatePaginationStatus:function(a){var c=this.rowsPerPage,b=Math.min(a,(this._currentPage-1)*c+1);this.paginationStatusNode.innerHTML=u.substitute(this.i18nPagination.status,{start:b,end:Math.min(a,b+c-1),total:a})},refresh:function(a){var c=this,b=a&&a.keepCurrentPage?Math.min(this._currentPage,Math.ceil(this._total/this.rowsPerPage)):1;this.inherited(arguments);return this.gotoPage(b).then(function(a){setTimeout(function(){l.emit(c.domNode,"dgrid-refresh-complete",{bubbles:!0,cancelable:!1,grid:c})},
0);return a})},_onNotification:function(a,b,e){a=this.rowsPerPage;var c=this._currentPage*a;"add"===b.type&&b.index<c||"delete"===b.type&&b.previousIndex<c||"update"===b.type&&Math.floor(b.index/a)!==Math.floor(b.previousIndex/a)?this.gotoPage(Math.min(this._currentPage,Math.ceil(b.totalLength/this.rowsPerPage))):e===this._renderedCollection&&b.totalLength!==this._total&&(this._updatePaginationStatus(b.totalLength),this._updateNavigation(b.totalLength))},renderQueryResults:function(a,b){var c=this,
e=this.inherited(arguments);b||(this._topLevelRequest&&(this._topLevelRequest.cancel(),delete this._topLevelRequest),"function"===typeof e.cancel&&(this._topLevelRequest=e),e.then(function(){c._topLevelRequest&&delete c._topLevelRequest}));return e},insertRow:function(){var a=this._oldPageNodes,b=this.inherited(arguments);a&&b===a[b.id]&&delete a[b.id];return b},gotoPage:function(a){var c=this,e=(this._currentPage-1)*this.rowsPerPage;if(!this._renderedCollection)return b([]);this._renderedCollection.releaseRange&&
this._renderedCollection.releaseRange(e,e+this.rowsPerPage);return this._trackError(function(){var b=c.rowsPerPage,e=(a-1)*b,f={start:e,count:b},d,k=c.contentNode,l,q,u;if(c.showLoadingMessage)h(c),c.loadingNode=g.create("div",{className:"dgrid-loading",innerHTML:c.loadingMessage},k);else for(c._oldPageNodes=l={},k=k.children,q=0,u=k.length;q<u;q++)l[k[q].id]=k[q];c._isLoading=!0;d=c._renderedCollection.fetchRange({start:e,end:e+b});return c.renderQueryResults(d,null,f).then(function(f){r(c);c.scrollTo({y:0});
c._rows&&(c._rows.min=e,c._rows.max=e+b-1);d.totalLength.then(function(b){b||(c.noDataNode&&(g.destroy(c.noDataNode),delete c.noDataNode),c.noDataNode=g.create("div",{className:"dgrid-no-data",innerHTML:c.noDataMessage},c.contentNode));c._total=b;c._currentPage=a;c._rowsOnPage=f.length;c._updatePaginationStatus(b);c._updateNavigation(b)});return d},function(a){r(c);throw a;})})}})})},"dgrid/extensions/DnD":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/aspect dojo/dom-class dojo/on dojo/topic dojo/has dojo/when dojo/dnd/Source dojo/dnd/Manager dojo/_base/NodeList ../Selection ./util/touch ./_DnD-touch-autoscroll".split(" "),
function(t,p,n,m,g,d,l,k,u,a,b,e,h,r){var c=t(a,{grid:null,getObject:function(a){var c=this.grid;return c.collection.get(a.id.slice(c.id.length+5))},_legalMouseDown:function(a){return this.inherited(arguments)&&a.target!==this.grid.bodyNode},onDrop:function(a,c,b){var e=this,f=this._targetAnchor=this.targetAnchor,h=this.grid,d=h.collection;!this.before&&f&&(f=f.nextSibling);f=f&&h.row(f);u(f&&d.get(f.id),function(f){if(e!==a)e.onDropExternal(a,c,b,f);else e.onDropInternal(c,b,f)})},onDropInternal:function(a,
c,b){var e=this.grid,f=e.collection,h=this,d=h._targetAnchor,g;d&&(g=this.before?d.previousSibling:d.nextSibling);d=e.row(a[0]);(c||g!==a[0]&&(b||!d||e.down(d).element!==a[0]))&&a.forEach(function(a){u(h.getObject(a),function(a){var d=f.getIdentity(a);f[c&&f.copy?"copy":"put"](a,{beforeId:b?f.getIdentity(b):null});h._selectedNodes[d]&&(h._selectedNodes[d]=e.row(d).element)})})},onDropExternal:function(a,c,b,e){var f=this.grid.collection,h=a.grid;c.forEach(function(c,d){u(a.getObject(c),function(g){b||
(h?u(h.collection.getIdentity(g),function(b){!d&&a.selectNone();a.delItem(c.id);h.collection.remove(b)}):a.deleteSelectedNodes());f[f.copy?"copy":"put"](g,{beforeId:e?f.getIdentity(e):null})})})},onDndStart:function(a){this.inherited(arguments);a===this&&(this.grid.cancelTouchScroll&&this.grid.cancelTouchScroll(),b.manager().avatar.node.style.width=this.grid.domNode.offsetWidth/2+"px")},onMouseDown:function(a){k("touch")&&this.isDragging&&1<r.countCurrentTouches(a,this.grid.touchNode)?(l.publish("/dnd/cancel"),
b.manager().stopDrag()):this.inherited(arguments)},onMouseMove:function(a){(!k("touch")||1>=r.countCurrentTouches(a,this.grid.touchNode))&&this.inherited(arguments)},checkAcceptance:function(c){return c.getObject&&a.prototype.checkAcceptance.apply(this,arguments)},getSelectedNodes:function(){if(!this.grid.selection)return this.inherited(arguments);var a=new e,c;for(c in this.grid.selection)a.push(this._selectedNodes[c]);return a}});t=t(h,{dndSourceType:"dgrid-row",dndParams:null,dndConstructor:c,
postMixInProperties:function(){this.inherited(arguments);this.dndParams=p.mixin({accept:[this.dndSourceType]},this.dndParams)},postCreate:function(){function a(a){e[a.id]=a.element}function b(a){delete e[a.id];g.remove(a.element,"dojoDndItemSelected dojoDndItemAnchor")}this.inherited(arguments);this.dndSource=new (this.dndConstructor||c)(this.bodyNode,p.mixin(this.dndParams,{grid:this,dropParent:this.contentNode}));var e=this.dndSource._selectedNodes={};this.on("dgrid-select",function(c){n.forEach(c.rows,
a)});this.on("dgrid-deselect",function(a){n.forEach(a.rows,b)});m.after(this,"destroy",function(){delete this.dndSource._selectedNodes;e=null;this.dndSource.destroy()},!0)},insertRow:function(a){var c=this.inherited(arguments),b="function"===typeof this.getObjectDndType?this.getObjectDndType(a):[this.dndSourceType];g.add(c,"dojoDndItem");this.dndSource.setItem(c.id,{data:a,type:b instanceof Array?b:[b]});return c},removeRow:function(a){this.dndSource.delItem(this.row(a));this.inherited(arguments)}});
t.GridSource=c;return t})},"dgrid/extensions/_DnD-touch-autoscroll":function(){define(["dojo/aspect","dojo/dom-geometry","dojo/dnd/autoscroll","../List"],function(t,p,n,m){var g=n.autoScrollNodes,d,l;d={};t.after(m.prototype,"postCreate",function(g){d[this.id]=this;return g});t.after(m.prototype,"destroy",function(g){delete d[this.id];return g});l=function(g){for(var k,a;g;){if((k=g.id)&&(a=d[k]))return a;g=g.parentNode}};n.autoScrollNodes=function(d){var k=d.target,a=l(k),b,e,h,r,c,f;if(a&&(k=a.touchNode.parentNode,
k=p.position(k,!0),b=d.pageX-k.x,e=d.pageY-k.y,h=Math.min(n.H_TRIGGER_AUTOSCROLL,k.w/2),r=Math.min(n.V_TRIGGER_AUTOSCROLL,k.h/2),b<h?c=-h:b>k.w-h&&(c=h),e<r?f=-r:e>k.h-r&&(f=r),c||f)){d=a.getScrollPosition();k={};c&&(k.x=d.x+c);f&&(k.y=d.y+f);a.scrollTo(k);return}g.call(this,d)};return n})},"dgrid/Editor":function(){define("dojo/_base/declare dojo/_base/lang dojo/Deferred dojo/dom-construct dojo/dom-class dojo/on dojo/has dojo/query ./Grid dojo/_base/sniff".split(" "),function(t,p,n,m,g,d,l,k,u){return t(null,
{constructor:function(){this._editorInstances={};this._editorColumnListeners=[];this._editorCellListeners={};this._editorsPendingStartup=[]},postCreate:function(){var a=this;this.inherited(arguments);this.on(".dgrid-input:focusin",function(){a._focusedEditorCell=a.cell(this)});this._editorFocusoutHandle=d.pausable(this.domNode,".dgrid-input:focusout",function(){a._focusedEditorCell=null});this._listeners.push(this._editorFocusoutHandle)},insertRow:function(){this._editorRowListeners={};var a=this.inherited(arguments),
b=this.row(a),e=this._editorCellListeners[a.id]=this._editorCellListeners[a.id]||{},h;for(h in this._editorRowListeners)e[h]=this._editorRowListeners[h];this._editorRowListeners=null;(e=this._previouslyFocusedEditorCell)&&e.row.id===b.id&&this.edit(this.cell(b,e.column.id));return a},refresh:function(){for(var a in this._editorInstances){var b=this._editorInstances[a].domNode;b&&b.parentNode&&b.parentNode.removeChild(b)}this.inherited(arguments)},removeRow:function(a){var b=this,e=this._focusedEditorCell;
e&&e.row.id===this.row(a).id&&(this._previouslyFocusedEditorCell=e,this._editorFocusoutHandle.pause(),setTimeout(function(){b._editorFocusoutHandle.resume();b._previouslyFocusedEditorCell=null},0));if(this._editorCellListeners[a.id]){for(var h in this._editorCellListeners[a.id])this._editorCellListeners[a.id][h].remove();delete this._editorCellListeners[a.id]}for(e=this._alwaysOnWidgetColumns.length;e--;)if(h=(h=this.cell(a,this._alwaysOnWidgetColumns[e].id).element)&&(h.contents||h).widget)this._editorFocusoutHandle.pause(),
h.destroyRecursive();return this.inherited(arguments)},renderArray:function(){var a=this.inherited(arguments);a.length?this._startupPendingEditors():this._editorsPendingStartup=[];return a},_onNotification:function(){this.inherited(arguments);this._startupPendingEditors()},_destroyColumns:function(){this._editorStructureCleanup();this.inherited(arguments)},_editorStructureCleanup:function(){var a=this._editorInstances,b=this._editorColumnListeners;this._editTimer&&clearTimeout(this._editTimer);for(var e in a){var h=
a[e];h.domNode&&h.destroyRecursive()}this._editorInstances={};for(a=b.length;a--;)b[a].remove();for(var d in this._editorCellListeners)for(e in this._editorCellListeners[d])this._editorCellListeners[d][e].remove();for(a=0;a<this._editorColumnListeners.length;a++)this._editorColumnListeners[a].remove();this._editorCellListeners={};this._editorColumnListeners=[];this._editorsPendingStartup=[]},_configColumns:function(){var a=this.inherited(arguments);this._alwaysOnWidgetColumns=[];for(var b=0,e=a.length;b<
e;b++)a[b].editor&&this._configureEditorColumn(a[b]);return a},_configureEditorColumn:function(a){var b=this,e=a.renderCell||this._defaultRenderCell,h=a.editOn,g="string"!==typeof a.editor;h?this._editorInstances[a.id]=this._createSharedEditor(a,e):g&&this._alwaysOnWidgetColumns.push(a);a.renderCell=h?function(c,f,g,k){if(!k||!k.alreadyHooked){var r=d(g,h,function(){b._activeOptions=k;b.edit(this)});if(b._editorRowListeners)b._editorRowListeners[a.id]=r;else{var l=b.row(c);b._editorCellListeners[l.element.id][a.id]=
r}}return e.call(a,c,f,g,k)}:function(c,f,h,d){if(!a.canEdit||a.canEdit(c,f))d=b._createEditor(a),d.object=c,b._showEditor(d,a,h,f),h[g?"widget":"input"]=d;else return e.call(a,c,f,h,d)}},edit:function(a){function b(a){e._activeCell=d;e._showEditor(k,h,d,g);e._editTimer=setTimeout(function(){k.focus&&k.focus();h._editorBlurHandle&&h._editorBlurHandle.resume();e._editTimer=null;a.resolve(k)},0)}var e=this,h,d,c,f,g,k,l;a.column||(a=this.cell(a));if(!a||!a.element)return null;h=a.column;f=h.field;d=
a.element.contents||a.element;if(k=this._editorInstances[h.id]){if(this._activeCell!==d){var u=a.row;g=(c=this.dirty&&this.dirty[u.id])&&f in c?c[f]:h.get?h.get(u.data):u.data[f];if(!h.canEdit||h.canEdit(a.row.data,g))return l=new n,a=k.domNode||k,a.offsetWidth?(a.blur(),setTimeout(function(){b(l)},0)):b(l),l.promise}}else if(h.editor&&(k=d.widget||d.input))return l=new n,k.focus&&k.focus(),l.resolve(k),l.promise;return null},refreshCell:function(a){var b=a.row.element.id,e=a.column.id;this._editorCellListeners[b]&&
this._editorCellListeners[b][e]&&(this._editorCellListeners[b][e].remove(),this._editorCellListeners[b][e]=null);return this.inherited(arguments)},_showEditor:function(a,b,e,h){var d=a.domNode;d||this._updateInputValue(a,h);e.innerHTML="";g.add(e,"dgrid-cell-editing");d&&b.editOn&&a.validate&&a.reset&&a.reset();e.appendChild(a.domNode||a);d&&!b.editOn?this._editorsPendingStartup.push([a,b,e,h]):this._startupEditor(a,b,e,h)},_startupEditor:function(a,b,e,h){a.domNode&&(a._started||a.startup(),a._dgridIgnoreChange=
!0,a.set("value",h),setTimeout(function(){a._dgridIgnoreChange=!1},0));a._dgridLastValue=h;this._activeCell&&(this._activeValue=h,d.emit(e,"dgrid-editor-show",{grid:this,cell:this.cell(e),column:b,editor:a,bubbles:!0,cancelable:!1}))},_startupPendingEditors:function(){for(var a=this._editorsPendingStartup,b=a.length;b--;)this._startupEditor.apply(this,a[b]);this._editorsPendingStartup=[]},_handleEditorChange:function(a,b){var e=a.target;"_dgridLastValue"in e&&-1<e.className.indexOf("dgrid-input")&&
this._updatePropertyFromEditor(b||this.cell(e).column,e,a)},_createEditor:function(a){var b=a.editor,e=a.editOn,h=this,g="string"!==typeof b&&b,c,f,k={};c=a.editorArgs||{};"function"===typeof c&&(c=c.call(this,a));g?(f=new g(c),b=f.focusNode||f.domNode,b.className+=" dgrid-input",f.on(e?"blur":"change",function(){f._dgridIgnoreChange||h._updatePropertyFromEditor(a,this,{type:"widget"})})):(this._hasInputListener||(this._hasInputListener=!0,this.on("change",function(a){h._handleEditorChange(a)})),
"textarea"===b?e="textarea":(e="input",k.type=b),f=b=m.create(e,p.mixin(k,{className:"dgrid-input",name:a.field,tabIndex:isNaN(a.tabIndex)?-1:a.tabIndex},c)));if(a.autoSelect){var l=f.focusNode||f;l.select&&d(l,"focus",function(){setTimeout(function(){l.select()},0)})}return f},_createSharedEditor:function(a){function b(){var a=h._activeCell;f.blur();"function"===typeof h.focus&&setTimeout(function(){h.focus(a)},k&&9>l("ie")?15:0)}var e=this._createEditor(a),h=this,k=e.domNode,c=e.domNode||e,f=e.focusNode||
c,q=k?function(){e.set("value",e._dgridLastValue)}:function(){h._updateInputValue(e,e._dgridLastValue);h._updatePropertyFromEditor(a,e)};this._editorColumnListeners.push(d(f,"keydown",function(c){c=c.keyCode||c.which;27===c?(q(),h._activeValue=e._dgridLastValue,b()):13===c&&!1!==a.dismissOnEnter&&b()}));(a._editorBlurHandle=d.pausable(e,"blur",function(){var b=c.parentNode,f={alreadyHooked:!0},k=h.cell(c);d.emit(k.element,"dgrid-editor-hide",{grid:h,cell:k,column:a,editor:e,bubbles:!0,cancelable:!1});
a._editorBlurHandle.pause();b.removeChild(c);k.row&&(g.remove(k.element,"dgrid-cell-editing"),m.empty(b),u.appendIfNode(b,a.renderCell(k.row.data,h._activeValue,b,h._activeOptions?p.delegate(f,h._activeOptions):f)));h._focusedEditorCell=h._activeCell=h._activeValue=h._activeOptions=null})).pause();this._editorColumnListeners.push(a._editorBlurHandle);return e},_updatePropertyFromEditor:function(a,b,e){var h;if(!b.isValid||b.isValid())if(e=this._updateProperty((b.domNode||b).parentNode,this._activeCell?
this._activeValue:b._dgridLastValue,this._retrieveEditorValue(a,b),e),this._activeCell?this._activeValue=e:b._dgridLastValue=e,"radio"===b.type&&b.name&&!a.editOn&&a.field)for(h in e=this.row(b),k("input[type\x3dradio][name\x3d"+b.name+"]",this.contentNode).forEach(function(e){var c=this.row(e);e!==b&&e._dgridLastValue&&(e._dgridLastValue=!1,this.updateDirty?this.updateDirty(c.id,a.field,!1):c.data[a.field]=!1)},this),this.dirty)e.id.toString()!==h&&this.dirty[h][a.field]&&this.updateDirty(h,a.field,
!1)},_updateProperty:function(a,b,e,h){var g=this;if((b&&b.valueOf())!==(e&&e.valueOf())){var c=this.cell(a),f=c.row,k=c.column;a=c.element;if(k.field&&f)if(c={grid:this,cell:c,oldValue:b,value:e,bubbles:!0,cancelable:!0},h&&h.type&&(c.parentType=h.type),d.emit(a,"dgrid-datachange",c))this.updateDirty?(this.updateDirty(f.id,k.field,e),k.autoSave&&setTimeout(function(){g._trackError("save")},0)):f.data[k.field]=e;else{var l;(l=a.widget)?(l._dgridIgnoreChange=!0,l.set("value",b),setTimeout(function(){l._dgridIgnoreChange=
!1},0)):(l=a.input)&&this._updateInputValue(l,b);return b}}return e},_updateInputValue:function(a,b){a.value=b;if("radio"===a.type||"checkbox"===a.type)a.checked=a.defaultChecked=!!b},_retrieveEditorValue:function(a,b){return"function"===typeof b.get?this._convertEditorValue(b.get("value")):this._convertEditorValue(b["checkbox"===b.type||"radio"===b.type?"checked":"value"])},_convertEditorValue:function(a,b){"number"===typeof b?a=isNaN(a)?a:parseFloat(a):"boolean"===typeof b?a="true"===a?!0:"false"===
a?!1:a:b instanceof Date&&(b=new Date(a),a=isNaN(b.getTime())?a:b);return a}})})},"dstore/Store":function(){define("dojo/_base/lang dojo/_base/array dojo/aspect dojo/has dojo/when dojo/_base/declare dstore/QueryMethod dstore/Filter dojo/Evented".split(" "),function(t,p,n,m,g,d,l,k,u){function a(a){return function(b,e){var c=this;g(b,function(b){b={target:b};var f=e[1]||{};"beforeId"in f&&(b.beforeId=f.beforeId);c.emit(a,b)});return b}}m.add("object-proto",!!{}.__proto__&&!{}.watch);var b=m("object-proto");
return d(u,{constructor:function(b){b&&d.safeMixin(this,b);this.Model&&this.Model.createSubclass&&(this.Model=this.Model.createSubclass([],{}).extend({_store:this}));this.storage=new u;var e=this;this.autoEmitEvents&&(n.after(this,"add",a("add")),n.after(this,"put",a("update")),n.after(this,"remove",function(a,c){g(a,function(){e.emit("delete",{id:c[0]})});return a}))},autoEmitEvents:!0,idProperty:"id",queryAccessors:!0,getIdentity:function(a){return a.get?a.get(this.idProperty):a[this.idProperty]},
_setIdentity:function(a,b){a.set?a.set(this.idProperty,b):a[this.idProperty]=b},forEach:function(a,b){var e=this;return g(this.fetch(),function(c){for(var f=0,d;void 0!==(d=c[f]);f++)a.call(b,d,f,e);return c})},on:function(a,b){return this.storage.on(a,b)},emit:function(a,b){b=b||{};b.type=a;try{return this.storage.emit(a,b)}finally{return b.cancelable}},parse:null,stringify:null,Model:null,_restore:function(a,d){var e=this.Model;if(e&&a){var c=e.prototype,f=c._restore;f?a=f.call(a,e,d):b&&d?a.__proto__=
c:a=t.delegate(c,a)}return a},create:function(a){return new this.Model(a)},_createSubCollection:function(a){var b=t.delegate(this.constructor.prototype),e;for(e in this)this._includePropertyInSubCollection(e,b)&&(b[e]=this[e]);return d.safeMixin(b,a)},_includePropertyInSubCollection:function(a,b){return!(a in b)||b[a]!==this[a]},queryLog:[],filter:new l({type:"filter",normalizeArguments:function(a){var b=this.Filter;return a instanceof b?[a]:[new b(a)]}}),Filter:k,sort:new l({type:"sort",normalizeArguments:function(a,
b){var e;"function"===typeof a?e=[a]:(e=a instanceof Array?a.slice():"object"===typeof a?[].slice.call(arguments):[{property:a,descending:b}],e=p.map(e,function(a){a=t.mixin({},a);a.descending=!!a.descending;return a}),e=[e]);return e}}),select:new l({type:"select"}),_getQuerierFactory:function(a){return this["_create"+(a[0].toUpperCase()+a.substr(1))+"Querier"]}})})},"dstore/QueryMethod":function(){define([],function(){return function(t){var p=t.type,n=t.normalizeArguments,m=t.applyQuery,g=t.querierFactory;
return function(){var d=Array.prototype.slice.call(arguments),l=n?n.apply(this,d):d,d={type:p,arguments:d,normalizedArguments:l},k=this._getQuerierFactory(p)||g;k&&(d.querier=k.apply(this,l));l=this._createSubCollection({queryLog:this.queryLog.concat(d)});return m?m.call(this,l,d):l}}})},"dstore/Filter":function(){define(["dojo/_base/declare"],function(t){function p(m){return function(){var g=this.constructor,d=new g;d.type=m;d.args=Array.prototype.slice.call(arguments);return this.type?p("and").call(g.prototype,
this,d):d}}function n(m){return function(){for(var g=this.constructor,d=[],l=0;l<arguments.length;l++){var k=arguments[l];d.push(k instanceof g?k:new g(k))}g=new g;g.type=m;g.args=d;this.type===m?g.args=this.args.concat(d):this.type?d.unshift(this):1===d.length&&(g.type=d[0].type,g.args=d[0].args.slice());return g}}t=t(null,{constructor:function(m){var g=typeof m;switch(g){case "object":var g=this,d;for(d in m)var l=m[d],g=l instanceof this.constructor?g[l.type](d,l.args[0]):l&&l.test?g.match(d,l):
g.eq(d,l);this.type=g.type;this.args=g.args;break;case "function":case "string":this.type=g,this.args=[m]}},and:n("and"),or:n("or"),eq:p("eq"),ne:p("ne"),lt:p("lt"),lte:p("lte"),gt:p("gt"),gte:p("gte"),contains:p("contains"),"in":p("in"),match:p("match")});t.filterCreator=p;t.logicalOperatorCreator=n;return t})},"dstore/Memory":function(){define("dojo/_base/declare dojo/_base/array ./Store ./Promised ./SimpleQuery ./QueryResults".split(" "),function(t,p,n,m,g,d){return t([n,m,g],{constructor:function(){this.storage.version=
0},postscript:function(){this.inherited(arguments);this.setData(this.data||[])},data:null,autoEmitEvents:!1,getSync:function(d){return this.storage.fullData[this.storage.index[d]]},putSync:function(d,g){g=g||{};var k=this.storage,a=k.index,b=k.fullData,e=this.Model;!e||d instanceof e||(d=this._restore(d));var h=this.getIdentity(d);null==h&&(this._setIdentity(d,"id"in g?g.id:Math.random()),h=this.getIdentity(d));k.version++;var k=h in a?"update":"add",e={target:d},l;if("update"===k){if(!1===g.overwrite)throw Error("Object already exists");
b.splice(l=a[h],1);h=l}else h=this.defaultNewToStart?0:b.length;if("beforeId"in g){var c=g.beforeId;null===c?g=b.length:(g=a[c],l<g&&--g);void 0!==g?e.beforeId=c:(console.error("options.beforeId was specified but no corresponding index was found"),g=h)}else g=h;b.splice(g,0,d);l=isFinite(l)?Math.min(l,g):g;for(g=b.length;l<g;++l)a[this.getIdentity(b[l])]=l;this.emit(k,e);return d},addSync:function(d,g){(g=g||{}).overwrite=!1;return this.putSync(d,g)},removeSync:function(d){var g=this.storage,l=g.index,
g=g.fullData;if(d in l)return l=g.splice(l[d],1)[0],this._reindex(),!0!==this._ignoreChangeEvents&&this.emit("delete",{id:d,target:l}),!0},setData:function(d){this.parse&&(d=this.parse(d));d.items&&(this.idProperty=d.identifier||this.idProperty,d=d.items);this.storage.fullData=this.data=d;this._reindex()},_reindex:function(){for(var d=this.storage,g=d.index={},u=d.fullData,a=this.Model,b=Object.prototype,e=0,h=u.length;e<h;e++){var r=u[e];if(a&&!(r instanceof a)){var c=this._restore(r,r.__proto__===
b);r!==c&&(u[e]=r=c)}g[this.getIdentity(r)]=e}d.version++},fetchSync:function(){var g=this.data;if(!g||g._version!==this.storage.version){for(var g=this.storage.fullData,k=this.queryLog,u=0,a=k.length;u<a;u++)g=k[u].querier(g);g._version=this.storage.version;this.data=g}return new d(g)},fetchRangeSync:function(g){var k=this.fetchSync();return new d(k.slice(g.start,g.end),{totalLength:k.length})},_includePropertyInSubCollection:function(d){return"data"!==d&&this.inherited(arguments)}})})},"dstore/Promised":function(){define(["dojo/_base/declare",
"dojo/Deferred","./QueryResults","dojo/when"],function(t,p,n,m){function g(d,g){return function(){var k=new p;try{k.resolve(this[d].apply(this,arguments))}catch(u){k.reject(u)}return g?(k=new n(k.promise),k.totalLength=m(k.totalLength),k):k.promise}}return t(null,{get:g("getSync"),put:g("putSync"),add:g("addSync"),remove:g("removeSync"),fetch:g("fetchSync",!0),fetchRange:g("fetchRangeSync",!0)})})},"dstore/QueryResults":function(){define(["dojo/_base/lang","dojo/when"],function(t,p){function n(m,
g){return p(this,function(d){for(var l=0,k=d.length;l<k;l++)m.call(g,d[l],l,d)})}return function(m,g){var d=g&&"totalLength"in g;if(m.then){m=t.delegate(m);var l=m.then(function(k){var l=d?g.totalLength:k.totalLength||k.length;k.totalLength=l;return!d&&l});m.totalLength=d?g.totalLength:l;m.response=g&&g.response}else m.totalLength=d?g.totalLength:m.length;m.forEach=n;return m}})},"dstore/SimpleQuery":function(){define(["dojo/_base/declare","dojo/_base/array"],function(t,p){function n(g,d){if(-1<g.indexOf(".")){var l=
g.split("."),k=l.length;return function(g){for(var a=0;a<k;a++)g=g&&(d&&g.get?g.get(l[a]):g[l[a]]);return g}}return function(d){return d.get?d.get(g):d[g]}}var m={eq:function(g,d){return g===d},"in":function(g,d){return-1<p.indexOf(d.data||d,g)},ne:function(g,d){return g!==d},lt:function(g,d){return g<d},lte:function(g,d){return g<=d},gt:function(g,d){return g>d},gte:function(g,d){return g>=d},match:function(g,d,l){return d.test(g,l)},contains:function(g,d,l,k){var m=this;return p.every(d.data||d,
function(a){if("object"===typeof a&&a.type){var b=m._getFilterComparator(a.type);return p.some(g,function(e){return b.call(m,e,a.args[1],l,k)})}return-1<p.indexOf(g,a)})}};return t(null,{_createFilterQuerier:function(g){function d(a){var b=a.type;a=a.args;var e=k._getFilterComparator(b);if(e){var h=a[0],g=n(h,l),c=a[1];c&&c.fetchSync&&(c=c.fetchSync());return function(a){return e.call(k,g(a),c,a,h)}}switch(b){case "and":case "or":for(var f=0,p=a.length;f<p;f++){var u=d(a[f]);m=m?function(a,c){return"and"===
b?function(b){return a(b)&&c(b)}:function(b){return a(b)||c(b)}}(m,u):u}return m;case "function":return a[0];case "string":f=k[a[0]];if(!f)throw Error("No filter function "+a[0]+" was found in the collection");return f;case void 0:return function(){return!0};default:throw Error('Unknown filter operation "'+b+'"');}}var l=this.queryAccessors,k=this,m=d(g);return function(a){return p.filter(a,m)}},_getFilterComparator:function(g){return m[g]||this.inherited(arguments)},_createSelectQuerier:function(g){return function(d){var l=
g.length;return p.map(d,g instanceof Array?function(d){for(var k={},a=0;a<l;a++){var b=g[a];k[b]=d[b]}return k}:function(d){return d[g]})}},_createSortQuerier:function(g){var d=this.queryAccessors;return function(l){l=l.slice();l.sort("function"==typeof g?g:function(k,l){for(var a=0;a<g.length;a++){var b,e=g[a];if("function"==typeof e)b=e(k,l);else{b=e.get||(e.get=n(e.property,d));var e=e.descending,h=b(k);b=b(l);null!=h&&(h=h.valueOf());null!=b&&(b=b.valueOf());b=h===b?0:!!e===(null===h||h>b&&null!==
b)?-1:1}if(0!==b)return b}return 0});return l}}})})},"dstore/Tree":function(){define(["dojo/_base/declare"],function(t){return t(null,{constructor:function(){this.root=this},mayHaveChildren:function(p){return"hasChildren"in p?p.hasChildren:!0},getRootCollection:function(){return this.root.filter({parent:null})},getChildren:function(p){return this.root.filter({parent:this.getIdentity(p)})}})})},"dstore/Cache":function(){define("dojo/_base/array dojo/when dojo/_base/declare dojo/_base/lang ./Store ./Memory ./QueryResults".split(" "),
function(t,p,n,m,g,d,l){function k(a){return function(){var b=this.inherited(arguments),d=this.cachingCollection||this.cachingStore;b.cachingCollection=d[a].apply(d,arguments);b.isValidFetchCache=!0===this.canCacheQuery||this.canCacheQuery(a,arguments);return b}}function u(a){a.cachingStore||(a.cachingStore=new d);a.cachingStore.Model=a.Model;a.cachingStore.idProperty=a.idProperty}var a={cachingStore:null,constructor:function(){u(this)},canCacheQuery:function(a,e){return!1},isAvailableInCache:function(){return this.isValidFetchCache&&
(this.allLoaded||this.fetchRequest)||this._parent&&this._parent.isAvailableInCache()},fetch:function(){return this._fetch(arguments)},fetchRange:function(){return this._fetch(arguments,!0)},_fetch:function(a,e){var b=this.cachingStore,d=this.cachingCollection||b,c=this,f=this.isAvailableInCache();if(f)return new l(p(f,function(){return c.isAvailableInCache()?e?d.fetchRange(a[0]):d.fetch():c.inherited(a)}));f=this.fetchRequest=this.inherited(a);p(f,function(a){var d=!e;c.fetchRequest=null;t.forEach(a,
function(a){!c.isLoaded||c.isLoaded(a)?b.put(a):d=!1});d&&(c.allLoaded=!0);return a});return f},isValidFetchCache:!1,get:function(a,e){var b=this.cachingStore,d=this.getInherited(arguments),c=this;return p(this.fetchRequest,function(){return p(b.get(a),function(f){if(void 0!==f)return f;if(d)return p(d.call(c,a,e),function(c){c&&b.put(c,{id:a});return c})})})},add:function(a,e){var b=this.cachingStore;return p(this.inherited(arguments),function(d){var c=b.put(d&&"object"===typeof d?d:a,e);return d||
c})},put:function(a,e){var b=this.cachingStore;b.remove(e&&e.id||this.getIdentity(a));return p(this.inherited(arguments),function(d){var c=b.put(d&&"object"===typeof d?d:a,e);return d||c})},remove:function(a,e){var b=this.cachingStore;return p(this.inherited(arguments),function(d){return p(b.remove(a,e),function(){return d})})},evict:function(a){this.allLoaded=!1;return this.cachingStore.remove(a)},invalidate:function(){this.allLoaded=!1},_createSubCollection:function(){var a=this.inherited(arguments);
a._parent=this;return a},sort:k("sort"),filter:k("filter"),select:k("select"),_getQuerierFactory:function(a){var b=this.cachingStore;return this.inherited(arguments)||m.hitch(b,b._getQuerierFactory(a))}};g=n(null,a);g.create=function(b,d){b=n.safeMixin(m.delegate(b),a);n.safeMixin(b,d);u(b);return b};return g})},"dstore/Trackable":function(){define("dojo/_base/lang dojo/_base/declare dojo/aspect dojo/when dojo/promise/all dojo/_base/array dojo/on".split(" "),function(t,p,n,m,g,d,l){function k(a,d,
h){for(var b=a.length-1;0<=b;--b){var c=a[b],e=c.start,c=e+c.count;if(d>c){a.splice(b+1,0,{start:d,count:h-d});return}h>=e&&(d=Math.min(d,e),h=Math.max(h,c),a.splice(b,1))}a.unshift({start:d,count:h-d})}var u=0,a={track:function(){function a(){return function(){var a=this,b=this.inherited(arguments);m(b,function(b){b=a._results=b.slice();a._partialResults&&(a._partialResults=null);a._ranges=[];k(a._ranges,0,b.length)});return b}}function e(){return function(a){var b=this,c=a.start,d=a.end,e=this.inherited(arguments);
this._results||m(e,function(a){return m(a.totalLength,function(e){var f=b._partialResults||(b._partialResults=[]);d=Math.min(d,c+a.length);f.length=e;e=[c,d-c].concat(a);f.splice.apply(f,e);k(b._ranges,c,d);return a})});return e}}function h(a,b){u++;var c=b.target;b=t.delegate(b,G[a]);m(x._results||x._partialResults,function(e){if(e){var f,h,k,l=x._ranges,m,n="id"in b?b.id:g.getIdentity(c),r=-1,p=-1,q=-1,u=-1;if("delete"===a||"update"===a)for(f=0;-1===r&&f<l.length;++f)for(m=l[f],h=m.start,k=h+m.count;h<
k;++h)if(g.getIdentity(e[h])==n){r=b.previousIndex=h;p=f;e.splice(r,1);m.count--;for(h=f+1;h<l.length;++h)l[h].start--;break}if("add"===a||"update"===a){if(F){if(F([c]).length){var t=0;k=l.length-1;h=-1;for(var v;t<=k&&-1===q;)f=t+Math.round((k-t)/2),m=l[f],p=e.slice(m.start,m.start+m.count),"beforeId"in b&&(h=null===b.beforeId?p.length:I(p,b.beforeId)),-1===h&&(h=r>=Math.max(0,m.start-1)&&r<=m.start+m.count?r:g.defaultNewToStart?0:p.length),p.splice(h,0,c),n=d.indexOf(F(p),c),v=m.start+n,0===n&&
0!==m.start?k=f-1:n>=p.length-1&&v<e.length?t=f+1:(q=v,u=f);if(-1===q&&0<t&&t<l.length)var w=!0}}else{h=-1;if("beforeId"in b)if(null===b.beforeId)q=e.length,h=l.length-1;else for(f=0,k=l.length;-1===u&&f<k;++f)m=l[f],q=I(e,b.beforeId,m.start,m.start+m.count),-1!==q&&(u=f);else"update"===a?(q=r,u=p):g.defaultNewToStart?h=q=0:(q=e.length,h=l.length-1);-1!==h&&-1===u&&(m=l[h])&&m.start<=q&&q<=m.start+m.count&&(u=h)}if(-1<q&&-1<u)for(b.index=q,e.splice(q,0,c),l[u].count++,f=u+1;f<l.length;++f)l[f].start++;
else if(w)for(b.beforeIndex=l[t].start,f=t;f<l.length;++f)l[f].start++}b.totalLength=e.length}(e=x["on_tracked"+a])&&e.call(x,b)})}var g=this.store||this,c=[],f={add:1,update:1,"delete":1},q;for(q in f)c.push(this.on(q,function(a){return function(b){h(a,b)}}(q)));var x=p.safeMixin(t.delegate(this),{_ranges:[],fetch:a(),fetchRange:e(),releaseRange:function(a,b){if(this._partialResults){a:for(var c=this._ranges,d=0,e;e=c[d];++d){var f=e.start,h=f+e.count;if(a<=f)if(b>=h)c.splice(d,1);else{e.start=b;
e.count=h-e.start;break a}else if(a<h)if(b>f){c.splice(d,1,{start:f,count:a-f},{start:b,count:h-b});break a}else e.count=a-e.start}for(;a<b;++a)delete this._partialResults[a]}},on:function(a,b){var c=this,e=this.getInherited(arguments);return l.parse(x,a,b,function(a,d){return d in f?n.after(x,"on_tracked"+d,b,!0):e.call(c,d,b)})},tracking:{remove:function(){for(;0<c.length;)c.pop().remove();this.remove=function(){}}},track:null});this.fetchSync&&(p.safeMixin(x,{fetchSync:a(),fetchRangeSync:e()}),
x.fetchSync());var F;d.forEach(this.queryLog,function(a){var b=F,c=a.querier;c&&(F=b?function(a){return c(b(a))}:c)});var G={add:{index:void 0},update:{previousIndex:void 0,index:void 0},"delete":{previousIndex:void 0}},I=function(a,b,c,d){d=void 0!==d?d:a.length;for(c=void 0!==c?c:0;c<d;++c)if(g.getIdentity(a[c])===b)return c;return-1};return x}};g=p(null,a);g.create=function(b,d){b=p.safeMixin(t.delegate(b),a);p.safeMixin(b,d);return b};return g})},"dstore/legacy/DstoreAdapter":function(){define(["dojo/_base/declare",
"dojo/_base/array","dojo/store/util/QueryResults"],function(t,p,n){function m(d){return d}var g={store:null,constructor:function(d){this.store=d;if(d._getQuerierFactory("filter")||d._getQuerierFactory("sort"))this.queryEngine=function(g,l){l=l||{};var a=d._getQuerierFactory("filter"),b=a?a(g):m;g=d._getQuerierFactory("sort");var e=m;g&&(e=g(p.map(l.sort,function(a){return{property:a.attribute,descending:a.descending}})));var h=m;isNaN(l.start)&&isNaN(l.count)||(h=function(a){var b=l.start||0,b=a.slice(b,
b+(l.count||Infinity));b.total=a.length;return b});return function(a){return h(e(b(a)))}};var g=this;d.on("add,update,delete",function(k){var l=k.type,a=k.target;g.notify("add"===l||"update"===l?a:void 0,"delete"===l||"update"===l?"id"in k?k.id:d.getIdentity(a):void 0)})},labelAttr:"title",getLabel:function(d){return this.store.getLabel(d)},query:function(d,g){g=g||{};var k=this.store.filter(d),l,a;if(d=g.sort)if("[object Array]"===Object.prototype.toString.call(d))for(var b;b=d.pop();)k=k.sort(b.attribute,
b.descending);else k=k.sort(d);k.track&&!k.tracking&&(k=k.track(),a=!0);"start"in g&&(l=g.start||0,l=k[k.fetchRangeSync?"fetchRangeSync":"fetchRange"]({start:l,end:g.count?l+g.count:Infinity}));l=l||k[k.fetchSync?"fetchSync":"fetch"]();g=l.totalLength;l=new n(l);l.total=g;l.observe=function(b,d){function e(b){return void 0===b&&a?-1:b}var c=k.on("add",function(a){b(a.target,-1,e(a.index))}),f=k.on("update",function(a){!d&&a.previousIndex===a.index&&isFinite(a.index)||b(a.target,e(a.previousIndex),
e(a.index))}),h=k.on("delete",function(a){b(a.target,e(a.previousIndex),-1)}),g={remove:function(){c.remove();f.remove();h.remove()}};g.cancel=g.remove;return g};return l},notify:function(){}};p.forEach(["get","put","add","remove","getIdentity"],function(d){g[d]=function(){var g=this.store;return(g[d+"Sync"]||g[d]).apply(g,arguments)}});return t(null,g)})}}});
//# sourceMappingURL=dgrid.js.map