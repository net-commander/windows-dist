//>>built
require({cache:{"dgrid/main":function(){define("dgrid/Tree dgrid/Selection dgrid/OnDemandList dgrid/OnDemandGrid dgrid/extensions/ColumnReorder dgrid/extensions/ColumnResizer dgrid/extensions/CompoundColumns dgrid/extensions/Pagination dgrid/extensions/DnD dgrid/Editor dstore/Store dstore/Memory dstore/Tree dstore/Cache dstore/Trackable dstore/legacy/DstoreAdapter".split(" "),function(){})},"dgrid/Tree":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/aspect dojo/dom-construct dojo/dom-class dojo/on dojo/query dojo/when ./util/has-css3 ./Grid xdojo/has!touch?./util/touch".split(" "),
function(q,l,p,r,d,m,k,e,u,a,b,c){return q(null,{collapseOnRefresh:!1,enableTreeTransitions:!1,treeIndentWidth:9,constructor:function(){this._treeColumnListeners=[]},shouldExpand:function(a,b,h){return h},expand:function(b,c,h){function f(f){!0===B.spin&&f.mayHaveChildren&&(m.remove(f,"fa-spin fa-spinner dgrid-cell-loading"),m.replace(f,"ui-icon-triangle-1-"+(v?"se":"e"),"ui-icon-triangle-1-"+(v?"e":"se")))}if(this._treeColumn){var t=this,y=b.element?b:this.row(b),C=!!this._expanded[y.id],F=a("transitionend"),
G,B=this.collection;if(b=y.element){b=-1<b.className.indexOf("dgrid-expando-icon")?b:e(".dgrid-expando-icon",b)[0];h=h||!this.enableTreeTransitions;if(b&&b.mayHaveChildren&&(h||c!==C)){var v=void 0===c?!this._expanded[y.id]:c;!0===B.spin&&c?(m.remove(b,"ui-icon-triangle-1-e"),m.remove(b,"ui-icon-triangle-1-se"),m.add(b,"fa fa-spinner fa-spin dgrid-cell-loading")):m.replace(b,"ui-icon-triangle-1-"+(v?"se":"e"),"ui-icon-triangle-1-"+(v?"e":"se"));m.toggle(y.element,"dgrid-row-expanded",v);c=y.element;
var w=c.connected,x,p,r={};if(!w){var w=r.container=c.connected=d.create("div",{className:"dgrid-tree-container"},c,"after"),q=function(f){var h=t._renderedCollection.getChildren(y.data);t.sort&&(h=h.sort(t.sort));h.track&&t.shouldTrackCollection&&(w._rows=f.rows=[],h=h.track(),w._handles=[h.tracking,t._observeCollection(h,w,f)]);return"start"in f?h.fetchRange({start:f.start,end:f.start+f.count}):h.fetch()};"level"in b&&(q.level=b.level);if(this.renderQuery)G=this.renderQuery(q,r);else{var D=d.create("div",
null,w);G=this._trackError(function(){return t.renderQueryResults(q(r),D,l.mixin({rows:r.rows},"level"in q?{queryLevel:q.level}:null)).then(function(f){d.destroy(D);return f})})}F&&k(w,F,this._onTreeTransitionEnd)}w.hidden=!v;x=w.style;!F||h?(x.display=v?"block":"none",x.height=""):(v?(x.display="block",p=w.scrollHeight,x.height="0px"):(m.add(w,"dgrid-tree-resetting"),x.height=w.scrollHeight+"px"),setTimeout(function(){m.remove(w,"dgrid-tree-resetting");x.height=v?p?p+"px":"auto":"0px"},0));v?this._expanded[y.id]=
!0:delete this._expanded[y.id]}G&&G.then?G.then(function(){f(b)}):f(b);return u(G)}}},_configColumns:function(){var a=this.inherited(arguments);this._expanded={};for(var b=0,h=a.length;b<h;b++)if(a[b].renderExpando){this._configureTreeColumn(a[b]);break}return a},insertRow:function(a){var b=this.inherited(arguments),h=this.row(b);(h=this.shouldExpand(h,this._currentLevel,this._expanded[h.id]))&&this.expand(b,!0,!0);(h||!this.collection.mayHaveChildren||this.collection.mayHaveChildren(a))&&m.add(b,
"dgrid-row-expandable");return b},removeRow:function(a,b){var h=a.connected,f={};h&&(h._handles&&(p.forEach(h._handles,function(f){f.remove()}),delete h._handles),h._rows&&(f.rows=h._rows),e("\x3e.dgrid-row",h).forEach(function(h){this.removeRow(h,!0,f)},this),h._rows&&(h._rows.length=0,delete h._rows),b||d.destroy(h));this.inherited(arguments)},_refreshCellFromItem:function(a,b){if(!a.column.renderExpando)return this.inherited(arguments);this.inherited(arguments,[a,b,{queryLevel:e(".dgrid-expando-icon",
a.element)[0].level-1}])},cleanup:function(){this.inherited(arguments);this.collapseOnRefresh&&(this._expanded={})},_destroyColumns:function(){this.inherited(arguments);for(var a=this._treeColumnListeners,b=a.length;b--;)a[b].remove();this._treeColumnListeners=[];this._treeColumn=null},_calcRowHeight:function(a){var b=a.connected;return this.inherited(arguments)+(b?b.offsetHeight:0)},_configureTreeColumn:function(b){var n=this,h=this.collection,f=".dgrid-content .dgrid-column-"+b.id,t;this._treeColumn=
b;if(!b._isConfiguredTreeColumn){var y=b.renderCell||this._defaultRenderCell;b._isConfiguredTreeColumn=!0;b.renderCell=function(f,a,c,t){if(h){var e=Number(t&&t.queryLevel)+1,d=!h.mayHaveChildren||h.mayHaveChildren(f),m,e=n._currentLevel=isNaN(e)?0:e;m=b.renderExpando(e,d,n._expanded[h.getIdentity(f)],f);m.level=e;m.mayHaveChildren=d;(f=y.call(b,f,a,c,t))&&f.nodeType?(c.appendChild(m),c.appendChild(f)):c.insertBefore(m,c.firstChild)}};"function"!==typeof b.renderExpando&&(b.renderExpando=this._defaultRenderExpando)}var e=
this._treeColumnListeners;0===e.length&&(e.push(this.on(b.expandOn||".dgrid-expando-icon:click,"+f+":dblclick,"+f+":keydown",function(f){var h=n.row(f);n.collection.mayHaveChildren&&!n.collection.mayHaveChildren(h.data)||"keydown"===f.type&&32!==f.keyCode||"dblclick"===f.type&&t&&1<t.count&&h.id===t.id&&-1<f.target.className.indexOf("dgrid-expando-icon")||n.expand(h);-1<f.target.className.indexOf("dgrid-expando-icon")&&(t&&t.id===n.row(f).id?t.count++:t={id:n.row(f).id,count:1})})),a("touch")&&e.push(this.on(c.selector(f,
c.dbltap),function(){n.expand(this)})))},_defaultRenderExpando:function(a,b,h){var f=this.grid.isRTL?"right":"left",c="dgrid-expando-icon";b&&(c+=" ui-icon ui-icon-triangle-1-"+(h?"se":"e"));return d.create("div",{className:c,innerHTML:"\x26nbsp;",style:"margin-"+f+": "+a*this.grid.treeIndentWidth+"px; float: "+f+";"})},_onNotification:function(a,b){"delete"===b.type&&delete this._expanded[b.id];this.inherited(arguments)},_onTreeTransitionEnd:function(a){var b=this,h=this.style.height;h&&(this.style.display=
"0px"===h?"none":"block");a&&(m.add(this,"dgrid-tree-resetting"),setTimeout(function(){m.remove(b,"dgrid-tree-resetting")},0));this.style.height=""}})})},"dgrid/util/has-css3":function(){define(["dojo/has"],function(q){function l(l,d){var m=l.style,k;if(d in m)return!0;d=d.slice(0,1).toUpperCase()+d.slice(1);for(k=p.length;k--;)if(p[k]+d in m)return p[k];return!1}var p=["ms","O","Moz","Webkit"];q.add("css-transitions",function(p,d,m){return l(m,"transitionProperty")});q.add("css-transforms",function(p,
d,m){return l(m,"transform")});q.add("css-transforms3d",function(p,d,m){return l(m,"perspective")});q.add("transitionend",function(){var l=q("css-transitions");return l?!0===l?"transitionend":{ms:"MSTransitionEnd",O:"oTransitionEnd",Moz:"transitionend",Webkit:"webkitTransitionEnd"}[l]:!1});return q})},"dgrid/Grid":function(){define("dojo/_base/declare dojo/_base/lang dojo/dom-construct dojo/dom-class dojo/on dojo/has ./List ./util/misc dojo/_base/sniff".split(" "),function(q,l,p,r,d,m,k,e){function u(a,
b){b&&b.nodeType&&a.appendChild(b)}q=q(k,{columns:null,hasNeutralSort:!1,cellNavigation:!0,tabableHeader:!0,showHeader:!0,column:function(a){return"object"!==typeof a?this.columns[a]:this.cell(a).column},listType:"grid",cell:function(a,b){if(a.column&&a.element)return a;a.target&&a.target.nodeType&&(a=a.target);var c;if(a.nodeType){do{if(this._rowIdToObject[a.id])break;var g=a.columnId;if(g){b=g;c=a;break}a=a.parentNode}while(a&&a!==this.domNode)}if(!c&&"undefined"!==typeof b){var n=this.row(a);if(g=
n&&n.element)for(var g=g.getElementsByTagName("td"),h=0;h<g.length;h++)if(g[h].columnId===b){c=g[h];break}}if(null!=a)return{row:n||this.row(a),column:b&&this.column(b),element:c}},createRowCells:function(a,b,c,g,n){var h=p.create("table",{className:"dgrid-row-table",role:"presentation"}),f=9>m("ie")?p.create("tbody",null,h):h,t,y,d,k,u,B,v,l,x,r;c=c||this.subRows;y=0;for(d=c.length;y<d;y++)for(B=c[y],t=p.create("tr",null,f),B.className&&(t.className=B.className),k=0,u=B.length;k<u;k++){v=B[k];l=
v.id;x=v.field?" field-"+e.escapeCssIdentifier(v.field,"-"):"";(r="function"===typeof v.className?v.className(g):v.className)&&(x+=" "+r);x=p.create(a,{className:"dgrid-cell"+(l?" dgrid-column-"+e.escapeCssIdentifier(l,"-"):"")+x,role:"th"===a?"columnheader":"gridcell"});x.columnId=l;if(l=v.colSpan)x.colSpan=l;if(l=v.rowSpan)x.rowSpan=l;b(x,v,g,n);t.appendChild(x)}return h},_createBodyRowCell:function(a,b,c,g){var n=c;b.get?n=b.get(c):"field"in b&&"_item"!==b.field&&(n=c[b.field]);b.renderCell?u(a,
b.renderCell(c,n,a,g)):this._defaultRenderCell.call(b,c,n,a,g)},_createHeaderRowCell:function(a,b){var c=b.headerNode=a,g=b.field;g&&(a.field=g);b.renderHeaderCell?u(c,b.renderHeaderCell(c)):("label"in b||b.field)&&c.appendChild(document.createTextNode("label"in b?b.label:b.field));!1!==b.sortable&&g&&"_item"!==g&&(a.sortable=!0,a.className+=" dgrid-sortable")},left:function(a,b){a.element||(a=this.cell(a));return this.cell(this._move(a,-(b||1),"dgrid-cell"))},right:function(a,b){a.element||(a=this.cell(a));
return this.cell(this._move(a,b||1,"dgrid-cell"))},_defaultRenderCell:function(a,b,c){if(this.formatter){var g=this.formatter,n=this.grid.formatterScope;c.innerHTML="string"===typeof g&&n?n[g](b,a):this.formatter(b,a)}else null!=b&&c.appendChild(document.createTextNode(b))},renderRow:function(a,b){var c=this.createRowCells("td",l.hitch(this,"_createBodyRowCell"),b&&b.subRows,a,b),g=p.create("div",{role:"row"});g.appendChild(c);return g},renderHeader:function(){var a=this,b=this.headerNode;b.setAttribute("role",
"row");p.empty(b);var c=this.createRowCells("th",l.hitch(this,"_createHeaderRowCell"),this.subRows&&this.subRows.headerRows);this._rowIdToObject[c.id=this.id+"-header"]=this.columns;b.appendChild(c);this._sortListener&&this._sortListener.remove();this._sortListener=d(c,"click,keydown",function(c){if("click"===c.type||32===c.keyCode||!m("opera")&&13===c.keyCode){var n=c.target,h,f;do if(n.sortable){h=n.field||n.columnId;f=a.sort[0];h=a.hasNeutralSort&&f&&f.property===h&&f.descending?[]:[{property:h,
descending:f&&f.property===h&&!f.descending}];f={bubbles:!0,cancelable:!0,grid:a,parentType:c.type,sort:h};d.emit(c.target,"dgrid-sort",f)&&(a._sortNode=n,a.set("sort",h));break}while((n=n.parentNode)&&n!==b)}})},resize:function(){if(this.headerNode){var a=this.headerNode.firstChild,b=this.contentNode,c;this.inherited(arguments);b.style.width="";b&&a&&(c=a.offsetWidth)>b.offsetWidth&&(b.style.width=c+"px")}},destroy:function(){this._destroyColumns();this._sortListener&&this._sortListener.remove();
this.inherited(arguments)},_setSort:function(){this.inherited(arguments);this.updateSortArrow(this.sort)},_findSortArrowParent:function(a){var b=this.columns,c;for(c in b){var g=b[c];if(g.field===a)return g.headerNode}},updateSortArrow:function(a,b){this._lastSortedArrow&&(r.remove(this._lastSortedArrow.parentNode,"dgrid-sort-up dgrid-sort-down"),p.destroy(this._lastSortedArrow),delete this._lastSortedArrow);b&&(this.sort=a);if(a[0]){var c=a[0].property,g=a[0].descending,c=this._sortNode||this._findSortArrowParent(c);
delete this._sortNode;c&&(c=c.contents||c,this._lastSortedArrow=p.create("div",{className:"dgrid-sort-arrow ui-icon",innerHTML:"\x26nbsp;",role:"presentation"},c,"first"),r.add(c,"dgrid-sort-"+(g?"down":"up")),this.resize())}},styleColumn:function(a,b){return this.addCssRule("#"+e.escapeCssIdentifier(this.domNode.id)+" .dgrid-column-"+e.escapeCssIdentifier(a,"-"),b)},_configColumns:function(a,b){var c=[],g=b instanceof Array;e.each(b,function(n,h){"string"===typeof n&&(b[h]=n={label:n});g||n.field||
(n.field=h);h=n.id=n.id||(isNaN(h)?h:a+h);this._configColumn&&(this._configColumn(n,b,a),h=n.id);g&&(this.columns[h]=n);n.grid=this;c.push(n)},this);return g?b:c},_destroyColumns:function(){this.cleanup()},configStructure:function(){var a=this.subRows,b=this._columns=this.columns;this.columns=!b||b instanceof Array?{}:b;if(a)for(b=0;b<a.length;b++)a[b]=this._configColumns(b+"-",a[b]);else this.subRows=[this._configColumns("",b)]},_getColumns:function(){return this._columns||this.columns},_setColumns:function(a){this._destroyColumns();
this.subRows=null;this.columns=a;this._updateColumns()},_setSubRows:function(a){this._destroyColumns();this.subRows=a;this._updateColumns()},_updateColumns:function(){this.configStructure();this.renderHeader();this.refresh();this._lastCollection&&this.renderArray(this._lastCollection);this._started&&(this.sort.length?(this._lastSortedArrow=null,this.updateSortArrow(this.sort)):this.resize())}});q.appendIfNode=u;return q})},"dgrid/List":function(){define("dojo/_base/declare dojo/dom-construct dojo/dom-class dojo/on dojo/has ./util/misc xide/$".split(" "),
function(q,l,p,r,d,m,k){function e(f,h){f.className="dgrid-scrollbar-measure";document.body.appendChild(f);var a=f["offset"+h]-f["client"+h];f.className="";f.parentNode&&document.body.removeChild(f);return a}function u(f){p.replace(this.domNode,f,this._class||"");this._class=f}function a(){return this._class}var b=[];d("mozilla")&&b.push("has-mozilla");d("touch")&&b.push("has-touch");p.add(document.documentElement,b);d.add("pointer",function(f){return"PointerEvent"in f?"pointer":"MSPointerEvent"in
f?"MSPointer":!1});var c,g;d.add("dom-scrollbar-width",function(f,h,a){return e(a,"Width")});d.add("dom-scrollbar-height",function(f,h,a){return e(a,"Height")});d.add("dom-rtl-scrollbar-left",function(f,h,a){f=document.createElement("div");a.className="dgrid-scrollbar-measure";a.setAttribute("dir","rtl");a.appendChild(f);document.body.appendChild(a);h=!!d("ie")||!!d("trident")||/\bEdge\//.test(navigator.userAgent)||f.offsetLeft>=d("dom-scrollbar-width");a.className="";a.parentNode&&document.body.removeChild(a);
l.destroy(f);a.removeAttribute("dir");return h});var n=0,h=q(null,{tabableHeader:!1,showHeader:!1,showFooter:!1,maintainOddEven:!0,cleanAddedRules:!0,addUiClasses:!1,highlightDuration:250,postscript:function(f,a){var h=this;(this._Row=function(f,a,h){this.id=f;this.data=a;this.element=h}).prototype.remove=function(){h.removeRow(this.element)};a&&(this.srcNodeRef=a=a.nodeType?a:document.getElementById(a));this.create(f,a)},listType:"list",create:function(f,a){var b=this.domNode=a||document.createElement("div"),
c;f&&(this.params=f,q.safeMixin(this,f),c=f["class"]||f.className||b.className);this.sort=this.sort||[];this._listeners=[];this._rowIdToObject={};this.postMixInProperties&&this.postMixInProperties();this.id=b.id=b.id||this.id||h.autoIdPrefix+n++;this.buildRendering();c&&u.call(this,c);this.postCreate();delete this.srcNodeRef},buildRendering:function(){var f=this.domNode,a=this.addUiClasses,h=this,b,c,g;g=this.isRTL="rtl"===(document.body.dir||document.documentElement.dir||document.body.style.direction).toLowerCase();
f.className="";f.setAttribute("role","grid");p.add(f,"dgrid dgrid-"+this.listType+(a?" ui-widget":""));b=this.headerNode=l.create("div",{tabIndex:-1,className:"dgrid-header dgrid-header-row"+(a?" ui-widget-header":"")+(this.showHeader?"":" dgrid-header-hidden")},f);c=this.bodyNode=l.create("div",{className:"dgrid-scroller"},f);d("ff")&&(c.tabIndex=-1);this.headerScrollNode=l.create("div",{className:"dgrid-header dgrid-header-scroll dgrid-scrollbar-width"+(a?" widget":"")},f);this.footerNode=l.create("div",
{className:"dgrid-footer"+(this.showFooter?"":" dgrid-footer-hidden")},f);g&&(f.className+=" dgrid-rtl"+(d("dom-rtl-scrollbar-left")?" dgrid-rtl-swap":""));r(c,"scroll",function(a){h.showHeader&&(b.scrollLeft=a.scrollLeft||c.scrollLeft);a.stopPropagation();r.emit(f,"scroll",{scrollTarget:c})});this.configStructure();this.renderHeader();this.contentNode=this.touchNode=l.create("div",{className:"dgrid-content"+(a?" widget":"")},this.bodyNode)},startup:function(){this._started||(this.inherited(arguments),
this._started=!0,this.set("sort",this.sort))},configStructure:function(){},resize:function(){var f=this.bodyNode,a=this.footerNode,a=this.showFooter?a.offsetHeight:0;this.headerScrollNode.style.height=f.style.marginTop=this.headerNode.offsetHeight+"px";f.style.marginBottom=a+"px";c||(c=d("dom-scrollbar-width"),g=d("dom-scrollbar-height"),d("ie")&&(c++,g++),17!==c&&m.addCssRule(".dgrid-rtl-swap .dgrid-header-row","left: "+c+"px"))},addCssRule:function(f,a){var h=m.addCssRule(f,a);this.cleanAddedRules&&
this._listeners.push(h);return h},on:function(f,a){var h=r(this.domNode,f,a);d("dom-addeventlistener")||this._listeners.push(h);return h},cleanup:function(){for(var f in this._rowIdToObject)if(this._rowIdToObject[f]!==this.columns){var a=document.getElementById(f);a&&this.removeRow(a,!0)}},destroy:function(){if(this._listeners){for(var f=this._listeners.length;f--;)this._listeners[f].remove();this._listeners=null}this._started=!1;this.cleanup();k(this.domNode).remove()},refresh:function(){this.cleanup();
this._rowIdToObject={};this._autoRowId=0;k(this.contentNode).empty()},adjustRowIndices:function(f){var a=f.rowIndex;if(-1<a){do-1<f.rowIndex&&(this.maintainOddEven&&p.contains(f,"dgrid-row")&&p.replace(f,1===a%2?"dgrid-row-odd":"dgrid-row-even",0===a%2?"dgrid-row-odd":"dgrid-row-even"),f.rowIndex=a++);while((f=f.nextSibling)&&f.rowIndex!==a)}},renderArray:function(f,a,h){h=h||{};var b=h.start||0,c=document.createDocumentFragment(),g=[],n=0,e=f.length;a||(this._lastCollection=f);for(;n<e;)g[n]=this.insertRow(f[n],
c,null,b++,h),n++;(f=a?a.parentNode:this.contentNode)&&f.parentNode&&(f!==this.contentNode||e)&&(f.insertBefore(c,a||null),e&&this.adjustRowIndices(g[e-1]));return g},renderHeader:function(){},_autoRowId:0,insertRow:function(f,a,h,b,c){var g=this.id+"-row-"+(this.collection&&this.collection.getIdentity?this.collection.getIdentity(f):this._autoRowId++),n=document.getElementById(g),e=n&&n.previousSibling;n&&(n===h&&(h=(h.connected||h).nextSibling),this.removeRow(n,!1,c));n=this.renderRow(f,c);n.className=
(n.className||"")+" dgrid-row "+(1===b%2?"dgrid-row-odd":"dgrid-row-even");this._rowIdToObject[n.id=g]=f;a.insertBefore(n,h||null);n.rowIndex=b;e&&e.rowIndex!==n.rowIndex-1&&this.adjustRowIndices(e);return n},renderRow:function(f){var a=document.createElement("div");a.appendChild(document.createTextNode(f));return a},removeRow:function(f,a){f=f.element||f;delete this._rowIdToObject[f.id];a||k(f).remove()},row:function(f){var a;if(f instanceof this._Row)return f;if(!f)return null;f.target&&f.target.nodeType&&
(f=f.target);if(f.nodeType){do{var h=f.id;if(a=this._rowIdToObject[h])return new this._Row(h.substring(this.id.length+5),a,f);f=f.parentNode}while(f&&f!==this.domNode)}else return"object"===typeof f?a=this.collection.getIdentity(f):(a=f,f=this._rowIdToObject[this.id+"-row-"+a]),new this._Row(a,f,document.getElementById(this.id+"-row-"+a))},cell:function(f){return{row:this.row(f)}},_move:function(f,a,h,b){var c,g;g=c=f.element;a=a||1;do if(f=c[0>a?"previousSibling":"nextSibling"]){do if((c=f)&&-1<
(c.className+" ").indexOf(h+" ")){g=c;a+=0>a?1:-1;break}while(f=(!b||!c.hidden)&&c[0>a?"lastChild":"firstChild"])}else if(c=c.parentNode,!c||c===this.bodyNode||c===this.headerNode)break;while(a);return g},up:function(a,h,b){a.element||(a=this.row(a));return this.row(this._move(a,-(h||1),"dgrid-row",b))},down:function(a,h,b){a.element||(a=this.row(a));return this.row(this._move(a,h||1,"dgrid-row",b))},scrollTo:function(a){"undefined"!==typeof a.x&&(this.bodyNode.scrollLeft=a.x);"undefined"!==typeof a.y&&
(this.bodyNode.scrollTop=a.y)},getScrollPosition:function(){return{x:this.bodyNode.scrollLeft,y:this.bodyNode.scrollTop}},get:function(a){var h="_get"+a.charAt(0).toUpperCase()+a.slice(1);return"function"===typeof this[h]?this[h].apply(this,[].slice.call(arguments,1)):this[a]},set:function(a,h){if("object"===typeof a)for(var b in a)this.set(b,a[b]);else b="_set"+a.charAt(0).toUpperCase()+a.slice(1),"function"===typeof this[b]?this[b].apply(this,[].slice.call(arguments,1)):this[a]=h;return this},_getClass:a,
_setClass:u,_getClassName:a,_setClassName:u,_setSort:function(a,h){this.sort="string"!==typeof a?a:[{property:a,descending:h}];this._applySort()},_applySort:function(){this.refresh();if(this._lastCollection){var a=this.sort;if(a&&0<a.length){var h=a[0].property,b=!!a[0].descending;this._lastCollection.sort(function(a,f){var c=a[h],g=f[h];void 0===c&&(c="");void 0===g&&(g="");return c===g?0:c>g!==b?1:-1})}this.renderArray(this._lastCollection)}},_setShowHeader:function(a){var h=this.headerNode;this.showHeader=
a;p.toggle(h,"dgrid-header-hidden",!a);this.renderHeader();this.resize();a&&(h.scrollLeft=this.getScrollPosition().x)},_setShowFooter:function(a){this.showFooter=a;p.toggle(this.footerNode,"dgrid-footer-hidden",!a);this.resize()}});h.autoIdPrefix="dgrid_";return h})},"dgrid/util/misc":function(){define(["dojo/has"],function(q){q.add("dom-contains",function(e,d,a){return!!a.contains});var l=[],p,r,d,m=/([^A-Za-z0-9_\u00A0-\uFFFF-])/g,k={defaultDelay:15,throttle:function(e,d,a){var b=!1;a=a||k.defaultDelay;
return function(){b||(b=!0,e.apply(d,arguments),setTimeout(function(){b=!1},a))}},throttleDelayed:function(e,d,a){var b=!1;a=a||k.defaultDelay;return function(){if(!b){b=!0;var c=arguments;setTimeout(function(){b=!1;e.apply(d,c)},a)}}},debounce:function(e,d,a){var b;a=a||k.defaultDelay;return function(){b&&(clearTimeout(b),b=null);var c=arguments;b=setTimeout(function(){e.apply(d,c)},a)}},each:function(e,d,a){var b,c;if(e)if("number"===typeof e.length)for(b=0,c=e.length;b<c;b++)d.call(a,e[b],b,e);
else for(b in e)d.call(a,e[b],b,e)},contains:function(e,d){return q("dom-contains")?e.contains(d):e.compareDocumentPosition(d)&8},addCssRule:function(e,m){p||(p=document.createElement("style"),document.getElementsByTagName("head")[0].appendChild(p),p=p.sheet||p.styleSheet,r=p.deleteRule?"deleteRule":"removeRule",d=p.cssRules?"cssRules":"rules");var a=l.length;l[a]=(p.cssRules||p.rules).length;p.addRule?p.addRule(e,m):p.insertRule(e+"{"+m+"}",l[a]);return{get:function(b){return p[d][l[a]].style[b]},
set:function(b,c){"undefined"!==typeof l[a]&&(p[d][l[a]].style[b]=c)},remove:function(){var b=l[a],c,g;if(void 0!==b)for(p[r](b),l[a]=void 0,c=a+1,g=l.length;c<g;c++)l[c]>b&&l[c]--}}},escapeCssIdentifier:function(e,d){return"string"===typeof e?e.replace(m,d||"\\$1"):e}};return k})},"dgrid/Selection":function(){define("dojo/_base/declare dojo/dom-class dojo/on dojo/has dojo/aspect ./List dgrid/util/touch dojo/query dojo/_base/sniff dojo/dom".split(" "),function(q,l,p,r,d,m,k){function e(a,f){for(var b=
a.unselectable=f?"on":"",c=a.getElementsByTagName("*"),g=c.length;--g;)"INPUT"!==c[g].tagName&&"TEXTAREA"!==c[g].tagName&&(c[g].unselectable=b)}function u(a,f){var c=a.bodyNode,g=f?"text":21>r("ff")?"-moz-none":"none";b&&"msUserSelect"!==b?c.style[b]=g:r("dom-selectstart")?f||a._selectstartHandle?f&&a._selectstartHandle&&(a._selectstartHandle.remove(),delete a._selectstartHandle):a._selectstartHandle=p(c,"selectstart",function(a){var h=a.target&&a.target.tagName;"INPUT"!==h&&"TEXTAREA"!==h&&a.preventDefault()}):
(e(c,!f),f||a._unselectableHandle)?f&&a._unselectableHandle&&(a._unselectableHandle.remove(),delete a._unselectableHandle):a._unselectableHandle=d.after(a,"renderRow",function(a){e(a,!0);return a})}r.add("dom-comparedocumentposition",function(a,f,b){return!!b.compareDocumentPosition});r.add("dom-selectstart","undefined"!==typeof document.onselectstart);var a=r("mac")?"metaKey":"ctrlKey",b=r("css-user-select"),c=(m=r("pointer"))&&"MS"===m.slice(0,2),g=m?m+(c?"Down":"down"):"mousedown",n=m?m+(c?"Up":
"up"):"mouseup";"WebkitUserSelect"===b&&"undefined"!==typeof document.documentElement.style.msUserSelect&&(b=!1);return q(null,{selectionDelegate:".dgrid-row",selectionEvents:g+","+n+",dgrid-cellfocusin",selectionTouchEvents:r("touch")?k.tap:null,deselectOnRefresh:!0,allowSelectAll:!1,selection:{},selectionMode:"extended",allowTextSelection:void 0,_selectionTargetType:"rows",create:function(){this.selection={};return this.inherited(arguments)},postCreate:function(){this.inherited(arguments);this._initSelectionEvents();
var a=this.selectionMode;this.selectionMode="";this._setSelectionMode(a)},destroy:function(){this.inherited(arguments);this._selectstartHandle&&this._selectstartHandle.remove();this._unselectableHandle&&this._unselectableHandle.remove();this._removeDeselectSignals&&this._removeDeselectSignals()},_setSelectionMode:function(a){a!==this.selectionMode&&(this.clearSelection(),this.selectionMode=a,this._selectionHandlerName="_"+a+"SelectionHandler",this._setAllowTextSelection(this.allowTextSelection))},
_setAllowTextSelection:function(a){"undefined"!==typeof a?u(this,a):u(this,"none"===this.selectionMode);this.allowTextSelection=a},_handleSelect:function(a,f){if(this[this._selectionHandlerName]&&this.allowSelect(this.row(f))&&("dgrid-cellfocusin"!==a.type||"mousedown"!==a.parentType)&&(a.type!==n||f===this._waitForMouseUp)){this._waitForMouseUp=null;this._selectionTriggerEvent=a;if(!a.keyCode||!a.ctrlKey||32===a.keyCode)if(!a.shiftKey&&a.type===g&&this.isSelected(f))this._waitForMouseUp=f;else this[this._selectionHandlerName](a,
f);this._selectionTriggerEvent=null}},_singleSelectionHandler:function(h,f){var b=h.keyCode?h.ctrlKey:h[a];this._lastSelected===f?this.select(f,null,!b||!this.isSelected(f)):(this.clearSelection(),this.select(f),this._lastSelected=f)},_multipleSelectionHandler:function(h,f){var b=this._lastSelected,c=h.keyCode?h.ctrlKey:h[a],g;h.shiftKey||(g=c?null:!0,b=null);this.select(f,b,g,null,-1!==h.type.indexOf("mouse")?"mouse":h.type);b||(this._lastSelected=f)},_extendedSelectionHandler:function(b,f){(2===
b.button?this.isSelected(f):b.keyCode?b.ctrlKey:b[a])||this.clearSelection(null,!0);this._multipleSelectionHandler(b,f)},_toggleSelectionHandler:function(a,f){this.select(f,null,null)},_initSelectionEvents:function(){var b=this,f=this.contentNode,c=this.selectionDelegate;this._selectionEventQueues={deselect:[],select:[]};r("touch")&&!r("pointer")&&this.selectionTouchEvents?(p(f,k.selector(c,this.selectionTouchEvents),function(a){b._handleSelect(a,this);b._ignoreMouseSelect=this}),p(f,p.selector(c,
this.selectionEvents),function(a){b._ignoreMouseSelect!==this?b._handleSelect(a,this):a.type===n&&(b._ignoreMouseSelect=null)})):p(f,p.selector(c,this.selectionEvents),function(a){b._handleSelect(a,this)});this.addKeyHandler&&this.addKeyHandler(32,function(a){b._handleSelect(a,a.target)});if(this.allowSelectAll)this.on("keydown",function(f){f[a]&&65===f.keyCode&&!/\bdgrid-input\b/.test(f.target.className)&&(f.preventDefault(),b[b.allSelected?"clearSelection":"selectAll"]())});this._setCollection&&
d.before(this,"_setCollection",function(a){b._updateDeselectionAspect(a)});this._updateDeselectionAspect()},_updateDeselectionAspect:function(a){function b(a,f,h){if((a=c.row(a))&&c.selection[a.id])c[f](a,null,!0,null,h)}var c=this,g;this._removeDeselectSignals&&this._removeDeselectSignals();g=a&&a.track&&this._observeCollection?[d.before(this,"_observeCollection",function(a){g.push(a.on("delete",function(a){"undefined"===typeof a.index&&b(a.id,"deselect")}))}),d.after(this,"_observeCollection",function(a){g.push(a.on("update",
function(h){"undefined"!==typeof h.index&&b(a.getIdentity(h.target),"select","update")}))},!0)]:[d.before(this,"removeRow",function(a,b){var f;b||(f=this.row(a))&&f.id in this.selection&&this.deselect(f)})];this._removeDeselectSignals=function(){for(var a=g.length;a--;)g[a].remove();g=[]}},allowSelect:function(){return!0},_fireSelectionEvent:function(a){var b=this._selectionEventQueues[a],c=this._selectionTriggerEvent,g;g={bubbles:!0,grid:this};c&&(g.parentType=c.type);g[this._selectionTargetType]=
b;this._selectionEventQueues[a]=[];p.emit(this.contentNode,"dgrid-"+a,g)},_fireSelectionEvents:function(){var a=this._selectionEventQueues,b;for(b in a)a[b].length&&this._fireSelectionEvent(b)},_select:function(a,b,c){var g,n,d;"undefined"===typeof c&&(c=!0);a.element||(a=this.row(a));if(!1===c||this.allowSelect(a))if(g=this.selection,n=!!g[a.id],null===c&&(c=!n),d=a.element,c||this.allSelected?g[a.id]=c:delete this.selection[a.id],d&&(c?l.add(d,"dgrid-selected"+(this.addUiClasses?" ui-state-active":
"")):l.remove(d,"dgrid-selected ui-state-active")),c!==n&&d&&this._selectionEventQueues[(c?"":"de")+"select"].push(a),b)if(b.element||(b=this.row(b)),b){if(b=b.element)for(g=this._determineSelectionDirection(d,b),g||(b=document.getElementById(b.id),g=this._determineSelectionDirection(d,b));a.element!==b&&(a=this[g](a));)this._select(a,null,c)}else this._lastSelected=d},_determineSelectionDirection:r("dom-comparedocumentposition")?function(a,b){var c=b.compareDocumentPosition(a);return c&1?!1:2===
c?"down":"up"}:function(a,b){return 1>b.sourceIndex?!1:b.sourceIndex>a.sourceIndex?"down":"up"},select:function(a,b,c){this._select(a,b,c);this._fireSelectionEvents()},deselect:function(a,b){this.select(a,b,!1)},clearSelection:function(a,b){this.allSelected=!1;for(var c in this.selection)a!==c&&this._select(c,null,!1);b||(this._lastSelected=null);this._fireSelectionEvents()},selectAll:function(){this.allSelected=!0;this.selection={};for(var a in this._rowIdToObject){var b=this.row(this._rowIdToObject[a]);
this._select(b.id,null,!0)}this._fireSelectionEvents()},isSelected:function(a){if("undefined"===typeof a||null===a)return!1;a.element||(a=this.row(a));return a.id in this.selection?!!this.selection[a.id]:this.allSelected&&(!a.data||this.allowSelect(a))},refresh:function(){this.deselectOnRefresh&&this.clearSelection();this._lastSelected=null;return this.inherited(arguments)},renderArray:function(){var a=this.inherited(arguments),b=this.selection,c,g,n;for(c=0;c<a.length;c++)g=this.row(a[c]),(n=g.id in
b?b[g.id]:this.allSelected)&&this.select(g,null,n,null,"renderArray");this._fireSelectionEvents();return a}})})},"dgrid/util/touch":function(){define(["dojo/on"],function(q,l){function p(d,m,k,e){if(!(1<k.targetTouches.length)){var u=k.changedTouches[0],a=u.screenX,b=u.screenY;e&&k.preventDefault();var c=q(d,"touchend",function(g){var n=g.changedTouches[0];g.targetTouches.length||(Math.abs(n.screenX-a)<r.tapRadius&&Math.abs(n.screenY-b)<r.tapRadius&&(e&&g.preventDefault(),m.call(this,g)),c.remove())})}}
var r={tapRadius:10,dbltapTime:250,selector:function(d,m,k){return function(e,u){var a=m.bubble;a?m=a:!1!==k&&(k=!0);return q(e,m,function(a){var c=a.target;3===c.nodeType&&(c=c.parentNode);for(;!l.matches(c,d,e);)if(c===e||!k||!(c=c.parentNode))return;return u.call(c,a)})}},countCurrentTouches:function(d,m){if(!("touches"in d))return-1;var k,e,u;for(e=k=0;u=d.touches[k];++k)m.contains(u.target)&&++e;return e},tap:function(d,m){return q(d,"touchstart",function(k){p(d,m,k)})},dbltap:function(d,m){var k,
e;return q(d,"touchstart",function(u){k?p(d,function(a){if(k){var b=a.changedTouches[0];Math.abs(b.screenX-k.screenX)<r.tapRadius&&Math.abs(b.screenY-k.screenY)<r.tapRadius&&(e&&clearTimeout(e),k=e=null,m.call(this,a))}},u,!0):p(d,function(a){k=a.changedTouches[0];e=setTimeout(function(){k=e=null},r.dbltapTime)},u)})}};return r})},"dgrid/OnDemandList":function(){define("./List ./_StoreMixin dojo/_base/declare dojo/_base/lang dojo/dom-construct dojo/on dojo/when ./util/misc".split(" "),function(q,
l,p,r,d,m,k,e){return p([q,l],{minRowsPerPage:2500,maxRowsPerPage:250,maxEmptySpace:Infinity,bufferRows:10,farOffRemoval:2E3,queryRowsOverlap:0,pagingMethod:"debounce",pagingDelay:e.defaultDelay,keepScrollPosition:!0,rowHeight:0,postCreate:function(){this.inherited(arguments);var d=this;m(this.bodyNode,"scroll",e[this.pagingMethod](function(a){d._processScroll(a)},null,this.pagingDelay))},destroy:function(){this.inherited(arguments);this._refreshTimeout&&clearTimeout(this._refreshTimeout)},renderQuery:function(e,
a){var b=this,c=a&&a.container||this.contentNode,g={query:e,count:0},n,h=this.preload,f={node:d.create("div",{className:"dgrid-preload",style:{height:"0"}},c),count:0,query:e,next:g};f.node.rowIndex=0;g.node=n=d.create("div",{className:"dgrid-preload"},c);g.previous=f;n.rowIndex=this.minRowsPerPage;h?((g.next=h.next)&&n.offsetTop>=h.node.offsetTop?g.previous=h:(g.next=h,g.previous=h.previous),g.previous.next=g,g.next.previous=g):this.preload=g;var t=d.create("div",{className:"dgrid-loading"},n,"before");
d.create("div",{className:"dgrid-below"},t).innerHTML=this.loadingMessage;a=r.mixin({start:0,count:this.minRowsPerPage},"level"in e?{queryLevel:e.level}:null);return this._trackError(function(){var f=e(a);return b.renderQueryResults(f,n,a).then(function(c){return f.totalLength.then(function(f){var h=c.length,e=n.parentNode,m=b.noDataNode;b._rows&&(b._rows.min=0,b._rows.max=h===f?Infinity:h-1);d.destroy(t);"queryLevel"in a||(b._total=f);0===f&&e&&(m&&(d.destroy(m),delete b.noDataNode),b.noDataNode=
m=d.create("div",{className:"dgrid-no-data",innerHTML:b.noDataMessage}),b._emit("noData"),e.insertBefore(m,b._getFirstRowSibling(e)));for(m=e=0;m<h;m++)e+=b._calcRowHeight(c[m]);h&&e&&(b.rowHeight=e/h);f-=h;g.count=f;n.rowIndex=h;f?n.style.height=Math.min(f*b.rowHeight,b.maxEmptySpace)+"px":n.style.display="none";b._previousScrollPosition&&(b.scrollTo(b._previousScrollPosition),delete b._previousScrollPosition);return k(b._processScroll()).then(function(){return c})})}).otherwise(function(a){d.destroy(t);
throw a;})})},refresh:function(e){var a=this;e&&e.keepScrollPosition&&(this._previousScrollPosition=this.getScrollPosition());this.inherited(arguments);if(this._renderedCollection)return this.renderQuery(function(b){return a._renderedCollection.fetchRange({start:b.start,end:b.start+b.count})}).then(function(){a._refreshTimeout=setTimeout(function(){m.emit(a.domNode,"dgrid-refresh-complete",{bubbles:!0,cancelable:!1,grid:a});a._refreshTimeout=null},0)})},resize:function(){this.inherited(arguments);
this._processScroll()},cleanup:function(){this.inherited(arguments);this.preload=null},renderQueryResults:function(e){var a=this.inherited(arguments),b=this._renderedCollection;b&&b.releaseRange&&a.then(function(a){a[0]&&!a[0].parentNode.tagName&&e.totalLength.then(function(){b.releaseRange(a[0].rowIndex,a[a.length-1].rowIndex+1)})});return a},_getFirstRowSibling:function(e){return e.lastChild},_calcRowHeight:function(e){var a=e.nextSibling;return a&&!/\bdgrid-preload\b/.test(a.className)?a.offsetTop-
e.offsetTop:e.offsetHeight},lastScrollTop:0,_processScroll:function(e){function a(a,f,c,h){var n=g.farOffRemoval,e=a.node;if(f>2*n){for(var t,m=e[c],k=0,y=0,v=[],u=m&&m.rowIndex,l;t=m;){var p=g._calcRowHeight(t);if(k+p+n>f||0>m.className.indexOf("dgrid-row")&&0>m.className.indexOf("dgrid-loading"))break;m=t[c];k+=p;y+=t.count||1;g.removeRow(t,!0);v.push(t);"rowIndex"in t&&(l=t.rowIndex)}g._renderedCollection.releaseRange&&"number"===typeof u&&"number"===typeof l&&(h?g._renderedCollection.releaseRange(l,
u+1):g._renderedCollection.releaseRange(u,l+1),g._rows[h?"max":"min"]=l,g._rows.max>=g._total-1&&(g._rows.max=Infinity));a.count+=y;h?(e.rowIndex-=y,b(a)):e.style.height=e.offsetHeight+k+"px";var C=document.createElement("div");for(a=v.length;a--;)C.appendChild(v[a]);setTimeout(function(){d.destroy(C)},1)}}function b(a,b){a.node.style.height=Math.min(a.count*g.rowHeight,b?Infinity:g.maxEmptySpace)+"px"}function c(a,b){do a=b?a.next:a.previous;while(a&&!a.node.offsetWidth);return a}if(this.rowHeight){var g=
this,n=g.bodyNode;e=e&&e.scrollTop||this.getScrollPosition().y;var n=n.offsetHeight+e,h,f,t=g.preload,m=g.lastScrollTop,k=g.bufferRows*g.rowHeight,l=k-g.rowHeight,p,r=!0;for(g.lastScrollTop=e;t&&!t.node.offsetWidth;)t=t.previous;for(;t&&t!==h;){h=g.preload;g.preload=t;f=t.node;var v=f.offsetTop;if(n+1+l<v)t=c(t,r=!1);else if(e-1-l>v+f.offsetHeight)t=c(t,r=!0);else{var v=((f.rowIndex?e-k:n)-v)/g.rowHeight,w=(n-e+2*k)/g.rowHeight,x=Math.max(Math.min((e-m)*g.rowHeight,g.maxRowsPerPage/2),g.maxRowsPerPage/
-2),w=w+Math.min(Math.abs(x),10);0===f.rowIndex&&(v-=w);v=Math.max(v,0);10>v&&0<v&&w+v<g.maxRowsPerPage&&(w+=Math.max(0,v),v=0);w=Math.min(Math.max(w,g.minRowsPerPage),g.maxRowsPerPage,t.count);if(0===w)t=c(t,r);else{var w=Math.ceil(w),v=Math.min(Math.floor(v),t.count-w),q={};t.count-=w;var A=f,I,x=g.queryRowsOverlap,D=(0<f.rowIndex||f.offsetTop>e)&&t;if(D){var E=t.previous;E&&(a(E,e-(E.node.offsetTop+E.node.offsetHeight),"nextSibling"),0<v&&E.node===f.previousSibling?(v=Math.min(t.count,v),t.previous.count+=
v,b(t.previous,!0),f.rowIndex+=v,x=0):w+=v,t.count-=v);q.start=f.rowIndex-x;q.count=Math.min(w+x,g.maxRowsPerPage);f.rowIndex=q.start+q.count}else t.next&&(a(t.next,t.next.node.offsetTop-n,"previousSibling",!0),A=f.nextSibling,A===t.next.node?(t.next.count+=t.count-v,t.next.node.rowIndex=v+w,b(t.next),t.count=v,x=0):I=!0),q.start=t.count,q.count=Math.min(w+x,g.maxRowsPerPage);I&&A&&A.offsetWidth&&(I=A.offsetTop);b(t);"level"in t.query&&(q.queryLevel=t.query.level);if("queryLevel"in q||!(q.start>g._total||
0>q.count)){var H=d.create("div",{className:"dgrid-loading",style:{height:w*g.rowHeight+"px"}},A,"before");d.create("div",{className:"dgrid-"+(D?"below":"above"),innerHTML:g.loadingMessage},H);H.count=w;g._trackError(function(){(function(a,f,c){var h=t.query(q);p=g.renderQueryResults(h,a,q).then(function(n){var e=g._rows;!e||"queryLevel"in q||!n.length||(f?(e.max<=e.min&&(e.min=n[0].rowIndex),e.max=n[n.length-1].rowIndex):(e.max<=e.min&&(e.max=n[n.length-1].rowIndex),e.min=n[0].rowIndex));A=a.nextSibling;
d.destroy(a);c&&A&&A.offsetWidth&&(e=g.getScrollPosition(),g.scrollTo({x:e.x,y:e.y+A.offsetTop-c,preserveMomentum:!0}));h.totalLength.then(function(a){"queryLevel"in q||(g._total=a,g._rows&&g._rows.max>=g._total-1&&(g._rows.max=Infinity));f&&(f.count=a-f.node.rowIndex,b(f))});g._processScroll();return n},function(b){d.destroy(a);throw b;})})(H,D,I)});t=t.previous}}}}return p}}})})},"dgrid/_StoreMixin":function(){define("dojo/_base/declare dojo/_base/lang dojo/Deferred dojo/aspect dojo/dom-construct dojo/has dojo/on dojo/when".split(" "),
function(q,l,p,r,d,m,k,e){function u(a){if("object"!==typeof a)a=Error(a);else if("cancel"===a.dojoType)return;k.emit(this.domNode,"dgrid-error",{grid:this,error:a,cancelable:!0,bubbles:!0})&&console.error(a)}return q(null,{collection:null,_renderedCollection:null,_rows:null,_observerHandle:null,shouldTrackCollection:!1,getBeforePut:!0,noDataMessage:"",loadingMessage:"",_total:0,constructor:function(){this.dirty={};this._updating={};this._columnsWithSet={};r.before(this,"configStructure",l.hitch(this,
function(){this._columnsWithSet={}}))},destroy:function(){this.inherited(arguments);this._renderedCollection&&this._cleanupCollection()},_configColumn:function(a){a.set&&(this._columnsWithSet[a.field]=a);this.inherited(arguments)},_setCollection:function(a){this._renderedCollection&&(this.cleanup(),this._cleanupCollection({shouldRevert:!a||a.storage!==this._renderedCollection.storage}));this.collection=a;if(this._started){if(a){var b=a;this.sort&&0<this.sort.length&&(b=a.sort(this.sort));b.track&&
this.shouldTrackCollection&&(b=b.track(),this._rows=[],this._observerHandle=this._observeCollection(b,this.contentNode,{rows:this._rows}));this._renderedCollection=b}this.refresh()}},_setStore:function(){},_getTotal:function(){return this._total},_cleanupCollection:function(a){a=a||{};this._renderedCollection.tracking&&this._renderedCollection.tracking.remove();this._observerHandle&&(this._observerHandle.remove(),this._observerHandle=this._rows=null);!1!==a.shouldRevert&&(this.dirty={});this._renderedCollection=
this.collection=null},_applySort:function(){this.collection&&this.set("collection",this.collection)},row:function(){var a=this.inherited(arguments);a&&a.data&&"undefined"!==typeof a.id&&(this.collection?a.id=this.collection.getIdentity(a.data):console.error("_StoreMixin:have no collection!"));return a},refresh:function(){var a=this.inherited(arguments);this.collection||(this.noDataNode=d.create("div",{className:"dgrid-no-data",innerHTML:this.noDataMessage},this.contentNode),this._emit("noData"));
return a},refreshCell:function(a){if(!this.collection||!this._createBodyRowCell)return!1;if(a.column){if(a.column&&a.column.selector)return(new p).resolve();this.inherited(arguments);return this.collection.get(a.row.id).then(l.hitch(this,"_refreshCellFromItem",a))}},_refreshCellFromItem:function(a,b,c){if(a&&a.element){var g=a.element;g.widget&&g.widget.destroyRecursive();d.empty(g);var n=this.dirty&&this.dirty[a.row.id];n&&(b=l.delegate(b,n));this._createBodyRowCell(g,a.column,b,c)}},renderArray:function(){var a=
this.inherited(arguments);this.collection||a.length&&this.noDataNode&&d.destroy(this.noDataNode);return a},insertRow:function(a,b,c,g,n){var h=this.collection,f=this.dirty,h=h&&h.getIdentity(a),e;h in f&&!(h in this._updating)&&(e=f[h]);e&&(a=l.delegate(a,e));f=this.inherited(arguments);n&&n.rows&&(n.rows[g]=f);this.noDataNode&&(d.destroy(this.noDataNode),this.noDataNode=null);return f},updateDirty:function(a,b,c){var g=this.dirty,n=g[a];n||(n=g[a]={});n[b]=c},save:function(){function a(a,f){return function(n){var e=
b._columnsWithSet,d=b._updating,t,m;if("function"===typeof n.set)n.set(f);else for(t in f)n[t]=f[t];for(t in e)m=e[t].set(n),void 0!==m&&(n[t]=m);d[a]=!0;return c.put(n).then(function(b){delete g[a];delete d[a];h[a]=b;return h})}}var b=this,c=this.collection,g=this.dirty,n=new p,h={},f=function(a){var f;return b.getBeforePut||!(f=b.row(a).data)?function(){return c.get(a)}:function(){return f}},e=n.then(function(){return h}),d;for(d in g)var m=a(d,g[d]),e=e.then(f(d)).then(m);n.resolve();return e},
revert:function(){this.dirty={};this.refresh()},_trackError:function(a){"string"===typeof a&&(a=l.hitch(this,a));var b=this,c;try{c=e(a())}catch(g){a=new p,a.reject(g),c=a.promise}c.otherwise(function(a){u.call(b,a)});return c},removeRow:function(a,b,c){var g={element:a};!b&&this.noDataMessage&&this.up(g).element===a&&this.down(g).element===a&&(this.noDataNode=d.create("div",{className:"dgrid-no-data",innerHTML:this.noDataMessage},this.contentNode),this._emit("noData"));(g=c&&c.rows||this._rows)&&
delete g[a.rowIndex];return this.inherited(arguments)},renderQueryResults:function(a,b,c){c=l.mixin({rows:this._rows},c);var g=this;return a.then(function(a){a=g.renderArray(a,b,c);delete g._lastCollection;return a})},_observeCollection:function(a,b,c){var g=this,n=c.rows,h,f=[a.on("delete, update",function(a){var f=a.previousIndex,e=a.index;void 0!==f&&n[f]&&("max"in n&&(void 0===e||e<n.min||e>n.max)&&n.max--,h=n[f],h.parentNode===b&&g.removeRow(h,!1,c),n.splice(f,1),("delete"===a.type||"update"===
a.type&&(f<e||void 0===e))&&n[f]&&n[f].rowIndex--);"delete"===a.type&&(h=null)}),a.on("add, update",function(a){var f=a.previousIndex,e=a.index;if(void 0!==e&&(!("max"in n)||e>=n.min&&e<=n.max)){"max"in n&&(void 0===f||f<n.min||f>n.max)&&n.max++;if(n.length){if(f=n[e],!f&&(f=n[e-1]))f=(f.connected||f).nextSibling}else f=g._getFirstRowSibling&&g._getFirstRowSibling(b);h&&f&&h.id===f.id&&(f=(f.connected||f).nextSibling);f&&!f.parentNode&&(f=document.getElementById(f.id));n.splice(e,0,void 0);h=g.insertRow(a.target,
b,f,e,c);g.highlightRow(h)}h=null}),a.on("add, delete, update",function(b){var f="undefined"!==typeof b.previousIndex?b.previousIndex:Infinity,c="undefined"!==typeof b.index?b.index:Infinity,h=Math.min(f,c);f!==c&&n[h]&&g.adjustRowIndices(n[h]);Infinity!==f&&g._processScroll&&(n[f]||n[f-1])&&g._processScroll();g._onNotification(n,b,a);a===g._renderedCollection&&"totalLength"in b&&(g._total=b.totalLength)})];return{remove:function(){for(;0<f.length;)f.pop().remove()}}},_onNotification:function(){}})})},
"dgrid/OnDemandGrid":function(){define(["dojo/_base/declare","./Grid","./OnDemandList"],function(q,l,p){return q([l,p],{})})},"dgrid/extensions/ColumnReorder":function(){define("dojo/_base/lang dojo/_base/declare dojo/_base/array dojo/dom-class dojo/on dojo/query dojo/dnd/Source".split(" "),function(q,l,p,r,d,m){function k(a,c){var g=c[2],e=a[g?"columnSets":"subRows"][c[1]];return g?e[c[2]]:e}function e(a,c,g){c[2]?a.columnSets[c[1]][c[2]]=g:a.subRows[c[1]]=g}function u(a,c){return c.slice(("dgrid-"+
a+"-").length)}var a=/(\d+)(?:-(\d+))?$/;q=l(m,{copyState:function(){return!1},checkAcceptance:function(a){return a===this},_legalMouseDown:function(a){return-1<a.target.className.indexOf("dgrid-resize-handle")?!1:this.inherited(arguments)},onDropInternal:function(b){var c=this.grid,g=a.exec(u(c.id,b[0].getAttribute("dndType"))),n=g[2]?"columnSets":"subRows",h=k(c,g),f=c.columns;this.inherited(arguments);g&&setTimeout(function(){var a=p.map(b[0].parentNode.childNodes,function(a){return f[a.columnId]});
e(c,g,a);a={grid:c,subRow:a,column:f[b[0].columnId],bubbles:!0,cancelable:!0,parentType:"dnd"};a[n]=c[n];d.emit(c.domNode,"dgrid-columnreorder",a)?c.set(n,c[n]):(e(c,g,h),c.renderHeader(),c.sort.length&&c.updateSortArrow(c.sort))},0)}});l=l("dgrid.ColumnReorder",null,{columnDndConstructor:q,_initSubRowDnd:function(a,c){var g,e,h,f;e=0;for(h=a.length;e<h;e++)f=a[e],!1!==f.reorderable&&(f=f.headerNode,r.add(f,"dojoDndItem"),f.setAttribute("dndType",c),g||(g=f.parentNode));g&&this._columnDndSources.push(new this.columnDndConstructor(g,
{horizontal:!0,grid:this}))},renderHeader:function(){var a="dgrid-"+this.id+"-",c,g;this.inherited(arguments);this._columnDndSources=[];if(this.columnSets)for(g=0,c=this.columnSets.length;g<c;g++)p.forEach(this.columnSets[g],function(c,h){this._initSubRowDnd(c,a+g+"-"+h)},this);else p.forEach(this.subRows,function(c,h){this._initSubRowDnd(c,a+h)},this)},_destroyColumns:function(){this._columnDndSources&&p.forEach(this._columnDndSources,function(a){a&&a.destroy&&a.destroy()});this.inherited(arguments)}});
l.ColumnDndSource=q;return l})},"dgrid/extensions/ColumnResizer":function(){define("dojo/_base/declare dojo/on dojo/query dojo/_base/lang dojo/dom dojo/dom-construct dojo/dom-geometry dojo/has ../util/misc dojo/_base/html".split(" "),function(q,l,p,r,d,m,k,e,u){function a(a){for(var b=a.length,c=b,g=a[0].length,e=Array(b);b--;)e[b]=Array(g);for(var n={},b=0;b<c;b++)for(var d=e[b],m=a[b],k=0,u=0;k<g;k++){var l=m[u],p;if("undefined"===typeof d[k]){d[k]=l.id;if(l.rowSpan&&1<l.rowSpan){p=e;for(var r=
l.rowSpan,q=b,D=k,E=l.id,H=1;H<r;H++)p[q+H][D]=E}if(0<b&&l.colSpan&&1<l.colSpan)for(p=1;p<l.colSpan;p++)if(d[++k]=l.id,l.rowSpan&&1<l.rowSpan)for(var r=e,q=l.rowSpan,D=b,E=k,H=l.id,J=1;J<q;J++)r[D+J][E]=H;n[l.id]=a[0][k].id;u++}}return n}function b(a,b,c,g,e){if(!(0>=c)){var n=a.columns[b],d;if(n&&(d={grid:a,columnId:b,width:c,bubbles:!0,cancelable:!0},g&&(d.parentType=g),!a._resizedColumns||l.emit(a.headerNode,"dgrid-columnresize",d)))return"auto"===c?delete n.width:(n.width=c,c+="px"),(g=a._columnSizes[b])?
g.set("width",c):g=u.addCssRule("#"+u.escapeCssIdentifier(a.domNode.id)+" .dgrid-column-"+u.escapeCssIdentifier(b,"-"),"width: "+c+";"),a._columnSizes[b]=g,!1!==e&&a.resize(),!0}}var c,g=0,n={create:function(){c=m.create("div",{className:"dgrid-column-resizer"})},destroy:function(){m.destroy(c);c=null},show:function(a){a=k.position(a.domNode,!0);c.style.top=a.y+"px";c.style.height=a.h+"px";document.body.appendChild(c)},move:function(a){c.style.left=a+"px"},hide:function(){c.parentNode.removeChild(c)}};
return q("dgrid.ColumnResizer",null,{resizeNode:null,minWidth:40,adjustLastColumn:!0,_resizedColumns:!1,buildRendering:function(){this.inherited(arguments);g||n.create();g++},destroy:function(){this.inherited(arguments);for(var a in this._columnSizes)this._columnSizes[a].remove();--g||n.destroy()},resizeColumnWidth:function(a,f){return b(this,a,f)},configStructure:function(){var a=this._oldColumnSizes=r.mixin({},this._columnSizes),b;this._resizedColumns=!1;this._columnSizes={};this.inherited(arguments);
for(b in a)b in this._columnSizes||a[b].remove();delete this._oldColumnSizes},_configColumn:function(a){this.inherited(arguments);var b=a.id,c;"width"in a&&((c=this._oldColumnSizes[b])?c.set("width",a.width+"px"):c=u.addCssRule("#"+u.escapeCssIdentifier(this.domNode.id)+" .dgrid-column-"+u.escapeCssIdentifier(b,"-"),"width: "+a.width+"px;"),this._columnSizes[b]=c)},renderHeader:function(){this.inherited(arguments);var b=this,f;if(this.columnSets&&this.columnSets.length)for(var c=this.columnSets.length;c--;)f=
r.mixin(f||{},a(this.columnSets[c]));else this.subRows&&1<this.subRows.length&&(f=a(this.subRows));for(var c=p(".dgrid-cell",b.headerNode),g=c.length;g--;){var n=c[g],d=n.columnId,k=b.columns[d],q=n.childNodes;if(k&&!1!==k.resizable){k=m.create("div",{className:"dgrid-resize-header-container"});for(n.contents=k;0<q.length;)k.appendChild(q[0]);q=m.create("div",{className:"dgrid-resize-handle resizeNode-"+u.escapeCssIdentifier(d,"-")},k);n.appendChild(k);q.columnId=f&&f[d]||d}}b.mouseMoveListen||(l(b.headerNode,
".dgrid-resize-handle:mousedown"+(e("touch")?",.dgrid-resize-handle:touchstart":""),function(a){b._resizeMouseDown(a,this);b.mouseMoveListen.resume();b.mouseUpListen.resume()}),b._listeners.push(b.mouseMoveListen=l.pausable(document,"mousemove"+(e("touch")?",touchmove":""),u.throttleDelayed(function(a){b._updateResizerPosition(a)}))),b._listeners.push(b.mouseUpListen=l.pausable(document,"mouseup"+(e("touch")?",touchend":""),function(a){b._resizeMouseUp(a);b.mouseMoveListen.pause();b.mouseUpListen.pause()})),
b.mouseMoveListen.pause(),b.mouseUpListen.pause())},_resizeMouseDown:function(a,b){a.preventDefault();d.setSelectable(this.domNode,!1);this._startX=this._getResizeMouseLocation(a);this._targetCell=p(".dgrid-column-"+u.escapeCssIdentifier(b.columnId,"-"),this.headerNode)[0];this._updateResizerPosition(a);n.show(this)},_resizeMouseUp:function(a){var f=this._columnSizes,c,g,e;this.adjustLastColumn&&(e=this.headerNode.clientWidth-1);this._resizedColumns||(c=p(".dgrid-cell",this.headerNode),this.columnSets&&
this.columnSets.length?c=c.filter(function(a){return"0"===a.columnId.split("-")[0]&&!(a.columnId in f)}):this.subRows&&1<this.subRows.length&&(c=c.filter(function(a){return"0"===a.columnId.charAt(0)&&!(a.columnId in f)})),g=c.map(function(a){return a.offsetWidth}),c.forEach(function(a,f){b(this,a.columnId,g[f],null,!1)},this),this._resizedColumns=!0);d.setSelectable(this.domNode,!0);c=this._targetCell;var m=this._getResizeMouseLocation(a)-this._startX,k=c.offsetWidth+m,l=this._getResizedColumnWidths(),
v=l.totalWidth,l=l.lastColId,q=p(".dgrid-column-"+u.escapeCssIdentifier(l,"-"),this.headerNode)[0].offsetWidth;k<this.minWidth&&(k=this.minWidth);b(this,c.columnId,k,a.type)&&c.columnId!==l&&this.adjustLastColumn&&(v+m<e?b(this,l,"auto",a.type):q-m<=this.minWidth&&b(this,l,this.minWidth,a.type));n.hide();delete this._startX;delete this._targetCell},_updateResizerPosition:function(a){if(this._targetCell){a=this._getResizeMouseLocation(a);var b=this._targetCell.offsetWidth,c=a;b+(a-this._startX)<this.minWidth&&
(c=this._startX-(b-this.minWidth));n.move(c)}},_getResizeMouseLocation:function(a){var b=0;a.pageX?b=a.pageX:a.clientX&&(b=a.clientX+document.body.scrollLeft+document.documentElement.scrollLeft);return b},_getResizedColumnWidths:function(){var a=0,b=p((this.columnSets?".dgrid-column-set-cell ":"")+"tr:first-child .dgrid-cell",this.headerNode),c=b.length;if(!c)return{};for(var g=b[c-1].columnId;c--;)a+=b[c].offsetWidth;return{totalWidth:a,lastColId:g}}})})},"dgrid/extensions/CompoundColumns":function(){define(["dojo/_base/lang",
"dojo/_base/declare","dojo/sniff","dojo/query","../util/misc"],function(q,l,p,r,d){return l(null,{configStructure:function(){function m(b,c,g,n){var k=0,p=function(){},r,B;d.each(b,function(d,w){"string"===typeof d&&(d={label:d});b instanceof Array||d.field||(d.field=w);B=(r=d.children)&&!1!==d.showChildHeaders;d.parentColumn=n;r?null==d.id?d.id=(n&&n.id||c-1)+"-"+l.length:n&&n.id&&(d.id=n.id+"-"+d.id):(a.push(d),l.push(q.delegate(d,{renderHeaderCell:p})),k++);B||(d=q.delegate(d,{rowSpan:-c}));r&&
(k+=d.colSpan=m(r,c+1,B,d));g&&(e[c]||(e[c]=[])).push(d)},this);return k}var k=this.subRows&&this.subRows[0]||this.columns,e=[[]],l=e[0],a=[];e[0].className="dgrid-spacer-row";m(k,1,!0);var k=e.length,b,c,g,n;for(b=0;b<k;b++)for(g=e[b],c=0;c<g.length;c++)n=g[c],1>n.rowSpan&&(n.rowSpan+=k);a=[a];a.headerRows=e;this.subRows=a;this.inherited(arguments)},renderHeader:function(){var d,k=this.subRows[0],e=this.subRows.headerRows[0];this.inherited(arguments);for(d=k.length;d--;)k[d].headerNode=e[d].headerNode},
_findSortArrowParent:function(){var m=this.inherited(arguments);if(m&&d.contains(r(".dgrid-spacer-row",this.headerNode)[0],m))return m=m.columnId||m.parentNode.columnId,m=r(".dgrid-column-"+m,this.headerNode),m[m.length-1]},_configColumn:function(d,k,e){var l=d.parentColumn,a=d.id;l&&(a=0===a.indexOf(e)?a.substring(e.length):a,e=l.id+"-",d.id=e+a);this.inherited(arguments,[d,k,e])},cell:function(d,k){if("object"!==typeof k){var e=this.column(k);e&&(k=e.id)}return this.inherited(arguments,[d,k])},
column:function(d){var k=this.inherited(arguments);if(null==k&&"object"!==typeof d){var e="-"+d,l=e.length,a;for(a in this.columns)if(-1!==a.indexOf(e,a.length-l))return this.columns[a]}return k},_updateCompoundHiddenStates:function(d,k){var e=this.columns[d],l;if(!e||e.hidden!==k)for(;e&&e.parentColumn;){e=e.parentColumn;if(l=e.colSpan+=k?-1:1)e.headerNode.colSpan=l;1!==l||k?!l&&k&&this._hideColumn(e.id):this._showColumn(e.id)}},_hideColumn:function(d){var k=this;this._updateCompoundHiddenStates(d,
!0);this.inherited(arguments);p("ff")&&(this.headerNode.style.display="none",setTimeout(function(){k.headerNode.style.display="";k.resize()},0))},_showColumn:function(d){this._updateCompoundHiddenStates(d,!1);this.inherited(arguments)},_getResizedColumnWidths:function(){var d=0,k=this.columns,e;for(e in k)d+=k[e].headerNode.offsetWidth;return{totalWidth:d,lastColId:this.subRows[0][this.subRows[0].length-1].id}}})})},"dgrid/extensions/Pagination":function(){define("../_StoreMixin dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/dom-construct dojo/dom-class dojo/on dojo/query dojo/string dojo/has dojo/when ../util/misc dojo/_base/sniff".split(" "),
function(q,l,p,r,d,m,k,e,u,a,b,c){function g(a){a.noDataNode?(d.destroy(a.noDataNode),delete a.noDataNode):a.cleanup();a.contentNode.innerHTML=""}function n(a){if(a.loadingNode)d.destroy(a.loadingNode),delete a.loadingNode;else if(a._oldPageNodes){for(var b in a._oldPageNodes)a.removeRow(a._oldPageNodes[b]);delete a._oldPageNodes}delete a._isLoading}return l(q,{rowsPerPage:10,pagingTextBox:!1,previousNextArrows:!0,firstLastArrows:!1,pagingLinks:2,pageSizeOptions:null,showLoadingMessage:!0,i18nPagination:{status:"${start} - ${end} of ${total} results",
gotoFirst:"Go to first page",gotoNext:"Go to next page",gotoPrev:"Go to previous page",gotoLast:"Go to last page",gotoPage:"Go to page",jumpPage:"Jump to page",rowsPerPage:"Number of rows per page"},showFooter:!0,_currentPage:1,buildRendering:function(){this.inherited(arguments);var a=this,b=this.paginationNode=d.create("div",{className:"dgrid-pagination"},this.footerNode),c=this.paginationStatusNode=d.create("div",{className:"dgrid-status"},b),g=this.i18nPagination;c.tabIndex=0;this.addUiClasses&&
m.add(this.footerNode,"ui-widget-content");this._updatePaginationSizeSelect();this._updateRowsPerPageOption();this._updatePaginationStatus(this._total);b=this.paginationNavigationNode=d.create("div",{className:"dgrid-navigation"},b);this.firstLastArrows&&(this.paginationFirstNode=d.create("span",{"aria-label":g.gotoFirst,className:"dgrid-first dgrid-page-link",innerHTML:"\u00ab",tabIndex:0},b));this.previousNextArrows&&(this.paginationPreviousNode=d.create("span",{"aria-label":g.gotoPrev,className:"dgrid-previous dgrid-page-link",
innerHTML:"\u2039",tabIndex:0},b));this.paginationLinksNode=d.create("span",{className:"dgrid-pagination-links"},b);this.previousNextArrows&&(this.paginationNextNode=d.create("span",{"aria-label":g.gotoNext,className:"dgrid-next dgrid-page-link",innerHTML:"\u203a",tabIndex:0},b));this.firstLastArrows&&(this.paginationLastNode=d.create("span",{"aria-label":g.gotoLast,className:"dgrid-last dgrid-page-link",innerHTML:"\u00bb",tabIndex:0},b));this._listeners.push(k(b,".dgrid-page-link:click,.dgrid-page-link:keydown",
function(b){if("keydown"!==b.type||13===b.keyCode){b=this.className;var c,f;a._isLoading||-1<b.indexOf("dgrid-page-disabled")||(c=a._currentPage,f=Math.ceil(a._total/a.rowsPerPage),this===a.paginationPreviousNode?a.gotoPage(c-1):this===a.paginationNextNode?a.gotoPage(c+1):this===a.paginationFirstNode?a.gotoPage(1):this===a.paginationLastNode?a.gotoPage(f):"dgrid-page-link"===b&&a.gotoPage(+this.innerHTML))}}))},destroy:function(){this.inherited(arguments);this._pagingTextBoxHandle&&this._pagingTextBoxHandle.remove()},
_updatePaginationSizeSelect:function(){var a=this.pageSizeOptions,b=this.paginationSizeSelect,c;if(a&&a.length){b||(b=this.paginationSizeSelect=d.create("select",{"aria-label":this.i18nPagination.rowsPerPage,className:"dgrid-page-size"},this.paginationNode),c=this._paginationSizeChangeHandle=k(b,"change",r.hitch(this,function(){this.set("rowsPerPage",+this.paginationSizeSelect.value)})),this._listeners.push(c));for(c=b.options.length=0;c<a.length;c++)d.create("option",{innerHTML:a[c],selected:this.rowsPerPage===
a[c],value:a[c]},b);this._updateRowsPerPageOption()}else a&&a.length||!b||(d.destroy(b),this.paginationSizeSelect=null,this._paginationSizeChangeHandle.remove())},_setPageSizeOptions:function(a){this.pageSizeOptions=a&&a.sort(function(a,b){return a-b});this._updatePaginationSizeSelect()},_updateRowsPerPageOption:function(){var a=this.rowsPerPage,b=this.pageSizeOptions,c=this.paginationSizeSelect;c&&(0>p.indexOf(b,a)?this._setPageSizeOptions(b.concat([a])):c.value=""+a)},_setRowsPerPage:function(a){this.rowsPerPage=
a;this._updateRowsPerPageOption();this.gotoPage(1)},_updateNavigation:function(a){function b(a,c){var f,g;l.pagingTextBox&&a===q&&1<x?(f=d.create("input",{"aria-label":u.jumpPage,className:"dgrid-page-input",type:"text",value:q},p),l._pagingTextBoxHandle=k(f,"change",function(){var a=+this.value;!isNaN(a)&&0<a&&a<=x&&l.gotoPage(+this.value)}),z&&"INPUT"===z.tagName&&f.focus()):(g=a===q,f=d.create("span",{"aria-label":u.gotoPage,className:"dgrid-page-link"+(g?" dgrid-page-disabled":""),innerHTML:a+
(c?" ":""),tabIndex:g?-1:0},p),A===a&&(g?a<x?A++:I.focus():f.focus()),g||(I=f))}function g(a,b){m.toggle(a,"dgrid-page-disabled",b);a.tabIndex=b?-1:0}function n(){d.create("span",{className:"dgrid-page-skip",innerHTML:"..."},p)}var l=this,u=this.i18nPagination,p=this.paginationLinksNode,q=this._currentPage,r=this.pagingLinks,w=this.paginationNavigationNode,x=Math.ceil(a/this.rowsPerPage);a=this._pagingTextBoxHandle;var z=document.activeElement,A,I;z&&c.contains(this.paginationNavigationNode,z)?"dgrid-page-link"===
z.className&&(A=+z.innerHTML):z=null;a&&a.remove();p.innerHTML="";e(".dgrid-first, .dgrid-previous",w).forEach(function(a){g(a,1===q)});e(".dgrid-last, .dgrid-next",w).forEach(function(a){g(a,q>=x)});if(r&&0<x){b(1,!0);w=q-r;for(2<w?n():w=2;w<Math.min(q+r+1,x);w++)b(w,!0);q+r+1<x&&n();1<x&&b(x)}else l.pagingTextBox&&b(q);z&&-1===z.tabIndex&&(r=e('[tabindex\x3d"0"]',this.paginationNavigationNode),z===this.paginationPreviousNode||z===this.paginationFirstNode?z=r[0]:r.length&&(z=r[r.length-1]),z&&z.focus())},
_updatePaginationStatus:function(a){var b=this.rowsPerPage,c=Math.min(a,(this._currentPage-1)*b+1);this.paginationStatusNode.innerHTML=u.substitute(this.i18nPagination.status,{start:c,end:Math.min(a,c+b-1),total:a})},refresh:function(a){var b=this,c=a&&a.keepCurrentPage?Math.min(this._currentPage,Math.ceil(this._total/this.rowsPerPage)):1;this.inherited(arguments);return this.gotoPage(c).then(function(a){setTimeout(function(){k.emit(b.domNode,"dgrid-refresh-complete",{bubbles:!0,cancelable:!1,grid:b})},
0);return a})},_onNotification:function(a,b,c){a=this.rowsPerPage;var g=this._currentPage*a;"add"===b.type&&b.index<g||"delete"===b.type&&b.previousIndex<g||"update"===b.type&&Math.floor(b.index/a)!==Math.floor(b.previousIndex/a)?this.gotoPage(Math.min(this._currentPage,Math.ceil(b.totalLength/this.rowsPerPage))):c===this._renderedCollection&&b.totalLength!==this._total&&(this._updatePaginationStatus(b.totalLength),this._updateNavigation(b.totalLength))},renderQueryResults:function(a,b){var c=this,
g=this.inherited(arguments);b||(this._topLevelRequest&&(this._topLevelRequest.cancel(),delete this._topLevelRequest),"function"===typeof g.cancel&&(this._topLevelRequest=g),g.then(function(){c._topLevelRequest&&delete c._topLevelRequest}));return g},insertRow:function(){var a=this._oldPageNodes,b=this.inherited(arguments);a&&b===a[b.id]&&delete a[b.id];return b},gotoPage:function(a){var c=this,e=(this._currentPage-1)*this.rowsPerPage;if(!this._renderedCollection)return b([]);this._renderedCollection.releaseRange&&
this._renderedCollection.releaseRange(e,e+this.rowsPerPage);return this._trackError(function(){var b=c.rowsPerPage,e=(a-1)*b,k={start:e,count:b},m,l=c.contentNode,t,u,p;if(c.showLoadingMessage)g(c),c.loadingNode=d.create("div",{className:"dgrid-loading",innerHTML:c.loadingMessage},l);else for(c._oldPageNodes=t={},l=l.children,u=0,p=l.length;u<p;u++)t[l[u].id]=l[u];c._isLoading=!0;m=c._renderedCollection.fetchRange({start:e,end:e+b});return c.renderQueryResults(m,null,k).then(function(g){n(c);c.scrollTo({y:0});
c._rows&&(c._rows.min=e,c._rows.max=e+b-1);m.totalLength.then(function(b){b||(c.noDataNode&&(d.destroy(c.noDataNode),delete c.noDataNode),c.noDataNode=d.create("div",{className:"dgrid-no-data",innerHTML:c.noDataMessage},c.contentNode));c._total=b;c._currentPage=a;c._rowsOnPage=g.length;c._updatePaginationStatus(b);c._updateNavigation(b)});return m},function(a){n(c);throw a;})})}})})},"dgrid/extensions/DnD":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/aspect dojo/dom-class dojo/on dojo/topic dojo/has dojo/when dojo/dnd/Source dojo/dnd/Manager dojo/_base/NodeList ../Selection dojo/has!touch?../util/touch dojo/has!touch?./_DnD-touch-autoscroll".split(" "),
function(q,l,p,r,d,m,k,e,u,a,b,c,g,n){var h=q(a,{grid:null,getObject:function(a){var b=this.grid;return b.collection.get(a.id.slice(b.id.length+5))},_legalMouseDown:function(a){return this.inherited(arguments)&&a.target!==this.grid.bodyNode},onDrop:function(a,b,c){var g=this,e=this._targetAnchor=this.targetAnchor,h=this.grid,n=h.collection;!this.before&&e&&(e=e.nextSibling);e=e&&h.row(e);u(e&&n.get(e.id),function(e){if(g!==a)g.onDropExternal(a,b,c,e);else g.onDropInternal(b,c,e)})},onDropInternal:function(a,
b,c){var g=this.grid,e=g.collection,h=this,n=h._targetAnchor,d;n&&(d=this.before?n.previousSibling:n.nextSibling);n=g.row(a[0]);(b||d!==a[0]&&(c||!n||g.down(n).element!==a[0]))&&a.forEach(function(a){u(h.getObject(a),function(a){var f=e.getIdentity(a);e[b&&e.copy?"copy":"put"](a,{beforeId:c?e.getIdentity(c):null});h._selectedNodes[f]&&(h._selectedNodes[f]=g.row(f).element)})})},onDropExternal:function(a,b,c,g){var e=this.grid.collection,h=a.grid;b.forEach(function(b,n){u(a.getObject(b),function(d){c||
(h?u(h.collection.getIdentity(d),function(c){!n&&a.selectNone();a.delItem(b.id);h.collection.remove(c)}):a.deleteSelectedNodes());e[e.copy?"copy":"put"](d,{beforeId:g?e.getIdentity(g):null})})})},onDndStart:function(a){this.inherited(arguments);a===this&&(this.grid.cancelTouchScroll&&this.grid.cancelTouchScroll(),b.manager().avatar.node.style.width=this.grid.domNode.offsetWidth/2+"px")},onMouseDown:function(a){e("touch")&&this.isDragging&&1<n.countCurrentTouches(a,this.grid.touchNode)?(k.publish("/dnd/cancel"),
b.manager().stopDrag()):this.inherited(arguments)},onMouseMove:function(a){(!e("touch")||1>=n.countCurrentTouches(a,this.grid.touchNode))&&this.inherited(arguments)},checkAcceptance:function(b){return b.getObject&&a.prototype.checkAcceptance.apply(this,arguments)},getSelectedNodes:function(){if(!this.grid.selection)return this.inherited(arguments);var a=new c,b;for(b in this.grid.selection)a.push(this._selectedNodes[b]);return a}});q=q(g,{dndSourceType:"dgrid-row",dndParams:null,dndConstructor:h,
postMixInProperties:function(){this.inherited(arguments);this.dndParams=l.mixin({accept:[this.dndSourceType]},this.dndParams)},postCreate:function(){function a(b){c[b.id]=b.element}function b(a){delete c[a.id];d.remove(a.element,"dojoDndItemSelected dojoDndItemAnchor")}this.inherited(arguments);this.dndSource=new (this.dndConstructor||h)(this.bodyNode,l.mixin(this.dndParams,{grid:this,dropParent:this.contentNode}));var c=this.dndSource._selectedNodes={};this.on("dgrid-select",function(b){p.forEach(b.rows,
a)});this.on("dgrid-deselect",function(a){p.forEach(a.rows,b)});r.after(this,"destroy",function(){delete this.dndSource._selectedNodes;c=null;this.dndSource.destroy()},!0)},insertRow:function(a){var b=this.inherited(arguments),c="function"===typeof this.getObjectDndType?this.getObjectDndType(a):[this.dndSourceType];d.add(b,"dojoDndItem");this.dndSource.setItem(b.id,{data:a,type:c instanceof Array?c:[c]});return b},removeRow:function(a){this.dndSource.delItem(this.row(a));this.inherited(arguments)}});
q.GridSource=h;return q})},"dgrid/Editor":function(){define("dojo/_base/declare dojo/_base/lang dojo/Deferred dojo/dom-construct dojo/dom-class dojo/on dojo/has dojo/query ./Grid dojo/_base/sniff".split(" "),function(q,l,p,r,d,m,k,e,u){return q(null,{constructor:function(){this._editorInstances={};this._editorColumnListeners=[];this._editorCellListeners={};this._editorsPendingStartup=[]},postCreate:function(){var a=this;this.inherited(arguments);this.on(".dgrid-input:focusin",function(){a._focusedEditorCell=
a.cell(this)});this._editorFocusoutHandle=m.pausable(this.domNode,".dgrid-input:focusout",function(){a._focusedEditorCell=null});this._listeners.push(this._editorFocusoutHandle)},insertRow:function(){this._editorRowListeners={};var a=this.inherited(arguments),b=this.row(a),c=this._editorCellListeners[a.id]=this._editorCellListeners[a.id]||{},g;for(g in this._editorRowListeners)c[g]=this._editorRowListeners[g];this._editorRowListeners=null;(c=this._previouslyFocusedEditorCell)&&c.row.id===b.id&&this.edit(this.cell(b,
c.column.id));return a},refresh:function(){for(var a in this._editorInstances){var b=this._editorInstances[a].domNode;b&&b.parentNode&&b.parentNode.removeChild(b)}this.inherited(arguments)},removeRow:function(a){var b=this,c=this._focusedEditorCell;c&&c.row.id===this.row(a).id&&(this._previouslyFocusedEditorCell=c,this._editorFocusoutHandle.pause(),setTimeout(function(){b._editorFocusoutHandle.resume();b._previouslyFocusedEditorCell=null},0));if(this._editorCellListeners[a.id]){for(var g in this._editorCellListeners[a.id])this._editorCellListeners[a.id][g].remove();
delete this._editorCellListeners[a.id]}for(c=this._alwaysOnWidgetColumns.length;c--;)if(g=(g=this.cell(a,this._alwaysOnWidgetColumns[c].id).element)&&(g.contents||g).widget)this._editorFocusoutHandle.pause(),g.destroyRecursive();return this.inherited(arguments)},renderArray:function(){var a=this.inherited(arguments);a.length?this._startupPendingEditors():this._editorsPendingStartup=[];return a},_onNotification:function(){this.inherited(arguments);this._startupPendingEditors()},_destroyColumns:function(){this._editorStructureCleanup();
this.inherited(arguments)},_editorStructureCleanup:function(){var a=this._editorInstances,b=this._editorColumnListeners;this._editTimer&&clearTimeout(this._editTimer);for(var c in a){var g=a[c];g.domNode&&g.destroyRecursive()}this._editorInstances={};for(a=b.length;a--;)b[a].remove();for(var e in this._editorCellListeners)for(c in this._editorCellListeners[e])this._editorCellListeners[e][c].remove();for(a=0;a<this._editorColumnListeners.length;a++)this._editorColumnListeners[a].remove();this._editorCellListeners=
{};this._editorColumnListeners=[];this._editorsPendingStartup=[]},_configColumns:function(){var a=this.inherited(arguments);this._alwaysOnWidgetColumns=[];for(var b=0,c=a.length;b<c;b++)a[b].editor&&this._configureEditorColumn(a[b]);return a},_configureEditorColumn:function(a){var b=this,c=a.renderCell||this._defaultRenderCell,g=a.editOn,e="string"!==typeof a.editor;g?this._editorInstances[a.id]=this._createSharedEditor(a,c):e&&this._alwaysOnWidgetColumns.push(a);a.renderCell=g?function(e,f,n,d){if(!d||
!d.alreadyHooked){var k=m(n,g,function(){b._activeOptions=d;b.edit(this)});if(b._editorRowListeners)b._editorRowListeners[a.id]=k;else{var l=b.row(e);b._editorCellListeners[l.element.id][a.id]=k}}return c.call(a,e,f,n,d)}:function(g,f,d,k){if(!a.canEdit||a.canEdit(g,f))k=b._createEditor(a),k.object=g,b._showEditor(k,a,d,f),d[e?"widget":"input"]=k;else return c.call(a,g,f,d,k)}},edit:function(a){function b(a){c._activeCell=e;c._showEditor(k,g,e,d);c._editTimer=setTimeout(function(){k.focus&&k.focus();
g._editorBlurHandle&&g._editorBlurHandle.resume();c._editTimer=null;a.resolve(k)},0)}var c=this,g,e,h,f,d,k,m;a.column||(a=this.cell(a));if(!a||!a.element)return null;g=a.column;f=g.field;e=a.element.contents||a.element;if(k=this._editorInstances[g.id]){if(this._activeCell!==e){var l=a.row;d=(h=this.dirty&&this.dirty[l.id])&&f in h?h[f]:g.get?g.get(l.data):l.data[f];if(!g.canEdit||g.canEdit(a.row.data,d))return m=new p,a=k.domNode||k,a.offsetWidth?(a.blur(),setTimeout(function(){b(m)},0)):b(m),m.promise}}else if(g.editor&&
(k=e.widget||e.input))return m=new p,k.focus&&k.focus(),m.resolve(k),m.promise;return null},refreshCell:function(a){var b=a.row.element.id,c=a.column.id;this._editorCellListeners[b]&&this._editorCellListeners[b][c]&&(this._editorCellListeners[b][c].remove(),this._editorCellListeners[b][c]=null);return this.inherited(arguments)},_showEditor:function(a,b,c,g){var e=a.domNode;e||this._updateInputValue(a,g);c.innerHTML="";d.add(c,"dgrid-cell-editing");e&&b.editOn&&a.validate&&a.reset&&a.reset();c.appendChild(a.domNode||
a);e&&!b.editOn?this._editorsPendingStartup.push([a,b,c,g]):this._startupEditor(a,b,c,g)},_startupEditor:function(a,b,c,g){a.domNode&&(a._started||a.startup(),a._dgridIgnoreChange=!0,a.set("value",g),setTimeout(function(){a._dgridIgnoreChange=!1},0));a._dgridLastValue=g;this._activeCell&&(this._activeValue=g,m.emit(c,"dgrid-editor-show",{grid:this,cell:this.cell(c),column:b,editor:a,bubbles:!0,cancelable:!1}))},_startupPendingEditors:function(){for(var a=this._editorsPendingStartup,b=a.length;b--;)this._startupEditor.apply(this,
a[b]);this._editorsPendingStartup=[]},_handleEditorChange:function(a,b){var c=a.target;"_dgridLastValue"in c&&-1<c.className.indexOf("dgrid-input")&&this._updatePropertyFromEditor(b||this.cell(c).column,c,a)},_createEditor:function(a){var b=a.editor,c=a.editOn,g=this,e="string"!==typeof b&&b,h,f,d={};h=a.editorArgs||{};"function"===typeof h&&(h=h.call(this,a));e?(f=new e(h),h=f.focusNode||f.domNode,h.className+=" dgrid-input",f.on(c?"blur":"change",function(){f._dgridIgnoreChange||g._updatePropertyFromEditor(a,
this,{type:"widget"})})):(this._hasInputListener||(this._hasInputListener=!0,this.on("change",function(a){g._handleEditorChange(a)})),"textarea"===b?e="textarea":(e="input",d.type=b),f=h=r.create(e,l.mixin(d,{className:"dgrid-input",name:a.field,tabIndex:isNaN(a.tabIndex)?-1:a.tabIndex},h)),9>k("ie")&&(b="radio"===b||"checkbox"===b?m(f,"click",function(b){g._handleEditorChange(b,a)}):m(f,"change",function(b){g._handleEditorChange(b,a)}),c?this._editorColumnListeners.push(b):this._editorRowListeners?
this._editorRowListeners[a.id]=b:this._editorCellListeners[this.row(object).element.id][a.id]=b));if(a.autoSelect){var u=f.focusNode||f;u.select&&m(u,"focus",function(){setTimeout(function(){u.select()},0)})}return f},_createSharedEditor:function(a){function b(){var a=g._activeCell;f.blur();"function"===typeof g.focus&&setTimeout(function(){g.focus(a)},e&&9>k("ie")?15:0)}var c=this._createEditor(a),g=this,e=c.domNode,h=c.domNode||c,f=c.focusNode||h,p=e?function(){c.set("value",c._dgridLastValue)}:
function(){g._updateInputValue(c,c._dgridLastValue);g._updatePropertyFromEditor(a,c)};this._editorColumnListeners.push(m(f,"keydown",function(f){f=f.keyCode||f.which;27===f?(p(),g._activeValue=c._dgridLastValue,b()):13===f&&!1!==a.dismissOnEnter&&b()}));(a._editorBlurHandle=m.pausable(c,"blur",function(){var b=h.parentNode,f={alreadyHooked:!0},e=g.cell(h);m.emit(e.element,"dgrid-editor-hide",{grid:g,cell:e,column:a,editor:c,bubbles:!0,cancelable:!1});a._editorBlurHandle.pause();b.removeChild(h);e.row&&
(d.remove(e.element,"dgrid-cell-editing"),r.empty(b),u.appendIfNode(b,a.renderCell(e.row.data,g._activeValue,b,g._activeOptions?l.delegate(f,g._activeOptions):f)));g._focusedEditorCell=g._activeCell=g._activeValue=g._activeOptions=null})).pause();this._editorColumnListeners.push(a._editorBlurHandle);return c},_updatePropertyFromEditor:function(a,b,c){var g;if(!b.isValid||b.isValid())if(c=this._updateProperty((b.domNode||b).parentNode,this._activeCell?this._activeValue:b._dgridLastValue,this._retrieveEditorValue(a,
b),c),this._activeCell?this._activeValue=c:b._dgridLastValue=c,"radio"===b.type&&b.name&&!a.editOn&&a.field)for(g in c=this.row(b),e("input[type\x3dradio][name\x3d"+b.name+"]",this.contentNode).forEach(function(c){var g=this.row(c);c!==b&&c._dgridLastValue&&(c._dgridLastValue=!1,this.updateDirty?this.updateDirty(g.id,a.field,!1):g.data[a.field]=!1)},this),this.dirty)c.id.toString()!==g&&this.dirty[g][a.field]&&this.updateDirty(g,a.field,!1)},_updateProperty:function(a,b,c,g){var e=this;if((b&&b.valueOf())!==
(c&&c.valueOf())){var d=this.cell(a),f=d.row,k=d.column;a=d.element;if(k.field&&f)if(d={grid:this,cell:d,oldValue:b,value:c,bubbles:!0,cancelable:!0},g&&g.type&&(d.parentType=g.type),m.emit(a,"dgrid-datachange",d))this.updateDirty?(this.updateDirty(f.id,k.field,c),k.autoSave&&setTimeout(function(){e._trackError("save")},0)):f.data[k.field]=c;else{var l;(l=a.widget)?(l._dgridIgnoreChange=!0,l.set("value",b),setTimeout(function(){l._dgridIgnoreChange=!1},0)):(l=a.input)&&this._updateInputValue(l,b);
return b}}return c},_updateInputValue:function(a,b){a.value=b;if("radio"===a.type||"checkbox"===a.type)a.checked=a.defaultChecked=!!b},_retrieveEditorValue:function(a,b){return"function"===typeof b.get?this._convertEditorValue(b.get("value")):this._convertEditorValue(b["checkbox"===b.type||"radio"===b.type?"checked":"value"])},_convertEditorValue:function(a,b){if("number"===typeof b)a=isNaN(a)?a:parseFloat(a);else if("boolean"===typeof b)a="true"===a?!0:"false"===a?!1:a;else if(b instanceof Date){var c=
new Date(a);a=isNaN(c.getTime())?a:c}return a}})})},"dstore/Store":function(){define("dojo/_base/lang dojo/_base/array dojo/aspect dojo/has dojo/when dojo/_base/declare dstore/QueryMethod dstore/Filter dojo/Evented".split(" "),function(q,l,p,r,d,m,k,e,u){function a(a){return function(b,e){var h=this;d(b,function(b){b={target:b};var g=e[1]||{};"beforeId"in g&&(b.beforeId=g.beforeId);h.emit(a,b)});return b}}r.add("object-proto",!!{}.__proto__&&!{}.watch);var b=r("object-proto");return m(u,{constructor:function(b){b&&
m.safeMixin(this,b);this.Model&&this.Model.createSubclass&&(this.Model=this.Model.createSubclass([],{}).extend({_store:this}));this.storage=new u;var g=this;this.autoEmitEvents&&(p.after(this,"add",a("add")),p.after(this,"put",a("update")),p.after(this,"remove",function(a,b){d(a,function(){g.emit("delete",{id:b[0]})});return a}))},autoEmitEvents:!0,idProperty:"id",queryAccessors:!0,getIdentity:function(a){return a.get?a.get(this.idProperty):a[this.idProperty]},_setIdentity:function(a,b){a.set?a.set(this.idProperty,
b):a[this.idProperty]=b},forEach:function(a,b){var e=this;return d(this.fetch(),function(d){for(var f=0,k;void 0!==(k=d[f]);f++)a.call(b,k,f,e);return d})},on:function(a,b){return this.storage.on(a,b)},emit:function(a,b){b=b||{};b.type=a;try{return this.storage.emit(a,b)}finally{return b.cancelable}},parse:null,stringify:null,Model:null,_restore:function(a,g){var e=this.Model;if(e&&a){var d=e.prototype,f=d._restore;f?a=f.call(a,e,g):b&&g?a.__proto__=d:a=q.delegate(d,a)}return a},create:function(a){return new this.Model(a)},
_createSubCollection:function(a){var b=q.delegate(this.constructor.prototype),e;for(e in this)this._includePropertyInSubCollection(e,b)&&(b[e]=this[e]);return m.safeMixin(b,a)},_includePropertyInSubCollection:function(a,b){return!(a in b)||b[a]!==this[a]},queryLog:[],filter:new k({type:"filter",normalizeArguments:function(a){var b=this.Filter;return a instanceof b?[a]:[new b(a)]}}),Filter:e,sort:new k({type:"sort",normalizeArguments:function(a,b){var e;"function"===typeof a?e=[a]:(e=a instanceof Array?
a.slice():"object"===typeof a?[].slice.call(arguments):[{property:a,descending:b}],e=l.map(e,function(a){a=q.mixin({},a);a.descending=!!a.descending;return a}),e=[e]);return e}}),select:new k({type:"select"}),_getQuerierFactory:function(a){return this["_create"+(a[0].toUpperCase()+a.substr(1))+"Querier"]}})})},"dstore/QueryMethod":function(){define([],function(){return function(q){var l=q.type,p=q.normalizeArguments,r=q.applyQuery,d=q.querierFactory;return function(){var m=Array.prototype.slice.call(arguments),
k=p?p.apply(this,m):m,m={type:l,arguments:m,normalizedArguments:k},e=this._getQuerierFactory(l)||d;e&&(m.querier=e.apply(this,k));k=this._createSubCollection({queryLog:this.queryLog.concat(m)});return r?r.call(this,k,m):k}}})},"dstore/Filter":function(){define(["dojo/_base/declare"],function(q){function l(p){return function(){var d=this.constructor,m=new d;m.type=p;m.args=Array.prototype.slice.call(arguments);return this.type?l("and").call(d.prototype,this,m):m}}function p(l){return function(){for(var d=
this.constructor,m=[],k=0;k<arguments.length;k++){var e=arguments[k];m.push(e instanceof d?e:new d(e))}d=new d;d.type=l;d.args=m;this.type===l?d.args=this.args.concat(m):this.type?m.unshift(this):1===m.length&&(d.type=m[0].type,d.args=m[0].args.slice());return d}}q=q(null,{constructor:function(l){var d=typeof l;switch(d){case "object":var d=this,m;for(m in l)var k=l[m],d=k instanceof this.constructor?d[k.type](m,k.args[0]):k&&k.test?d.match(m,k):d.eq(m,k);this.type=d.type;this.args=d.args;break;case "function":case "string":this.type=
d,this.args=[l]}},and:p("and"),or:p("or"),eq:l("eq"),ne:l("ne"),lt:l("lt"),lte:l("lte"),gt:l("gt"),gte:l("gte"),contains:l("contains"),"in":l("in"),match:l("match")});q.filterCreator=l;q.logicalOperatorCreator=p;return q})},"dstore/Memory":function(){define("dojo/_base/declare dojo/_base/array ./Store ./Promised ./SimpleQuery ./QueryResults".split(" "),function(q,l,p,r,d,m){return q([p,r,d],{constructor:function(){this.storage.version=0},postscript:function(){this.inherited(arguments);this.setData(this.data||
[])},data:null,autoEmitEvents:!1,getSync:function(d){return this.storage.fullData[this.storage.index[d]]},putSync:function(d,e){e=e||{};var m=this.storage,a=m.index,b=m.fullData,c=this.Model;!c||d instanceof c||(d=this._restore(d));var g=this.getIdentity(d);null==g&&(this._setIdentity(d,"id"in e?e.id:Math.random()),g=this.getIdentity(d));m.version++;var m=g in a?"update":"add",c={target:d},n;if("update"===m){if(!1===e.overwrite)throw Error("Object already exists");b.splice(n=a[g],1);g=n}else g=this.defaultNewToStart?
0:b.length;var h;if("beforeId"in e){var f=e.beforeId;null===f?h=b.length:(h=a[f],n<h&&--h);void 0!==h?c.beforeId=f:(console.error("options.beforeId was specified but no corresponding index was found"),h=g)}else h=g;b.splice(h,0,d);n=isFinite(n)?Math.min(n,h):h;for(g=b.length;n<g;++n)a[this.getIdentity(b[n])]=n;this.emit(m,c);return d},addSync:function(d,e){(e=e||{}).overwrite=!1;return this.putSync(d,e)},removeSync:function(d){var e=this.storage,m=e.index,e=e.fullData;if(d in m)return m=e.splice(m[d],
1)[0],this._reindex(),!0!==this._ignoreChangeEvents&&this.emit("delete",{id:d,target:m}),!0},setData:function(d){this.parse&&(d=this.parse(d));d.items&&(this.idProperty=d.identifier||this.idProperty,d=d.items);this.storage.fullData=this.data=d;this._reindex()},_reindex:function(){for(var d=this.storage,e=d.index={},m=d.fullData,a=this.Model,b=Object.prototype,c=0,g=m.length;c<g;c++){var n=m[c];if(a&&!(n instanceof a)){var h=this._restore(n,n.__proto__===b);n!==h&&(m[c]=n=h)}e[this.getIdentity(n)]=
c}d.version++},fetchSync:function(){var d=this.data;if(!d||d._version!==this.storage.version){for(var d=this.storage.fullData,e=this.queryLog,l=0,a=e.length;l<a;l++)d=e[l].querier(d);d._version=this.storage.version;this.data=d}return new m(d)},fetchRangeSync:function(d){var e=this.fetchSync();return new m(e.slice(d.start,d.end),{totalLength:e.length})},_includePropertyInSubCollection:function(d){return"data"!==d&&this.inherited(arguments)}})})},"dstore/Promised":function(){define(["dojo/_base/declare",
"dojo/Deferred","./QueryResults","dojo/when"],function(q,l,p,r){function d(d,k){return function(){var e=new l;try{e.resolve(this[d].apply(this,arguments))}catch(u){e.reject(u)}return k?(e=new p(e.promise),e.totalLength=r(e.totalLength),e):e.promise}}return q(null,{get:d("getSync"),put:d("putSync"),add:d("addSync"),remove:d("removeSync"),fetch:d("fetchSync",!0),fetchRange:d("fetchRangeSync",!0)})})},"dstore/QueryResults":function(){define(["dojo/_base/lang","dojo/when"],function(q,l){function p(p,
d){return l(this,function(m){for(var k=0,e=m.length;k<e;k++)p.call(d,m[k],k,m)})}return function(l,d){var m=d&&"totalLength"in d;if(l.then){l=q.delegate(l);var k=l.then(function(e){var k=m?d.totalLength:e.totalLength||e.length;e.totalLength=k;return!m&&k});l.totalLength=m?d.totalLength:k;l.response=d&&d.response}else l.totalLength=m?d.totalLength:l.length;l.forEach=p;return l}})},"dstore/SimpleQuery":function(){define(["dojo/_base/declare","dojo/_base/array"],function(q,l){function p(d,m){if(-1<d.indexOf(".")){var k=
d.split("."),e=k.length;return function(d){for(var a=0;a<e;a++)d=d&&(m&&d.get?d.get(k[a]):d[k[a]]);return d}}return function(e){return e.get?e.get(d):e[d]}}var r={eq:function(d,m){return d===m},"in":function(d,m){return-1<l.indexOf(m.data||m,d)},ne:function(d,m){return d!==m},lt:function(d,m){return d<m},lte:function(d,m){return d<=m},gt:function(d,m){return d>m},gte:function(d,m){return d>=m},match:function(d,m,k){return m.test(d,k)},contains:function(d,m,k,e){var p=this;return l.every(m.data||m,
function(a){if("object"===typeof a&&a.type){var b=p._getFilterComparator(a.type);return l.some(d,function(c){return b.call(p,c,a.args[1],k,e)})}return-1<l.indexOf(d,a)})}};return q(null,{_createFilterQuerier:function(d){function m(a){var b=a.type;a=a.args;var c=e._getFilterComparator(b);if(c){var g=a[0],d=p(g,k),h=a[1];h&&h.fetchSync&&(h=h.fetchSync());return function(a){return c.call(e,d(a),h,a,g)}}switch(b){case "and":case "or":for(var f=0,l=a.length;f<l;f++){var r=m(a[f]);q=q?function(a,c){return"and"===
b?function(b){return a(b)&&c(b)}:function(b){return a(b)||c(b)}}(q,r):r}return q;case "function":return a[0];case "string":f=e[a[0]];if(!f)throw Error("No filter function "+a[0]+" was found in the collection");return f;case void 0:return function(){return!0};default:throw Error('Unknown filter operation "'+b+'"');}}var k=this.queryAccessors,e=this,q=m(d);return function(a){return l.filter(a,q)}},_getFilterComparator:function(d){return r[d]||this.inherited(arguments)},_createSelectQuerier:function(d){return function(m){var k=
d.length;return l.map(m,d instanceof Array?function(e){for(var m={},a=0;a<k;a++){var b=d[a];m[b]=e[b]}return m}:function(e){return e[d]})}},_createSortQuerier:function(d){var m=this.queryAccessors;return function(k){k=k.slice();k.sort("function"==typeof d?d:function(e,k){for(var a=0;a<d.length;a++){var b,c=d[a];if("function"==typeof c)b=c(e,k);else{b=c.get||(c.get=p(c.property,m));var c=c.descending,g=b(e);b=b(k);null!=g&&(g=g.valueOf());null!=b&&(b=b.valueOf());b=g===b?0:!!c===(null===g||g>b&&null!==
b)?-1:1}if(0!==b)return b}return 0});return k}}})})},"dstore/Tree":function(){define(["dojo/_base/declare"],function(q){return q(null,{constructor:function(){this.root=this},mayHaveChildren:function(l){return"hasChildren"in l?l.hasChildren:!0},getRootCollection:function(){return this.root.filter({parent:null})},getChildren:function(l){return this.root.filter({parent:this.getIdentity(l)})}})})},"dstore/Cache":function(){define("dojo/_base/array dojo/when dojo/_base/declare dojo/_base/lang ./Store ./Memory ./QueryResults".split(" "),
function(q,l,p,r,d,m,k){function e(a){return function(){var c=this.inherited(arguments),g=this.cachingCollection||this.cachingStore;c.cachingCollection=g[a].apply(g,arguments);c.isValidFetchCache=!0===this.canCacheQuery||this.canCacheQuery(a,arguments);return c}}function u(a){a.cachingStore||(a.cachingStore=new m);a.cachingStore.Model=a.Model;a.cachingStore.idProperty=a.idProperty}var a={cachingStore:null,constructor:function(){u(this)},canCacheQuery:function(a,c){return!1},isAvailableInCache:function(){return this.isValidFetchCache&&
(this.allLoaded||this.fetchRequest)||this._parent&&this._parent.isAvailableInCache()},fetch:function(){return this._fetch(arguments)},fetchRange:function(){return this._fetch(arguments,!0)},_fetch:function(a,c){var g=this.cachingStore,e=this.cachingCollection||g,d=this,f=this.isAvailableInCache();if(f)return new k(l(f,function(){return d.isAvailableInCache()?c?e.fetchRange(a[0]):e.fetch():d.inherited(a)}));f=this.fetchRequest=this.inherited(a);l(f,function(a){var b=!c;d.fetchRequest=null;q.forEach(a,
function(a){!d.isLoaded||d.isLoaded(a)?g.put(a):b=!1});b&&(d.allLoaded=!0);return a});return f},isValidFetchCache:!1,get:function(a,c){var g=this.cachingStore,e=this.getInherited(arguments),d=this;return l(this.fetchRequest,function(){return l(g.get(a),function(f){if(void 0!==f)return f;if(e)return l(e.call(d,a,c),function(c){c&&g.put(c,{id:a});return c})})})},add:function(a,c){var e=this.cachingStore;return l(this.inherited(arguments),function(d){var h=e.put(d&&"object"===typeof d?d:a,c);return d||
h})},put:function(a,c){var e=this.cachingStore;e.remove(c&&c.id||this.getIdentity(a));return l(this.inherited(arguments),function(d){var h=e.put(d&&"object"===typeof d?d:a,c);return d||h})},remove:function(a,c){var e=this.cachingStore;return l(this.inherited(arguments),function(d){return l(e.remove(a,c),function(){return d})})},evict:function(a){this.allLoaded=!1;return this.cachingStore.remove(a)},invalidate:function(){this.allLoaded=!1},_createSubCollection:function(){var a=this.inherited(arguments);
a._parent=this;return a},sort:e("sort"),filter:e("filter"),select:e("select"),_getQuerierFactory:function(a){var c=this.cachingStore;return this.inherited(arguments)||r.hitch(c,c._getQuerierFactory(a))}};d=p(null,a);d.create=function(b,c){b=p.safeMixin(r.delegate(b),a);p.safeMixin(b,c);u(b);return b};return d})},"dstore/Trackable":function(){define("dojo/_base/lang dojo/_base/declare dojo/aspect dojo/when dojo/promise/all dojo/_base/array dojo/on".split(" "),function(q,l,p,r,d,m,k){function e(a,c,
e){for(var d=a.length-1;0<=d;--d){var h=a[d],f=h.start,h=f+h.count;if(c>h){a.splice(d+1,0,{start:c,count:e-c});return}e>=f&&(c=Math.min(c,f),e=Math.max(e,h),a.splice(d,1))}a.unshift({start:c,count:e-c})}var u=0,a={track:function(){function a(){return function(){var a=this,b=this.inherited(arguments);r(b,function(b){b=a._results=b.slice();a._partialResults&&(a._partialResults=null);a._ranges=[];e(a._ranges,0,b.length)});return b}}function c(){return function(a){var b=this,c=a.start,d=a.end,f=this.inherited(arguments);
this._results||r(f,function(a){return r(a.totalLength,function(f){var g=b._partialResults||(b._partialResults=[]);d=Math.min(d,c+a.length);g.length=f;f=[c,d-c].concat(a);g.splice.apply(g,f);e(b._ranges,c,d);return a})});return f}}function d(a,b){u++;var c=b.target;b=q.delegate(b,F[a]);r(y._results||y._partialResults,function(e){if(e){var d,f,g,h=y._ranges,k,l="id"in b?b.id:n.getIdentity(c),p=-1,q=-1,r=-1,u=-1;if("delete"===a||"update"===a)for(d=0;-1===p&&d<h.length;++d)for(k=h[d],f=k.start,g=f+k.count;f<
g;++f)if(n.getIdentity(e[f])==l){p=b.previousIndex=f;q=d;e.splice(p,1);k.count--;for(f=d+1;f<h.length;++f)h[f].start--;break}if("add"===a||"update"===a){if(C){if(C([c]).length){var t=0;g=h.length-1;f=-1;for(var F;t<=g&&-1===r;)d=t+Math.round((g-t)/2),k=h[d],q=e.slice(k.start,k.start+k.count),"beforeId"in b&&(f=null===b.beforeId?q.length:G(q,b.beforeId)),-1===f&&(f=p>=Math.max(0,k.start-1)&&p<=k.start+k.count?p:n.defaultNewToStart?0:q.length),q.splice(f,0,c),l=m.indexOf(C(q),c),F=k.start+l,0===l&&
0!==k.start?g=d-1:l>=q.length-1&&F<e.length?t=d+1:(r=F,u=d);if(-1===r&&0<t&&t<h.length)var K=!0}}else{f=-1;if("beforeId"in b)if(null===b.beforeId)r=e.length,f=h.length-1;else for(d=0,g=h.length;-1===u&&d<g;++d)k=h[d],r=G(e,b.beforeId,k.start,k.start+k.count),-1!==r&&(u=d);else"update"===a?(r=p,u=q):n.defaultNewToStart?f=r=0:(r=e.length,f=h.length-1);-1!==f&&-1===u&&(k=h[f])&&k.start<=r&&r<=k.start+k.count&&(u=f)}if(-1<r&&-1<u)for(b.index=r,e.splice(r,0,c),h[u].count++,d=u+1;d<h.length;++d)h[d].start++;
else if(K)for(b.beforeIndex=h[t].start,d=t;d<h.length;++d)h[d].start++}b.totalLength=e.length}(e=y["on_tracked"+a])&&e.call(y,b)})}var n=this.store||this,h=[],f={add:1,update:1,"delete":1},t;for(t in f)h.push(this.on(t,function(a){return function(b){d(a,b)}}(t)));var y=l.safeMixin(q.delegate(this),{_ranges:[],fetch:a(),fetchRange:c(),releaseRange:function(a,b){if(this._partialResults){a:for(var c=this._ranges,d=0,e;e=c[d];++d){var f=e.start,g=f+e.count;if(a<=f)if(b>=g)c.splice(d,1);else{e.start=b;
e.count=g-e.start;break a}else if(a<g)if(b>f){c.splice(d,1,{start:f,count:a-f},{start:b,count:g-b});break a}else e.count=a-e.start}for(c=a;c<b;++c)delete this._partialResults[c]}},on:function(a,b){var c=this,d=this.getInherited(arguments);return k.parse(y,a,b,function(a,e){return e in f?p.after(y,"on_tracked"+e,b,!0):d.call(c,e,b)})},tracking:{remove:function(){for(;0<h.length;)h.pop().remove();this.remove=function(){}}},track:null});this.fetchSync&&(l.safeMixin(y,{fetchSync:a(),fetchRangeSync:c()}),
y.fetchSync());var C;m.forEach(this.queryLog,function(a){var b=C,c=a.querier;c&&(C=b?function(a){return c(b(a))}:c)});var F={add:{index:void 0},update:{previousIndex:void 0,index:void 0},"delete":{previousIndex:void 0}},G=function(a,b,c,e){e=void 0!==e?e:a.length;for(c=void 0!==c?c:0;c<e;++c)if(n.getIdentity(a[c])===b)return c;return-1};return y}};d=l(null,a);d.create=function(b,c){b=l.safeMixin(q.delegate(b),a);l.safeMixin(b,c);return b};return d})},"dstore/legacy/DstoreAdapter":function(){define(["dojo/_base/declare",
"dojo/_base/array","dojo/store/util/QueryResults"],function(q,l,p){function r(d){return d}var d={store:null,constructor:function(d){this.store=d;if(d._getQuerierFactory("filter")||d._getQuerierFactory("sort"))this.queryEngine=function(e,k){k=k||{};var a=d._getQuerierFactory("filter"),b=a?a(e):r,a=d._getQuerierFactory("sort"),c=r;a&&(c=a(l.map(k.sort,function(a){return{property:a.attribute,descending:a.descending}})));var g=r;isNaN(k.start)&&isNaN(k.count)||(g=function(a){var b=k.start||0,b=a.slice(b,
b+(k.count||Infinity));b.total=a.length;return b});return function(a){return g(c(b(a)))}};var k=this;d.on("add,update,delete",function(e){var l=e.type,a=e.target;k.notify("add"===l||"update"===l?a:void 0,"delete"===l||"update"===l?"id"in e?e.id:d.getIdentity(a):void 0)})},labelAttr:"title",getLabel:function(d){return this.store.getLabel(d)},query:function(d,k){k=k||{};var e=this.store.filter(d),l,a,b;if(b=k.sort)if("[object Array]"===Object.prototype.toString.call(b))for(var c;c=b.pop();)e=e.sort(c.attribute,
c.descending);else e=e.sort(b);e.track&&!e.tracking&&(e=e.track(),a=!0);"start"in k&&(l=k.start||0,l=e[e.fetchRangeSync?"fetchRangeSync":"fetchRange"]({start:l,end:k.count?l+k.count:Infinity}));l=l||e[e.fetchSync?"fetchSync":"fetch"]();b=l.totalLength;l=new p(l);l.total=b;l.observe=function(b,c){function d(b){return void 0===b&&a?-1:b}var f=e.on("add",function(a){b(a.target,-1,d(a.index))}),k=e.on("update",function(a){!c&&a.previousIndex===a.index&&isFinite(a.index)||b(a.target,d(a.previousIndex),
d(a.index))}),l=e.on("delete",function(a){b(a.target,d(a.previousIndex),-1)}),m={remove:function(){f.remove();k.remove();l.remove()}};m.cancel=m.remove;return m};return l},notify:function(){}};l.forEach(["get","put","add","remove","getIdentity"],function(l){d[l]=function(){var d=this.store;return(d[l+"Sync"]||d[l]).apply(d,arguments)}});return q(null,d)})}}});
//# sourceMappingURL=dgrid.js.map