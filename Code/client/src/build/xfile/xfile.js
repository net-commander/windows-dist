//>>built
require({cache:{"xfile/main":function(){define("dojo/_base/kernel dojo/Stateful dojo/query dojo/cache dojo/window xfile/types xfile/component xfile/views/Grid xfile/views/FileGrid xfile/FileActions xfile/Statusbar xfile/ThumbRenderer xfile/Breadcrumb xfile/types xfile/component xfile/config xfile/model/File xfile/manager/FileManager xfile/manager/MountManager xfile/manager/BlockManager xfile/views/FileConsole xfile/data/DriverStore xfile/views/FileGridLight xfile/manager/Electron".split(" "),function(){})},
"xfile/types":function(){define(["xide/utils","xide/types","xide/types/Types","xaction/types"],function(m,k){k.registerCustomMimeIconExtension=function(e,a){k.customMimeIcons[e]=a};var g=k.ACTION;k.DEFAULT_FILE_GRID_PERMISSIONS=[g.EDIT,g.COPY,g.CLOSE,g.MOVE,g.RENAME,g.DOWNLOAD,g.RELOAD,g.DELETE,g.NEW_FILE,g.NEW_DIRECTORY,g.CLIPBOARD,g.LAYOUT,g.COLUMNS,g.SELECTION,g.PREVIEW,g.OPEN_IN,g.GO_UP,g.SEARCH,g.OPEN_IN_TAB,g.TOOLBAR,g.STATUSBAR,g.UPLOAD,g.SIZE_STATS,g.CONSOLE,g.HEADER,"File/Compress","File/New",
g.CONTEXT_MENU,g.SOURCE,"File/OpenInOS"];k.FIELDS={SHOW_ISDIR:1602,SHOW_OWNER:1604,SHOW_MIME:1608,SHOW_SIZE:1616,SHOW_PERMISSIONS:1632,SHOW_TIME:1633,SHOW_FOLDER_SIZE:1634,SHOW_FOLDER_HIDDEN:1635,SHOW_TYPE:1636,SHOW_MEDIA_INFO:1637};k.FILE_PANEL_LAYOUT={TREE:1,LIST:2,THUMB:3,PREVIEW:4,COVER:5,SPLIT_VERTICAL:6,SPLIT_HORIZONTAL:7,IMAGE_GRID:8};k.LAYOUT_PRESET={DUAL:1,SINGLE:2,BROWSER:3,PREVIEW:4,GALLERY:5,EDITOR:6};k.PANEL_OPTIONS={ALLOW_NEW_TABS:!0,ALLOW_MULTI_TAB:!1,ALLOW_INFO_VIEW:!0,ALLOW_LOG_VIEW:!0,
ALLOW_CONTEXT_MENU:!0,ALLOW_LAYOUT_SELECTOR:!0,ALLOW_SOURCE_SELECTOR:!0,ALLOW_COLUMN_RESIZE:!0,ALLOW_COLUMN_REORDER:!0,ALLOW_COLUMN_HIDE:!0,ALLOW_ACTION_TOOLBAR:!0,ALLOW_MAIN_MENU:!0};k.FILE_PANEL_OPTIONS_LEFT={LAYOUT:2,AUTO_OPEN:!0};k.FILE_PANEL_OPTIONS_MAIN={LAYOUT:3,AUTO_OPEN:!0};k.FILE_PANEL_OPTIONS_RIGHT={LAYOUT:3,AUTO_OPEN:!0};k.FILE_GRID_COLUMNS={NAME:"name",SIZE:"size",MODIFIED:"modified"};k.ACTION_TOOLBAR_MODE={SELF:"self"};m.mixin(k.ITEM_TYPE,{FILE:"BTFILE"});m.mixin(k.EVENTS,{STORE_CHANGED:"onStoreChange",
BEFORE_STORE_CHANGE:"onBeforeStoreChange",STORE_REFRESHED:"onStoreRefreshed",ON_FILE_STORE_READY:"onFileStoreReady",ON_DID_OPEN_ITEM:"onDidOpenItem",ON_SHOW_PANEL:"onShowPanel",ITEM_SELECTED:"onItemSelected",ERROR:"fileOperationError",STATUS:"fileOperationStatus",IMAGE_LOADED:"imageLoaded",IMAGE_ERROR:"imageError",RESIZE:"resize",ON_UPLOAD_BEGIN:"onUploadBegin",ON_UPLOAD_PROGRESS:"onUploadProgress",ON_UPLOAD_FINISH:"onUploadFinish",ON_UPLOAD_FAILED:"onUploadFailed",ON_CLIPBOARD_COPY:"onClipboardCopy",
ON_CLIPBOARD_PASTE:"onClipboardPaste",ON_CLIPBOARD_CUT:"onClipboardCut",ON_CONTEXT_MENU_OPEN:"onContextMenuOpen",ON_PLUGIN_LOADED:"onPluginLoaded",ON_PLUGIN_READY:"onPluginReady",ON_MAIN_VIEW_READY:"onMainViewReady",ON_FILE_CONTENT_CHANGED:"onFileContentChanged",ON_PANEL_CLOSED:"onPanelClosed",ON_PANEL_CREATED:"onPanelCreated",ON_COPY_BEGIN:"onCopyBegin",ON_COPY_END:"onCopyEnd",ON_DOWNLOAD_TO_BEGIN:"onDownloadToBegin",ON_DOWNLOAD_TO_END:"onDownloadToEnd",ON_DELETE_BEGIN:"onDeleteBegin",ON_DELETE_END:"onDeleteEnd",
ON_MOVE_BEGIN:"onMoveBegin",ON_MOVE_END:"onMoveEnd",ON_COMPRESS_BEGIN:"onCompressBegin",ON_COMPRESS_END:"onCompressEnd",ON_SOURCE_MENU_OPEN:"onSourceMenuOpen",ON_MOUNT_DATA_READY:"onMountDataReady",ON_XFILE_READY:"onXFileReady",ON_CHANGE_PERSPECTIVE:"onChangePerspective",ON_FILE_PROPERTIES_RENDERED:"onFilePropertiesRendered"});k.SELECTION_MODE={SINGLE:"single",MULTI:"multiple",EXTENDED:"extended"};k.OPERATION={COPY:"copy",MOVE:"move",RENAME:"rename",DELETE:"delete",OPEN:"open",EDIT:"edit",DOWNLOAD:"download",
DOWNLOAD_TO:"downloadTo",INFO:"info",COMPRESS:"compress",RELOAD:"reload",PREVIEW:"preview",INSERT_IMAGE:"insertImage",COPY_PASTE:"copypaste",DND:"dnd",OPTIONS:"options",NEW_FILE:"mkfile",NEW_DIRECTORY:"mkdir",GET_CONTENT:"get",SET_CONTENT:"set",FIND:"find",CUSTOM:"custom",PERMA_LINK:"permaLink",ADD_MOUNT:"ADD_MOUNT",REMOVE_MOUNT:"REMOVE_MOUNT",EDIT_MOUNT:"EDIT_MOUNT",PERSPECTIVE:"PERSPECTIVE",EXTRACT:"extract"};k.OPERATION_INT={NONE:0,EDIT:1,COPY:2,MOVE:3,INFO:4,DOWNLOAD:5,COMPRESS:6,DELETE:7,RENAME:8,
DND:9,COPY_PASTE:10,OPEN:11,RELOAD:12,PREVIEW:13,INSERT_IMAGE:15,NEW_FILE:16,NEW_DIRECTORY:17,UPLOAD:18,READ:19,WRITE:20,PLUGINS:21,CUSTOM:22,FIND:23,PERMA_LINK:24,ADD_MOUNT:25,REMOVE_MOUNT:26,EDIT_MOUNT:27,PERSPECTIVE:28,CLIPBOARD_COPY:29,CLIPBOARD_CUT:30,CLIPBOARD_PASTE:31,EXTRACT:32};k.EResolveMode={SKIP:0,OVERWRITE:1,IF_NEWER:2,IF_SIZE_DIFFERS:3,APPEND:4,THROW:5,ABORT:6};k.EResolve={ALWAYS:0,THIS:1};k.EError={NONE:"None",EXISTS:"EEXIST",PERMISSION:"EACCES",NOEXISTS:"ENOENT",ISDIR:"EISDIR"};return k})},
"xfile/component":function(){define(["dcl/dcl","xide/model/Component"],function(m,k){return m(k,{beanType:"BTFILE",getDependencies:function(){return["xfile/types","xfile/manager/FileManager","xfile/manager/MountManager","xfile/factory/Store","xfile/views/FileGrid"]},getLabel:function(){return"xfile"},getBeanType:function(){return this.beanType}})})},"xfile/views/Grid":function(){define("xdojo/declare xide/types xgrid/ListRenderer xfile/ThumbRenderer xgrid/TreeRenderer xgrid/Grid xgrid/MultiRenderer xfile/FileActions xfile/Statusbar xfile/views/UploadMixin xide/views/_LayoutMixin xgrid/KeyboardNavigation xgrid/Search xgrid/Selection xide/mixins/_State xide/widgets/_Widget xdojo/has!FileConsole?xfile/views/FileConsole xfile/FolderSize xide/noob".split(" "),
function(m,k,g,e,a,d,t,w,p,r,q,c,n,v,h,f,b,l,u){g=[g,e,a];m=m.classFactory("multiRenderer",{},g,t.Implementation);k=d.createGridClass("xfile.views.Grid",{},{SELECTION:{CLASS:v},KEYBOARD_SELECTION:!0,CONTEXT_MENU:k.GRID_FEATURES.CONTEXT_MENU,TOOLBAR:k.GRID_FEATURES.TOOLBAR,CLIPBOARD:k.GRID_FEATURES.CLIPBOARD,ACTIONS:k.GRID_FEATURES.ACTIONS,ITEM_ACTIONS:{CLASS:w},STATUS_BAR:{CLASS:p},SPLIT:{CLASS:q},KEYBOARD_NAVIGATION:{CLASS:c},SEARCH:{CLASS:n},STATE:{CLASS:h},UPLOAD:{CLASS:r},WIDGET:{CLASS:f},CONSOLE:{CLASS:b?
b:u},SIZES:{CLASS:l}},{RENDERER:m},{renderers:g,selectedRenderer:a});k.DEFAULT_RENDERERS=g;k.DEFAULT_MULTI_RENDERER=m;return k})},"xfile/ThumbRenderer":function(){define(["xdojo/declare","xide/utils","dojo/dom-construct","xgrid/ThumbRenderer"],function(m,k,g,e){return m("xfile.ThumbRenderer",[e],{thumbSize:"400",resizeThumb:!0,__type:"thumb",deactivateRenderer:function(){$(this.domNode.parentNode).removeClass("metro");$(this.domNode).css("padding","");this.isThumbGrid=!1},activateRenderer:function(){$(this.domNode.parentNode).addClass("metro");
$(this.contentNode).css("padding","8px");this.isThumbGrid=!0;this.refresh()},_renderUpload:function(a,d,e){d=parseInt(d.replace("%",""));100==d&&(d=90);a='\x3cdiv class\x3d"tile widget uploadItem"\x3e\x3cdiv class\x3d"radial-progress tile widget " data-progress\x3d"'+d+'"\x3e\x3cdiv class\x3d"circle"\x3e\x3cdiv class\x3d"mask full"\x3e\x3cdiv class\x3d"fill"\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"mask half"\x3e\x3cdiv class\x3d"fill"\x3e\x3c/div\x3e\x3cdiv class\x3d"fill fix"\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"shadow"\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"inset"\x3e\x3cdiv class\x3d"percentage"\x3e\x3cdiv class\x3d"numbers"\x3e\x3cspan\x3e-\x3c/span\x3e';
for(d=0;99>d;d++)a+="\x3cspan\x3e"+d+"%\x3c/span\x3e";return a+"\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e"},renderRow:function(a){if(!0===a.isUpload)return $(this._renderUpload(a.name,a.progress+"%",a))[0];if(a.renderRow){var d=a.renderRow.apply(this,[a]);if(d)return d}var d=g.create("div",{className:"tile widget"}),e=!1===a.read&&!1===a.write,w=".."==a.name,p=a&&!!a.directory,r=!1,q="",c="fa fa-folder fa-5x";this._doubleWidthThumbs=!0;var n="icon";p?(c=w?"fa fa-level-up fa-5x itemFolder":
e?"fa fa-lock fa-5x itemFolder":"fa fa-folder fa-5x itemFolder",r=!0):e?(c="fa fa-lock fa-5x itemFolder",r=!0):k.isImage(a.path)?(c=this.getImageUrl(a),a.icon=c?c:this.config.REPO_URL+"/"+a.path,c="imageFile"):(c="fa fa-5x "+k.getIconClass(a.path),r=!0);q=a.name;e='\x3cspan style\x3d"text-shadow: 2px 2px 5px rgba(0,0,0,0.3);font-size: 72px;opacity: 0.7" class\x3d"fa fa-6x '+c+'"\x3e\x3c/span\x3e';k.isImage(a.path)&&(c=this.getImageUrl(a),a.icon=c?c:this.config.REPO_URL+"/"+a.path,c="",n="image",e=
'\x3cdiv style\x3d"" class\x3d"tile-content image"\x3e\x3cimg class\x3d"'+c+'" src\x3d"'+a.icon+'"/\x3e\x3c/div\x3e',r=!0);q='\x3cdiv title\x3d"'+(q+"\n"+a.modified)+'" class\x3d"tile-content '+n+'"\x3e'+e+'\x3c/div\x3e\x3cdiv class\x3d"brand opacity"\x3e\x3cspan class\x3d"thumbText text opacity ellipsis" style\x3d""\x3e'+q+"\x3c/span\x3e\x3c/div\x3e";if(r)return d.innerHTML=q,d;d.innerHTML=p?q:'\x3cimg class\x3d"'+c+'" src\x3d"'+a.icon+'"/\x3e\x26nbsp;\x3cdiv class\x3d"name"\x3e'+a.name+"\x3c/div\x3e";
return d},getImageUrl:function(a){var d=this.ctx.getFileManager();if(d&&d){var e=null;this.resizeThumb&&(e={width:this.thumbSize});return d.getImageUrl(a,null,e)}return null}})})},"xfile/FileActions":function(){define("dcl/dcl xdojo/declare xdojo/has dojo/Deferred xide/utils xide/types xide/factory xide/model/Path xaction/DefaultActions xide/editor/Registry xide/editor/Default dojo/aspect xfile/views/FileOperationDialog xfile/views/FilePreview xide/views/_CIDialog xide/views/_Dialog xide/views/_PanelDialog xfile/views/FilePicker".split(" "),
function(m,k,g,e,a,d,t,w,p,r,q,c,n,v,h,f,b,l){function u(){return{includes:["*",".*"],excludes:[],mode:1502}}function y(f,c){var h=c.userData.value||".",u=new e,n=this,q=new b({size:d.DIALOG_SIZE.SIZE_NORMAL,getContentSize:function(){return{width:"600px",height:"500px"}},bodyCSS:{height:"auto","min-height":"500px",padding:"8px","margin-right":"16px"},picker:null,title:c.title,onOk:function(){var b=this.picker._selection;b&&b[0]&&(c.set("value",b[0].path),u.resolve(b[0].path),q.value=b[0].path)},onShow:function(b,
f){var c=a.addWidget(l,{ctx:n.ctx,owner:n,selection:h||".",resizeToParent:!0,mount:n.collection.mount,storeOptionsMixin:{includeList:"*,.*",excludeList:""},Module:n.Module,permissions:a.clone(n.Module.DEFAULT_PERMISSIONS)},this,f,!0);this.picker=c;this.add(c,null,!1);this.startDfd.resolve();return[this.picker]}});q.show();return u}var x=d.ACTION;c={__loading:!0,touch:function(){var b=new e;try{var f=this,c=this.getSelectedItem(),l=this.getCurrentFolder(),u=c?a.pathinfo(c.path,d.PATH_PARTS.ALL).filename:
"",n=this.collection,q={inputs:[a.createCI("Name",13,u,{widget:{instant:!0,validator:function(b){return l?null==n.getSync(l.path+"/"+b)&&0<b.length:!0}}})]},t={select:c,focus:!0,append:!1};(new h({cis:q,title:"Create new File",ctx:this.ctx,size:d.DIALOG_SIZE.SIZE_SMALL,bodyCSS:{height:"auto","min-height":"80px"},_onError:function(b,f,c){b=b||this.title;(c=c||this.notificationMessage)&&c.update({message:b+this.failedText+(f?"\x3cbr/\x3e"+f:""),type:"error",actions:!1,duration:15E3});this.onError&&
this.onError(f)},onCancel:function(){b.resolve()},onOk:function(){var c=this.getField("name");if(null==c)b.resolve(t);else{var l=(f.getCurrentFolder()||{path:"."}).path+"/"+c;f.ctx.getFileManager().mkfile(n.mount,l,{checkErrors:!0,returnProm:!1}).then(function(c){f.runAction(x.RELOAD).then(function(){n.getSync(l)&&b.resolve({select:l,append:!1,focus:!0})})},function(f){b.resolve(t);logError(f,"error creating directory")})}}})).show()}catch(v){logError(v,"error creating dialog")}return b},newTabArgs:null,
openInOS:function(b){var f=this.ctx.getResourceManager().getVariable("VFS_CONFIG")||{},c=b.mount.replace("/","");if(f[c]){var l=window.eRequire;l||console.error("have no electron");var h=l("os"),d=l("electron").shell,l=l("path"),c=f[c],c=a.replaceAll(" ","",c);b=b.path.replace("./","/");b=a.replaceAll("/",l.sep,b);c=l.resolve(c+l.sep+b);c=a.replaceAll(" ","",c);"win32"!==h.platform()?d.openItem(c):d.openItem("file:///"+c)}else console.error("open in os failed: have no VFS config for "+c)},getFileActions:function(b){b=
b||this.permissions;var f=[],c=d.ACTION,l=d.ACTION_ICON,a=this,h=a.ctx,u=a.domNode,e=h.getResourceManager(),e=e?e.getVariable("VFS_CONFIG"):{};a.getActionStore();f.push(a.createAction({label:"Go up",command:c.GO_UP,icon:l.GO_UP,tab:"Home",group:"Navigation",keycombo:["backspace"],mixin:{quick:!0}}));f.push(a.createAction({label:"Copy",command:c.COPY,icon:"fa-paste",tab:"Home",group:"Organize",keycombo:["f5"],shouldDisable:function(){return null==a.getSelectedItem()}}));f.push(a.createAction({label:"Close",
command:c.CLOSE,icon:"fa-close",tab:"View",group:"Organize",keycombo:["ctrl 0"]}));f.push(a.createAction({label:"Move",command:c.MOVE,icon:"fa-long-arrow-right",tab:"Home",group:"Organize",keycombo:["f6"],shouldDisable:function(){return null==a.getSelectedItem()}}));(-1!==location.href.indexOf("electron\x3dtrue")||g("electronx"))&&e&&f.push(a.createAction({label:"Open with System",command:"File/OpenInOS",icon:"fa-share",tab:"Home",group:"Open",keycombo:["shift f4"],mixin:{addPermission:!0,quick:!0},
shouldDisable:function(){if(a.getSelectedItem())return!1}}));f.push(this.createAction("Open In New Tab","File/OpenInNewTab","fa-share",["alt enter"],"Home","Open","item",null,null,{quick:!0},null,function(){var b=a.getSelectedItem();return b&&b.isDir?!1:!0},b,u,a));if(h&&h.getMountManager&&p.hasAction(b,c.SOURCE)){b.push(c.SOURCE);var n=h.getMountManager().getMounts(),q=0;if(n&&0<n.length){var t=a.collection.mount;f.push(this.createAction({label:"Source",command:c.SOURCE,icon:"fa-hdd-o",keyCombo:["ctrl f1"],
tab:"Home",group:"Navigation",mixin:{data:n,addPermission:!0,quick:!0},onCreate:function(b){b.set("value",t)}}));_.each(n,function(l){var h=l.label;b.push(c.SOURCE+"/"+h);h=a.createAction({label:h,command:c.SOURCE+"/"+h,icon:"fa-hdd-o",keyCombo:["alt f"+q],tab:"Home",group:"Navigation",mixin:{data:n,item:l,closeOnClick:!1,quick:!0},onCreate:function(b){b.set("value",l.name);b._oldIcon=this.icon;b.actionType=d.ACTION_TYPE.SINGLE_TOGGLE}});f.push(h);q++})}}return f.concat(this.getEditorActions(b))},
rename:function(b){var f=new e,c=this,l=b||this.getSelectedItem();b=this.getSelection();var u=this.getCurrentFolder(),n=l?a.pathinfo(l.path,d.PATH_PARTS.ALL).basename:"",q=this.collection,t={select:b,focus:!0,append:!1};b={inputs:[a.createCI("name",d.ECIType.STRING,n,{widget:{instant:!0,title:"New Name",validator:function(b){return null==q.getSync(u.path+"/"+b)&&0<b.length}}})]};(new h({cis:b,title:"Rename",ctx:this.ctx,size:d.DIALOG_SIZE.SIZE_NORMAL,bodyCSS:{height:"auto","min-height":"80px",width:"100%",
"min-width":"400px"},onCancel:function(){f.resolve(t)},onOk:function(){var b=this.getField("name");if(null==b)f.resolve(t);else{var a=c.getCurrentFolder();c.ctx.getFileManager().rename(l.mount,l.path,b,{checkErrors:!0,returnProm:!1}).then(function(l){c.runAction(x.RELOAD).then(function(){t.select=a.path+"/"+b;f.resolve(t)})},function(b){logError(b,"__error renaming file!");f.resolve(t)})}}})).show();return f},move:function(b){var f=new e,c=this;b=this.getSelectedItem();var l=this.getSelection(),n=
this.getCurrentFolder();b&&a.pathinfo(b.path,d.PATH_PARTS.ALL);var q=this.collection,t={select:l,focus:!0,append:!1};if(!b.directory){var v=b.getParent();v&&(b=v)}b={inputs:[a.createCI("Name",d.ECIType.FILE,b.path,{widget:{instant:!0,title:"Target",validator:function(b){return null==q.getSync(n.path+"/"+b)&&0<b.length}}})]};var g=new h({cis:b,title:c.localize("Move"),ctx:this.ctx,size:d.DIALOG_SIZE.SIZE_NORMAL,onCancel:function(){f.resolve(t)},onOk:function(){var b=this.getField("name");if(null==
b)f.resolve(t);else{var h=c._buildServerSelection(l),d=(b=c.collection.getSync(b))?a.normalizePath(b.mount+"/"+b.path):"";b&&(h.dstPath=d);b=u();c.getCurrentFolder();c.ctx.getFileManager().moveItem(h.selection,h.dstPath,b.includes,b.excludes,b.mode,{checkErrors:!0,returnProm:!1}).then(function(b){c.runAction(x.RELOAD).then(function(){f.resolve(t)})},function(b){logError(b,"__error creating file!");f.resolve(t)})}}});g._on("widget",function(b){b.widget._onSelect=function(b){return y.apply(c,[g,b])}});
g.show();return f},copy:function(b){var f=new e,c=this,l=this.getSelectedItem(),q=this.getSelection(),t=this.getCurrentFolder();l&&a.pathinfo(l.path,d.PATH_PARTS.ALL);var v=this.collection,g={select:q,focus:!0,append:!1};l.directory||(b=l.getParent())&&(l=b);b={inputs:[a.createCI("Name",d.ECIType.FILE,l.path,{widget:{instant:!0,title:"Target",validator:function(b){return null==v.getSync(t.path+"/"+b)&&0<b.length}}})]};var p=new (m([n,h],{}))({cis:b,title:c.localize("Copy"),ctx:this.ctx,size:d.DIALOG_SIZE.SIZE_NORMAL,
bodyCSS:{height:"auto","min-height":"80px",width:"100%","min-width":"400px"},onCancel:function(){f.resolve(g)},onOk:function(){var b=this.getField("name");if(null==b)f.resolve(g);else{this.showMessage();var h=this,d=c._buildServerSelection(q),n=c.collection.getSync(b),e=n?a.normalizePath(n.mount+"/"+n.path):"";d.dstPath=n?e:a.normalizePath(l.mount+"/"+b);c.getCurrentFolder();b=c.ctx.getFileManager().copyItem(d.selection,d.dstPath,u(),{checkErrors:!0,returnProm:!1});b.then(function(b){h._onSuccess(b)},
function(b){h._onError()});b.then(function(b){c.runAction(x.RELOAD).then(function(){f.resolve(g)})},function(b){logError(b,"__error creating file!");f.resolve(g)})}}});p._on("widget",function(b){b.widget._onSelect=function(b){return y.apply(c,[p,b])}});p.show();return f},clipboardPaste:function(){var b=new e,f=this.currentCutSelection,c=f?this.currentCutSelection:this.currentCopySelection,l=this._buildServerSelection(c),f=f?"moveItem":"copyItem",a=this,h={select:c,focus:!0,append:!1};if(!c)return b.resolve(),
b;c=u();a.ctx.getFileManager()[f](l.selection,l.dstPath,{include:c.includes,exclude:c.excludes,mode:c.mode}).then(function(f){a.runAction(d.ACTION.RELOAD).then(function(){b.resolve(h)})},function(f){b.resolve(h)},function(f){b.resolve(h)});return b},mkdir:function(){var b=new e;try{var f=this,c=this.getSelectedItem(),l=this.getCurrentFolder(),u=c?a.pathinfo(c.path,d.PATH_PARTS.ALL).filename:"",n=this.collection,q={inputs:[a.createCI("Name",13,u,{widget:{instant:!0,validator:function(b){return l?null==
n.getSync(l.path+"/"+b)&&0<b.length:!0}}})]},t={select:c,focus:!0,append:!1};(new h({cis:q,title:"Create new Directory",ctx:this.ctx,size:d.DIALOG_SIZE.SIZE_NORMAL,bodyCSS:{height:"auto","min-height":"80px",width:"100%","min-width":"400px"},_onError:function(b,f,c){b=b||this.title;(c=c||this.notificationMessage)&&c.update({message:b+this.failedText+(f?"\x3cbr/\x3e"+f:""),type:"error",actions:!1,duration:15E3});this.onError&&this.onError(f)},onCancel:function(){b.resolve()},onOk:function(){var c=this.getField("name");
if(null==c)b.resolve(t);else{var l=(f.getCurrentFolder()||{path:"."}).path+"/"+c;f.ctx.getFileManager().mkdir(n.mount,l,{checkErrors:!0,returnProm:!1}).then(function(c){f.runAction(x.RELOAD).then(function(){n.getSync(l)&&b.resolve({select:l,append:!1,focus:!0})})},function(f){b.resolve(t);logError(f,"error creating directory")})}}})).show()}catch(g){logError(g,"error creating dialog")}return b},_buildServerSelection:function(b,f){!f&&(f=this.getCurrentFolder());f&&!f.directory&&(f=f.getParent());
_.isArray(b)||(b=[b]);var c=[],l=b[0].getStore(),h=f?a.normalizePath(f.mount+"/"+f.path):"";_.each(b,function(b){l.getSync(b.path)&&c.push(a.normalizePath(b.mount+"/"+b.path))});return{selection:c,store:b[0]._S,dstPath:"/"+h+"/",firstItem:b[0],parent:f}},openPreview:function(b,f){var c=this.row(b).element,l=this,a=new e;if(this._preview)return this._preview.item=b,this._preview.open().then(function(){l._preview.preview.trigger($.Event("update",{file:b}))});var h=new v({node:$(c),item:b,delegate:this.ctx.getFileManager(),
parent:$(c),ctx:l.ctx,container:f?f.containerNode:null});f?h.buildRenderingEmbedded():h.buildRendering();h.init();h.exec();this._preview=h;this._preview.handler=this;l._on("selectionChanged",function(b){if(b=l.getSelectedItem())h.item=b,h.preview.trigger($.Event("update",{file:b}))});this.add(h,null,!1);h._emit("changeState",function(f){0===f&&a.resolve({select:b,focus:!0,append:!1})});return a},deleteSelection:function(b){b=b||this.getSelection();var f=new e,c=this.getNext(b[0],null,!0),l=this.getPrevious(b[0],
null,!0),a=c||l,h=this._buildServerSelection(b),u=this;(new n({ctx:u.ctx,notificationMessage:null,title:"Delete "+h.selection.length+" items",type:d.DIALOG_TYPE.DANGER,onBeforeOk:function(){},getOkDfd:function(){var b=this;return this.ctx.getFileManager().deleteItems(h.selection,{hints:[1]},{checkErrors:!1,returnProm:!1,onError:function(f){b._onError(null,f.message)}})},onCancel:function(){f.resolve({select:b,focus:!0,append:!1})},onSuccess:function(){u.runAction(d.ACTION.RELOAD).then(function(){f.resolve({select:a,
focus:!0,append:!1})})}})).show();return f},goUp:function(b){b=this._history.getNow();b=_.isString(b)?this.collection.getSync(b):b;var f=new e,c=this,l=this.getHistory().getNow();if(!b){var a=this.getRows();a[0]&&a[0]._S&&(a=a[0]._S.getParent(a[0]))&&(a=a._S.getParent(a))&&(b=a)}b?(a=b._S.getParent(b))&&(b=this.openFolder(a,!0,!1))&&b.then&&b.then(function(){if(l){var b=c.collection.getSync(l);b&&f.resolve({select:b,focus:!0,delay:1})}}):l?(b=this.collection.getSync(l))&&this.select([b],null,!0,{focus:!0,
delay:1}):(a=this.getRows(),a[0]&&a[0]._S&&(a=a[0]._S.getParent(a[0]))&&(a=a._S.getParent(a))&&this.openFolder(a,!0));return f},reload:function(b){var f=new e,c=this.getSelection();b=b||this.getRows()[0];var l=this.getCurrentFolder()||{path:"."},a=this;l.isBack&&(l=this.collection.getSync(l.rPath)||{path:"."});var h=!1;this.isExpanded&&this.expand&&b&&(h=this._isExpanded(b))&&this.expand(b,null,!1);a.collection.resetQueryLog();this.collection.loadItem(l,!0).then(function(b){"."===l.path&&a.collection.resetQueryLog();
a.refresh().then(function(){var b=a.openItem(l,!1,!1);b&&b.then&&b.then(function(){f.resolve({select:c,append:!1,focus:!0,delay:1})});a.deselectAll();f.resolve({select:c,append:!1,focus:!0,delay:2})})});return f},toHistory:function(b){b=(b.getFolder?new w(b.getFolder()):new w(".")).getSegments();var f=this.collection.rootSegment,c=f;b&&"."===b[0]&&(b[0]=f);var l=[];_.each(b,function(b){b=b!==c?c+(c.endsWith("/")?"":"/")+b:b;l.push(b);c=b});return l},openFolder:function(b,f,c){var l=this.getCurrentFolder(),
a=this.collection,h=this.getHistory();h.getNow();h.getNow();var d=this;(b=_.isString(b)?a.getSync(b):a.getSync(b.path)||b)||(b=a.getRootItem());var u=d.toHistory(b);h.set(u);if(!b)return this.setQueryEx(a.getRootItem());if(!(l&&b&&f&&l.path===b.path)&&b){this.deselectAll();var l=(l=this.row(b))?l.element:null,n;b._S.isItemLoaded(b)||((l=$(l).find("span.fa"))&&l[0]&&(n=$(l[0])),n&&(n.removeClass("fa fa-folder"),n.addClass("fa-spinner fa-spin")));var q=new e;this._emit("openFolder",{item:b,back:f});
(l=this.setQueryEx(b,null))&&l.then(function(){n&&(n.addClass("fa fa-folder"),n.removeClass("fa-spinner fa-spin"));q.resolve({select:!1!==c?f?b:d.getRows()[0]:null,focus:!0,append:!1,delay:1});d._emit("openedFolder",{item:b,back:f})});return q}},changeSource:function(b,f){var c=new e,l=this,a=l.ctx||a,h=a.getFileManager(),d=t.createFileStore(b.name,null,h.config,null,a),n=this.collection,a=this.getAction(x.SOURCE),h=b.label||b.name,u=this.getAction(x.SOURCE+"/"+h);n.destroy();!0!==f&&this._emit("changeSource",
b);this.set("loading",!0);this.set("collection",d.getDefaultCollection("./"));a.set("value",b.name);l.set("title","Files ("+b.label+")");n=a.getChildren();_.each(n,function(b){b.set("icon",b._oldIcon)});a.set("label",h);u&&u.set("icon","fa-spinner fa-spin");this.refresh().then(function(){l.set("loading",!1);l.set("collection",d.getDefaultCollection("./"));u&&u.set("icon","fa-check");!0!==f&&l._emit("changedSource",b);l.select([0],null,!0,{append:!1,focus:!0}).then(function(){c.resolve()})});return c},
openInNewTab:function(b){var f=this.ctx,c=f.getWindowManager(),l=new e,h=null,h=_.isFunction(this.newTarget)?this.newTarget({title:b.name,icon:"fa-folder",target:this._parent,location:null,tabOrientation:null}):c.createTab(b.name,"fa-folder",this.newTarget||this),d=this.collection;b.isDir||(b=this.getCurrentFolder());var n=t.createFileStore(d.mount,d.options,d.config,null,f),f=a.mixin({showToolbar:this.showToolbar,collection:n,selectedRenderer:this.selectedRenderer,showHeader:this.showHeader,newTarget:this.newTarget,
style:this.style,options:a.clone(this.options),permissions:this.permissions,_columns:this._columns,attachDirect:!0,registerEditors:this.registerEditors},this.newTabArgs||{}),u=a.addWidget(this.getClass(),f,null,h,!1);l.resolve();u.set("loading",!0);n.initRoot().then(function(f){(f=n.getItem(b.path,!0))&&f.then(function(){u.startup();u.openItem(b).then(function(){u.set("loading",!1);u.select([0],null,!0,{focus:!0,append:!1,delay:1})});c.registerView(u,!0)})});return l},openItem:function(b,f,c){if(!b){var l=
this.getRows();l[0]&&l[0].isBack&&(b=l[0])}if(b&&b.isBack)return b._S=null,this.goUp();if(b=_.isString(b)?this.collection.getSync(b):b){if(!0===b.directory)return this.openFolder(b,f,c);f=r.getEditors(b);return(f=_.find(f,function(b){return!0===b.isDefault}))?f.onEdit(b,this):this.ctx.getWindowManager().openItem(b,this.newTarget||this,{register:!0})}},getSelectedItem:function(){return this.getSelection()[0]},openDefaultEditor:function(b){return q.Implementation.open(b)},close:function(){var b=this._parent;
if(b){var f=b.docker();f&&(this.onAfterAction=null,f.removePanel(b))}return!1},compress:function(b){b=b||this.getSelection();var f=this;(b=this._buildServerSelection(b))&&b.store&&b.selection&&f.ctx.getFileManager().compressItem(b.firstItem.mount,b.selection,"zip").then(function(b){f.reload()})},runAction:function(b,f){_.isString(b)&&(b=this.getAction(b));if(b&&b.command){var c=d.ACTION,l=this.getSelectedItem()||f,a=this.getSelection();if(-1!=b.command.indexOf(x.SOURCE))return this.changeSource(b.item);
switch(b.command){case "File/Compress":return this.compress(a);case c.PREVIEW:return this.openPreview(l);case "File/OpenInNewTab":return this.openInNewTab(l||this.collection.getRootItem());case c.EDIT:return this.openItem(l);case c.NEW_FILE:return this.touch(l);case c.NEW_DIRECTORY:return this.mkdir(l);case c.RELOAD:return this.reload(l);case c.RENAME:return this.rename(l);case c.GO_UP:return this.goUp(null);case c.COPY:return this.copy(null);case c.MOVE:return this.move(null);case c.DELETE:return this.deleteSelection(null);
case c.OPEN_IN+"/Default Editor":return this.openDefaultEditor(l);case c.DOWNLOAD:return this.ctx.getFileManager().download(l);case c.CLOSE:return this.close();case "File/OpenInOS":return this.openInOS(l)}return-1!=b.command.indexOf(c.OPEN_IN+"/")?b.editor.onEdit(l):this.inherited(arguments)}},getEditorActions:function(b){function f(b){function c(b,f){f.handler=function(){b.onEdit(e.getSelection()[0])}}function l(b){b=r.getEditors(b)||[];for(var f=[],a=0;a<b.length;a++){var h=b[a];if("Default Editor"!==
h.name){var d=e.createAction(h.name,n.OPEN_IN+"/"+h.name,h.iconClass,null,"Home","Open","item",null,function(){},{addPermission:!0,tab:"Home",editor:h,custom:!0,quick:!0},null,null,u,q,e);c(h,d);f.push(d)}}return f}var a=b.selection;if(a&&a[0]){var h=a[0],u=this.permissions,n=d.ACTION,e=this,q=e.domNode,t=e.getActionStore(),a=this.getContextMenu?this.getContextMenu():null;"deselect"!=b.why&&(t.getSync(d.ACTION.OPEN_IN),b=e.addActions(l(h)),this._lastEditorActions&&(_.each(this._lastEditorActions,
function(b){t.removeSync(b.command)}),delete this._lastEditorActions),a&&a.removeCustomActions(),0<b.length&&(b=this.addActions(b),t._emit("onActionsAdded",b),this._lastEditorActions=b))}}b=b||this.permissions;var c=[],l=d.ACTION,a=d.ACTION_ICON,h=this,u=h.domNode;h.getActionStore();var n=null;this._selHandle||(this._selHandle=this._on("selectionChanged",function(b){f.apply(h,[b])}));n=this.createAction("Open In",l.OPEN_IN,a.EDIT,null,"Home","Open","item",null,function(){},{addPermission:!0,tab:"Home",
quick:!0},null,p.shouldDisableDefaultFileOnly,b,u,h);c.push(n);b=h.createAction("Default Editor",l.OPEN_IN+"/Default Editor","fa-code",null,"Home","Open","item",null,function(){},{addPermission:!0,tab:"Home",forceSubs:!0,quick:!0},null,null,b,u,h);c.push(b);return c}};k=k("xfile.FileActions",null,c);k.Implementation=c;k.createFilePicker=function(f,c,h,u,n,e,q,t){(new b({size:d.DIALOG_SIZE.SIZE_NORMAL,getContentSize:function(){return{width:"600px",height:"500px"}},bodyCSS:{height:"auto","min-height":"500px",
padding:"8px","margin-right":"16px"},picker:null,title:u,onOk:function(){var b=this.picker._selection;b&&b[0]&&(h(b[0]),q&&q.resolve(b[0],b,this.picker))},onShow:function(b,h){var u=a.addWidget(l,a.mixin({ctx:f.ctx,owner:f,selection:c||".",resizeToParent:!0,storeOptionsMixin:{includeList:"*,.*",excludeList:""},Module:t,permissions:n||a.clone(d.DEFAULT_FILE_GRID_PERMISSIONS)},e),this,h,!0);this.picker=u;this.add(u);this.startDfd.resolve();return[this.picker]}})).show();return q};return k})},"xfile/views/FileOperationDialog":function(){define(["dcl/dcl",
"xide/types","xide/views/_Dialog"],function(m,k,g){return m(g,{title:"",type:k.DIALOG_TYPE.INFO,size:k.DIALOG_SIZE.SIZE_SMALL,bodyCSS:{},failedText:" Failed!",successText:": Success!",showSpinner:!0,spinner:'  \x3cspan class\x3d"fa-spinner fa-spin"/\x3e',notificationMessage:null,doOk:function(e){this.onBeforeOk&&this.onBeforeOk();this.showMessage();var a=this;e.then(function(d){a._onSuccess(d)},function(d){a._onError()})},_onSuccess:function(e,a,d){e=e||this.title;(d=d||this.notificationMessage)&&
d.update({message:e+this.successText+(a?"\x3cbr/\x3e"+a:""),type:"info",actions:!1,duration:1500});this.onSuccess&&this.onSuccess()},_onError:function(e,a,d){e=e||this.title;(d=d||this.notificationMessage)&&d.update({message:e+this.failedText+(a?"\x3cbr/\x3e"+a:""),type:"error",actions:!1,duration:15E3});this.onError&&this.onError(a)},onOk:function(){this.showMessage();this.doOk(this.getOkDfd())},showMessage:function(e){if(this.notificationMessage)return this.notificationMessage;e=e||this.title;return this.notificationMessage=
e=this.ctx.getNotificationManager().postMessage({message:e+(this.showSpinner?this.spinner:""),type:"info",showCloseButton:!0,duration:4500})}})})},"xfile/views/FilePreview":function(){define("dcl/dcl xide/types xide/utils xide/mixins/EventedMixin xide/widgets/_Widget dojo/cache dojo/Deferred dijit/registry xide/editor/Default xaction/DefaultActions".split(" "),function(m,k,g,e,a,d,t,w,p,r){var q=[function(c){var a=["image/jpeg","image/png","image/gif"],d=c.preview;$.each(navigator.mimeTypes,function(c,
f){var b=f.type;0===b.indexOf("image/")&&$.inArray(b,a)&&a.push(b)});d.bind("update",function(h){var f=h.file,b;c.opened()&&-1!==$.inArray(f.mime,a)&&(h.stopImmediatePropagation(),h=null,c.resizeToPreview&&(h={width:d.width()}),b=$("\x3cimg/\x3e").hide().appendTo(d).load(function(){setTimeout(function(){var f=(b.width()/b.height()).toFixed(2);d.bind("changesize",function(){var c=parseInt(d.width()),a=parseInt(d.height()),h;f<(c/a).toFixed(2)?(h=a,c=Math.floor(h*f)):h=Math.floor(c/f);b.width(c).height(h).css("margin-top",
h<a?Math.floor((a-h)/2):0)}).trigger("changesize");c.hideinfo();b.fadeIn(100)},1)}),b.attr("src",c.fm.url(f,null,h)))})},function(c){var a=["text/html","application/xhtml+xml"],d=c.preview;d.bind("update",function(h){var f=h.file;c.opened()&&-1!==$.inArray(f.mime,a)&&(h.stopImmediatePropagation(),c.ctx.getFileManager().getContent(f.mount,f.path,function(b){c.hideinfo();doc=$('\x3ciframe class\x3d"elfinder-quicklook-preview-html"/\x3e').appendTo(d)[0].contentWindow.document;doc.open();doc.write(b);
doc.close()}))})},function(c){var a=c.preview,d="application/x-empty application/javascript application/xhtml+xml audio/x-mp3-playlist application/x-web-config application/docbook+xml application/x-php application/x-perl application/x-awk application/x-config application/x-csh application/xml application/x-empty text/html text/x-c text/x-php text/plain text/x-c++ text/x-lisp".split(" ");a.bind("update",function(h){var f=h.file,b=f.mime;if(c.opened()&&(0===b.indexOf("text/")||-1!==$.inArray(b,d))&&
(h.stopImmediatePropagation(),c.useAce)){c.hideinfo();h=$('\x3cdiv class\x3d"elfinder-quicklook-preview-text-wrapper"\x3e\x3c/div\x3e');h.appendTo(a);var l=c._editor,b=l;if(!l&&(l=p.Implementation.open(f,h[0],c.editorOptions,!1,c),c._editor=l,c.add(l,null,!1),r.hasAction(c.editorOptions.permissions,k.ACTION.TOOLBAR))){var u=l.getToolbar();u&&$(u.domNode).addClass("bg-opaque")}b&&(h.append(l.domNode),l.set("item",f));a.bind("changesize",function(){parseInt(a.width());parseInt(a.height());g.resizeTo(l.domNode,
a[0],!0,!0);l.resize()})}})},function(c){var a=c.preview,d=!1,d=!1;$.each(navigator.plugins,function(c,f){$.each(f,function(b,f){if("application/pdf"==f.type)return!(d=!0)})});d&&a.bind("update",function(h){var f=h.file,b;c.opened()&&"application/pdf"==f.mime&&(h.stopImmediatePropagation(),a.one("change",function(){b.unbind("load").remove()}),b=$('\x3ciframe class\x3d"elfinder-quicklook-preview-pdf"/\x3e').hide().appendTo(a).load(function(){c.hideinfo();b.show()}).attr("src",c.fm.url(f)))})},function(c){var a=
c.fm,d=c.preview,h=!1;$.each(navigator.plugins,function(f,b){$.each(b,function(b,f){if("application/x-shockwave-flash"==f.type)return!(h=!0)})});h&&d.bind("update",function(f){var b=f.file;c.opened()&&"application/x-shockwave-flash"==b.mime&&(f.stopImmediatePropagation(),c.hideinfo(),d.append($('\x3cembed class\x3d"elfinder-quicklook-preview-flash" pluginspage\x3d"http://www.macromedia.com/go/getflashplayer" src\x3d"'+a.url(b)+'" quality\x3d"high" type\x3d"application/x-shockwave-flash" /\x3e')))})},
function(c){var a=c.preview,d=!!c.options.autoplay,h={"audio/mpeg":"mp3","audio/mpeg3":"mp3","audio/mp3":"mp3","audio/x-mpeg3":"mp3","audio/x-mp3":"mp3","audio/x-wav":"wav","audio/wav":"wav","audio/x-m4a":"m4a","audio/aac":"m4a","audio/mp4":"m4a","audio/x-mp4":"m4a","audio/ogg":"ogg"},f;a.bind("update",function(b){if(c.opened()){var l=b.file;c.support.audio[h[l.mime]]&&(b.stopImmediatePropagation(),f=$('\x3caudio class\x3d"elfinder-quicklook-preview-audio" controls preload\x3d"auto" autobuffer\x3e\x3csource src\x3d"'+
c.fm.url(l)+'" /\x3e\x3c/audio\x3e').appendTo(a),d&&f[0].play())}}).bind("change",function(){f&&f.parent().length&&(f[0].pause(),f.remove(),f=null)})},function(c){var a=c.preview,d=!!c.options.autoplay,h={"video/mp4":"mp4","video/x-m4v":"mp4","video/ogg":"ogg","application/ogg":"ogg","video/webm":"webm"},f;a.bind("update",function(b){if(c.opened()){var l=b.file;c.support.video[h[l.mime]]&&(b.stopImmediatePropagation(),c.hideinfo(),f=$('\x3cvideo class\x3d"elfinder-quicklook-preview-video" controls preload\x3d"auto" autobuffer\x3e\x3csource src\x3d"'+
c.fm.url(l)+'" /\x3e\x3c/video\x3e').appendTo(a),d&&f[0].play())}}).bind("change",function(){f&&f.parent().length&&(f[0].pause(),f.remove(),f=null)})},function(c){var a=c.preview,d=[],h;c.opened()&&($.each(navigator.plugins,function(f,b){$.each(b,function(b,f){0!==f.type.indexOf("audio/")&&0!==f.type.indexOf("video/")||d.push(f.type)})}),a.bind("update",function(f){if(c.opened()){var b=f.file,l=b.mime;-1!==$.inArray(b.mime,d)&&(f.stopImmediatePropagation(),(f=0===l.indexOf("video/"))&&c.hideinfo(),
h=$('\x3cembed src\x3d"'+c.fm.url(b)+'" type\x3d"'+l+'" class\x3d"elfinder-quicklook-preview-'+(f?"video":"audio")+'"/\x3e').appendTo(a))}}).bind("change",function(){h&&h.parent().length&&(h.remove(),h=null)}))}];e=m([a.dcl,e.dcl],{resizeToPreview:!0,useAce:!0,registerEditors:!1,editorPermissions:[],container:null,destroy:function(){this.window.empty();g.destroy(this.window[0]);this.inherited(arguments)},init:function(){var c=this.options={autoplay:!0,jplayer:"extensions/jplayer",ui:"button"},a=this,
d=this.window,h=this.preview,f=this.container;width=0<c.width?parseInt(c.width):450;height=0<c.height?parseInt(c.height):300;f||d.appendTo("body").zIndex(20);$(document).keydown(function(b){27==b.keyCode&&a.opened()&&d.trigger("close")});!f&&$.fn.resizable&&d.resizable({handles:"se",minWidth:350,minHeight:120,resize:function(){h.trigger("changesize")}});$.each(q||[],function(b,f){"function"==typeof f&&new f(a)});h.bind("update",function(){a.info.show()})},buildRenderingEmbedded:function(){var c=this,
a=this.navicon,d=this.container?$(this.container):null;$('\x3cdiv class\x3d"elfinder-quicklook-title" style\x3d"display: none"\x3e'+c.title+"\x3c/div\x3e");var h=$("\x3cdiv/\x3e"),f=$('\x3cdiv class\x3d"elfinder-quicklook-info"/\x3e');c.openDfd=new t;c.fsicon=$('\x3cdiv class\x3d"'+a+" "+a+' fa-2x fa-arrows-alt"/\x3e').mousedown(function(b){var f=c.window,h=f.is("."+c.fullscreen),d=$(window);b.stopPropagation();h?(f.css(f.data("position")).unbind("mousemove"),d.unbind("scroll.elfinder-finder").trigger(c.resize).unbind(c.resize),
c.navbar.unbind("mouseenter").unbind("mousemove")):(f.data("position",{left:f.css("left"),top:f.css("top"),width:f.width(),height:f.height()}).css({width:"100%",height:"100%"}),$(window).bind("scroll.elfinder-finder",function(){f.css({left:parseInt($(window).scrollLeft())+"px",top:parseInt($(window).scrollTop())+"px"})}).bind(c.resize,function(b){c.preview.trigger("changesize")}).trigger("scroll.elfinder-finder").trigger(c.resize),f.bind("mousemove",function(b){c.navbar.stop(!0,!0).show().delay(3E3).fadeOut("slow")}).mousemove(),
c.navbar.mouseenter(function(){c.navbar.stop(!0,!0).show()}).mousemove(function(b){b.stopPropagation()}));c.navbar.attr("style","").draggable(h?"destroy":{});f.toggleClass(c.fullscreen);$(this).toggleClass(a+"-fullscreen-off");parent||(parent=$(".xapp"))});c.navbar=$('\x3cdiv class\x3d"" style\x3d"display: none;"/\x3e');c.preview=$('\x3cdiv class\x3d"elfinder-quicklook-preview ui-helper-clearfix"/\x3e').bind("change",function(b){c.info.attr("style","").hide();h.removeAttr("class").attr("style","");
f.html("")}).bind("update",function(b){var f=b.file;f?(!f.read&&b.stopImmediatePropagation(),c.preview.unbind("changesize").trigger("change").children().remove(),c.info.delay(100).fadeIn(10)):b.stopImmediatePropagation()});c.info=$('\x3cdiv class\x3d"elfinder-quicklook-info-wrapper"/\x3e').append(h).append(f);c.window=$('\x3cdiv id\x3d"'+c.id+'" class\x3d"ui-helper-reset ui-widget elfinder-quicklook widget bg-opaque" style\x3d""/\x3e').click(function(b){b.stopPropagation()}).append(c.preview).append(c.info.hide()).bind("open",
function(b){c._open=!0;b=c.window;var f=c.node;c.closed()&&(c.update(1,c.value),c.navbar.attr("style",""),c.state=1,f&&f.trigger("scrolltoview"),b.css(c.closedCss(f)).show().animate(c.openedCss(),550,function(){c.state=2;c.update(2,c.value);c.openDfd.resolve()}))}).bind("close",function(b){var f=c.window,a=c.preview.trigger("change");b={};var h=function(){c._open=!1;c.state=0;f.hide();a.children().remove();c.update(0,c.value)};c.opened()&&(state=1,f.is("."+c.fullscreen)&&c.fsicon.mousedown(),b.length?
f.animate(c.closedCss(b),500,h):h())});d&&d.append(c.window);d=this.supportTest;c.support={audio:{ogg:d('audio/ogg; codecs\x3d"vorbis"'),mp3:d("audio/mpeg;"),wav:d('audio/wav; codecs\x3d"1"'),m4a:d("audio/x-m4a;")||d("audio/aac;")},video:{ogg:d('video/ogg; codecs\x3d"theora"'),webm:d('video/webm; codecs\x3d"vp8, vorbis"'),mp4:d('video/mp4; codecs\x3d"avc1.42E01E"')||d('video/mp4; codecs\x3d"avc1.42E01E, mp4a.40.2"')}}},buildRendering:function(){var c=this,a=this.navicon,d=this.container?$(this.container):
null,h=$('\x3cdiv class\x3d"elfinder-quicklook-title"\x3e'+c.title+"\x3c/div\x3e"),f=$("\x3cdiv/\x3e"),b=$('\x3cdiv class\x3d"elfinder-quicklook-info"/\x3e');c.openDfd=new t;c.fsicon=$('\x3cdiv class\x3d"'+a+" "+a+' fa-2x fa-arrows-alt"/\x3e').mousedown(function(b){var f=c.window,h=f.is("."+c.fullscreen),d=$(window);b.stopPropagation();h?(f.css(f.data("position")).unbind("mousemove"),d.unbind("scroll.elfinder-finder").trigger(c.resize).unbind(c.resize),c.navbar.unbind("mouseenter").unbind("mousemove")):
(f.data("position",{left:f.css("left"),top:f.css("top"),width:f.width(),height:f.height()}).css({width:"100%",height:"100%"}),$(window).bind("scroll.elfinder-finder",function(){f.css({left:parseInt($(window).scrollLeft())+"px",top:parseInt($(window).scrollTop())+"px"})}).bind(c.resize,function(b){c.preview.trigger("changesize")}).trigger("scroll.elfinder-finder").trigger(c.resize),f.bind("mousemove",function(b){c.navbar.stop(!0,!0).show().delay(3E3).fadeOut("slow")}).mousemove(),c.navbar.mouseenter(function(){c.navbar.stop(!0,
!0).show()}).mousemove(function(b){b.stopPropagation()}));c.navbar.attr("style","").draggable(h?"destroy":{});f.toggleClass(c.fullscreen);$(this).toggleClass(a+"-fullscreen-off");parent||(parent=$(".xapp"))});c.navbar=$('\x3cdiv class\x3d"elfinder-quicklook-navbar"/\x3e').append($('\x3cdiv class\x3d"'+a+" "+a+' fa-2x fa-arrow-left"/\x3e').mousedown(function(){c.navtrigger(37)})).append(c.fsicon).append($('\x3cdiv class\x3d"'+a+" "+a+' fa-2x fa-arrow-right"/\x3e').mousedown(function(){c.navtrigger(39)})).append('\x3cdiv class\x3d"elfinder-quicklook-navbar-separator"/\x3e').append($('\x3cdiv class\x3d"'+
a+" "+a+'-close"/\x3e').mousedown(function(){c.window.trigger("close")}));c.preview=$('\x3cdiv class\x3d"elfinder-quicklook-preview ui-helper-clearfix"/\x3e').bind("change",function(a){c.info.attr("style","").hide();f.removeAttr("class").attr("style","");b.html("")}).bind("update",function(b){var f=b.file;f?(!f.read&&b.stopImmediatePropagation(),c.preview.unbind("changesize").trigger("change").children().remove(),c.info.delay(100).fadeIn(10)):b.stopImmediatePropagation()});c.info=$('\x3cdiv class\x3d"elfinder-quicklook-info-wrapper"/\x3e').append(f).append(b);
c.window=$('\x3cdiv id\x3d"'+c.id+'" class\x3d"ui-helper-reset ui-widget elfinder-quicklook widget bg-opaque" style\x3d"position:absolute"/\x3e').click(function(b){b.stopPropagation()}).append($('\x3cdiv class\x3d"elfinder-quicklook-titlebar"/\x3e').append(h).append($('\x3cspan class\x3d"fa-close" style\x3d"margin-left: 4px; color: white; font-size: 16px; text-align: center; position: absolute; left: 0px; top: 2px;"/\x3e').mousedown(function(b){b.stopPropagation();c.window.trigger("close")}))).append(c.preview.add(c.navbar)).append(c.info.hide()).draggable({handle:"div.elfinder-quicklook-titlebar"}).bind("open",
function(b){c._open=!0;b=c.window;var f=c.node;c.closed()&&(c.update(1,c.value),c.navbar.attr("style",""),c.state=1,f.trigger("scrolltoview"),b.css(c.closedCss(f)).show().animate(c.openedCss(),550,function(){c.state=2;c.update(2,c.value);c.openDfd.resolve()}))}).bind("close",function(b){var f=c.window,a=c.preview.trigger("change");b={};var h=function(){c._open=!1;c.state=0;f.hide();a.children().remove();c.update(0,c.value)};c.opened()&&(state=1,f.is("."+c.fullscreen)&&c.fsicon.mousedown(),b.length?
f.animate(c.closedCss(b),500,h):h())});d&&d.append(c.window);d=this.supportTest;c.support={audio:{ogg:d('audio/ogg; codecs\x3d"vorbis"'),mp3:d("audio/mpeg;"),wav:d('audio/wav; codecs\x3d"1"'),m4a:d("audio/x-m4a;")||d("audio/aac;")},video:{ogg:d('video/ogg; codecs\x3d"theora"'),webm:d('video/webm; codecs\x3d"vp8, vorbis"'),mp4:d('video/mp4; codecs\x3d"avc1.42E01E"')||d('video/mp4; codecs\x3d"avc1.42E01E, mp4a.40.2"')}}},constructor:function(c){g.mixin(this,c)},editorOptions:{permissions:[k.ACTION.TOOLBAR,
k.ACTION.RELOAD,"Editor/Settings","View/Increase Font Size","View/Decrease Font Size","View/Themes","File/Search"]},title:"Preview",width:450,height:300,fm:null,state:0,navicon:"elfinder-quicklook-navbar-icon",fullscreen:"elfinder-quicklook-fullscreen",parent:null,cwd:null,resize:"resize.elfinder-finder",alwaysEnabled:!0,value:null,handlers:{select:function(){this.update(void 0,this.fm.selectedFiles()[0])},error:function(){self.window.is(":visible")&&self.window.data("hash","").trigger("close")},
"searchshow searchhide":function(){this.opened()&&this.window.trigger("close")}},shortcuts:[{pattern:"space"}],navtrigger:function(c){$(document).trigger($.Event("keydown",{keyCode:c,ctrlKey:!1,shiftKey:!1,altKey:!1,metaKey:!1}))},closedCss:function(c){return{opacity:0,width:20,height:20,top:c?c.offset().top+"px":0,left:c?c.offset().left+"px":0}},openedCss:function(){var c=this.container?$(this.container):null,a=c||$(window),d=c?"100%":Math.min(this.width,a.width()-10),c=c?"100%":Math.min(this.height,
a.height()-80);return{opacity:1,width:d,height:c,top:parseInt((a.height()-c-60)/2+a.scrollTop()),left:parseInt((a.width()-d)/2+a.scrollLeft())}},supportTest:function(c){var a=document.createElement(c.substr(0,c.indexOf("/"))),d=!1;try{d=a.canPlayType&&a.canPlayType(c)}catch(h){}return d&&""!==d&&"no"!=d},changeView:function(c){this.currentView&&(g.destroy(this.currentView),this.currentView.destroy&&this.currentView.destroy())},update:function(c){this._open=c;this._emit("changeState",c);if(1==c&&this.onAnimate)this.onAnimate();
if(2==c&&this.onOpened)this.onOpened();if(0==c&&this.onClosed)this.onClosed()},closed:function(){return 0==this.state},opened:function(){return 2==this.state},bind:function(c,a){var d;if("function"==typeof a)for(c=(""+c).toLowerCase().split(/\s+/),d=0;d<c.length;d++)void 0===listeners[c[d]]&&(listeners[c[d]]=[]),listeners[c[d]].push(a);return this},one:function(a,d){var e=this,h=$.proxy(d,function(f){setTimeout(function(){e.unbind(f.type,h)},3);return d.apply(this,arguments)});return this.bind(a,
h)},open:function(a){var d=this;a=d.window;var e=d.node;d._open=!0;d.openDfd=new t;d.closed()?(d.navbar.attr("style",""),d._open=!0,d.state=1,e&&e.trigger("scrolltoview"),a.css(d.closedCss(e)).show().animate(d.openedCss(),550,function(){d.state=2;d.update(1,d.value);d.openDfd.resolve()})):d.openDfd.resolve();return d.openDfd},close:function(a){this._open=!1;var d=this,e=d.window,h=d.preview.trigger("change");a=d.node;var f=function(){d.state=0;e.hide();h.children().remove();d.update(0,d.value);d.closeDfd&&
d.closeDfd.resolve()};d.opened()&&(d.state=1,e.is("."+d.fullscreen)&&d.fsicon.mousedown(),a&&a.length?e.animate(d.closedCss(a),500,f):f());return d.closeDfd},getstate:function(){return 2==this.state?1:0},exec:function(){this.window.trigger(this.opened()?"close":"open")},hideinfo:function(){this.info.stop(!0).hide()}});e=m(e,{destroy:function(){this.close();this.preview.trigger($.Event("update",{file:null}));this.inherited(arguments);g.destroy(this._editor);g.destroy(this.preview);g.destroy(this.window)},
onOpened:function(){var a=this;a.fm={url:function(d,e,h){return a.delegate.getImageUrl(d,e,h)}};a.preview.trigger($.Event("update",{file:a.item}))},onClosed:function(){},onAnimate:function(){}});m=m(e,{resize:function(){this.preview.trigger("changesize")},constructor:function(a){this.parent=$(a._parent.containerNode);this.container=a._parent.containerNode;this.resizeToParent=!0;this.delegate=a.ctx.getFileManager();this.item=a.item;this.buildRenderingEmbedded();this.domNode=this.info[0]},openItem:function(a){this.id=
g.createUUID();w.add(this);this.item=a||this.item;this.init();this.exec();this.window.css({height:"100%",width:"100%"});this._parent.add(this,null,!1);this.preview.trigger($.Event("update",{file:this.item}));this._parent.resize();this.resize()}});e.EditorClass=m;return e})},"xfile/views/FilePicker":function(){define("dcl/dcl xide/types xide/utils xide/factory module xide/_base/_Widget xdocker/Docker2 xfile/ThumbRenderer dojo/promise/all xfile/Breadcrumb".split(" "),function(m,k,g,e,a,d,t,w,p,r){return m(d,
{declaredClass:"xfile.views.FilePicker",templateString:'\x3cdiv class\x3d"FilePicker"\x3e\x3c/div\x3e',resizeToParent:!0,docker:null,dockerOptions:{resizeToParent:!0},breadcrumb:null,leftStore:null,rightStore:null,storeOptionsMixin:null,storeOptions:null,leftGrid:null,leftGridArgs:null,rightGrid:null,rightGridArgs:null,removePermissions:[k.ACTION.OPEN_IN_TAB],defaultGridArgs:{registerEditors:!1,_columns:{Name:!0,Path:!1,Size:!1,Modified:!1}},selection:null,mount:"root",_selection:null,getDocker:function(){if(this.docker)return this.docker;
var a=this.dockerOptions||{resizeToParent:!0},a=this.docker||t.createDefault(this.domNode,a);a.resizeToParent=!0;this.add(a,null,!1);return this.docker=a},createLayout:function(){var a=this.getDocker();this.layoutTop=a.addPanel("DefaultFixed",k.DOCKER.DOCK.TOP,null,{h:50,title:!1});this.layoutTop._minSize.y=50;this.layoutTop._maxSize.y=50;this.layoutTop._scrollable={x:!1,y:!1};this.breadcrumb=g.addWidget(r,{},null,this.layoutTop,!0);this.layoutLeft=a.addPanel("DefaultFixed",k.DOCKER.DOCK.BOTTOM,null,
{w:100,title:!1});this.layoutLeft._minSize.x=150;this.layoutLeft.moveable(!0);this.layoutMain=a.addPanel("DefaultFixed",k.DOCKER.DOCK.RIGHT,this.layoutLeft,{w:"70%",title:!1});this.layoutTop.initSize(100,"100%");this.layoutLeft.initSize("100%",150);a.resize()},setSelection:function(a){this._selection=a},connectGrids:function(a,c){var d=this;c._on("selectionChanged",function(a){"deselect"!==a.why&&(a=c.getSelection(),c.getSelectedItem()&&d.setSelection(a))});a._on("selectionChanged",function(e){e=
a.getSelection();var h=a.getSelectedItem();h||(h=a.getCurrentFolder());if(h){var f=null;h.directory?f=h:(h.getParent||console.error("item has no item.getParent!"),f=h.getParent?h.getParent():null);f&&c.openFolder(f.path,!1);h&&d.setSelection(e)}})},createFileGrid:function(a,c,d){return this.Module.createDefault(this.ctx,d,c,!1,!0,a)},onLeftGridReady:function(a){},onRightGridReady:function(a){},onError:function(a,c){},startGrids:function(a,c){var d=this,e=a.collection,h=c.collection,f={focus:!0,append:!1},
b=[a.refresh(),c.refresh()],l=this.selection,u=g.pathinfo(l,k.PATH_PARTS.ALL).dirname||"";"."===u&&(u=l);a.showStatusbar&&a.showStatusbar(!1);a._on("changeSource",function(b){c.changeSource(b,!0)});a._on("changedSource",function(b){a.select([0],null,!0,f)});c._on("changeSource",function(b){a.changeSource(b,!0)});c._on("changedSource",function(b){a.select([0],null,!0,f)});p(b).then(function(){d.onLeftGridReady(a);d.onRightGridReady(c);d.getDocker().resize();p([e.getItem(u,!0),h.getItem(u,!0)]).then(function(b){p(_.invoke([a],
"openFolder",u)).then(function(){p(_.invoke([a,c],"select",[l],null,!0,f)).then(function(){l._selection=l;d.connectGrids(a,c)},function(b){d.onError(b,"selecting items")})},function(b){d.onError(b,"open folder")})},function(b){d.onError(b,"loading items")})},function(b){d.onError(err,"refresh grid")})},setupBreadcrumb:function(a,c,d){function e(b,a,c){h.grid!=c&&h.setSource(c);h.clear();h.setPath(".",f.getRootItem(),a.getPath(),b)}var h=this.breadcrumb;a.getCurrentFolder();var f=a.collection,b=c.collection;
h.setSource(a);this.addHandle("click",a.on("click",function(){h.setSource(a)}));this.addHandle("click",c.on("click",function(){h.setSource(c)}));a._on("openFolder",function(b){e(f,b.item,a)});c._on("openFolder",function(f){e(b,f.item,c)})},destroy:function(){g.destroy(this.leftStore);g.destroy(this.rightStore);g.destroy(this.leftGrid);g.destroy(this.rightGrid);g.destroy(this.breadcrumb);g.destroy(this.docker)},startup:function(){this.createLayout();var a=this.layoutLeft,c=this.layoutMain,d=this.ctx,
t=d.config,h=this.mount||"root",f=this.storeOptions,b=this.storeOptionsMixin||{includeList:"*.jpg,*.png",excludeList:"*"},l=this.leftStore||e.createFileStore(h,f,t,b,d),d=this.rightStore||e.createFileStore(h,f,t,b,d),h=this.layoutMain,t=g.mixin({},g.clone(this.defaultGridArgs)),u=this.removePermissions,h=g.mixin(t,this.leftGridArgs||{newTarget:h});_.remove(h.permissions,function(b){return-1!==_.indexOf(u,b)});this.leftGrid=a=this.leftGrid||this.createFileGrid(l,a,h);l=g.mixin(t,this.rightGridArgs||
{selectedRenderer:w});_.remove(l.permissions,function(b){return-1!==_.indexOf(u,b)});this.rightGrid=c=this.rightGrid||this.createFileGrid(d,c,l);return this.startGrids(a,c)}})})},"xfile/Breadcrumb":function(){define(["dcl/dcl","xide/widgets/TemplatedWidgetBase","xide/model/Path","xide/_base/_Widget"],function(m,k,g,e){return m(e,{templateString:"\x3cul attachTo\x3d'root' style\x3d'-webkit-app-region:drag' class\x3d'breadcrumb'\x3e\x3c/ul\x3e",grid:null,destroy:function(){this.clear();this.grid=null},
setSource:function(a){if(this.grid!=a){this.grid=a;var d=a.collection;this.clear();var e=a.getBreadcrumbPath?a.getBreadcrumbPath():null;!1!==e&&(e?this.setPath(e.root,null,e,null):d&&a.getCurrentFolder&&(a=(a=a.getCurrentFolder())?a.path:"",this.setPath(".",d.getRootItem(),a,d)))}},setPath:function(a,d,e,w,p){this.clear();d&&a&&this.addSegment(a,!0,d);a=(new g(e)).getSegments();var r=p||".";_.each(a,function(a){var c=r+"/"+a;this.addSegment(a,!0,w?w.getSync(c):null);r=c},this)},onClick:function(a,
d,e){this._emit("click",{element:e,event:d,label:a,data:e.data})},addSegment:function(a,d,e){if(e&&this.has(e))return null;var g=this;a=$("\x3cli class\x3d'"+(d?"active":"")+"'\x3e\x3ca href\x3d'#'\x3e"+a+"\x3c/a\x3e\x3c/li\x3e");_.each(this.all(),function(a){a.el.removeClass("active")});$(this.domNode).append(a);e&&(a.on("click",function(a){g.grid&&g.grid.openFolder(e)}),a[0].data=e);return a},pop:function(){this.last().remove()},last:function(){return $(this.root).children().last()},has:function(a){for(var d=
this.all(),e=0;e<d.length;e++)if(d[e].data.path===a.path)return!0;return!1},all:function(){var a=[];_.each(this.$root.children(),function(d){a.push({el:$(d),label:d.outerText,data:d.data})});return a},clear:function(){for(var a=this.all();a.length;){var d=a[a.length-1];d.el.remove();d.data=null;a.remove(d)}},unwind:function(a){var d=this.all().reverse();_.each(d,function(d){d.data&&d.data.path!==(a&&a.path)&&"."!==d.data.path&&this.pop()},this)},startup:function(){this._on("click",function(a){a=a.element[0].data;
var d=this.grid;a&&(this.unwind(a),d&&d.openFolder(a))}.bind(this))}})})},"xfile/Statusbar":function(){define(["xdojo/declare","xide/types","xfile/Breadcrumb"],function(m,k,g){return m("xgrid.Statusbar",null,{statusbar:null,setState:function(e){this.showStatusbar(e.statusBar);return this.inherited(arguments)},getState:function(e){e=this.inherited(arguments)||{};e.statusBar=null!=this.statusbar;return e},runAction:function(e){e.command==k.ACTION.STATUSBAR&&this.showStatusbar(this.statusbar?!1:!0);
return this.inherited(arguments)},showStatusbar:function(e,a){!e&&this.statusbar?this._destroyStatusbar():e&&this.getStatusbar();this.resize();this._statusbarAction&&!0!==a&&this._statusbarAction.set("value",e)},_destroyStatusbar:function(){this.statusbarRoot&&this.statusbarRoot.remove();this.statusbarRoot=this.statusbar=null},_statusbarAction:null,buildRendering:function(){this.inherited(arguments);var e=this;this._on("onAddActions",function(a){var d=a.actions,g=k.ACTION.STATUSBAR;a.store.getSync(g)||
(a=e.createAction({label:"Statusbar",command:g,icon:k.ACTION_ICON.STATUSBAR,tab:"View",group:"Show",mixin:{actionType:"multiToggle"},onCreate:function(a){a.set("value",null!==e.statusbar);e._statusbarAction=a},onChange:function(a,d,g){e.showStatusbar(d,!0)}}),d.push(a))})},getStatusbar:function(){return this.statusbar?this.statusbar:this.createStatusbar()},onRenderedStatusBar:function(e,a,d){e=this.__bc;!e&&a&&a.append&&(e=new g({},$("\x3cdiv\x3e")),a.append(e.domNode),$(e.domNode).css({"float":"right",
padding:0,"margin-right":10,top:0,right:50,position:"absolute"}),this.__bc=e,e.setSource(this));e&&(e.clear(),a=this.collection,d=(d=this.getCurrentFolder())?d.path:"",e.setPath(".",a.getRootItem(),d,a))},onStatusbarCollapse:function(e){},createStatusbar:function(e){e=e=this.footer;var a=this.statusbar,d=this;if(!a){var g=$('\x3cdiv class\x3d"statusbar widget" style\x3d"width:inherit;padding: 0;margin:0;padding-left: 4px;"\x3e\x3c/div\x3e')[0];e.appendChild(g);a=$('\x3cdiv class\x3d"status-bar-text ellipsis" style\x3d"display: inline-block;"\x3e0 items selected\x3c/div\x3e')[0];
g.appendChild(a);var w=$('\x3cdiv class\x3d"status-bar-collapser fa-caret-up" style\x3d"" \x3e\x3c/div\x3e');w.click(function(a){d.onStatusbarCollapse(w)});e=w[0];g.appendChild(e);this.statusbar=a;this.statusbarCollapse=e;this.statusbarRoot=g;this._emit("createStatusbar",{root:g,statusbar:a,collapser:e})}return a},startup:function(){function e(a){if(0==a)return"0 Byte";var d=parseInt(Math.floor(Math.log(a)/Math.log(1024)));return Math.round(a/Math.pow(1024,d),2)+" "+["Bytes","KB","MB","GB","TB"][d]}
function a(a){var d=0,g="0 KB";_.each(a,function(a){d+=a.sizeBytes||0});0<d&&(g=e(d));return{bytes:d,sizeStr:g}}this.inherited(arguments);if(this.hasPermission(k.ACTION.STATUSBAR)){var d=this.getStatusbar(),g=this;d&&this._on("selectionChanged",function(e){var p=e.selection||[];e=p.length;p=a(p);e=e+"  "+g.localize("selected")+" ("+p.sizeStr+")";d.innerHTML=e;if(g.onRenderedStatusBar)g.onRenderedStatusBar(d,g.statusbarRoot,e)})}}})})},"xfile/views/UploadMixin":function(){define(["xdojo/declare","xide/utils",
"xide/types","dojo/promise/all"],function(m,k,g,e){return m("xfiles.views.UploadMixin",null,{cssClass:"uploadFilesList droparea dropareaHover",__currentDragOverRow:null,__currentDragOverTimer:null,__currentDragOverTimeRow:null,buildRendering:function(){this.inherited(arguments);$(this.domNode).addClass(this.cssClass)},_createUploadItemTemplate:function(a,d,e){return'\x3cdiv class\x3d"" style\x3d"position: relative;margin: 0.1em;height: auto"\x3e\x3cdiv style\x3d"margin:0;vertical-align: middle;padding: 1px;" class\x3d"progress" role\x3d"progressbar" aria-valuemin\x3d"0" aria-valuemax\x3d"100"\x3e\x3cdiv class\x3d"progress-bar progress-bar-info" style\x3d"width:'+
d+';background-color: rgba(102, 161, 179, 0.35);height:auto;magin:0;"\x3e\x3cspan class\x3d"'+(e.failed?"text-danger":"text-info")+'" style\x3d"left: 0px"\x3e'+a+"\x3c/span\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e"},_createUploadItems:function(a){function d(a){var c={sizeBytes:k.humanFileSize(a.size),size:k.humanFileSize(a.size),name:a.name,type:a.type,path:p.path+"/"+a.name+"__uploading__"+Math.random(2),isDir:!1,mount:p.mount,parent:p.path,progress:0,isUpload:!0,modified:a.lastModified/1E3,renderColumn:function(a,
c,d){if("name"===a)return e._createUploadItemTemplate(d.name,d.progress+"%",d);if("sizeBytes"===a&&100>d.progress)return k.humanFileSize(d.loaded)+" of "+k.humanFileSize(d.total)}};g.putSync(c);c=g.getSync(c.path);return a._item=c}var e=this,g=this.collection,p=this.getCurrentFolder();this.__currentDragOverRow&&(p=this.__currentDragOverRow.data);var r=[];_.each(a,function(a){r.push(d(a))});return r},_onAllUploaded:function(a){a=this._toUploadItems(a);var d=this;_.each(a,function(a){var d=a._store?
a:a._item;d&&(d.progress=d.failed?0:100,d.refresh(),setTimeout(function(){d.remove()},1))});setTimeout(function(){d.runAction(g.ACTION.RELOAD).then(function(){})},1)},_onBrowserFilesDropped:function(a,d,e){var g=this.ctx.getFileManager(),p=a.getCurrentFolder();this.__currentDragOverRow&&(p=this.__currentDragOverRow.data);this._createUploadItems(d);return g.upload(d,p.mount,p?p.path:"./tmp",a,e)},_onUploadFailed:function(a){a&&(a.failed=!0,a.done=!0)},_onSomeFileUploaded:function(a){var d=this;a&&
(a.progress=100,a.done=!0,a.renderColumn=null,a.renderRow=null,a.refresh(),setTimeout(function(){d.runAction(g.ACTION.RELOAD).then(function(){});a.remove()},1));return!0},_toUploadItems:function(a){var d=[];_.each(a,function(a){_.each(a,function(a){d.push(a)})});return d},_toUploadStoreItem:function(a){return a.file._item},onBrowserFilesDropped:function(a,d){function g(){var a=0;_.each(r,function(d){d.done&&a++});a==r.length&&p._onAllUploaded(d)}var k=this._onBrowserFilesDropped(this,d,a),p=this,
r=p._toUploadItems(d),q=1==r.length;e(k).then(this._onAllUploaded.bind(this,[d]));_.each(k,function(a){a.then(function(a){!q&&p._onSomeFileUploaded(p._toUploadStoreItem(a))&&g()},function(a){p._onUploadFailed(p._toUploadStoreItem(a));q&&p._onAllUploaded(d);!q&&g()},function(a){var c=a.progress;a=a.item.file._item;var d=Math.round(100*c.loaded/c.total);a&&(a.progress=d,a.loaded=c.loaded,a.total=c.total,a.refresh())})})},onBrowserUrlDropped:function(a,d){if(this.delegate&&this.delegate.onBrowserUrlDropped)this.delegate.onBrowserUrlDropped(this,
d)},dragEnter:function(a){a.preventDefault()},dragLeave:function(a){},dragOver:function(a){a.preventDefault();if(this.row){var d=this;a=this.row(a);var e=this.__currentDragOverRow,g=e?e.data:null;this.__currentDragOverRow&&$(this.__currentDragOverRow.element).removeClass("dgrid-focus");a&&a.element&&a.data&&!0===a.data.directory?(this.__currentDragOverTimer||(d.__currentDragOverTimeRow=a,d.__currentDragOverTimer=setTimeout(function(){var a=d.__currentDragOverTimeRow.data;a&&g&&a==g?(d.__currentDragOverTimeRow=
null,d.__currentDragOverTimer=null,d.openFolder(a)):d.__currentDragOverTimer=null},1550)),this.__currentDragOverRow=a,$(a.element).addClass("dgrid-focus")):this.__currentDragOverRow=null}},drop:function(a){a.preventDefault();var d=a.dataTransfer;if(d)if((d=d.files)&&d.length){if(this.onBrowserFilesDropped)this.onBrowserFilesDropped(this,d)}else try{var e=a.dataTransfer.getData("text/plain");if(e&&e.length)this.delegate.onBrowserUrlDropped(this,e)}catch(g){console.error("dropping url failed "+g)}},
initDND:function(){var a=this,d=this.domNode;d?(d.addEventListener("dragover",function(d){a.dragOver(d)},!1),d.addEventListener("drop",function(d){d.preventDefault();a.drop(d)},!1)):console.error("have not drop destination")},startup:function(){if(!this._started){var a=this.inherited(arguments);this.initDND();return a}}})})},"xfile/FolderSize":function(){define("xdojo/declare xide/types xide/utils xfile/Breadcrumb xide/layout/_TabContainer xfile/views/FileSize".split(" "),function(m,k,g,e,a,d){return m("xfile.FolderSize",
null,{__sizeDisplay:null,__bottomTabContainer:null,__bottomPanel:null,__sizesTab:null,showStats:function(e){var k=this.getBottomTabContainer(),p=this.__sizesTab,r=this.__sizeDisplay,q=this,c=this._getBottom(),n=c&&c.isExpanded();if(1==n&&c)e=!1;else if(!n&&c)return c.expand();if(e){c||(c=this.getBottomPanel(!1,.2));if(c&&r)return c.expand();k||(this.__bottomTabContainer=k=e=g.addWidget(a,{direction:"below"},null,c,!0),c._tabs=e);p||(p=this.__sizesTab=k.createTab("Sizes","fa-bar-chart"));r||(r=this.__sizeDisplay=
p.add(d,{owner:q},null,!1),r.startup(),this._on("openedFolder",function(a){g.destroy(q.__sizeDisplay);p.resize();q.resize();q.__sizeDisplay=null;q.__sizeDisplay=g.addWidget(d,{owner:q},null,p,!1);g.resizeTo(q.__sizeDisplay,p,!0,!0);q.__sizeDisplay.startup()}))}else c&&c.collapse()},_runAction:function(a){var d=this.getAction(a);return d&&d.command==k.ACTION.SIZE_STATS?this.showStats(this.__sizeDisplay?!1:!0):this.inherited(arguments)},buildRendering:function(){this.inherited(arguments);this._on("onAddActions",
function(a){})}})})},"xfile/views/FileSize":function(){define(["dcl/dcl","xide/_base/_Widget"],function(m,k){return m(k,{_find:function(g,e){var a=_.find(e,{path:g}),d=this;if(a&&a.children&&a.children){var t=d._find(g,a.children);t&&(a=t)}a||_.each(e,function(e){var t=null;e.children&&e.children.length&&(t=d._find(g,e.children))&&(a=t)});return a},select:function(g){(g=this._find(g,this.d3Nodes))&&this.highlight(g)},direction:"left",templateString:'\x3cdiv class\x3d"sizeDisplay tabbable tabs-${!direction}" attachTo\x3d"containerNode" style\x3d"width: inherit;height: 100%;padding: 4px"\x3e\x3cul class\x3d"nav nav-tabs tabs-right" role\x3d"tablist"\x3e\x3cli class\x3d"active"\x3e\x3ca href\x3d"#_tab-content2_${!id}" data-toggle\x3d"tab"\x3eOverall\x3c/a\x3e\x3c/li\x3e\x3cli\x3e\x3ca href\x3d"#_tab-content1_${!id}" data-toggle\x3d"tab"\x3eBy Type\x3c/a\x3e\x3c/li\x3e\x3c/ul\x3e\x3cdiv class\x3d"body tab-content"\x3e\x3cdiv attachTo\x3d"tab2" id\x3d"_tab-content2_${!id}" class\x3d"tab-pane active clearfix"\x3e\x3cdiv class\x3d"chart1" attachTo\x3d"chart1" style\x3d"width: 100%;height: inherit;min-height:250px"\x3e\x3cdiv class\x3d"" style\x3d"" id\x3d"detailInfo"\x3e\x3c/div\x3e\x3cdiv class\x3d"widget" id\x3d"explanation" \x3e\x3cspan id\x3d"percentage"\x3e\x3c/span\x3e\x3cbr/\x3e\x3cspan id\x3d"percentageDetail"\x3e\x3c/span\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv attachTo\x3d"tab1" id\x3d"_tab-content1_${!id}" class\x3d"tab-pane"\x3e\x3csvg class\x3d"chart2" style\x3d"width: 100%;height: inherit;min-height:250px"\x3e\x3c/svg\x3e\x3cdiv id\x3d"tooltip" class\x3d"hidden"\x3e\x3cspan id\x3d"chart2Per1"\x3eA\x3c/span\x3e \x3cbr\x3e\x3cspan id\x3d"chart2Per2"\x3e100\x3c/span\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e',
data:null,owner:self,vis:null,d3Nodes:null,colors:{dir:"#5687d1",jpeg:"#9b59b6",jpg:"#9b59b6",png:"#9b59b6",gif:"#9b59b6",psd:"#9b59b6",mp3:"#3498db",wav:"#3498db",wma:"#3498db",wmv:"#2ecc71","3gp":"#2ecc71",mp4:"#2ecc71",plv:"#2ecc71",mpg:"#2ecc71",mpeg:"#2ecc71",mkv:"#2ecc71",rm:"#2ecc71",rmvb:"#2ecc71",mov:"#2ecc71",doc:"#1abc9c",xls:"#1abc9c",ppt:"#1abc9c",docx:"#1abc9c",xlsx:"#1abc9c",pptx:"#1abc9c",pages:"#e74c3c",key:"#e74c3c",numbers:"#e74c3c",pdf:"#7b615c",epub:"#7b615c",c:"#f1c40f",cpp:"#f1c40f",
h:"#f1c40f",html:"#f1c40f",js:"#f1c40f",css:"#f1c40f",pl:"#f1c40f",py:"#f1c40f",php:"#f1c40f",sql:"#f1c40f",csv:"#de783b",odp:"#de783b",gz:"#6ab975",tar:"#6ab975",rar:"#6ab975",zip:"#6ab975","7z":"#6ab975","default":"#34495e"},totalSize:0,result:{},overallSize:0,buildHierarchy:function(g){for(var e={name:"root",children:[]},a=0;a<g.length;a++){var d=g[a][0],t=+g[a][1];if(!isNaN(t))for(var k=d.split("/"),p=e,r=0;r<k.length;r++){var q=p.children,c=k[r],n;if(r+1<k.length){for(var p=!1,m=0;m<q.length;m++)if(q[m].name==
c){n=q[m];p=!0;break}p||(n={name:c,type:"dir",children:[],path:d},q.push(n));p=n}else n=c.split(".").pop(),7>n.length&&(this.result[n]=n in this.result?this.result[n]+t:t),n={name:c,type:n,size:t,path:d},this.overallSize+=t,q.push(n)}}return e},bytesToSize:function(g){var e=["Bytes","KB","MB","GB","TB"];if(0==g)return"n/a";var a=parseInt(Math.floor(Math.log(g)/Math.log(1024)));return 0==a?g+" "+e[a]:(g/Math.pow(1024,a)).toFixed(1)+" "+e[a]},getAncestors:function(g){for(var e=[];g.parent;)e.unshift(g),
g=g.parent;return e},highlight:function(g){if(g){var e=(100*g.value/this.totalSize).toPrecision(3),a=e+"%";.1>e&&(a="\x3c 0.1%");var d=this.bytesToSize(g.value)+"/"+this.bytesToSize(this.totalSize),e=this.colors;d3.select("#percentage").text(a);d3.select("#percentageDetail").text(d);d3.select("#explanation").style("visibility","");var t=this.getAncestors(g);g=t.length;a="";for(d=0;d<g;d++)var k=t[d].type,a="dir"==k?a+('\x3cspan style\x3d"color:'+e[k]+'"\x3e'+t[d].name+"/\x3c/span\x3e"):a+('\x3cspan style\x3d"color:'+
e[k]+'"\x3e'+t[d].name+"\x3c/span\x3e");$("#detailInfo").html(a);d3.selectAll("path").style("opacity",.3);this.vis.selectAll("path").filter(function(a){return 0<=t.indexOf(a)}).style("opacity",1)}else console.error("cant find "+path)},createChart1:function(g,e,a,d,k){function m(a){var c=(100*a.value/r.totalSize).toPrecision(3),d=c+"%";.1>c&&(d="\x3c 0.1%");c=r.bytesToSize(a.value)+"/"+r.bytesToSize(r.totalSize);d3.select("#percentage").text(d);d3.select("#percentageDetail").text(c);d3.select("#explanation").style("visibility",
"");var g=r.getAncestors(a);a=g.length;d="";for(c=0;c<a;c++)var h=g[c].type,d="dir"==h?d+('\x3cspan style\x3d"color:'+p[h]+'"\x3e'+g[c].name+"/\x3c/span\x3e"):d+('\x3cspan style\x3d"color:'+p[h]+'"\x3e'+g[c].name+"\x3c/span\x3e");$("#detailInfo").html(d);d3.selectAll("path").style("opacity",.3);e.selectAll("path").filter(function(a){return 0<=g.indexOf(a)}).style("opacity",1)}e.append("svg:circle").attr("r",k).style("opacity",0);var p=this.colors,r=this;a=d3.layout.partition(k).size([2*Math.PI,k*
k]).value(function(a){return a.size}).nodes(g,k).filter(function(a){return.005<a.dx});d=d3.svg.arc().startAngle(function(a){return a.x}).endAngle(function(a){return a.x+a.dx}).innerRadius(function(a){return Math.sqrt(a.y)}).outerRadius(function(a){return Math.sqrt(a.y+a.dy)});g=e.data([g]).selectAll("path").data(a).enter().append("svg:path").attr("display",function(a){return a.depth?null:"none"}).attr("d",d).attr("fill-rule","evenodd").style("fill",function(a){return p[a.type]?p[a.type]:p["default"]}).style("opacity",
1).on("mouseover",m);d3.select("#container").on("mouseleave",function(a){d3.select("#trail").style("visibility","hidden");d3.selectAll("path").on("mouseover",null);d3.selectAll("path").transition().duration(1E3).style("opacity",1).each("end",function(){d3.select(this).on("mouseover",m)});d3.select("#explanation").transition().duration(1E3).style("visibility","hidden");$("#detailInfo").html("")});this.totalSize=g.node().__data__.value;return a},render:function(g){var e=$(this.tab2),a=e.height()-50,
e=e.height()-50;400>a&&(a=400);300>e&&(e=300);var d=e,k=d3.select(this.chart1).append("svg:svg").attr("width",a).attr("height",e).append("svg:g").attr("id","container").attr("transform","translate("+e/2+","+e/2+")"),a=this.createChart1(g,k,a,e,d/4,k);g=[];for(var m in this.result)if(d=this.result[m]/this.overallSize,!(.001>d)){var p=this.bytesToSize(this.result[m])+"/"+this.bytesToSize(this.overallSize);g.push({filetype:m,usage:d,detail:p})}this.vis=k;this.d3Nodes=a;a=$(this.tab1).width();400>a&&
(a=400);this.createChart2(g,a,e-100)},createChart2:function(g,e,a){var d=d3.scale.ordinal().rangeRoundBands([0,e],.1),k=d3.scale.linear().range([a,0]),m=d3.svg.axis().scale(d).orient("bottom"),p=d3.svg.axis().scale(k).orient("left"),r=this.colors;e=d3.select(this.tab1.children[0]).attr("width",e+40+30).attr("height",a+20+30).append("g").attr("transform","translate(40,20)");d.domain(g.map(function(a){return a.filetype}));k.domain([0,d3.max(g,function(a){return a.usage})]);e.append("g").attr("class",
"x axis").attr("transform","translate(0,"+a+")").call(m);e.append("g").attr("class","y axis").call(p);e.selectAll(".bar").data(g).enter().append("rect").attr("class","bar").attr("id",function(a){return"bar"+a.filetype}).attr("x",function(a){return d(a.filetype)}).attr("y",function(a){return k(a.usage)}).attr("height",function(d){return a-k(d.usage)}).attr("width",d.rangeBand()).attr("fill",function(a){return r[a.filetype]?r[a.filetype]:r["default"]}).on("mouseover",function(e){d3.select(this).transition().duration(50).attr("fill",
"#7f8c8d");var c=parseFloat(d3.select(this).attr("x"))+d.rangeBand()/2,g=parseFloat(d3.select(this).attr("y"))/2+a/2,k=parseFloat(100*e.usage).toFixed(2)+"%("+e.filetype+")";d3.select("#tooltip").style("left",c+"px").style("top",g+"px").select("#chart2Per2").text(e.detail);d3.select("#chart2Per1").text(k);d3.select("#tooltip").classed("hidden",!1)}).on("mouseout",function(){d3.select(this).transition().delay(100).duration(250).attr("fill",function(a){return r[a.filetype]?r[a.filetype]:r["default"]});
d3.select("#tooltip").classed("hidden",!0)})},startup:function(){if(this.owner){var g=this.owner,e=g.getRows(),a=[];_.each(e,function(d){a.push([d.path.replace("./",""),""+d.sizeBytes])});e=this.buildHierarchy(a);this.render(e);var d=this;g._on("selectionChanged",function(a){if("clear"!=a.why){a=(a=a.selection)?a[0]:null;var e=g.row(a),e=e?e.element:null;a&&e&&(a=a.path.replace("./",""),d.d3Nodes&&d.select(a))}})}}})})},"xfile/views/FileGrid":function(){define("xdojo/declare dojo/Deferred xide/types xide/utils xide/views/History xaction/DefaultActions xfile/views/Grid xfile/factory/Store xide/model/Path xfile/model/File xfile/types xlang/i18 xide/$".split(" "),
function(m,k,g,e,a,d,t,w,p,r,q,c,n){p=q.DEFAULT_FILE_GRID_PERMISSIONS;var v=m("xfile.views.FileGrid",t,{resizeAfterStartup:!0,formatters:{},menuOrder:{File:110,Edit:100,View:50,Settings:20,Navigation:10,Window:5},groupOrder:{Clipboard:110,File:100,Step:80,Open:70,Organize:60,Insert:10,Navigation:5,Select:0},tabOrder:{Home:100,View:50,Settings:20,Navigation:10},noDataMessage:"\x3cspan/\x3e",_history:null,options:e.clone(g.DEFAULT_GRID_OPTIONS),_columns:{},toolbarInitiallyHidden:!0,itemType:g.ITEM_TYPE.FILE,
permissions:p,contextMenuArgs:{limitTo:null,actionFilter:{quick:!0}},setState:function(a){this.inherited(arguments);var f=this,b=f.collection,c=a.store.path;b.getSync(c);var d=f.refresh();d.then(function(){b.getItem(c,!0).then(function(b){f.openFolder(b)})});return d},postMixInProperties:function(){var a=this.state;a&&a._columns&&(this._columns=a._columns);this.columns||(this.columns=this.getColumns());!this.collection&&this.state&&(a=this.state.store,this.collection=w.createFileStore(a.mount,a.storeOptions,
this.ctx.config).getDefaultCollection());return this.inherited(arguments)},getState:function(a){a=this.inherited(arguments)||{};a.store={mount:this.collection.mount,path:this.getCurrentFolder().path,storeOptions:this.collection.options};a._columns={};_.each(this._columns,function(f){a._columns[f.label]=!this.isColumnHidden(f.id)},this);return a},onSaveLayout:function(a){a=a.data;var f=this.getState();a.widgets.push({widget:this.declaredClass,state:f});return a},formatColumn:function(a,f,b){var d=
this.selectedRenderer?this.selectedRenderer.prototype:this;if(d.formatColumn&&(d=d.formatColumn.apply(arguments))||b.renderColumn&&(d=b.renderColumn.apply(this,arguments)))return d;switch(a){case "fileType":if("folder"==f)return c.localize("kindFolder");if(b.mime){var d="kind"+(b.mime.split("/")[1]||"unknown").toUpperCase(),u=c.localize(d);return d!==u?u:f}case "name":var u=b&&null!=b.directory&&!0===b.directory,g=!1===b.read&&!1===b.write,k=".."==b.name,d="",d=u?k?"fa fa-level-up itemFolderList":
g?"fa fa-lock itemFolderList":"fa fa-folder itemFolderList":g?"fa fa-lock itemFolderList":"itemFolderList fa "+e.getIconClass(b.path),u=!0===b.showPath?b.path:f;return'\x3cspan class\x3d"'+d+'""\x3e\x3c/span\x3e\x3cspan class\x3d"name fileGridNameNode" style\x3d"vertical-align: middle;padding-top: 0px"\x3e'+u+"\x3c/span\x3e";case "sizeBytes":return b.size;case "fileType":return e.capitalize(b.fileType||"unknown");case "mediaInfo":return b.mediaInfo||"unknown";case "owner":return b&&(d=b.owner)&&d.user?
d.user.name:"";case "modified":if(""===f)break;u=null==!b.directory;return!u&&c.translations.dateFormat?c.formatDate(f).replace("ms",""):""}return f},getColumns:function(a){function f(f,d,c,e){null!=b._columns[f]&&(e=!b._columns[f]);b.columns.push({renderExpando:"Name"===f,label:f,field:d,sortable:c,formatter:function(c,e){return f in a?a[f].apply(b,[d,c,e]):b.formatColumn(d,c,e)},hidden:e})}a=a||this.formatters;var b=this;this.columns=[];f("Name","name",!0,!1);f("Type","fileType",!0,!0);f("Path",
"path",!0,!0);f("Size","sizeBytes",!0,!1);f("Modified","modified",!0,!1);f("Owner","owner",!0,!0);f("Media","mediaInfo",!0,!0);return this.columns},_focus:function(){var a=this.getRows();a[0]&&this.focus(this.row(a[0]))},setQueryEx:function(a){if(!a||!a.directory)return!1;this._lastPath=a.getPath();var f=this,b=new k,d=f.collection;"."===a.path?(d.resetQueryLog(),f.set("collection",d.getDefaultCollection(a.getPath())),b.resolve()):d.open(a).then(function(c){d.resetQueryLog();f.set("collection",d.getDefaultCollection(a.getPath()));
b.resolve(c)});return b},getCurrentFolder:function(){var a=this.getSelectedRenderer();if(a&&a.getCurrentFolder&&(a=a.getCurrentFolder.apply(this))){if(a.isBack){var f=this.collection.getSync(a.rPath);f&&(a=f)}return a}if((a=this.getRows()[0])&&(a._S||a._store)){if(!0===a.isBack&&(f=this.getHistory().getNow()))return this.collection.getSync(f);if(a=a._S.getParent(a))return a}return null},getClass:function(){return v},getHistory:function(){this._history||(this._history=new a);return this._history},
_createBackItem:function(a){return{name:"..",path:"..",rPath:a,sizeBytes:0,size:"",icon:"fa-level-up",isBack:!0,modified:"",_S:this.collection,directory:!0,_EX:!0,children:[],mayHaveChildren:!1}},startup:function(){if(!this._started){var c=this.inherited(arguments);n(this.domNode).addClass("xfileGrid");this.set("loading",!0);this.permissions&&this.addActions([].concat(d.getDefaultActions(this.permissions,this,this).concat(this.getFileActions(this.permissions))));this._history=new a;var f=this;this.subscribe(g.EVENTS.ON_CLIPBOARD_COPY,
function(b){b.type===f.itemType&&(f.currentCopySelection=b.selection,f.refreshActions())});f._on("noData",function(){if(!(0<f._total)){var b=f._history.getNow();b&&"./."!==b&&f.renderArray([this._createBackItem(b)])}});this.on("dgrid-refresh-complete",function(){var b=f.getRows();b&&1<b.length&&(b=_.find(b,{isBack:!0}))&&(f.removeRow(b),f.refresh())});this._on("openFolder",function(b){f.set("title",b.item.name)});f.selectedRenderer&&(c=this.refresh())&&c.then(function(){f.set("loading",!1);f.setRenderer(f.selectedRenderer,
!1)});this._on("onChangeRenderer",this.refresh);this._emit("startup");c.then(this.resize.bind(this));return c}}});v.prototype.Module=v;v.Module=v;v.createDefault=function(a,f,b,d,c,g){g={collection:g.getDefaultCollection(),_parent:b,Module:v,ctx:a};e.mixin(g,f||{});f=e.addWidget(v,g,null,b,c,null,null,!0,null);d&&a.getWindowManager().registerView(f,!1);return f};v.DEFAULT_PERMISSIONS=p;return v})},"xfile/factory/Store":function(){define(["xide/types","xide/factory","xide/utils","xfile/data/Store"],
function(m,k,g,e){k.createFileStore=function(a,d,k,w,p,r){d=d||{fields:m.FIELDS.SHOW_ISDIR|m.FIELDS.SHOW_OWNER|m.FIELDS.SHOW_SIZE|m.FIELDS.SHOW_MIME|m.FIELDS.SHOW_PERMISSIONS|m.FIELDS.SHOW_TIME|m.FIELDS.SHOW_MEDIA_INFO};g.mixin(d,w);a=new e(g.mixin({data:[],ctx:p,config:k,url:k.FILE_SERVICE,serviceUrl:k.serviceUrl,serviceClass:k.FILES_STORE_SERVICE_CLASS,mount:a,options:d},r));a._state={initiated:!1,filter:null,filterDef:null};a.reset();a.setData([]);a.init();p&&p.getFileManager().addStore(a);return a};
return k})},"xfile/data/Store":function(){define("dojo/_base/declare dojo/_base/lang dojo/Deferred xide/mixins/ReloadMixin xide/manager/ServerActionBase dstore/Cache dstore/QueryResults xide/types xide/utils dojo/when xide/data/TreeMemory dstore/Trackable xide/data/ObservableStore xfile/model/File xide/lodash".split(" "),function(m,k,g,e,a,d,t,w,p,r,q,c,n,v,h){function f(){return{addDot:!0,recursive:!1,rootSegment:".",Model:v,idProperty:"path",parentProperty:"path",parentField:"parent",mount:"path",
options:{fields:1663,includeList:"*",excludeList:"*"},serviceUrl:null,serviceClass:null,singleton:!0,queryAccessors:!0,autoEmitEvents:!1,mayHaveChildren:function(b){return 0==b.mayHaveChildren?!1:!0===b.directory},_lastFilter:null,_lastFilterDef:null,_lastFilterItem:null,_initiated:{value:!1},id:null,_state:{initiated:!1,filter:null,filterDef:null},isInitiated:function(){return this._state.initiated},setInitiated:function(b){this._state.initiated=b},_extraSortProperties:{name:{ignoreCase:!0}},constructor:function(){this.id=
p.createUUID()},onSorted:function(b,a){if(1==b.length&&"name"===b[0].property){var f=b[0].descending,d=function(b){return b.name},c=h.groupBy(a,function(b){return!0===b.directory},this);a=h.sortBy(c["true"],d);a=a.concat(h.sortBy(c["false"],d));f&&a.reverse()}if(f=h.find(a,{name:".."}))a.remove(f),a.unshift(f);return a=this.onAfterSort(a)},onAfterSort:function(b){var a=this.micromatch;if("undefined"!==typeof mm&&a&&b&&b[0]){var f=b[0].realPath?"realPath":"path",f="name",d=h.pluck(b,f),c=mm(d,a);b=
b.filter(function(b){return-1===c.indexOf(b[f])?null:b});this._onAfterSort&&(b=this._onAfterSort(b))}return b},_createSortQuerier:function(b){var a=this;return function(f){f=f.slice();f.sort("function"==typeof b?b:function(f,d){for(var c=0;c<b.length;c++){var e;if("function"==typeof b[c])e=b[c](f,d);else{var h=b[c].property;a._extraSortProperties[h]&&p.mixin(b[c],a._extraSortProperties[h]);e=b[c].descending;var g=f.get?f.get(h):f[h],h=d.get?d.get(h):d[h],u=!!b[c].ignoreCase;null!=g&&(g=g.valueOf());
null!=h&&(h=h.valueOf());u&&(g.toUpperCase&&(g=g.toUpperCase()),h.toUpperCase&&(h=h.toUpperCase()));e=g===h?0:!!e===(null===g||g>h)?-1:1}if(0!==e)return e}return 0});return a.onSorted(b,f)}},_getItem:function(b,a){"/"===b&&(b=".");var f=this.getSync(b)||this.getSync("./"+b);return f&&(this.isItemLoaded(f)||1==a)?f:"."===b?this.getRootItem():null},getItem:function(b,a,f){b=b.replace("./","");if(0==a)return this._getItem(b);if(1==a){a=b.split("/");var c=this,d=[],e=c.getSync(b);if(e&&this.isItemLoaded(e))return e;
for(var k=new g,p=function(){if(h.find(d,{loaded:!1}))for(var a=0;a<d.length;a++){if(!d[a].loaded){var e=c.getSync(d[a].path);if(e)if(!0===e.directory&&c.isItemLoaded(e)){d[a].loaded=!0;continue}else if(null==e.directory){k.resolve(e);break}c._loadPath(d[a].path,!1,f).then(function(b){d[a].loaded=!0;p()},function(b){var f=Math.abs(Math.min(0,a-1));b=d[f];b||(f=d.length-1,b=d[f]);c.getItem(b.path);r(c.getItem(d[f].path,!1),function(b){k.resolve(b,d[f].path)})});break}}else k.resolve(c._getItem(b))},
e=".",n=0;n<a.length;n++)"."!=a[n]&&(0<a.length&&(e+="/"),e+=a[n],d.push({path:e,loaded:!1}));p();return k}return"."===b?this.getRootItem():null},getRootItem:function(){return{_EX:!0,path:".",name:".",mount:this.mount,directory:!0,virtual:!0,_S:this,getPath:function(){return this.path+"/"}}},getItemByPath:function(){},getParents:function(){return null},getParent:function(b){if(!b)return null;var a=b,f=null;k.isString(a)&&(a=this.getSync(b));a&&a.parent&&(f=this.getSync(a.parent));return f||this.getRootItem()},
isItemLoaded:function(b){return b&&(!b.directory||this._isLoaded(b))},loadItem:function(b,a){return this._loadItem(b,a)},_parse:function(b){b._S=this;h.isEmpty(b.children)||(h.each(b.children,function(a){a.parent||(a.parent=b.path);this._parse(a)},this),b._EX=!0,b.children=this.addItems(b.children));b.getPath=function(){return this.path}},_loadPath:function(b,a,f){var d=this,c=this._request(b,f);c.then(function(c){var e=d._getItem(b,!0);if(e)return a&&(h.isEmpty(e.children)||d.removeItems(e.children)),
e._EX=!0,d.addItems(c,a),e.children=c;if(f&&f.onError)f.onError("Error Requesting path on server : "+b);else throw Error("cant get item at "+b);}.bind(this),function(b){console.error("error in load")});return c},addSync:function(b,a){(a=a||{}).overwrite=!1;return this.putSync(b,a)},_loadItem:function(b,a){var f=new g,d=this;if(!b)return f.reject("need item"),f;a&&("."===b.path?(d.setInitiated(!1),d.fetchRange().then(function(a){f.resolve({store:d,items:a,item:b})})):this._loadPath(b.path,!0).then(function(a){f.resolve(b)},
function(b){console.error("error occured whilst loading items");f.reject(b)}));return f},_normalize:function(b){return b&&b.items?b.items[0]:[]},_isLoaded:function(b){return b&&!0===b._EX},fetch:function(){},put:function(){},add:function(b){var a=this.getSync(b.path);a||(a=this.addSync(b),a._S=this,a.getPath=function(){return this.path});return a},removeItems:function(b){h.each(b,function(b){this.getSync(b.path)&&this.removeSync(b.path)},this)},getSync:function(b){var a=this.storage.fullData;return a[this.storage.index[b]]||
a[this.storage.index[b.replace("./","")]]},addItems:function(b){var a=[];h.each(b,function(b){this.getSync(b.path)&&this.removeSync(b.path);a.push(this.add(b))},this);return a},open:function(b){var a=this;if(this._isLoaded(b)){var f=new g;a.resetQueryLog();f.resolve(b.children);return f}b.isLoading=!0;return a._request(b.path).then(function(f){b.isLoading=!1;b._EX=!0;a.addItems(f);return b.children=f})},getDefaultSort:function(){return[{property:"name",descending:!1,ignoreCase:!0}]},filter:function(b){if(b&&
"function"===typeof b)return this.inherited(arguments);b.parent&&(this._state.path=b.parent);var a=this.getSync(b.parent);a&&(this.isItemLoaded(a)?this._state.filterDef=null:(a.isLoading=!0,this._state.filterDef=this._loadPath(a.path),this._state.filterDef.then(function(){a.isLoading=!1})));delete this._state.filter;this._state.filter=b;return this.inherited(arguments)},_request:function(b,a){var f=this;return this.runDeferred(null,"ls",{path:b,mount:this.mount,options:this.options,recursive:this.recursive},
p.mixin({checkErrors:!1,displayError:!0},a)).then(function(a){a=f._normalize(a);f._parse(a);return a=a.children||a},function(b){a&&!1===a.displayError||logError(b,"error in FileStore : "+this.mount+" :"+b)})},fetchRangeSync:function(){var a=this.fetchSync(),f=new g;f.resolve(a.length);return new t(a,{totalLength:f})},reset:function(){this._state.filter=null;this._state.filterDef=null;this.resetQueryLog()},resetQueryLog:function(){this.queryLog=[]},fetchRange:function(){var a=this._fetchRange();return new t(a.then(function(a){return a}),
{totalLength:a.then(function(a){return a.length})})},initRoot:function(){var a=this;if(!this.isInitiated())return a._request(".").then(function(f){a.isInitiated()||(h.each(f,a._parse,a),a.setData(f),a.setInitiated(!0),a.emit("loaded"));return a.fetchRangeSync(arguments)}.bind(this));var f=new g;f.resolve();return f},_fetchRange:function(){if(this._state.filter){var a=this._state.filterDef;if(a)return a.then(function(f){this.reset();a&&a.resolve&&a.resolve(f)}.bind(this)),a}var f=this;if(this.isInitiated()){var d=
f.fetchRangeSync(arguments),c=new g,e=new g;c.resolve(d);e.resolve(d.length);f.emit("loaded");return new t(c,{totalLength:d.totalLength})}return f._request(".").then(function(a){f.isInitiated()||(h.each(a,f._parse,f),f.setData(a),f.setInitiated(!0),f.emit("loaded"));return f.fetchRangeSync(arguments)}.bind(this))},getDefaultCollection:function(a){var f=this.getDefaultSort();return null==a?this.sort(f):this.filter(function(f){return f.parent===a}).sort(f)},getChildren:function(a){return this.root.filter({parent:this.getIdentity(a)})},
spin:!0}}m=m("xfile/data/Store",[q,d,c,n,a.declare,e],f());m.Implementation=f;return m})},"xfile/model/File":function(){define(["dcl/dcl","xide/data/Model","xide/utils","xide/types"],function(m,k,g,e){return m(k,{declaredClass:"xfile.model.File",getFolder:function(){var a=this.getPath();return this.directory?a:g.pathinfo(a,e.PATH_PARTS.ALL).dirname},getChildren:function(){return this.children},getParent:function(){return(this.getStore()||this._S).getParent(this)},getStore:function(){return this._store||
this._S}})})},"xfile/config":function(){define(["dojo/_base/declare","xide/types"],function(m,k){k.config={ROOT_NODE:"xapp",FILE_SERVICE:"",START_PATH:"./",FILES_STORE_SERVICE_CLASS:"XCOM_Directory_Service",IS_MEDIA_PICKER:null,EDITOR_NODE:null,EDITOR_AFTER_NODE:null,ACTION_TOOLBAR:null,ALLOWED_DISPLAY_MODES:{TREE:1,LIST:1,THUMB:1,IMAGE_GRID:1},LAYOUT_PRESET:null,beanContextName:null};return k})},"xfile/manager/FileManager":function(){define("dcl/dcl dojo/_base/kernel xide/manager/ServerActionBase xide/types xfile/types xide/utils xide/encoding/SHA1 xide/manager/RPCService dojo/Deferred xdojo/has xfile/manager/FileManagerActions require xfile/factory/Store xide/lodash xdojo/has!electron?xfile/manager/Electron".split(" "),
function(m,k,g,e,a,d,t,w,p,r,q,c,n,v,h){g=[g,q];r("electronx")&&h&&g.push(h);return m(g,{declaredClass:"xfile.manager.FileManager",getNewName:function(a,b){for(var d=a.name.replace(".meta.json",""),c=!1,e=1,h=null;!c;)h=d+"-"+e+".meta.json",v.find(b,{name:h})?e++:c=!0;return h},_uploadXHR:null,store:null,config:null,filesToUpload:null,serviceUrl:"index.php",serviceClass:"XCOM_Directory_Service",settingsStore:null,stores:[],getStore:function(a,b){var d=v.find(this.stores,{mount:a});return d?d:n.createFileStore(a,
null,this.config,null,this.ctx)},addStore:function(a){this.stores.push(a);a._on("destroy",this.removeStore.bind(this))},removeStore:function(a){this.stores.indexOf(a)&&this.stores.remove(a)},download:function(a){[].push(a.path);if(r("nserver"))window.open("/files/"+a.mount+"/"+a.path+"?userDirectory\x3d"+encodeURIComponent(this.ctx.getUserDirectory()));else{var b=decodeURIComponent(this.serviceUrl),b=b.replace("view\x3drpc","view\x3dsmdCall"),b=-1!=b.indexOf("?")?b+"\x26":b+"?",c=this.serviceClass||
"XCOM_Directory_Service";a=d.buildPath(a.mount,a.path,!0);a=this.serviceObject.base64_encode(a);b+="service\x3d"+c+".get\x26path\x3d"+a+"\x26callback\x3dasdf";this.config.DOWNLOAD_URL&&(b=""+this.config.DOWNLOAD_URL,b+="\x26path\x3d"+a+"\x26callback\x3dasdf");var b=b+"\x26raw\x3dhtml\x26attachment\x3d1",e=d.getUrlArgs(location.href);d.mixin(e,{service:c+".get",path:a,callback:"asdf",raw:"html",attachment:"1",send:"1"});delete e.theme;delete e.debug;delete e.width;delete e.attachment;delete e.send;
c=k.toJson(JSON.stringify(e));c=t._hmac(c,this.config.RPC_PARAMS.rpcSignatureToken,1);b+="\x26"+this.config.RPC_PARAMS.rpcUserField+"\x3d"+this.config.RPC_PARAMS.rpcUserValue;b+="\x26"+this.config.RPC_PARAMS.rpcSignatureField+"\x3d"+c;window.open(b)}},getImageUrl:function(a,b,c){if(r("nserver"))return"/files/"+a.mount+"/"+a.path+"?userDirectory\x3d"+encodeURIComponent(this.ctx.getUserDirectory());b=-1!=location.href.indexOf("noImageCache")||!0===b||!0===a.dirty;var e=decodeURIComponent(this.serviceUrl),
e=e.replace("view\x3drpc","view\x3dsmdCall");a=d.buildPath(a.mount,a.path,!0);a=this.serviceObject.base64_encode(a);var h=this.ctx.getFileManager().serviceClass||"XCOM_Directory_Service",e=-1!=e.indexOf("?")?e+"\x26":e+"?",e=e+("service\x3d"+h+".get\x26path\x3d"+a+"\x26callback\x3dasdf");this.config.DOWNLOAD_URL&&(e=""+this.config.DOWNLOAD_URL,e+="\x26path\x3d"+a+"\x26callback\x3dasdf");var e=e+"\x26raw\x3dhtml\x26attachment\x3d0",e=e+"\x26send\x3d1",g=d.getUrlArgs(location.href);d.mixin(g,{service:h+
".get",path:a,callback:"asdf",raw:"html"});d.mixin(g,c);delete g.theme;delete g.debug;delete g.width;a=k.toJson(g);a=t._hmac(a,this.config.RPC_PARAMS.rpcSignatureToken,1);e+="\x26"+this.config.RPC_PARAMS.rpcUserField+"\x3d"+this.config.RPC_PARAMS.rpcUserValue;e+="\x26"+this.config.RPC_PARAMS.rpcSignatureField+"\x3d"+a;b&&(e+="\x26time\x3d"+(new Date).getTime());if(c)for(var n in c)e+="\x26"+n+"\x3d"+c[n];return e},onFileUploadFailed:function(a){var b=e.EVENTS;a.dfd&&a.dfd.reject(a);this.filesToUpload.remove(a);
this.publish(b.ON_UPLOAD_FAILED,{item:a},this)},onFileUploaded:function(a){var b=this,c=e.EVENTS;setTimeout(function(){b.publish(c.STATUS,{message:""+a.file.name+" uploaded to "+a.dstDir,messageArgs:{}},b);a.dfd&&a.dfd.resolve(a);b.filesToUpload.remove(a);b.publish(c.ON_UPLOAD_FINISH,{item:a})},500)},getUploadUrl:function(){if(r("nserver"))return this.serviceUrl.replace("/smd","/upload?");var a=""+decodeURIComponent(this.serviceUrl),a=a.replace("view\x3drpc","view\x3dupload"),a=a.replace("../../../../",
"./"),a=a+"\x26service\x3d"+this.serviceClass;return a+=".put\x26callback\x3dnada"},initXHRUpload:function(a,b,c,h){var g=new XMLHttpRequest;b=""+this.getUploadUrl();b+="\x26mount\x3d"+encodeURIComponent(h);b+="\x26dstDir\x3d"+encodeURIComponent(c);var k=this;c=g.upload;c.addEventListener("progress",function(b){if(b.lengthComputable)b={item:a,progress:b},a.isLoading=!0,a.dfd.progress(b);else k.onFileUploaded(a)}.bind(this),!1);g.onreadystatechange=function(){if(4==g.readyState){if(g.responseText&&
"OK"!=g.responseText){var b=d.getJson(g.responseText);!b&&g.responseText.indexOf("Fata Error")&&(b={result:[g.responseText],code:1});if(b&&b.result&&v.isArray(b.result)&&0<b.result.length){for(var c=null,h=0;h<b.result.length;h++)k.publish(e.EVENTS.ERROR,"Error uploading : "+a.name+" "+b.result[h],k),c=b.result[h];c&&(a.error=c);k.onFileUploadFailed(a);k.submitNext();return}b&&b.error&&(k.publish(e.EVENTS.ERROR,"Error uploading : "+a.name+" "+b.error.message,k),k.onFileUploadFailed(a))}k.onFileUploaded(a);
k.submitNext()}}.bind(this);c.onerror=function(){k.publish(e.EVENTS.ERROR,"Error uploading : "+a.name,k)};g.open("POST",b,!0);return g},hasLoadingItem:function(){for(var a=0;a<this.filesToUpload.length;a++)if("loading"==this.filesToUpload[a].status)return this.filesToUpload[a];return!1},upload:function(a,b,c,d,e){e=[];for(var h=0;h<a.length;h++){var g={file:a[h],dstDir:""+c,mount:""+b,callee:d,view:d,dfd:new p};e.push(g.dfd);this.filesToUpload.push(g)}this.submitNext();return e},sendFileUsingFormData:function(a,
b){var c=new FormData;c.append("userfile_0",b.file);a.send(c)},sendFileMultipart:function(a){a.status="loading";var b=this.initXHRUpload(a,"",a.dstDir,a.mount);this.publish(e.EVENTS.ON_UPLOAD_BEGIN,{item:a,name:a.name},this);window.FormData&&this.sendFileUsingFormData(b,a)},submitNext:function(){var a=this.getNextUploadItem();a&&this.sendFileMultipart(a)},getNextUploadItem:function(){for(var a=0;a<this.filesToUpload.length;a++)if(!this.filesToUpload[a].status)return this.filesToUpload[a];return!1},
onError:function(a){if(a)if(1===a.code){if(a.message&&v.isArray(a.message)){this.publish(e.EVENTS.ERROR,a.message.join("\x3cbr/\x3e"),this);return}}else 0===a.code&&this.publish(e.EVENTS.STATUS,"Ok",this);this.publish(e.EVENTS.ERROR,{error:a},this)},addError:function(a){var b=this;a.addCallback(function(){b.onError()})},downloadItem:function(a,b){return this.callMethod(e.OPERATION.DOWNLOAD,[a],b,!0)},downloadTo:function(a,b,c,d,h){if(h){var g=this,k=function(a){var b=!1;a&&a.error&&1==a.error.code&&
(b=!0);g.publish(e.EVENTS.ON_DOWNLOAD_TO_END,{terminatorItem:h,failed:b},this);d(arguments)};g.publish(e.EVENTS.ON_DOWNLOAD_TO_BEGIN,{dst:h,url:a,items:[h]},this)}return this.callMethod(e.OPERATION.DOWNLOAD_TO,[a,b,c],k,!0)},find:function(a,b,c){try{return this.callMethod(e.OPERATION.FIND,[a,b],c,!0)}catch(d){logError(d,"find")}},getContent:function(a,b,h,g){if(this.getContentE){var k=this.getContentE.apply(this,arguments);if(k)return k}return r("php")?(k=this.serviceObject.base64_encode(d.buildPath(a,
b,!0)),this.callMethod(e.OPERATION.GET_CONTENT,[k,!1,!1],h,!1)):this._getText(c.toUrl(a).replace("main.js","")+"/"+b,{sync:!1,handleAs:"text"}).then(function(a){try{h&&h(a)}catch(b){logError(b,"error running RPC")}})},setContent:function(a,b,c,d){this.publish(e.EVENTS.ON_CHANGED_CONTENT,{mount:a,path:b,content:c});this.publish(e.EVENTS.ON_STATUS_MESSAGE,{text:"Did save file : "+a+"://"+b});if(this.setContentE){var h=this.setContentE.apply(this,arguments);if(h)return h}return this.callMethod(e.OPERATION.SET_CONTENT,
[a,b,c],d,!0)},onMessages:function(a){if((a=d.getJson(a.events))&&v.isArray(a))for(var b=0;b<a.length;b++){var c={path:a[b].relPath};d.mixin(c,a[b]);this.publish(a[b].clientEvent,c,this)}},onErrors:function(a){},init:function(){this.stores=[];this.filesToUpload=[]},callMethodEx:function(a,b,c,h,g){var k=a||this.serviceClass,n=this;if(!this.serviceObject[k][b]){if(!0===g)this.onError({code:1,message:["Sorry, server doesnt know "+b]});return null}a={};a=d.mixin(a,this.config.RPC_PARAMS.rpcFixedParams);
a[this.config.RPC_PARAMS.rpcUserField]=this.config.RPC_PARAMS.rpcUserValue;this.serviceObject.extraArgs=a;this.serviceObject.signatureField=this.config.RPC_PARAMS.rpcSignatureField;this.serviceObject.signatureToken=this.config.RPC_PARAMS.rpcSignatureToken;this.serviceObject[k][b](c).then(function(a){try{h&&h(a)}catch(c){console.error("bad news : callback for method "+b+" caused a crash in service class "+k)}a&&a.error&&3==a.error.code&&setTimeout(function(){n.onMessages(a.error)},50);if(a&&a.error&&
a.error&&0!==a.error.code)n.onError(a.error);else n.publish(e.EVENTS.STATUS,{message:"Ok!"},this)},function(a){n.onError(a)})},callMethod:function(a,b,c,h){var g=this,k=this.serviceClass;try{if(!this.serviceObject[k][a]){if(!0===h)this.onError({code:1,message:["Sorry, server doesnt know "+a]});return null}k={};k=d.mixin(k,this.config.RPC_PARAMS.rpcFixedParams);k[this.config.RPC_PARAMS.rpcUserField]=this.config.RPC_PARAMS.rpcUserValue;this.serviceObject.extraArgs=k;this.serviceObject.signatureField=
this.config.RPC_PARAMS.rpcSignatureField;this.serviceObject.signatureToken=this.config.RPC_PARAMS.rpcSignatureToken;var n=this.serviceObject[this.serviceClass][a](b);n.then(function(b){try{c&&c(b)}catch(d){console.error("crashed in "+a),logError(d,"error running RPC")}b&&b.error&&3==b.error.code&&setTimeout(function(){g.onMessages(b.error)},50);if(b&&b.error&&b.error&&1==b.error.code)g.onError(b.error);else!1!==h&&g.publish(e.EVENTS.STATUS,{message:"Ok!"},this)},function(a){g.onError(a)});return n}catch(p){console.error("crash calling method"+
p,arguments),g.onError(p),logError(p,"error ")}},__initService:function(){this.filesToUpload=[];!this.serviceObject&&this.serviceUrl&&(this.serviceObject=new w(decodeURIComponent(this.serviceUrl)),this.serviceObject.config=this.config)}})})},"xfile/manager/FileManagerActions":function(){define(["dcl/dcl","xide/types","xide/utils"],function(m,k,g){return m(null,{declaredClass:"xfile/manager/FileManagerActions",_publishProgress:function(e,a,d,k,m){a={terminatorItem:a,failed:k,items:d||a};g.mixin(a,
m);this.publish(e,a,this)},doOperation:function(e,a,d,g,k,p){var r=this,q=e.substring(0,1).toUpperCase()+e.substring(1),c="on"+q+"End";r._publishProgress("on"+q+"Begin",d,g,!1,k);return this.runDeferred(null,e,a,p).then(function(){r._publishProgress(c,d,g,!1,k)},function(a){r._publishProgress(c,d,g,!0,k)})},deleteItems:function(e,a,d){return this.doOperation(k.OPERATION.DELETE,[e,a,!0],e,e,null,d)},copyItem:function(e,a,d,g){return this.doOperation(k.OPERATION.COPY,[e,a,d,!1],e,e,{dst:a},g)},mkdir:function(e,
a,d){return this.doOperation(k.OPERATION.NEW_DIRECTORY,[e,a],a,null,null,d)},mkfile:function(e,a,d){return this.doOperation(k.OPERATION.NEW_FILE,[e,a],a)},rename:function(e,a,d){return this.doOperation(k.OPERATION.RENAME,[e,a,d],a)},moveItem:function(e,a,d,g,m,p){return this.doOperation(k.OPERATION.MOVE,[e,a,d,g,m],e,null,null,p)},compressItem:function(e,a,d,g){return this.doOperation(k.OPERATION.COMPRESS,[e,a,d],a)},extractItem:function(e,a,d){return this.doOperation(k.OPERATION.EXTRACT,[e,a],a)}})})},
"xfile/manager/MountManager":function(){define("dcl/dcl dojo/_base/lang xide/manager/ResourceManager xide/mixins/ReloadMixin xide/mixins/EventedMixin xide/types xide/utils dojo/Deferred".split(" "),function(m,k,g,e,a,d,t,w){return m([g,a.dcl,e.dcl],{declaredClass:"xfile.manager.MountManager",serviceClass:"XApp_Resource_Service",mountData:null,didReload:!1,editMount:function(a){},removeMount:function(a){},getMounts:function(){return this.mountData},_onDialogOk:function(a,d,e){var c=t.toOptions(d),
g=this;a=null!=e.name;d={"class":"cmx.types.Resource",enabled:!0};for(var m=0;m<c.length;m++){var h=c[m];null==h.user?d[h.name]=h.value:(d.config||(d.config={}),d.config[h.name]=h.value)}c="";d.label?c=d.label:d.config.label&&(c=d.config.label);d.name=""+(null!=e.name?e.name:c.toLowerCase());"FILE_PROXY"===d.config.type?(d.path=""+d.path+"",k.mixin(d,d.config)):"REMOTE_FILE_PROXY"===d.config.type&&(d.path=d.name+"://");e=function(){g.ls(function(a){g.onMountDataReady(a)})};a?this.updateResource(d,
!1,e):this.createResource(d,!1,e)},registerLocalMount:function(a){},registerFTP:function(a){},registerSFTP:function(a){},registerDropbox:function(a){},registerWebDav:function(){},onMountDataReady:function(a){this.mountData=a;this.publish(d.EVENTS.ON_MOUNT_DATA_READY,{data:a});var e=this;setTimeout(function(){e.publish(d.EVENTS.ON_MOUNT_DATA_READY,{data:a})},4E3)},check:function(){this.serviceObject||this._initService()},init:function(){this.ctx.getFileManager()&&(this.serviceObject=this.ctx.getFileManager().serviceObject)},
createResource:function(a,d,e){return this.callMethodEx(null,"createResource",[a,d],e,!0)},removeResource:function(a,d,e){return this.callMethodEx(null,"removeResource",[a,!0],e,!0)},updateResource:function(a,d,e){return this.callMethodEx(null,"updateResource",[a,!0],e,!0)},ls:function(a){function d(c){this.mountData=c;this.onMountDataReady(c);a&&a(c)}if(!_.isEmpty(this.prefetch)){var e=new w;e.resolve(this.prefetch);d.apply(this,[this.prefetch]);delete this.prefetch;return e}return this.runDeferred(null,
"ls",[]).then(d.bind(this))}})})},"xfile/manager/BlockManager":function(){define(["dcl/dcl","xide/manager/ManagerBase","xide/mixins/ReloadMixin","xblox/manager/BlockManager"],function(m,k,g,e){return m([k,e,g.dcl],{declaredClass:"xfile/manager/BlockManager",currentItem:null,setScriptFunctions:function(a,d,e){this.inherited(arguments)}})})},"xfile/views/FileConsole":function(){define("xdojo/declare dcl/dcl xide/types xide/utils xide/mixins/PersistenceMixin xide/layout/_TabContainer xide/views/_Console xide/views/_ConsoleWidget xfile/views/FileSize xide/views/ConsoleView xide/lodash dojo/has!xace?xace/views/Editor".split(" "),
function(m,k,g,e,a,d,t,w,p,r,q,c){function n(){return k(null,{owner:null,onServerResponse:function(a,d,b){if(a&&d&&a.owner&&a.owner.onServerResponse)return a.owner.onServerResponse(d,b)},runBash:function(a,d,b,c){var e=this,g=e.ctx.fileManager;d=g.serviceObject.base64_encode(d);g.runDeferred("XShell","run",["sh",d,b]).then(function(b){c&&$(c).find(".consoleRunningCommand").remove();e.onServerResponse(a,b,!1)})},runPHP:function(a,d,b){var c=this,e=c.ctx.fileManager;d=e.serviceObject.base64_encode(d);
e.runDeferred("XShell","run",["php",d,b]).then(function(b){c.onServerResponse(a,b,!1)})},runJavascript:function(a,d,b,c){b=(new Function("{"+d+"; }")).call(b,c);return null!=b?(this.onServerResponse(a,b),b):d},onConsoleCommand:function(a,d){var b=a.console;if("sh"===b.type){var c=this.onServerResponse(b,"\x3cspan class\x3d'consoleRunningCommand fa-spinner fa-spin'\x3e\x3c/span\x3e\x3cpre style\x3d'font-weight: bold'\x3e# "+d+"\x3c/pre\x3e",!0),g=null;if(this.owner&&this.owner.getCurrentFolder){var k=
this.owner.getCurrentFolder();k&&(g=e.buildPath(k.mount,k.path,!1))}return this.runBash(b,d,g,c)}if("php"===b.type)return g=null,b.isLinked()&&(g=this.getCurrentPath()),this.runPHP(b,d,g);if("javascript"===b.type)return this.runJavascript(b,d)},onConsoleEnter:function(a,d){return this.onConsoleCommand(a,d)}})}function v(){var a=k(r.Editor,{didAddMCompleter:!1,multiFileCompleter:null,blockScope:null,driverInstance:null,onACEReady:function(a){},onEditorCreated:function(a,b){this.inherited(arguments);
this.onACEReady(a)}});return k(r,{EditorClass:a,onAddEditorActions:k.superCall(function(a){return function(b){a.call(this,b);b=b.actions;q.find(b,{command:"File/Save"});b.remove(q.find(b,{command:"File/Save"}));b.remove(q.find(b,{command:"File/Reload"}))}}),logTemplate:'\x3cpre style\x3d"font-size:100%;padding: 0px;" class\x3d""\x3e    ${time} - ${result}\x3c/pre\x3e',_parse:function(a,b,d){var c=""+b;0<c.indexOf("{{")||0<c.indexOf("}}")?c=_parser.parse(g.EXPRESSION_PARSER.FILTREX,c,this,{variables:a.getVariablesAsObject(),
delimiters:{begin:"{{",end:"}}"}}):(a=a.parseExpression(b,null,null,null,d))&&(c=a);return c},parse:function(a,b){var d=this.driverInstance;return d&&d.blockScope?this._parse(d.blockScope,a,b):a}})}m=m("xfile.views.FileConsole",null,{isStatusbarOpen:!1,resizeToParent:!0,__bottomTabContainer:null,onCloseStatusPanel:function(a){},onOpenStatusPanel:function(a){if(!a._tabs){var c=this,b=this.__bottomTabContainer||e.addWidget(d,{direction:"below"},null,a,!0);this.__bottomTabContainer=a._tabs=b;var g=v(),
k=new (n());k.ctx=c.ctx;k.owner=this;var m=b.createTab("Bash","fa-terminal");m.add(g,{type:"sh",title:"Bash",icon:"fa-terminal",ctx:c.ctx,owner:c,value:"ls -l --color\x3dalways"},null,!0).delegate=k;m._onShown();m=b.createTab("Javascript","fa-code").add(g,{type:"javascript",title:"Javascript",ctx:c.ctx,value:"return 2+2;",owner:c},null,!1);m.delegate=k;var m=b.createTab("PHP","fa-terminal").add(g,{type:"php",title:"PHP",ctx:c.ctx,value:"\x3c?php \n\n\x3e",owner:c},null,!1),q=b.createTab("Sizes","fa-bar-chart");
this.__fileSize=q.add(p,{owner:this,ctx:c.ctx},null,!1);this._on("openedFolder",function(a){e.destroy(c.__fileSize);q.resize();c.resize();c.__fileSize=null;c.__fileSize=q.add(p,{owner:c,ctx:c.ctx},null,!1);e.resizeTo(c.__fileSize,q,!0,!0);c.__fileSize.startup()});a.add(b)}return this.inherited(arguments)},onStatusbarCollapse:function(a){var c=null;this.isStatusbarOpen?(c=this.getBottomPanel(!1,.2),c.collapse(),this.onCloseStatusPanel(a),a&&a.removeClass("fa-caret-down"),a&&a.addClass("fa-caret-up")):
((c=this._getBottom())?c.expand():c=this.getBottomPanel(!1,.2),this.onOpenStatusPanel(c),a&&a.removeClass("fa-caret-up"),a&&a.addClass("fa-caret-down"));this.isStatusbarOpen=!this.isStatusbarOpen;c.resize()}});m.createEditor=function(a,d,b,g){var k={filePath:"",fileName:""};d={_permissions:[],item:k,value:d,style:"padding:0px;top:0 !important",iconClass:"fa-code",options:e.mixin(g,{filePath:k.path,fileName:k.name}),storeDelegate:{},title:"No Title"};e.mixin(d,g);a=e.addWidget(c,d,b,a,!0,null,null,
!1);a.resize();return a};m.createShellViewDelegate=n;m.createShellViewClass=v;return m})},"xfile/data/DriverStore":function(){define("dojo/_base/declare dojo/Deferred xide/data/ObservableStore xide/data/TreeMemory xfile/data/Store xide/manager/ServerActionBase xide/utils".split(" "),function(m,k,g,e,a,d,t){a=a.Implementation;return m("driverFileStore",[e,g,d.declare],t.mixin(a(),{driver:null,addDot:!1,rootSegment:"/",getRootItem:function(){var a=this._root;return a?a:this._root={_EX:!1,path:"/",name:"/",
mount:this.mount,directory:!0,virtual:!0,_S:this,getPath:function(){return this.path}}},_filter:function(a){return a},_request:function(a){var d=this,e=this;if("."===a||"/"===a){var g=new k,c=e.driver.callCommand("LSProg",{override:{args:["/*"]}});c.then(function(a){a=a.files;_.each(a,function(a){a.parent="."});a=e._filter(a);a=d._normalize({items:[{mount:"root",path:"/",children:a,name:"/",isDir:!0}]});e._parse(a);a=a.children||a;g.resolve(a)})}else g=new k,c=e.driver.callCommand("LSProg",{override:{args:[a+
(e.glob||"/*")]}}),c.then(function(c){c=c.files;_.each(c,function(c){c.parent=a});c=e._filter(c);c=d._normalize({items:[{mount:"root",path:a,children:c,isDir:!0}]});e._parse(c);c=c.children||c;g.resolve(c)});return g}}))})},"xfile/views/FileGridLight":function(){define("xdojo/declare dojo/dom-class dojo/Deferred xide/types xide/utils xide/views/History xaction/DefaultActions xfile/views/GridLight xfile/factory/Store xide/model/Path xfile/model/File xfile/types xlang/i18".split(" "),function(m,k,g,
e,a,d,t,w,p,r,q,c,n){r=c.DEFAULT_FILE_GRID_PERMISSIONS;var v=m("xfile.views.FileGrid",w,{resizeAfterStartup:!0,menuOrder:{File:110,Edit:100,View:50,Settings:20,Navigation:10,Window:5},groupOrder:{Clipboard:110,File:100,Step:80,Open:70,Organize:60,Insert:10,Navigation:5,Select:0},tabOrder:{Home:100,View:50,Settings:20,Navigation:10},noDataMessage:"\x3cspan/\x3e",_history:null,options:a.clone(e.DEFAULT_GRID_OPTIONS),_columns:{},toolbarInitiallyHidden:!0,itemType:e.ITEM_TYPE.FILE,permissions:r,contextMenuArgs:{limitTo:null},
setState:function(a){this.inherited(arguments);var c=this,b=c.collection,d=a.store.path;b.getSync(d);var e=c.refresh();try{e.then(function(){b.getItem(d,!0).then(function(a){c.openFolder(a)})})}catch(g){console.error("error restoring folder state")}return e},postMixInProperties:function(){var a=this.state;a&&a._columns&&(this._columns=a._columns);this.columns||(this.columns=this.getColumns());!this.collection&&this.state&&(a=this.state.store,this.collection=p.createFileStore(a.mount,a.storeOptions,
this.ctx.config).getDefaultCollection());return this.inherited(arguments)},getState:function(a){a=this.inherited(arguments)||{};a.store={mount:this.collection.mount,path:this.getCurrentFolder().path,storeOptions:this.collection.options};a._columns={};_.each(this._columns,function(c){a._columns[c.label]=!this.isColumnHidden(c.id)},this);return a},onSaveLayout:function(a){a=a.data;var c=this.getState();a.widgets.push({widget:this.declaredClass,state:c});return a},formatColumn:function(c,d,b){var e=
this.selectedRenderer?this.selectedRenderer.prototype:this;if(e.formatColumn&&(e=e.formatColumn.apply(arguments))||b.renderColumn&&(e=b.renderColumn.apply(this,arguments)))return e;switch(c){case "fileType":if("folder"==d)return n.localize("kindFolder");if(b.mime){var e="kind"+(b.mime.split("/")[1]||"unknown").toUpperCase(),g=n.localize(e);return e!==g?g:d}case "name":var g=b&&null!=b.directory&&!0===b.directory,k=!1===b.read&&!1===b.write,m=".."==b.name,e="",e=g?m?"fa fa-level-up itemFolderList":
k?"fa fa-lock itemFolderList":"fa fa-folder itemFolderList":k?"fa fa-lock itemFolderList":"itemFolderList fa "+a.getIconClass(b.path),g=!0===b.showPath?b.path:d;return'\x3cspan class\x3d"'+e+'""\x3e\x3c/span\x3e\x3cspan class\x3d"name fileGridNameNode" style\x3d"vertical-align: middle;padding-top: 0px"\x3e'+g+"\x3c/span\x3e";case "sizeBytes":return b.size;case "fileType":return a.capitalize(b.fileType||"unknown");case "mediaInfo":return b.mediaInfo||"unknown";case "owner":return b&&(e=b.owner)&&e.user?
e.user.name:"";case "modified":if(""===d)break;g=null==!b.directory;return!g&&n.translations.dateFormat?n.formatDate(d).replace("ms",""):""}return d},getColumns:function(){function a(b,d,e,g){null!=c._columns[b]&&(g=!c._columns[b]);c.columns.push({renderExpando:"Name"===b,label:b,field:d,sortable:e,formatter:function(a,b){return c.formatColumn(d,a,b)},hidden:g})}var c=this;this.columns=[];a("Name","name",!0,!1);a("Type","fileType",!0,!0);a("Path","path",!0,!0);a("Size","sizeBytes",!0,!1);a("Modified",
"modified",!0,!1);a("Owner","owner",!0,!0);a("Media","mediaInfo",!0,!0);return this.columns},_focus:function(){var a=this.getRows();a[0]&&(a=this.row(a[0]),this.focus(a.data))},setQueryEx:function(a,c){if(!a)return console.error("bad, no item!"),!1;if(!a.directory)return!1;this._lastPath=a.getPath();var b=this,d=new g;if(b){var e=this.collection;"."===a.path?(e.resetQueryLog(),b.set("collection",e.getDefaultCollection(a.getPath())),d.resolve&&d.resolve()):e.open(a).then(function(c){e.resetQueryLog();
b.set("collection",e.getDefaultCollection(a.getPath()));d.resolve&&d.resolve(c)});return d}console.error("have no grid")},getCurrentFolder:function(){var a=this.getSelectedRenderer();if(a&&a.getCurrentFolder&&(a=a.getCurrentFolder.apply(this))){if(a.isBack){var c=this.collection.getSync(a.rPath);c&&(a=c)}return a}if((a=this.getRows()[0])&&(a._S||a._store)){if(1==a.isBack&&(c=this.getHistory().getNow()))return this.collection.getSync(c);if(a=a._S.getParent(a))return a}return null},getClass:function(){return v},
getHistory:function(){this._history||(this._history=new d);return this._history},renderArray:function(a,c){_.find(arguments[0],{isBack:!0});return this.inherited(arguments)},startup:function(){if(!this._started){var a=this.inherited(arguments);k.add(this.domNode,"xfileGrid");this.set("loading",!0);if(this.permissions){var c=t.getDefaultActions(this.permissions,this,this),c=c.concat(this.getFileActions(this.permissions));this.addActions(c)}this._history=new d;var b=this;this.subscribe(e.EVENTS.ON_CLIPBOARD_COPY,
function(a){a.type===b.itemType&&(b.currentCopySelection=a.selection,b.refreshActions())});b._on("noData",function(){b.getRows();if(!(0<b._total)){var a=b._history.getNow();a&&"./."!==a&&b.renderArray([{name:"..",path:"..",rPath:a,sizeBytes:0,size:"",icon:"fa-level-up",isBack:!0,modified:"",_S:b.collection,directory:!0,_EX:!0,children:[],mayHaveChildren:!1}])}});this.on("dgrid-refresh-complete",function(){var a=b.getRows();a&&1<a.length&&(a=_.find(a,{isBack:!0}))&&(b.removeRow(a),b.refresh())});this._on("openFolder",
function(a){b.set("title",a.item.name)});b.selectedRenderer&&(a=this.refresh())&&a.then(function(){b.set("loading",!1);b.setRenderer(b.selectedRenderer,!1)});this._on("onChangeRenderer",function(){b.refresh()});setTimeout(function(){b.resize()},500);return a}}});v.prototype.Module=v;v.Module=v;v.createDefault=function(c,d,b,e,g,k){d=a.mixin({collection:k.getDefaultCollection(),_parent:b,Module:v,ctx:c},d||{});d=a.addWidget(v,d,null,b,g,null,null,!0,null);e&&c.getWindowManager().registerView(d,!1);
return d};v.DEFAULT_PERMISSIONS=r;return v})},"xfile/views/GridLight":function(){define("xdojo/declare xide/types xgrid/ListRenderer xfile/ThumbRenderer xgrid/TreeRenderer xgrid/GridLite xgrid/MultiRenderer xfile/FileActions xide/views/_LayoutMixin xgrid/KeyboardNavigation xgrid/Selection xide/mixins/_State xide/widgets/_Widget".split(" "),function(m,k,g,e,a,d,t,w,p,r,q,c,n){g=[g,e,a];m=m.classFactory("multiRenderer",{},g,t.Implementation);k=d.createGridClass("xfile.views.GridLight",{},{SELECTION:{CLASS:q},
KEYBOARD_SELECTION:!0,COLUMN_HIDER:!0,COLUMN_REORDER:!1,ACTIONS:k.GRID_FEATURES_LITE.ACTIONS,ITEM_ACTIONS:{CLASS:w},SPLIT:{CLASS:p},KEYBOARD_NAVIGATION:{CLASS:r},STATE:{CLASS:c},WIDGET:{CLASS:n}},{RENDERER:m},{renderers:g,selectedRenderer:a});k.DEFAULT_RENDERERS=g;k.DEFAULT_MULTI_RENDERER=m;return k})},"xfile/manager/Electron":function(){define(["dcl/dcl","xdojo/has","xide/utils","dojo/Deferred"],function(m,k,g,e){k("electronx");return m(null,{declaredClass:"xfile.manager.Electron",require:function(){return window.eRequire.apply(null,
arguments)},srequire:function(){return this.require("electron").remote.require.apply(null,arguments)},remote:function(){return(0,window.eRequire)("electron").remote},getContentE:function(a,d,k,m){var p=(this.ctx||sctx).getResourceManager().getVariable("VFS_CONFIG")||{};m=new e;this.require("os");this.require("electron");var r=this.require("path"),q=this.require("fs");a=a.replace("/","");if(p[a]){a=p[a];if(!a)return console.error("cant resolve file "+a+"/"+d),!1;d=d.replace("./","/");d=g.replaceAll("/",
r.sep,d);a=r.resolve(a+r.sep+d);if(q.existsSync(a)){d=q.statSync(a).size;r=new Buffer(d);a=q.openSync(a,"r");if(!d)return"";q.readSync(a,r,0,d,0);q.closeSync(a);q=r.toString();m.resolve(q);k&&k(q)}else return!1;return m}console.error("open in os failed: have no VFS config for "+a)},setContentE:function(a,d,k,m){var p=(this.ctx||sctx).getResourceManager().getVariable("VFS_CONFIG")||{},r=new e;this.require("os");var q=this.require("path"),c=this.require("fs");a=a.replace("/","");if(p[a]){a=p[a];if(!a)return!1;
d=d.replace("./","/");d=g.replaceAll("/",q.sep,d);q=q.resolve(a+q.sep+d);if(c.existsSync(q))try{c.writeFileSync(q,k),m&&m(),r.resolve()}catch(n){return console.error("error saving file "+q),!1}else return console.error("path "+q+" doesnt exists, fallback to legacy setContent"),!1;return r}console.error("open in os failed: have no VFS config for "+a)}})})}}});
//# sourceMappingURL=xfile.js.map