//>>built
require({cache:{"xfile/main":function(){define("dojo/_base/kernel dojo/Stateful dojo/query dojo/cache dojo/window xfile/types xfile/component xfile/views/Grid xfile/views/FileGrid xfile/FileActions xfile/Statusbar xfile/ThumbRenderer xfile/Breadcrumb xfile/types xfile/component xfile/config xfile/model/File xfile/manager/FileManager xfile/manager/MountManager xfile/manager/BlockManager xfile/views/FileConsole xfile/data/DriverStore xfile/views/FileGridLight xfile/manager/Electron".split(" "),function(){})},
"xfile/types":function(){define(["xide/utils","xide/types","xide/types/Types","xaction/types"],function(p,l){l.registerCustomMimeIconExtension=function(f,a){l.customMimeIcons[f]=a};var k=l.ACTION;l.DEFAULT_FILE_GRID_PERMISSIONS=[k.EDIT,k.COPY,k.CLOSE,k.MOVE,k.RENAME,k.DOWNLOAD,k.RELOAD,k.DELETE,k.NEW_FILE,k.NEW_DIRECTORY,k.CLIPBOARD,k.LAYOUT,k.COLUMNS,k.SELECTION,k.PREVIEW,k.OPEN_IN,k.GO_UP,k.SEARCH,k.OPEN_IN_TAB,k.TOOLBAR,k.STATUSBAR,k.UPLOAD,k.SIZE_STATS,k.CONSOLE,k.HEADER,"File/Compress","File/New",
k.CONTEXT_MENU,k.SOURCE,"File/OpenInOS"];l.FIELDS={SHOW_ISDIR:1602,SHOW_OWNER:1604,SHOW_MIME:1608,SHOW_SIZE:1616,SHOW_PERMISSIONS:1632,SHOW_TIME:1633,SHOW_FOLDER_SIZE:1634,SHOW_FOLDER_HIDDEN:1635,SHOW_TYPE:1636,SHOW_MEDIA_INFO:1637};l.FILE_PANEL_LAYOUT={TREE:1,LIST:2,THUMB:3,PREVIEW:4,COVER:5,SPLIT_VERTICAL:6,SPLIT_HORIZONTAL:7,IMAGE_GRID:8};l.LAYOUT_PRESET={DUAL:1,SINGLE:2,BROWSER:3,PREVIEW:4,GALLERY:5,EDITOR:6};l.PANEL_OPTIONS={ALLOW_NEW_TABS:!0,ALLOW_MULTI_TAB:!1,ALLOW_INFO_VIEW:!0,ALLOW_LOG_VIEW:!0,
ALLOW_CONTEXT_MENU:!0,ALLOW_LAYOUT_SELECTOR:!0,ALLOW_SOURCE_SELECTOR:!0,ALLOW_COLUMN_RESIZE:!0,ALLOW_COLUMN_REORDER:!0,ALLOW_COLUMN_HIDE:!0,ALLOW_ACTION_TOOLBAR:!0,ALLOW_MAIN_MENU:!0};l.FILE_PANEL_OPTIONS_LEFT={LAYOUT:2,AUTO_OPEN:!0};l.FILE_PANEL_OPTIONS_MAIN={LAYOUT:3,AUTO_OPEN:!0};l.FILE_PANEL_OPTIONS_RIGHT={LAYOUT:3,AUTO_OPEN:!0};l.FILE_GRID_COLUMNS={NAME:"name",SIZE:"size",MODIFIED:"modified"};l.ACTION_TOOLBAR_MODE={SELF:"self"};p.mixin(l.ITEM_TYPE,{FILE:"BTFILE"});p.mixin(l.EVENTS,{STORE_CHANGED:"onStoreChange",
BEFORE_STORE_CHANGE:"onBeforeStoreChange",STORE_REFRESHED:"onStoreRefreshed",ON_FILE_STORE_READY:"onFileStoreReady",ON_DID_OPEN_ITEM:"onDidOpenItem",ON_SHOW_PANEL:"onShowPanel",ITEM_SELECTED:"onItemSelected",ERROR:"fileOperationError",STATUS:"fileOperationStatus",IMAGE_LOADED:"imageLoaded",IMAGE_ERROR:"imageError",RESIZE:"resize",ON_UPLOAD_BEGIN:"onUploadBegin",ON_UPLOAD_PROGRESS:"onUploadProgress",ON_UPLOAD_FINISH:"onUploadFinish",ON_UPLOAD_FAILED:"onUploadFailed",ON_CLIPBOARD_COPY:"onClipboardCopy",
ON_CLIPBOARD_PASTE:"onClipboardPaste",ON_CLIPBOARD_CUT:"onClipboardCut",ON_CONTEXT_MENU_OPEN:"onContextMenuOpen",ON_PLUGIN_LOADED:"onPluginLoaded",ON_PLUGIN_READY:"onPluginReady",ON_MAIN_VIEW_READY:"onMainViewReady",ON_FILE_CONTENT_CHANGED:"onFileContentChanged",ON_PANEL_CLOSED:"onPanelClosed",ON_PANEL_CREATED:"onPanelCreated",ON_COPY_BEGIN:"onCopyBegin",ON_COPY_END:"onCopyEnd",ON_DOWNLOAD_TO_BEGIN:"onDownloadToBegin",ON_DOWNLOAD_TO_END:"onDownloadToEnd",ON_DELETE_BEGIN:"onDeleteBegin",ON_DELETE_END:"onDeleteEnd",
ON_MOVE_BEGIN:"onMoveBegin",ON_MOVE_END:"onMoveEnd",ON_COMPRESS_BEGIN:"onCompressBegin",ON_COMPRESS_END:"onCompressEnd",ON_SOURCE_MENU_OPEN:"onSourceMenuOpen",ON_MOUNT_DATA_READY:"onMountDataReady",ON_XFILE_READY:"onXFileReady",ON_CHANGE_PERSPECTIVE:"onChangePerspective",ON_FILE_PROPERTIES_RENDERED:"onFilePropertiesRendered"});l.SELECTION_MODE={SINGLE:"single",MULTI:"multiple",EXTENDED:"extended"};l.OPERATION={COPY:"copy",MOVE:"move",RENAME:"rename",DELETE:"delete",OPEN:"open",EDIT:"edit",DOWNLOAD:"download",
DOWNLOAD_TO:"downloadTo",INFO:"info",COMPRESS:"compress",RELOAD:"reload",PREVIEW:"preview",INSERT_IMAGE:"insertImage",COPY_PASTE:"copypaste",DND:"dnd",OPTIONS:"options",NEW_FILE:"mkfile",NEW_DIRECTORY:"mkdir",GET_CONTENT:"get",SET_CONTENT:"set",FIND:"find",CUSTOM:"custom",PERMA_LINK:"permaLink",ADD_MOUNT:"ADD_MOUNT",REMOVE_MOUNT:"REMOVE_MOUNT",EDIT_MOUNT:"EDIT_MOUNT",PERSPECTIVE:"PERSPECTIVE",EXTRACT:"extract"};l.OPERATION_INT={NONE:0,EDIT:1,COPY:2,MOVE:3,INFO:4,DOWNLOAD:5,COMPRESS:6,DELETE:7,RENAME:8,
DND:9,COPY_PASTE:10,OPEN:11,RELOAD:12,PREVIEW:13,INSERT_IMAGE:15,NEW_FILE:16,NEW_DIRECTORY:17,UPLOAD:18,READ:19,WRITE:20,PLUGINS:21,CUSTOM:22,FIND:23,PERMA_LINK:24,ADD_MOUNT:25,REMOVE_MOUNT:26,EDIT_MOUNT:27,PERSPECTIVE:28,CLIPBOARD_COPY:29,CLIPBOARD_CUT:30,CLIPBOARD_PASTE:31,EXTRACT:32};l.EResolveMode={SKIP:0,OVERWRITE:1,IF_NEWER:2,IF_SIZE_DIFFERS:3,APPEND:4,THROW:5,ABORT:6};l.EResolve={ALWAYS:0,THIS:1};l.EError={NONE:"None",EXISTS:"EEXIST",PERMISSION:"EACCES",NOEXISTS:"ENOENT",ISDIR:"EISDIR"};return l})},
"xfile/component":function(){define(["dcl/dcl","xide/model/Component"],function(p,l){return p(l,{beanType:"BTFILE",getDependencies:function(){return["xfile/types","xfile/manager/FileManager","xfile/manager/MountManager","xfile/factory/Store","xfile/views/FileGrid"]},getLabel:function(){return"xfile"},getBeanType:function(){return this.beanType}})})},"xfile/views/Grid":function(){define("xdojo/declare xide/types xgrid/ListRenderer xfile/ThumbRenderer xgrid/TreeRenderer xgrid/Grid xgrid/MultiRenderer xfile/FileActions xfile/Statusbar xfile/views/UploadMixin xide/views/_LayoutMixin xgrid/KeyboardNavigation xgrid/Search xgrid/Selection xide/mixins/_State xide/widgets/_Widget xdojo/has!FileConsole?xfile/views/FileConsole xfile/FolderSize xide/noob".split(" "),
function(p,l,k,f,a,d,n,w,t,r,m,c,q,v,g,e,b,h,u){k=[k,f,a];p=p.classFactory("multiRenderer",{},k,n.Implementation);l=d.createGridClass("xfile.views.Grid",{},{SELECTION:{CLASS:v},KEYBOARD_SELECTION:!0,CONTEXT_MENU:l.GRID_FEATURES.CONTEXT_MENU,TOOLBAR:l.GRID_FEATURES.TOOLBAR,CLIPBOARD:l.GRID_FEATURES.CLIPBOARD,ACTIONS:l.GRID_FEATURES.ACTIONS,ITEM_ACTIONS:{CLASS:w},STATUS_BAR:{CLASS:t},SPLIT:{CLASS:m},KEYBOARD_NAVIGATION:{CLASS:c},SEARCH:{CLASS:q},STATE:{CLASS:g},UPLOAD:{CLASS:r},WIDGET:{CLASS:e},SIZES:{CLASS:h}},
{RENDERER:p},{renderers:k,selectedRenderer:a});l.DEFAULT_RENDERERS=k;l.DEFAULT_MULTI_RENDERER=p;return l})},"xfile/ThumbRenderer":function(){define(["xdojo/declare","xide/utils","dojo/dom-construct","xgrid/ThumbRenderer"],function(p,l,k,f){return p("xfile.ThumbRenderer",[f],{thumbSize:"400",resizeThumb:!0,__type:"thumb",deactivateRenderer:function(){$(this.domNode.parentNode).removeClass("metro");$(this.domNode).css("padding","");this.isThumbGrid=!1},activateRenderer:function(){$(this.domNode.parentNode).addClass("metro");
$(this.contentNode).css("padding","8px");this.isThumbGrid=!0;this.refresh()},_renderUpload:function(a,d,f){d=parseInt(d.replace("%",""));100==d&&(d=90);a='\x3cdiv class\x3d"tile widget uploadItem"\x3e\x3cdiv class\x3d"radial-progress tile widget " data-progress\x3d"'+d+'"\x3e\x3cdiv class\x3d"circle"\x3e\x3cdiv class\x3d"mask full"\x3e\x3cdiv class\x3d"fill"\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"mask half"\x3e\x3cdiv class\x3d"fill"\x3e\x3c/div\x3e\x3cdiv class\x3d"fill fix"\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"shadow"\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"inset"\x3e\x3cdiv class\x3d"percentage"\x3e\x3cdiv class\x3d"numbers"\x3e\x3cspan\x3e-\x3c/span\x3e';
for(d=0;99>d;d++)a+="\x3cspan\x3e"+d+"%\x3c/span\x3e";return a+"\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e"},renderRow:function(a){if(!0===a.isUpload)return $(this._renderUpload(a.name,a.progress+"%",a))[0];if(a.renderRow){var d=a.renderRow.apply(this,[a]);if(d)return d}var d=k.create("div",{className:"tile widget"}),f=!1===a.read&&!1===a.write,w=".."==a.name,t=a&&!!a.directory,r=!1,m="",c="fa fa-folder fa-5x";this._doubleWidthThumbs=!0;var q="icon";t?(c=w?"fa fa-level-up fa-5x itemFolder":
f?"fa fa-lock fa-5x itemFolder":"fa fa-folder fa-5x itemFolder",r=!0):(c="itemIcon",f?(c="fa fa-lock fa-5x itemFolder",r=!0):l.isImage(a.path)?(c=this.getImageUrl(a),a.icon=c?c:this.config.REPO_URL+"/"+a.path,c="imageFile"):(c="fa fa-5x "+l.getIconClass(a.path),r=!0));m=a.name;f='\x3cspan style\x3d"text-shadow: 2px 2px 5px rgba(0,0,0,0.3);font-size: 72px;opacity: 0.7" class\x3d"fa fa-6x '+c+'"\x3e\x3c/span\x3e';this.hideExtensions&&(m=l.pathinfo(m).filename);l.isImage(a.path)&&(c=this.getImageUrl(a),
a.icon=c?c:this.config.REPO_URL+"/"+a.path,c="",q="image",f='\x3cdiv style\x3d"" class\x3d"tile-content image"\x3e\x3cimg class\x3d"'+c+'" src\x3d"'+a.icon+'"/\x3e\x3c/div\x3e',r=!0);m='\x3cdiv title\x3d"'+(m+"\n"+a.modified)+'" class\x3d"tile-content '+q+'"\x3e'+f+'\x3c/div\x3e\x3cdiv class\x3d"brand opacity"\x3e\x3cspan class\x3d"thumbText text opacity ellipsis" style\x3d""\x3e'+m+"\x3c/span\x3e\x3c/div\x3e";if(r)return d.innerHTML=m,d;d.innerHTML=t?m:'\x3cimg class\x3d"'+c+'" src\x3d"'+a.icon+
'"/\x3e\x26nbsp;\x3cdiv class\x3d"name"\x3e'+a.name+"\x3c/div\x3e";return d},getImageUrl:function(a){var d=this.ctx.getFileManager();if(d&&d){var f=null;this.resizeThumb&&(f={width:this.thumbSize});return d.getImageUrl(a,null,f)}return null}})})},"xfile/FileActions":function(){define("dcl/dcl xdojo/declare xdojo/has dojo/Deferred xide/utils xide/types xide/factory xide/model/Path xaction/DefaultActions xide/editor/Registry xide/editor/Default dojo/aspect xfile/views/FileOperationDialog xfile/views/FilePreview xide/views/_CIDialog xide/views/_Dialog xide/views/_PanelDialog xfile/views/FilePicker".split(" "),
function(p,l,k,f,a,d,n,w,t,r,m,c,q,v,g,e,b,h,u){function z(){return{includes:["*",".*"],excludes:[],mode:1502}}function B(e,c){var g=c.userData.value||".",x=new f,m=this,q=new b({size:d.DIALOG_SIZE.SIZE_NORMAL,getContentSize:function(){return{width:"600px",height:"500px"}},bodyCSS:{height:"auto","min-height":"500px",padding:"8px","margin-right":"16px"},picker:null,title:c.title,onOk:function(){var b=this.picker._selection;b&&b[0]&&(c.set("value",b[0].path),x.resolve(b[0].path),q.value=b[0].path)},
onShow:function(b,e){this.picker=b=a.addWidget(h,{ctx:m.ctx,owner:m,selection:g||".",resizeToParent:!0,mount:m.collection.mount,storeOptionsMixin:{includeList:"*,.*",excludeList:""},Module:m.Module,permissions:a.clone(m.Module.DEFAULT_PERMISSIONS)},this,e,!0);this.add(b,null,!1);this.startDfd.resolve();return[this.picker]}});q.show();return x}var y=d.ACTION;c={__loading:!0,touch:function(){var b=new f;try{var e=this,c=this.getSelectedItem(),h=this.getCurrentFolder(),m=c?a.pathinfo(c.path,d.PATH_PARTS.ALL).filename:
"",q=this.collection,u={inputs:[a.createCI("Name",13,m,{widget:{instant:!0,validator:function(b){return h?null==q.getSync(h.path+"/"+b)&&0<b.length:!0}}})]},n={select:c,focus:!0,append:!1};(new g({cis:u,title:"Create new File",ctx:this.ctx,size:d.DIALOG_SIZE.SIZE_SMALL,bodyCSS:{height:"auto","min-height":"80px"},_onError:function(b,e,c){b=b||this.title;(c=c||this.notificationMessage)&&c.update({message:b+this.failedText+(e?"\x3cbr/\x3e"+e:""),type:"error",actions:!1,duration:15E3});this.onError&&
this.onError(e)},onCancel:function(){b.resolve()},onOk:function(){var c=this.getField("name");if(null==c)b.resolve(n);else{var h=(e.getCurrentFolder()||{path:"."}).path+"/"+c;e.ctx.getFileManager().mkfile(q.mount,h,{checkErrors:!0,returnProm:!1}).then(function(c){e.runAction(y.RELOAD).then(function(){q.getSync(h)&&b.resolve({select:h,append:!1,focus:!0})})},function(e){b.resolve(n);logError(e,"error creating directory")})}}})).show()}catch(A){logError(A,"error creating dialog")}return b},newTabArgs:null,
openInOS:function(b){var e=this.ctx.getResourceManager().getVariable("VFS_CONFIG")||{},c=b.mount.replace("/","");if(e[c]){var h=window.eRequire;h||console.error("have no electron");var g=h("os"),d=h("electron").shell,h=h("path"),c=e[c],c=a.replaceAll(" ","",c);b=b.path.replace("./","/");b=a.replaceAll("/",h.sep,b);c=h.resolve(c+h.sep+b);c=a.replaceAll(" ","",c);"win32"!==g.platform()?d.openItem(c):d.openItem("file:///"+c)}else console.error("open in os failed: have no VFS config for "+c)},getFileActions:function(b){b=
b||this.permissions;var e=[],c=d.ACTION,h=d.ACTION_ICON,a=this,g=a.ctx,x=a.domNode,f=g.getResourceManager(),f=f?f.getVariable("VFS_CONFIG"):{};a.getActionStore();e.push(a.createAction({label:"Go up",command:c.GO_UP,icon:h.GO_UP,tab:"Home",group:"Navigation",keycombo:["backspace"],mixin:{quick:!0}}));e.push(a.createAction({label:"Copy",command:c.COPY,icon:"fa-paste",tab:"Home",group:"Organize",keycombo:["f5"],shouldDisable:function(){return null==a.getSelectedItem()}}));e.push(a.createAction({label:"Close",
command:c.CLOSE,icon:"fa-close",tab:"View",group:"Organize",keycombo:["ctrl 0"]}));e.push(a.createAction({label:"Move",command:c.MOVE,icon:"fa-long-arrow-right",tab:"Home",group:"Organize",keycombo:["f6"],shouldDisable:function(){return null==a.getSelectedItem()}}));e.push(a.createAction({label:"Create New Scene",command:"File/New Scene",icon:"fa-magic",tab:"Home",group:"Organize",mixin:{addPermission:!0,quick:!0}}));(-1!==location.href.indexOf("electron\x3dtrue")||k("electronx"))&&f&&e.push(a.createAction({label:"Open with System",
command:"File/OpenInOS",icon:"fa-share",tab:"Home",group:"Open",keycombo:["shift f4"],mixin:{addPermission:!0,quick:!0},shouldDisable:function(){if(a.getSelectedItem())return!1}}));e.push(this.createAction("Open In New Tab","File/OpenInNewTab","fa-share",["alt enter"],"Home","Open","item",null,null,{quick:!0},null,function(){var b=a.getSelectedItem();return b&&b.isDir?!1:!0},b,x,a));if(g&&g.getMountManager&&t.hasAction(b,c.SOURCE)){b.push(c.SOURCE);var m=g.getMountManager().getMounts(),q=0;if(m&&
0<m.length){var u=a.collection.mount;e.push(this.createAction({label:"Source",command:c.SOURCE,icon:"fa-hdd-o",keyCombo:["ctrl f1"],tab:"Home",group:"Navigation",mixin:{data:m,addPermission:!0,quick:!0},onCreate:function(b){b.set("value",u)}}));_.each(m,function(h){var g=h.label;b.push(c.SOURCE+"/"+g);g=a.createAction({label:g,command:c.SOURCE+"/"+g,icon:"fa-hdd-o",keyCombo:["alt f"+q],tab:"Home",group:"Navigation",mixin:{data:m,item:h,closeOnClick:!1,quick:!0},onCreate:function(b){b.set("value",
h.name);b._oldIcon=this.icon;b.actionType=d.ACTION_TYPE.SINGLE_TOGGLE}});e.push(g);q++})}}return e.concat(this.getEditorActions(b))},rename:function(b){var e=new f,c=this,h=b||this.getSelectedItem();b=this.getSelection();var x=this.getCurrentFolder(),m=h?a.pathinfo(h.path,d.PATH_PARTS.ALL).basename:"",q=this.collection,u={select:b,focus:!0,append:!1};b={inputs:[a.createCI("name",d.ECIType.STRING,m,{widget:{instant:!0,title:"New Name",validator:function(b){return null==q.getSync(x.path+"/"+b)&&0<b.length}}})]};
(new g({cis:b,title:"Rename",ctx:this.ctx,size:d.DIALOG_SIZE.SIZE_NORMAL,bodyCSS:{height:"auto","min-height":"80px",width:"100%","min-width":"400px"},onCancel:function(){e.resolve(u)},onOk:function(){var b=this.getField("name");if(null==b)e.resolve(u);else{var a=c.getCurrentFolder();c.ctx.getFileManager().rename(h.mount,h.path,b,{checkErrors:!0,returnProm:!1}).then(function(h){c.runAction(y.RELOAD).then(function(){u.select=a.path+"/"+b;e.resolve(u)})},function(b){logError(b,"__error renaming file!");
e.resolve(u)})}}})).show();return e},move:function(b){var e=new f,c=this;b=this.getSelectedItem();var h=this.getSelection(),m=this.getCurrentFolder();b&&a.pathinfo(b.path,d.PATH_PARTS.ALL);var q=this.collection,x={select:h,focus:!0,append:!1};if(!b.directory){var u=b.getParent();u&&(b=u)}b={inputs:[a.createCI("Name",d.ECIType.FILE,b.path,{widget:{instant:!0,title:"Target",validator:function(b){return null==q.getSync(m.path+"/"+b)&&0<b.length}}})]};var n=new g({cis:b,title:c.localize("Move"),ctx:this.ctx,
size:d.DIALOG_SIZE.SIZE_NORMAL,onCancel:function(){e.resolve(x)},onOk:function(){var b=this.getField("name");if(null==b)e.resolve(x);else{var g=c._buildServerSelection(h),d=(b=c.collection.getSync(b))?a.normalizePath(b.mount+"/"+b.path):"";b&&(g.dstPath=d);b=z();c.getCurrentFolder();c.ctx.getFileManager().moveItem(g.selection,g.dstPath,b.includes,b.excludes,b.mode,{checkErrors:!0,returnProm:!1}).then(function(b){c.runAction(y.RELOAD).then(function(){e.resolve(x)})},function(b){logError(b,"__error creating file!");
e.resolve(x)})}}});n._on("widget",function(b){b.widget._onSelect=function(b){return B.apply(c,[n,b])}});n.show();return e},copy:function(b){var e=new f,c=this,h=this.getSelectedItem(),m=this.getSelection(),u=this.getCurrentFolder();h&&a.pathinfo(h.path,d.PATH_PARTS.ALL);var x=this.collection,n={select:m,focus:!0,append:!1};h.directory||(b=h.getParent())&&(h=b);b={inputs:[a.createCI("Name",d.ECIType.FILE,h.path,{widget:{instant:!0,title:"Target",validator:function(b){return null==x.getSync(u.path+
"/"+b)&&0<b.length}}})]};var k=new (p([q,g],{}))({cis:b,title:c.localize("Copy"),ctx:this.ctx,size:d.DIALOG_SIZE.SIZE_NORMAL,bodyCSS:{height:"auto","min-height":"80px",width:"100%","min-width":"400px"},onCancel:function(){e.resolve(n)},onOk:function(){var b=this.getField("name");if(null==b)e.resolve(n);else{this.showMessage();var g=this,d=c._buildServerSelection(m),f=c.collection.getSync(b),q=f?a.normalizePath(f.mount+"/"+f.path):"";d.dstPath=f?q:a.normalizePath(h.mount+"/"+b);c.getCurrentFolder();
b=c.ctx.getFileManager().copyItem(d.selection,d.dstPath,z(),{checkErrors:!0,returnProm:!1});b.then(function(b){g._onSuccess(b)},function(b){g._onError()});b.then(function(b){c.runAction(y.RELOAD).then(function(){e.resolve(n)})},function(b){logError(b,"__error creating file!");e.resolve(n)})}}});k._on("widget",function(b){b.widget._onSelect=function(b){return B.apply(c,[k,b])}});k.show();return e},clipboardPaste:function(){var b=new f,e=this.currentCutSelection,c=e?this.currentCutSelection:this.currentCopySelection,
h=this._buildServerSelection(c),e=e?"moveItem":"copyItem",a=this,g={select:c,focus:!0,append:!1};if(!c)return b.resolve(),b;c=z();a.ctx.getFileManager()[e](h.selection,h.dstPath,{include:c.includes,exclude:c.excludes,mode:c.mode}).then(function(e){a.runAction(d.ACTION.RELOAD).then(function(){b.resolve(g)})},function(e){b.resolve(g)},function(e){b.resolve(g)});return b},mkdir:function(){var b=new f;try{var e=this,c=this.getSelectedItem(),h=this.getCurrentFolder(),m=c?a.pathinfo(c.path,d.PATH_PARTS.ALL).filename:
"",q=this.collection,u={inputs:[a.createCI("Name",13,m,{widget:{instant:!0,validator:function(b){return h?null==q.getSync(h.path+"/"+b)&&0<b.length:!0}}})]},n={select:c,focus:!0,append:!1};(new g({cis:u,title:"Create new Directory",ctx:this.ctx,size:d.DIALOG_SIZE.SIZE_NORMAL,bodyCSS:{height:"auto","min-height":"80px",width:"100%","min-width":"400px"},_onError:function(b,e,c){b=b||this.title;(c=c||this.notificationMessage)&&c.update({message:b+this.failedText+(e?"\x3cbr/\x3e"+e:""),type:"error",actions:!1,
duration:15E3});this.onError&&this.onError(e)},onCancel:function(){b.resolve()},onOk:function(){var c=this.getField("name");if(null==c)b.resolve(n);else{var h=(e.getCurrentFolder()||{path:"."}).path+"/"+c;e.ctx.getFileManager().mkdir(q.mount,h,{checkErrors:!0,returnProm:!1}).then(function(c){e.runAction(y.RELOAD).then(function(){q.getSync(h)&&b.resolve({select:h,append:!1,focus:!0})})},function(e){b.resolve(n);logError(e,"error creating directory")})}}})).show()}catch(A){logError(A,"error creating dialog")}return b},
_buildServerSelection:function(b,e){!e&&(e=this.getCurrentFolder());e&&!e.directory&&(e=e.getParent());_.isArray(b)||(b=[b]);var c=[],h=b[0].getStore(),g=e?a.normalizePath(e.mount+"/"+e.path):"";_.each(b,function(b){h.getSync(b.path)&&c.push(a.normalizePath(b.mount+"/"+b.path))});return{selection:c,store:b[0]._S,dstPath:"/"+g+"/",firstItem:b[0],parent:e}},openPreview:function(b,e){var c=this.row(b).element,h=this,a=new f;if(this._preview)return this._preview.item=b,this._preview.open().then(function(){h._preview.preview.trigger($.Event("update",
{file:b}))});var g=new v({node:$(c),item:b,delegate:this.ctx.getFileManager(),parent:$(c),ctx:h.ctx,container:e?e.containerNode:null});e?g.buildRenderingEmbedded():g.buildRendering();g.init();g.exec();this._preview=g;this._preview.handler=this;h._on("selectionChanged",function(b){if(b=h.getSelectedItem())g.item=b,g.preview.trigger($.Event("update",{file:b}))});this.add(g,null,!1);g._emit("changeState",function(e){0===e&&a.resolve({select:b,focus:!0,append:!1})});return a},deleteSelection:function(b){b=
b||this.getSelection();var e=new f,c=this.getNext(b[0],null,!0),h=this.getPrevious(b[0],null,!0),a=c||h,g=this._buildServerSelection(b),m=this;(new q({ctx:m.ctx,notificationMessage:null,title:"Delete "+g.selection.length+" items",type:d.DIALOG_TYPE.DANGER,onBeforeOk:function(){},getOkDfd:function(){var b=this;return this.ctx.getFileManager().deleteItems(g.selection,{hints:[1]},{checkErrors:!1,returnProm:!1,onError:function(e){b._onError(null,e.message)}})},onCancel:function(){e.resolve({select:b,
focus:!0,append:!1})},onSuccess:function(){m.runAction(d.ACTION.RELOAD).then(function(){e.resolve({select:a,focus:!0,append:!1})})}})).show();return e},goUp:function(b){b=this._history.getNow();b=_.isString(b)?this.collection.getSync(b):b;var e=new f,c=this,h=this.getHistory().getNow();if(!b){var a=this.getRows();a[0]&&a[0]._S&&(a=a[0]._S.getParent(a[0]))&&(a=a._S.getParent(a))&&(b=a)}b?(a=b._S.getParent(b))&&(b=this.openFolder(a,!0,!1))&&b.then&&b.then(function(){if(h){var b=c.collection.getSync(h);
b&&e.resolve({select:b,focus:!0,delay:1})}}):h?(b=this.collection.getSync(h))&&this.select([b],null,!0,{focus:!0,delay:1}):(a=this.getRows(),a[0]&&a[0]._S&&(a=a[0]._S.getParent(a[0]))&&(a=a._S.getParent(a))&&this.openFolder(a,!0));return e},reload:function(b){var e=new f,c=this.getSelection();b=b||this.getRows()[0];var h=this.getCurrentFolder()||{path:"."},a=this;h.isBack&&(h=this.collection.getSync(h.rPath)||{path:"."});var g=!1;this.isExpanded&&this.expand&&b&&(g=this._isExpanded(b))&&this.expand(b,
null,!1);a.collection.resetQueryLog();this.collection.loadItem(h,!0).then(function(b){"."===h.path&&a.collection.resetQueryLog();a.refresh().then(function(){var b=a.openItem(h,!1,!1);b&&b.then&&b.then(function(){e.resolve({select:c,append:!1,focus:!0,delay:1})});a.deselectAll();e.resolve({select:c,append:!1,focus:!0,delay:2})})});return e},toHistory:function(b){b=(b.getFolder?new w(b.getFolder()):new w(".")).getSegments();var e=this.collection.rootSegment,c=e;b&&"."===b[0]&&(b[0]=e);var h=[];_.each(b,
function(b){b=b!==c?c+(c.endsWith("/")?"":"/")+b:b;h.push(b);c=b});return h},openFolder:function(b,e,c){var h=this.getCurrentFolder(),a=this.collection,g=this.getHistory();g.getNow();g.getNow();var d=this;(b=_.isString(b)?a.getSync(b):a.getSync(b.path)||b)||(b=a.getRootItem());var m=d.toHistory(b);g.set(m);if(!b)return this.setQueryEx(a.getRootItem());if(!(h&&b&&e&&h.path===b.path)&&b){this.deselectAll();var h=(h=this.row(b))?h.element:null,q;b._S.isItemLoaded(b)||((h=$(h).find("span.fa"))&&h[0]&&
(q=$(h[0])),q&&(q.removeClass("fa fa-folder"),q.addClass("fa-spinner fa-spin")));var u=new f;this._emit("openFolder",{item:b,back:e});(h=this.setQueryEx(b,null))&&h.then(function(){q&&(q.addClass("fa fa-folder"),q.removeClass("fa-spinner fa-spin"));u.resolve({select:!1!==c?e?b:d.getRows()[0]:null,focus:!0,append:!1,delay:1});d._emit("openedFolder",{item:b,back:e})});return u}},changeSource:function(b,e){var c=new f,h=this,a=h.ctx||a,g=a.getFileManager(),d=n.createFileStore(b.name,null,g.config,null,
a),m=this.collection,a=this.getAction(y.SOURCE),g=b.label||b.name,q=this.getAction(y.SOURCE+"/"+g);m.destroy();!0!==e&&this._emit("changeSource",b);this.set("loading",!0);this.set("collection",d.getDefaultCollection("./"));a.set("value",b.name);h.set("title","Files ("+b.label+")");m=a.getChildren();_.each(m,function(b){b.set("icon",b._oldIcon)});a.set("label",g);q&&q.set("icon","fa-spinner fa-spin");this.refresh().then(function(){h.set("loading",!1);h.set("collection",d.getDefaultCollection("./"));
q&&q.set("icon","fa-check");!0!==e&&h._emit("changedSource",b);h.select([0],null,!0,{append:!1,focus:!0}).then(function(){c.resolve()})});return c},openInNewTab:function(b){var e=this,c=e.ctx,h=c.getWindowManager(),g=new f,d=null,d=_.isFunction(this.newTarget)?this.newTarget({title:b.name,icon:"fa-folder",target:e._parent,location:null,tabOrientation:null}):h.createTab(b.name,"fa-folder",this.newTarget||this),m=this.collection;b.isDir||(b=this.getCurrentFolder());var q=n.createFileStore(m.mount,m.options,
m.config,null,c);q.micromatch=m.micromatch;var c=a.mixin({showToolbar:this.showToolbar,collection:q,selectedRenderer:this.selectedRenderer,showHeader:this.showHeader,newTarget:this.newTarget,style:this.style,options:a.clone(this.options),permissions:this.permissions,_columns:this._columns,attachDirect:!0,registerEditors:this.registerEditors,hideExtensions:this.hideExtensions},this.newTabArgs||{}),u=a.addWidget(this.getClass(),c,null,d,!1);g.resolve();u.set("loading",!0);q.initRoot().then(function(c){(c=
q.getItem(b.path,!0))&&c.then(function(){u.startup();u._showHeader(e.showHeader);u.openItem(b).then(function(){u.set("loading",!1);u.select([0],null,!0,{focus:!0,append:!1,delay:1})});h.registerView(u,!0)})});return g},openItem:function(b,e,c){if(!b){var h=this.getRows();h[0]&&h[0].isBack&&(b=h[0])}if(b&&b.isBack)return b._S=null,this.goUp();if(b=_.isString(b)?this.collection.getSync(b):b){if(!0===b.directory)return this.openFolder(b,e,c);e=r.getEditors(b);return(e=_.find(e,function(b){return!0===
b.isDefault}))?e.onEdit(b,this):this.ctx.getWindowManager().openItem(b,this.newTarget||this,{register:!0})}},getSelectedItem:function(){return this.getSelection()[0]},openDefaultEditor:function(b){return m.Implementation.open(b)},close:function(){var b=this._parent;if(b){var e=b.docker();e&&(this.onAfterAction=null,e.removePanel(b))}return!1},compress:function(b){b=b||this.getSelection();var e=this;(b=this._buildServerSelection(b))&&b.store&&b.selection&&e.ctx.getFileManager().compressItem(b.firstItem.mount,
b.selection,"zip").then(function(b){e.reload()})},newScene:function(){var b=new f;try{var e=this,c=this.getSelectedItem(),h=this.getCurrentFolder();c&&a.pathinfo(c.path,d.PATH_PARTS.ALL);var m=this.collection,q={inputs:[a.createCI("Name",13,"my new scene.dhtml",{widget:{instant:!0,validator:function(b){return h?null==m.getSync(h.path+"/"+b)&&0<b.length:!0}}})]},n={select:c,focus:!0,append:!1};(new g({cis:q,title:"Create new scene",ctx:this.ctx,size:d.DIALOG_SIZE.SIZE_SMALL,bodyCSS:{height:"auto",
"min-height":"80px"},_onError:function(b,e,c){b=b||this.title;(c=c||this.notificationMessage)&&c.update({message:b+this.failedText+(e?"\x3cbr/\x3e"+e:""),type:"error",actions:!1,duration:15E3});this.onError&&this.onError(e)},onCancel:function(){b.resolve()},onOk:function(){var c=this.getField("name");if(null==c)b.resolve(n);else{var h=(e.getCurrentFolder()||{path:"."}).path+"/"+c;e.ctx.getFileManager().mkfile(m.mount,h,u,{checkErrors:!0,returnProm:!1}).then(function(c){e.runAction(y.RELOAD).then(function(){m.getSync(h)&&
b.resolve({select:h,append:!1,focus:!0})})},function(e){b.resolve(n);logError(e,"error creating directory")})}}})).show()}catch(D){logError(D,"error creating dialog")}return b},runAction:function(b,e){_.isString(b)&&(b=this.getAction(b));if(b&&b.command){var c=d.ACTION,h=this.getSelectedItem()||e,a=this.getSelection();if(-1!=b.command.indexOf(y.SOURCE))return this.changeSource(b.item);switch(b.command){case "File/Compress":return this.compress(a);case c.PREVIEW:return this.openPreview(h);case "File/OpenInNewTab":return this.openInNewTab(h||
this.collection.getRootItem());case c.EDIT:return this.openItem(h);case "File/New Scene":return this.newScene(h);case c.NEW_FILE:return this.touch(h);case c.NEW_DIRECTORY:return this.mkdir(h);case c.RELOAD:return this.reload(h);case c.RENAME:return this.rename(h);case c.GO_UP:return this.goUp(null);case c.COPY:return this.copy(null);case c.MOVE:return this.move(null);case c.DELETE:return this.deleteSelection(null);case c.OPEN_IN+"/Default Editor":return this.openDefaultEditor(h);case c.DOWNLOAD:return this.ctx.getFileManager().download(h);
case c.CLOSE:return this.close();case "File/OpenInOS":return this.openInOS(h)}return-1!=b.command.indexOf(c.OPEN_IN+"/")?b.editor.onEdit(h):this.inherited(arguments)}},getEditorActions:function(b){function e(b){function e(b,e){e.handler=function(){b.onEdit(q.getSelection()[0])}}var c=b.selection;if(c&&c[0]){var h=c[0],a=this.permissions,g=d.ACTION,q=this,u=q.domNode,f=q.getActionStore(),c=this.getContextMenu?this.getContextMenu():null;"deselect"!=b.why&&(f.getSync(d.ACTION.OPEN_IN),b=q.addActions(function(b){for(var c=
r.getEditors(b)||[],h=[],d=0;d<c.length;d++){var f=c[d];if("Default Editor"!==f.name){var n=q.createAction(f.name,g.OPEN_IN+"/"+f.name,f.iconClass,null,"Home","Open","item",null,function(){},{addPermission:!0,tab:"Home",editor:f,custom:!0,quick:!0},null,null,a,u,q);e(f,n);h.push(n);f.editorClass&&f.editorClass.getFileActions&&(h=h.concat(f.editorClass.getFileActions(m,b)))}}return h}(h)),this._lastEditorActions&&(_.each(this._lastEditorActions,function(b){f.removeSync(b.command)}),delete this._lastEditorActions),
c&&c.removeCustomActions(),0<b.length&&(b=this.addActions(b),f._emit("onActionsAdded",b),this._lastEditorActions=b))}}b=b||this.permissions;var c=[],h=d.ACTION,a=d.ACTION_ICON,g=this,m=g.ctx,q=g.domNode;g.getActionStore();var u=null;this._selHandle||(this._selHandle=this._on("selectionChanged",function(b){e.apply(g,[b])}));u=this.createAction("Open In",h.OPEN_IN,a.EDIT,null,"Home","Open","item",null,function(){},{addPermission:!0,tab:"Home",quick:!0},null,t.shouldDisableDefaultFileOnly,b,q,g);c.push(u);
b=g.createAction("Default Editor",h.OPEN_IN+"/Default Editor","fa-code",null,"Home","Open","item",null,function(){},{addPermission:!0,tab:"Home",forceSubs:!0,quick:!0},null,null,b,q,g);c.push(b);return c}};l=l("xfile.FileActions",null,c);l.Implementation=c;l.createFilePicker=function(e,c,g,q,m,f,u,n,k){(new b({size:d.DIALOG_SIZE.SIZE_NORMAL,getContentSize:function(){return{width:"600px",height:"500px"}},bodyCSS:{height:"auto","min-height":"500px",padding:"8px","margin-right":"16px"},picker:null,title:q,
onOk:function(){var b=this.picker._selection;b&&b[0]&&(g(b[0]),u&&u.resolve(b[0],b,this.picker))},onShow:function(b,g){this.picker=b=a.addWidget(h,a.mixin({ctx:e.ctx,owner:e,selection:c||".",resizeToParent:!0,storeOptionsMixin:a.mixin({includeList:"*,.*",excludeList:""},k),Module:n,permissions:m||a.clone(d.DEFAULT_FILE_GRID_PERMISSIONS)},f),this,g,!0);this.add(b);this.startDfd.resolve();return[this.picker]}})).show();return u};return l})},"xfile/views/FileOperationDialog":function(){define(["dcl/dcl",
"xide/types","xide/views/_Dialog"],function(p,l,k){return p(k,{title:"",type:l.DIALOG_TYPE.INFO,size:l.DIALOG_SIZE.SIZE_SMALL,bodyCSS:{},failedText:" Failed!",successText:": Success!",showSpinner:!0,spinner:'  \x3cspan class\x3d"fa-spinner fa-spin"/\x3e',notificationMessage:null,doOk:function(f){this.onBeforeOk&&this.onBeforeOk();this.showMessage();var a=this;f.then(function(d){a._onSuccess(d)},function(d){a._onError()})},_onSuccess:function(f,a,d){f=f||this.title;(d=d||this.notificationMessage)&&
d.update({message:f+this.successText+(a?"\x3cbr/\x3e"+a:""),type:"info",actions:!1,duration:1500});this.onSuccess&&this.onSuccess()},_onError:function(f,a,d){f=f||this.title;(d=d||this.notificationMessage)&&d.update({message:f+this.failedText+(a?"\x3cbr/\x3e"+a:""),type:"error",actions:!1,duration:15E3});this.onError&&this.onError(a)},onOk:function(){this.showMessage();this.doOk(this.getOkDfd())},showMessage:function(f){if(this.notificationMessage)return this.notificationMessage;f=f||this.title;return this.notificationMessage=
f=this.ctx.getNotificationManager().postMessage({message:f+(this.showSpinner?this.spinner:""),type:"info",showCloseButton:!0,duration:4500})}})})},"xfile/views/FilePreview":function(){define("dcl/dcl xide/types xide/utils xide/mixins/EventedMixin xide/widgets/_Widget dojo/cache dojo/Deferred dijit/registry xide/editor/Default xaction/DefaultActions".split(" "),function(p,l,k,f,a,d,n,w,t,r){var m=[function(c){var a=["image/jpeg","image/png","image/gif"],d=c.preview;$.each(navigator.mimeTypes,function(c,
e){c=e.type;0===c.indexOf("image/")&&$.inArray(c,a)&&a.push(c)});d.bind("update",function(g){var e=g.file,b;c.opened()&&-1!==$.inArray(e.mime,a)&&(g.stopImmediatePropagation(),g=null,c.resizeToPreview&&(g={width:d.width()}),b=$("\x3cimg/\x3e").hide().appendTo(d).load(function(){setTimeout(function(){var e=(b.width()/b.height()).toFixed(2);d.bind("changesize",function(){var c=parseInt(d.width()),h=parseInt(d.height()),a;e<(c/h).toFixed(2)?(a=h,c=Math.floor(a*e)):a=Math.floor(c/e);b.width(c).height(a).css("margin-top",
a<h?Math.floor((h-a)/2):0)}).trigger("changesize");c.hideinfo();b.fadeIn(100)},1)}),b.attr("src",c.fm.url(e,null,g)))})},function(c){var a=["text/html","application/xhtml+xml"],d=c.preview;d.bind("update",function(g){var e=g.file;c.opened()&&-1!==$.inArray(e.mime,a)&&(g.stopImmediatePropagation(),c.ctx.getFileManager().getContent(e.mount,e.path,function(b){c.hideinfo();doc=$('\x3ciframe class\x3d"elfinder-quicklook-preview-html"/\x3e').appendTo(d)[0].contentWindow.document;doc.open();doc.write(b);
doc.close()}))})},function(c){var a=c.preview,d="application/x-empty application/javascript application/xhtml+xml audio/x-mp3-playlist application/x-web-config application/docbook+xml application/x-php application/x-perl application/x-awk application/x-config application/x-csh application/xml application/x-empty text/html text/x-c text/x-php text/plain text/x-c++ text/x-lisp".split(" ");a.bind("update",function(g){var e=g.file,b=e.mime;if(c.opened()&&(0===b.indexOf("text/")||-1!==$.inArray(b,d))&&
(g.stopImmediatePropagation(),c.useAce)){c.hideinfo();g=$('\x3cdiv class\x3d"elfinder-quicklook-preview-text-wrapper"\x3e\x3c/div\x3e');g.appendTo(a);var h=c._editor,b=h;if(!h&&(h=t.Implementation.open(e,g[0],c.editorOptions,!1,c),c._editor=h,c.add(h,null,!1),r.hasAction(c.editorOptions.permissions,l.ACTION.TOOLBAR))){var m=h.getToolbar();m&&$(m.domNode).addClass("bg-opaque")}b&&(g.append(h.domNode),h.set("item",e));a.bind("changesize",function(){parseInt(a.width());parseInt(a.height());k.resizeTo(h.domNode,
a[0],!0,!0);h.resize()})}})},function(c){var a=c.preview,d=!1,d=!1;$.each(navigator.plugins,function(c,e){$.each(e,function(b,e){if("application/pdf"==e.type)return!(d=!0)})});d&&a.bind("update",function(g){var e=g.file,b;c.opened()&&"application/pdf"==e.mime&&(g.stopImmediatePropagation(),a.one("change",function(){b.unbind("load").remove()}),b=$('\x3ciframe class\x3d"elfinder-quicklook-preview-pdf"/\x3e').hide().appendTo(a).load(function(){c.hideinfo();b.show()}).attr("src",c.fm.url(e)))})},function(c){var a=
c.fm,d=c.preview,g=!1;$.each(navigator.plugins,function(e,b){$.each(b,function(b,e){if("application/x-shockwave-flash"==e.type)return!(g=!0)})});g&&d.bind("update",function(e){var b=e.file;c.opened()&&"application/x-shockwave-flash"==b.mime&&(e.stopImmediatePropagation(),c.hideinfo(),d.append($('\x3cembed class\x3d"elfinder-quicklook-preview-flash" pluginspage\x3d"http://www.macromedia.com/go/getflashplayer" src\x3d"'+a.url(b)+'" quality\x3d"high" type\x3d"application/x-shockwave-flash" /\x3e')))})},
function(c){var a=c.preview,d=!!c.options.autoplay,g={"audio/mpeg":"mp3","audio/mpeg3":"mp3","audio/mp3":"mp3","audio/x-mpeg3":"mp3","audio/x-mp3":"mp3","audio/x-wav":"wav","audio/wav":"wav","audio/x-m4a":"m4a","audio/aac":"m4a","audio/mp4":"m4a","audio/x-mp4":"m4a","audio/ogg":"ogg"},e;a.bind("update",function(b){if(c.opened()){var h=b.file;c.support.audio[g[h.mime]]&&(b.stopImmediatePropagation(),e=$('\x3caudio class\x3d"elfinder-quicklook-preview-audio" controls preload\x3d"auto" autobuffer\x3e\x3csource src\x3d"'+
c.fm.url(h)+'" /\x3e\x3c/audio\x3e').appendTo(a),d&&e[0].play())}}).bind("change",function(){e&&e.parent().length&&(e[0].pause(),e.remove(),e=null)})},function(c){var a=c.preview,d=!!c.options.autoplay,g={"video/mp4":"mp4","video/x-m4v":"mp4","video/ogg":"ogg","application/ogg":"ogg","video/webm":"webm"},e;a.bind("update",function(b){if(c.opened()){var h=b.file;c.support.video[g[h.mime]]&&(b.stopImmediatePropagation(),c.hideinfo(),e=$('\x3cvideo class\x3d"elfinder-quicklook-preview-video" controls preload\x3d"auto" autobuffer\x3e\x3csource src\x3d"'+
c.fm.url(h)+'" /\x3e\x3c/video\x3e').appendTo(a),d&&e[0].play())}}).bind("change",function(){e&&e.parent().length&&(e[0].pause(),e.remove(),e=null)})},function(c){var a=c.preview,d=[],g;c.opened()&&($.each(navigator.plugins,function(e,b){$.each(b,function(b,e){0!==e.type.indexOf("audio/")&&0!==e.type.indexOf("video/")||d.push(e.type)})}),a.bind("update",function(e){if(c.opened()){var b=e.file,h=b.mime;-1!==$.inArray(b.mime,d)&&(e.stopImmediatePropagation(),(e=0===h.indexOf("video/"))&&c.hideinfo(),
g=$('\x3cembed src\x3d"'+c.fm.url(b)+'" type\x3d"'+h+'" class\x3d"elfinder-quicklook-preview-'+(e?"video":"audio")+'"/\x3e').appendTo(a))}}).bind("change",function(){g&&g.parent().length&&(g.remove(),g=null)}))}];f=p([a.dcl,f.dcl],{resizeToPreview:!0,useAce:!0,registerEditors:!1,editorPermissions:[],container:null,destroy:function(){this.window.empty();k.destroy(this.window[0]);this.inherited(arguments)},init:function(){var c=this.options={autoplay:!0,jplayer:"extensions/jplayer",ui:"button"},a=this,
d=this.window,g=this.preview,e=this.container;width=0<c.width?parseInt(c.width):450;height=0<c.height?parseInt(c.height):300;e||d.appendTo("body").zIndex(20);$(document).keydown(function(b){27==b.keyCode&&a.opened()&&d.trigger("close")});!e&&$.fn.resizable&&d.resizable({handles:"se",minWidth:350,minHeight:120,resize:function(){g.trigger("changesize")}});$.each(m||[],function(b,e){"function"==typeof e&&new e(a)});g.bind("update",function(){a.info.show()})},buildRenderingEmbedded:function(){var c=this,
a=this.navicon,d=this.container?$(this.container):null;$('\x3cdiv class\x3d"elfinder-quicklook-title" style\x3d"display: none"\x3e'+c.title+"\x3c/div\x3e");var g=$("\x3cdiv/\x3e"),e=$('\x3cdiv class\x3d"elfinder-quicklook-info"/\x3e');c.openDfd=new n;c.fsicon=$('\x3cdiv class\x3d"'+a+" "+a+' fa-2x fa-arrows-alt"/\x3e').mousedown(function(b){var e=c.window,g=e.is("."+c.fullscreen),d=$(window);b.stopPropagation();g?(e.css(e.data("position")).unbind("mousemove"),d.unbind("scroll.elfinder-finder").trigger(c.resize).unbind(c.resize),
c.navbar.unbind("mouseenter").unbind("mousemove")):(e.data("position",{left:e.css("left"),top:e.css("top"),width:e.width(),height:e.height()}).css({width:"100%",height:"100%"}),$(window).bind("scroll.elfinder-finder",function(){e.css({left:parseInt($(window).scrollLeft())+"px",top:parseInt($(window).scrollTop())+"px"})}).bind(c.resize,function(b){c.preview.trigger("changesize")}).trigger("scroll.elfinder-finder").trigger(c.resize),e.bind("mousemove",function(b){c.navbar.stop(!0,!0).show().delay(3E3).fadeOut("slow")}).mousemove(),
c.navbar.mouseenter(function(){c.navbar.stop(!0,!0).show()}).mousemove(function(b){b.stopPropagation()}));c.navbar.attr("style","").draggable(g?"destroy":{});e.toggleClass(c.fullscreen);$(this).toggleClass(a+"-fullscreen-off");parent||(parent=$(".xapp"))});c.navbar=$('\x3cdiv class\x3d"" style\x3d"display: none;"/\x3e');c.preview=$('\x3cdiv class\x3d"elfinder-quicklook-preview ui-helper-clearfix"/\x3e').bind("change",function(b){c.info.attr("style","").hide();g.removeAttr("class").attr("style","");
e.html("")}).bind("update",function(b){var e=b.file;e?(!e.read&&b.stopImmediatePropagation(),c.preview.unbind("changesize").trigger("change").children().remove(),c.info.delay(100).fadeIn(10)):b.stopImmediatePropagation()});c.info=$('\x3cdiv class\x3d"elfinder-quicklook-info-wrapper"/\x3e').append(g).append(e);c.window=$('\x3cdiv id\x3d"'+c.id+'" class\x3d"ui-helper-reset ui-widget elfinder-quicklook widget bg-opaque" style\x3d""/\x3e').click(function(b){b.stopPropagation()}).append(c.preview).append(c.info.hide()).bind("open",
function(b){c._open=!0;b=c.window;var e=c.node;c.closed()&&(c.update(1,c.value),c.navbar.attr("style",""),c.state=1,e&&e.trigger("scrolltoview"),b.css(c.closedCss(e)).show().animate(c.openedCss(),550,function(){c.state=2;c.update(2,c.value);c.openDfd.resolve()}))}).bind("close",function(b){var e=c.window,a=c.preview.trigger("change");b={};var g=function(){c._open=!1;c.state=0;e.hide();a.children().remove();c.update(0,c.value)};c.opened()&&(state=1,e.is("."+c.fullscreen)&&c.fsicon.mousedown(),b.length?
e.animate(c.closedCss(b),500,g):g())});d&&d.append(c.window);d=this.supportTest;c.support={audio:{ogg:d('audio/ogg; codecs\x3d"vorbis"'),mp3:d("audio/mpeg;"),wav:d('audio/wav; codecs\x3d"1"'),m4a:d("audio/x-m4a;")||d("audio/aac;")},video:{ogg:d('video/ogg; codecs\x3d"theora"'),webm:d('video/webm; codecs\x3d"vp8, vorbis"'),mp4:d('video/mp4; codecs\x3d"avc1.42E01E"')||d('video/mp4; codecs\x3d"avc1.42E01E, mp4a.40.2"')}}},buildRendering:function(){var c=this,a=this.navicon,d=this.container?$(this.container):
null,g=$('\x3cdiv class\x3d"elfinder-quicklook-title"\x3e'+c.title+"\x3c/div\x3e"),e=$("\x3cdiv/\x3e"),b=$('\x3cdiv class\x3d"elfinder-quicklook-info"/\x3e');c.openDfd=new n;c.fsicon=$('\x3cdiv class\x3d"'+a+" "+a+' fa-2x fa-arrows-alt"/\x3e').mousedown(function(b){var e=c.window,h=e.is("."+c.fullscreen),g=$(window);b.stopPropagation();h?(e.css(e.data("position")).unbind("mousemove"),g.unbind("scroll.elfinder-finder").trigger(c.resize).unbind(c.resize),c.navbar.unbind("mouseenter").unbind("mousemove")):
(e.data("position",{left:e.css("left"),top:e.css("top"),width:e.width(),height:e.height()}).css({width:"100%",height:"100%"}),$(window).bind("scroll.elfinder-finder",function(){e.css({left:parseInt($(window).scrollLeft())+"px",top:parseInt($(window).scrollTop())+"px"})}).bind(c.resize,function(b){c.preview.trigger("changesize")}).trigger("scroll.elfinder-finder").trigger(c.resize),e.bind("mousemove",function(b){c.navbar.stop(!0,!0).show().delay(3E3).fadeOut("slow")}).mousemove(),c.navbar.mouseenter(function(){c.navbar.stop(!0,
!0).show()}).mousemove(function(b){b.stopPropagation()}));c.navbar.attr("style","").draggable(h?"destroy":{});e.toggleClass(c.fullscreen);$(this).toggleClass(a+"-fullscreen-off");parent||(parent=$(".xapp"))});c.navbar=$('\x3cdiv class\x3d"elfinder-quicklook-navbar"/\x3e').append($('\x3cdiv class\x3d"'+a+" "+a+' fa-2x fa-arrow-left"/\x3e').mousedown(function(){c.navtrigger(37)})).append(c.fsicon).append($('\x3cdiv class\x3d"'+a+" "+a+' fa-2x fa-arrow-right"/\x3e').mousedown(function(){c.navtrigger(39)})).append('\x3cdiv class\x3d"elfinder-quicklook-navbar-separator"/\x3e').append($('\x3cdiv class\x3d"'+
a+" "+a+'-close"/\x3e').mousedown(function(){c.window.trigger("close")}));c.preview=$('\x3cdiv class\x3d"elfinder-quicklook-preview ui-helper-clearfix"/\x3e').bind("change",function(a){c.info.attr("style","").hide();e.removeAttr("class").attr("style","");b.html("")}).bind("update",function(b){var e=b.file;e?(!e.read&&b.stopImmediatePropagation(),c.preview.unbind("changesize").trigger("change").children().remove(),c.info.delay(100).fadeIn(10)):b.stopImmediatePropagation()});c.info=$('\x3cdiv class\x3d"elfinder-quicklook-info-wrapper"/\x3e').append(e).append(b);
c.window=$('\x3cdiv id\x3d"'+c.id+'" class\x3d"ui-helper-reset ui-widget elfinder-quicklook widget bg-opaque" style\x3d"position:absolute"/\x3e').click(function(b){b.stopPropagation()}).append($('\x3cdiv class\x3d"elfinder-quicklook-titlebar"/\x3e').append(g).append($('\x3cspan class\x3d"fa-close" style\x3d"margin-left: 4px; color: white; font-size: 16px; text-align: center; position: absolute; left: 0px; top: 2px;"/\x3e').mousedown(function(b){b.stopPropagation();c.window.trigger("close")}))).append(c.preview.add(c.navbar)).append(c.info.hide()).draggable({handle:"div.elfinder-quicklook-titlebar"}).bind("open",
function(b){c._open=!0;b=c.window;var e=c.node;c.closed()&&(c.update(1,c.value),c.navbar.attr("style",""),c.state=1,e.trigger("scrolltoview"),b.css(c.closedCss(e)).show().animate(c.openedCss(),550,function(){c.state=2;c.update(2,c.value);c.openDfd.resolve()}))}).bind("close",function(b){var e=c.window,a=c.preview.trigger("change");b={};var h=function(){c._open=!1;c.state=0;e.hide();a.children().remove();c.update(0,c.value)};c.opened()&&(state=1,e.is("."+c.fullscreen)&&c.fsicon.mousedown(),b.length?
e.animate(c.closedCss(b),500,h):h())});d&&d.append(c.window);d=this.supportTest;c.support={audio:{ogg:d('audio/ogg; codecs\x3d"vorbis"'),mp3:d("audio/mpeg;"),wav:d('audio/wav; codecs\x3d"1"'),m4a:d("audio/x-m4a;")||d("audio/aac;")},video:{ogg:d('video/ogg; codecs\x3d"theora"'),webm:d('video/webm; codecs\x3d"vp8, vorbis"'),mp4:d('video/mp4; codecs\x3d"avc1.42E01E"')||d('video/mp4; codecs\x3d"avc1.42E01E, mp4a.40.2"')}}},constructor:function(c){k.mixin(this,c)},editorOptions:{permissions:[l.ACTION.TOOLBAR,
l.ACTION.RELOAD,"Editor/Settings","View/Increase Font Size","View/Decrease Font Size","View/Themes","File/Search"]},title:"Preview",width:450,height:300,fm:null,state:0,navicon:"elfinder-quicklook-navbar-icon",fullscreen:"elfinder-quicklook-fullscreen",parent:null,cwd:null,resize:"resize.elfinder-finder",alwaysEnabled:!0,value:null,handlers:{select:function(){this.update(void 0,this.fm.selectedFiles()[0])},error:function(){self.window.is(":visible")&&self.window.data("hash","").trigger("close")},
"searchshow searchhide":function(){this.opened()&&this.window.trigger("close")}},shortcuts:[{pattern:"space"}],navtrigger:function(c){$(document).trigger($.Event("keydown",{keyCode:c,ctrlKey:!1,shiftKey:!1,altKey:!1,metaKey:!1}))},closedCss:function(c){return{opacity:0,width:20,height:20,top:c?c.offset().top+"px":0,left:c?c.offset().left+"px":0}},openedCss:function(){var c=this.container?$(this.container):null,a=c||$(window),d=c?"100%":Math.min(this.width,a.width()-10),c=c?"100%":Math.min(this.height,
a.height()-80);return{opacity:1,width:d,height:c,top:parseInt((a.height()-c-60)/2+a.scrollTop()),left:parseInt((a.width()-d)/2+a.scrollLeft())}},supportTest:function(c){var a=document.createElement(c.substr(0,c.indexOf("/"))),d=!1;try{d=a.canPlayType&&a.canPlayType(c)}catch(g){}return d&&""!==d&&"no"!=d},changeView:function(c){this.currentView&&(k.destroy(this.currentView),this.currentView.destroy&&this.currentView.destroy())},update:function(c){this._open=c;this._emit("changeState",c);if(1==c&&this.onAnimate)this.onAnimate();
if(2==c&&this.onOpened)this.onOpened();if(0==c&&this.onClosed)this.onClosed()},closed:function(){return 0==this.state},opened:function(){return 2==this.state},bind:function(c,a){var d;if("function"==typeof a)for(c=(""+c).toLowerCase().split(/\s+/),d=0;d<c.length;d++)void 0===listeners[c[d]]&&(listeners[c[d]]=[]),listeners[c[d]].push(a);return this},one:function(c,a){var d=this,g=$.proxy(a,function(e){setTimeout(function(){d.unbind(e.type,g)},3);return a.apply(this,arguments)});return this.bind(c,
g)},open:function(c){var a=this;c=a.window;var d=a.node;a._open=!0;a.openDfd=new n;a.closed()?(a.navbar.attr("style",""),a._open=!0,a.state=1,d&&d.trigger("scrolltoview"),c.css(a.closedCss(d)).show().animate(a.openedCss(),550,function(){a.state=2;a.update(1,a.value);a.openDfd.resolve()})):a.openDfd.resolve();return a.openDfd},close:function(c){this._open=!1;var a=this,d=a.window,g=a.preview.trigger("change");c=a.node;var e=function(){a.state=0;d.hide();g.children().remove();a.update(0,a.value);a.closeDfd&&
a.closeDfd.resolve()};a.opened()&&(a.state=1,d.is("."+a.fullscreen)&&a.fsicon.mousedown(),c&&c.length?d.animate(a.closedCss(c),500,e):e());return a.closeDfd},getstate:function(){return 2==this.state?1:0},exec:function(){this.window.trigger(this.opened()?"close":"open")},hideinfo:function(){this.info.stop(!0).hide()}});f=p(f,{destroy:function(){this.close();this.preview.trigger($.Event("update",{file:null}));this.inherited(arguments);k.destroy(this._editor);k.destroy(this.preview);k.destroy(this.window)},
onOpened:function(){var c=this;c.fm={url:function(a,d,g){return c.delegate.getImageUrl(a,d,g)}};c.preview.trigger($.Event("update",{file:c.item}))},onClosed:function(){},onAnimate:function(){}});p=p(f,{resize:function(){this.preview.trigger("changesize")},constructor:function(c){this.parent=$(c._parent.containerNode);this.container=c._parent.containerNode;this.resizeToParent=!0;this.delegate=c.ctx.getFileManager();this.item=c.item;this.buildRenderingEmbedded();this.domNode=this.info[0]},openItem:function(c){this.id=
k.createUUID();w.add(this);this.item=c||this.item;this.init();this.exec();this.window.css({height:"100%",width:"100%"});this._parent.add(this,null,!1);this.preview.trigger($.Event("update",{file:this.item}));this._parent.resize();this.resize()}});f.EditorClass=p;return f})},"xfile/views/FilePicker":function(){define("dcl/dcl xide/types xide/utils xide/factory module xide/_base/_Widget xdocker/Docker2 xfile/ThumbRenderer dojo/promise/all xfile/Breadcrumb".split(" "),function(p,l,k,f,a,d,n,w,t,r){return p(d,
{declaredClass:"xfile.views.FilePicker",templateString:'\x3cdiv class\x3d"FilePicker"\x3e\x3c/div\x3e',resizeToParent:!0,docker:null,dockerOptions:{resizeToParent:!0},breadcrumb:null,leftStore:null,rightStore:null,storeOptionsMixin:null,storeOptions:null,leftGrid:null,leftGridArgs:null,rightGrid:null,rightGridArgs:null,removePermissions:[l.ACTION.OPEN_IN_TAB],defaultGridArgs:{registerEditors:!1,_columns:{Name:!0,Path:!1,Size:!1,Modified:!1}},selection:null,mount:"root",_selection:null,getDocker:function(){if(this.docker)return this.docker;
var a=this.dockerOptions||{resizeToParent:!0},a=this.docker||n.createDefault(this.domNode,a);a.resizeToParent=!0;this.add(a,null,!1);return this.docker=a},createLayout:function(){var a=this.getDocker();this.layoutTop=a.addPanel("DefaultFixed",l.DOCKER.DOCK.TOP,null,{h:50,title:!1});this.layoutTop._minSize.y=50;this.layoutTop._maxSize.y=50;this.layoutTop._scrollable={x:!1,y:!1};this.breadcrumb=k.addWidget(r,{},null,this.layoutTop,!0);this.layoutLeft=a.addPanel("DefaultFixed",l.DOCKER.DOCK.BOTTOM,null,
{w:100,title:!1});this.layoutLeft._minSize.x=150;this.layoutLeft.moveable(!0);this.layoutMain=a.addPanel("DefaultFixed",l.DOCKER.DOCK.RIGHT,this.layoutLeft,{w:"70%",title:!1});this.layoutTop.initSize(100,"100%");this.layoutLeft.initSize("100%",150);a.resize()},setSelection:function(a){this._selection=a},connectGrids:function(a,c){var d=this;c._on("selectionChanged",function(a){"deselect"!==a.why&&(a=c.getSelection(),c.getSelectedItem()&&d.setSelection(a))});a._on("selectionChanged",function(f){f=
a.getSelection();var g=a.getSelectedItem();g||(g=a.getCurrentFolder());if(g){var e=null;g.directory?e=g:(g.getParent||console.error("item has no item.getParent!"),e=g.getParent?g.getParent():null);e&&c.openFolder(e.path,!1);g&&d.setSelection(f)}})},createFileGrid:function(a,c,d){return this.Module.createDefault(this.ctx,d,c,!1,!0,a)},onLeftGridReady:function(a){},onRightGridReady:function(a){},onError:function(a,c){},startGrids:function(a,c){var d=this,f=a.collection,g=c.collection,e={focus:!0,append:!1},
b=[a.refresh(),c.refresh()],h=this.selection,m=k.pathinfo(h,l.PATH_PARTS.ALL).dirname||"";"."===m&&(m=h);a.showStatusbar&&a.showStatusbar(!1);a._on("changeSource",function(b){c.changeSource(b,!0)});a._on("changedSource",function(b){a.select([0],null,!0,e)});c._on("changeSource",function(b){a.changeSource(b,!0)});c._on("changedSource",function(b){a.select([0],null,!0,e)});t(b).then(function(){d.onLeftGridReady(a);d.onRightGridReady(c);d.getDocker().resize();t([f.getItem(m,!0),g.getItem(m,!0)]).then(function(b){t(_.invoke([a],
"openFolder",m)).then(function(){t(_.invoke([a,c],"select",[h],null,!0,e)).then(function(){h._selection=h;d.connectGrids(a,c)},function(b){d.onError(b,"selecting items")})},function(b){d.onError(b,"open folder")})},function(b){d.onError(b,"loading items")})},function(b){d.onError(err,"refresh grid")})},setupBreadcrumb:function(a,c,d){function f(b,a,c){g.grid!=c&&g.setSource(c);g.clear();g.setPath(".",e.getRootItem(),a.getPath(),b)}var g=this.breadcrumb;a.getCurrentFolder();var e=a.collection,b=c.collection;
g.setSource(a);this.addHandle("click",a.on("click",function(){g.setSource(a)}));this.addHandle("click",c.on("click",function(){g.setSource(c)}));a._on("openFolder",function(b){f(e,b.item,a)});c._on("openFolder",function(e){f(b,e.item,c)})},destroy:function(){k.destroy(this.leftStore);k.destroy(this.rightStore);k.destroy(this.leftGrid);k.destroy(this.rightGrid);k.destroy(this.breadcrumb);k.destroy(this.docker)},startup:function(){this.createLayout();var a=this.layoutLeft,c=this.layoutMain,d=this.ctx,
n=d.config,g=this.mount||"root",e=this.storeOptions,b=this.storeOptionsMixin||{includeList:"*.jpg,*.png",excludeList:"*"},h=this.leftStore||f.createFileStore(g,e,n,b,d,b),d=this.rightStore||f.createFileStore(g,e,n,b,d,b),g=this.layoutMain,n=k.mixin({},k.clone(this.defaultGridArgs)),u=this.removePermissions,g=k.mixin(n,this.leftGridArgs||{newTarget:g});_.remove(g.permissions,function(b){return-1!==_.indexOf(u,b)});this.leftGrid=a=this.leftGrid||this.createFileGrid(h,a,g);h=k.mixin(n,this.rightGridArgs||
{selectedRenderer:w});_.remove(h.permissions,function(b){return-1!==_.indexOf(u,b)});this.rightGrid=c=this.rightGrid||this.createFileGrid(d,c,h);return this.startGrids(a,c)}})})},"xfile/Breadcrumb":function(){define(["dcl/dcl","xide/widgets/TemplatedWidgetBase","xide/model/Path","xide/_base/_Widget"],function(p,l,k,f){return p(f,{templateString:"\x3cul attachTo\x3d'root' style\x3d'-webkit-app-region:drag' class\x3d'breadcrumb'\x3e\x3c/ul\x3e",grid:null,destroy:function(){this.clear();this.grid=null},
setSource:function(a){if(this.grid!=a){this.grid=a;var d=a.collection;this.clear();var f=a.getBreadcrumbPath?a.getBreadcrumbPath():null;!1!==f&&(f?this.setPath(f.root,null,f,null):d&&a.getCurrentFolder&&(a=(a=a.getCurrentFolder())?a.path:"",this.setPath(".",d.getRootItem(),a,d)))}},setPath:function(a,d,f,w,l){this.clear();d&&a&&this.addSegment(a,!0,d);a=(new k(f)).getSegments();var n=l||".";_.each(a,function(a){var c=n+"/"+a;this.addSegment(a,!0,w?w.getSync(c):null);n=c},this)},onClick:function(a,
d,f){this._emit("click",{element:f,event:d,label:a,data:f.data})},addSegment:function(a,d,f){if(f&&this.has(f))return null;var n=this;a=$("\x3cli class\x3d'"+(d?"active":"")+"'\x3e\x3ca href\x3d'#'\x3e"+a+"\x3c/a\x3e\x3c/li\x3e");_.each(this.all(),function(a){a.el.removeClass("active")});$(this.domNode).append(a);f&&(a.on("click",function(a){n.grid&&n.grid.openFolder(f)}),a[0].data=f);return a},pop:function(){this.last().remove()},last:function(){return $(this.root).children().last()},has:function(a){for(var d=
this.all(),f=0;f<d.length;f++)if(d[f].data.path===a.path)return!0;return!1},all:function(){var a=[];_.each(this.$root.children(),function(d){a.push({el:$(d),label:d.outerText,data:d.data})});return a},clear:function(){for(var a=this.all();a.length;){var d=a[a.length-1];d.el.remove();d.data=null;a.remove(d)}},unwind:function(a){var d=this.all().reverse();_.each(d,function(d){d.data&&d.data.path!==(a&&a.path)&&"."!==d.data.path&&this.pop()},this)},startup:function(){this._on("click",function(a){a=a.element[0].data;
var d=this.grid;a&&(this.unwind(a),d&&d.openFolder(a))}.bind(this))}})})},"xfile/Statusbar":function(){define(["xdojo/declare","xide/types","xfile/Breadcrumb"],function(p,l,k){return p("xgrid.Statusbar",null,{statusbar:null,setState:function(f){this.showStatusbar(f.statusBar);return this.inherited(arguments)},getState:function(f){f=this.inherited(arguments)||{};f.statusBar=null!=this.statusbar;return f},runAction:function(f){f.command==l.ACTION.STATUSBAR&&this.showStatusbar(this.statusbar?!1:!0);
return this.inherited(arguments)},showStatusbar:function(f,a){!f&&this.statusbar?this._destroyStatusbar():f&&this.getStatusbar();this.resize();this._statusbarAction&&!0!==a&&this._statusbarAction.set("value",f)},_destroyStatusbar:function(){this.statusbarRoot&&this.statusbarRoot.remove();this.statusbarRoot=this.statusbar=null},_statusbarAction:null,buildRendering:function(){this.inherited(arguments);var f=this;this._on("onAddActions",function(a){var d=a.actions,n=l.ACTION.STATUSBAR;a.store.getSync(n)||
(a=f.createAction({label:"Statusbar",command:n,icon:l.ACTION_ICON.STATUSBAR,tab:"View",group:"Show",mixin:{actionType:"multiToggle"},onCreate:function(a){a.set("value",null!==f.statusbar);f._statusbarAction=a},onChange:function(a,d,n){f.showStatusbar(d,!0)}}),d.push(a))})},getStatusbar:function(){return this.statusbar?this.statusbar:this.createStatusbar()},onRenderedStatusBar:function(f,a,d){f=this.__bc;!f&&a&&a.append&&(f=new k({},$("\x3cdiv\x3e")),a.append(f.domNode),$(f.domNode).css({"float":"right",
padding:0,"margin-right":10,top:0,right:50,position:"absolute"}),this.__bc=f,f.setSource(this));f&&(f.clear(),a=this.collection,d=(d=this.getCurrentFolder())?d.path:"",f.setPath(".",a.getRootItem(),d,a))},onStatusbarCollapse:function(f){},createStatusbar:function(f){f=f=this.footer;var a=this.statusbar,d=this;if(!a){var n=$('\x3cdiv class\x3d"statusbar widget" style\x3d"width:inherit;padding: 0;margin:0;padding-left: 4px;"\x3e\x3c/div\x3e')[0];f.appendChild(n);a=$('\x3cdiv class\x3d"status-bar-text ellipsis" style\x3d"display: inline-block;"\x3e0 items selected\x3c/div\x3e')[0];
n.appendChild(a);var k=$('\x3cdiv class\x3d"status-bar-collapser fa-caret-up" style\x3d"" \x3e\x3c/div\x3e');k.click(function(a){d.onStatusbarCollapse(k)});f=k[0];n.appendChild(f);this.statusbar=a;this.statusbarCollapse=f;this.statusbarRoot=n;this._emit("createStatusbar",{root:n,statusbar:a,collapser:f})}return a},startup:function(){function f(a){if(0==a)return"0 Byte";var d=parseInt(Math.floor(Math.log(a)/Math.log(1024)));return Math.round(a/Math.pow(1024,d),2)+" "+["Bytes","KB","MB","GB","TB"][d]}
function a(a){var d=0,n="0 KB";_.each(a,function(a){d+=a.sizeBytes||0});0<d&&(n=f(d));return{bytes:d,sizeStr:n}}this.inherited(arguments);if(this.hasPermission(l.ACTION.STATUSBAR)){var d=this.getStatusbar(),n=this;d&&this._on("selectionChanged",function(f){var k=f.selection||[];f=k.length;k=a(k);f=f+"  "+n.localize("selected")+" ("+k.sizeStr+")";d.innerHTML=f;if(n.onRenderedStatusBar)n.onRenderedStatusBar(d,n.statusbarRoot,f)})}}})})},"xfile/views/UploadMixin":function(){define(["xdojo/declare","xide/utils",
"xide/types","dojo/promise/all"],function(p,l,k,f){return p("xfiles.views.UploadMixin",null,{cssClass:"uploadFilesList droparea dropareaHover",__currentDragOverRow:null,__currentDragOverTimer:null,__currentDragOverTimeRow:null,buildRendering:function(){this.inherited(arguments);$(this.domNode).addClass(this.cssClass)},_createUploadItemTemplate:function(a,d,f){return'\x3cdiv class\x3d"" style\x3d"position: relative;margin: 0.1em;height: auto"\x3e\x3cdiv style\x3d"margin:0;vertical-align: middle;padding: 1px;" class\x3d"progress" role\x3d"progressbar" aria-valuemin\x3d"0" aria-valuemax\x3d"100"\x3e\x3cdiv class\x3d"progress-bar progress-bar-info" style\x3d"width:'+
d+';background-color: rgba(102, 161, 179, 0.35);height:auto;magin:0;"\x3e\x3cspan class\x3d"'+(f.failed?"text-danger":"text-info")+'" style\x3d"left: 0px"\x3e'+a+"\x3c/span\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e"},_createUploadItems:function(a){function d(a){var c={sizeBytes:l.humanFileSize(a.size),size:l.humanFileSize(a.size),name:a.name,type:a.type,path:t.path+"/"+a.name+"__uploading__"+Math.random(2),isDir:!1,mount:t.mount,parent:t.path,progress:0,isUpload:!0,modified:a.lastModified/1E3,renderColumn:function(a,
c,d){if("name"===a)return f._createUploadItemTemplate(d.name,d.progress+"%",d);if("sizeBytes"===a&&100>d.progress)return l.humanFileSize(d.loaded)+" of "+l.humanFileSize(d.total)}};k.putSync(c);c=k.getSync(c.path);return a._item=c}var f=this,k=this.collection,t=this.getCurrentFolder();this.__currentDragOverRow&&(t=this.__currentDragOverRow.data);var r=[];_.each(a,function(a){r.push(d(a))});return r},_onAllUploaded:function(a){a=this._toUploadItems(a);var d=this;_.each(a,function(a){var d=a._store?
a:a._item;d&&(d.progress=d.failed?0:100,d.refresh(),setTimeout(function(){d.remove()},1))});setTimeout(function(){d.runAction(k.ACTION.RELOAD).then(function(){})},1)},_onBrowserFilesDropped:function(a,d,f){var k=this.ctx.getFileManager(),n=a.getCurrentFolder();this.__currentDragOverRow&&(n=this.__currentDragOverRow.data);this._createUploadItems(d);return k.upload(d,n.mount,n?n.path:"./tmp",a,f)},_onUploadFailed:function(a){a&&(a.failed=!0,a.done=!0)},_onSomeFileUploaded:function(a){var d=this;a&&
(a.progress=100,a.done=!0,a.renderColumn=null,a.renderRow=null,a.refresh(),setTimeout(function(){d.runAction(k.ACTION.RELOAD).then(function(){});a.remove()},1));return!0},_toUploadItems:function(a){var d=[];_.each(a,function(a){_.each(a,function(a){d.push(a)})});return d},_toUploadStoreItem:function(a){return a.file._item},onBrowserFilesDropped:function(a,d){function k(){var a=0;_.each(t,function(c){c.done&&a++});a==t.length&&l._onAllUploaded(d)}a=this._onBrowserFilesDropped(this,d,a);var l=this,
t=l._toUploadItems(d),r=1==t.length;f(a).then(this._onAllUploaded.bind(this,[d]));_.each(a,function(a){a.then(function(a){!r&&l._onSomeFileUploaded(l._toUploadStoreItem(a))&&k()},function(a){l._onUploadFailed(l._toUploadStoreItem(a));r&&l._onAllUploaded(d);!r&&k()},function(a){var c=a.progress;a=a.item.file._item;var d=Math.round(100*c.loaded/c.total);a&&(a.progress=d,a.loaded=c.loaded,a.total=c.total,a.refresh())})})},onBrowserUrlDropped:function(a,d){if(this.delegate&&this.delegate.onBrowserUrlDropped)this.delegate.onBrowserUrlDropped(this,
d)},dragEnter:function(a){a.preventDefault()},dragLeave:function(a){},dragOver:function(a){a.preventDefault();if(this.row){var d=this;a=this.row(a);var f=this.__currentDragOverRow,k=f?f.data:null;this.__currentDragOverRow&&$(this.__currentDragOverRow.element).removeClass("dgrid-focus");a&&a.element&&a.data&&!0===a.data.directory?(this.__currentDragOverTimer||(d.__currentDragOverTimeRow=a,d.__currentDragOverTimer=setTimeout(function(){var a=d.__currentDragOverTimeRow.data;a&&k&&a==k?(d.__currentDragOverTimeRow=
null,d.__currentDragOverTimer=null,d.openFolder(a)):d.__currentDragOverTimer=null},1550)),this.__currentDragOverRow=a,$(a.element).addClass("dgrid-focus")):this.__currentDragOverRow=null}},drop:function(a){a.preventDefault();var d=a.dataTransfer;if(d)if((d=d.files)&&d.length){if(this.onBrowserFilesDropped)this.onBrowserFilesDropped(this,d)}else try{var f=a.dataTransfer.getData("text/plain");if(f&&f.length)this.delegate.onBrowserUrlDropped(this,f)}catch(w){console.error("dropping url failed "+w)}},
initDND:function(){var a=this,d=this.domNode;d?(d.addEventListener("dragover",function(d){a.dragOver(d)},!1),d.addEventListener("drop",function(d){d.preventDefault();a.drop(d)},!1)):console.error("have not drop destination")},startup:function(){if(!this._started){var a=this.inherited(arguments);this.initDND();return a}}})})},"xfile/FolderSize":function(){define("xdojo/declare xide/types xide/utils xfile/Breadcrumb xide/layout/_TabContainer xfile/views/FileSize".split(" "),function(p,l,k,f,a,d){return p("xfile.FolderSize",
null,{__sizeDisplay:null,__bottomTabContainer:null,__bottomPanel:null,__sizesTab:null,showStats:function(f){var n=this.getBottomTabContainer(),l=this.__sizesTab,r=this.__sizeDisplay,m=this,c=this._getBottom(),q=c&&c.isExpanded();if(1==q&&c)f=!1;else if(!q&&c)return c.expand();if(f){c||(c=this.getBottomPanel(!1,.2));if(c&&r)return c.expand();n||(this.__bottomTabContainer=n=f=k.addWidget(a,{direction:"below"},null,c,!0),c._tabs=f);l||(l=this.__sizesTab=n.createTab("Sizes","fa-bar-chart"));r||(r=this.__sizeDisplay=
l.add(d,{owner:m},null,!1),r.startup(),this._on("openedFolder",function(a){k.destroy(m.__sizeDisplay);l.resize();m.resize();m.__sizeDisplay=null;m.__sizeDisplay=k.addWidget(d,{owner:m},null,l,!1);k.resizeTo(m.__sizeDisplay,l,!0,!0);m.__sizeDisplay.startup()}))}else c&&c.collapse()},_runAction:function(a){var d=this.getAction(a);return d&&d.command==l.ACTION.SIZE_STATS?this.showStats(this.__sizeDisplay?!1:!0):this.inherited(arguments)},buildRendering:function(){this.inherited(arguments);this._on("onAddActions",
function(a){})}})})},"xfile/views/FileSize":function(){define(["dcl/dcl","xide/_base/_Widget"],function(p,l){return p(l,{_find:function(k,f){var a=_.find(f,{path:k}),d=this;if(a&&a.children&&a.children){var n=d._find(k,a.children);n&&(a=n)}a||_.each(f,function(f){var n=null;f.children&&f.children.length&&(n=d._find(k,f.children))&&(a=n)});return a},select:function(k){(k=this._find(k,this.d3Nodes))&&this.highlight(k)},direction:"left",templateString:'\x3cdiv class\x3d"sizeDisplay tabbable tabs-${!direction}" attachTo\x3d"containerNode" style\x3d"width: inherit;height: 100%;padding: 4px"\x3e\x3cul class\x3d"nav nav-tabs tabs-right" role\x3d"tablist"\x3e\x3cli class\x3d"active"\x3e\x3ca href\x3d"#_tab-content2_${!id}" data-toggle\x3d"tab"\x3eOverall\x3c/a\x3e\x3c/li\x3e\x3cli\x3e\x3ca href\x3d"#_tab-content1_${!id}" data-toggle\x3d"tab"\x3eBy Type\x3c/a\x3e\x3c/li\x3e\x3c/ul\x3e\x3cdiv class\x3d"body tab-content"\x3e\x3cdiv attachTo\x3d"tab2" id\x3d"_tab-content2_${!id}" class\x3d"tab-pane active clearfix"\x3e\x3cdiv class\x3d"chart1" attachTo\x3d"chart1" style\x3d"width: 100%;height: inherit;min-height:250px"\x3e\x3cdiv class\x3d"" style\x3d"" id\x3d"detailInfo"\x3e\x3c/div\x3e\x3cdiv class\x3d"widget" id\x3d"explanation" \x3e\x3cspan id\x3d"percentage"\x3e\x3c/span\x3e\x3cbr/\x3e\x3cspan id\x3d"percentageDetail"\x3e\x3c/span\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv attachTo\x3d"tab1" id\x3d"_tab-content1_${!id}" class\x3d"tab-pane"\x3e\x3csvg class\x3d"chart2" style\x3d"width: 100%;height: inherit;min-height:250px"\x3e\x3c/svg\x3e\x3cdiv id\x3d"tooltip" class\x3d"hidden"\x3e\x3cspan id\x3d"chart2Per1"\x3eA\x3c/span\x3e \x3cbr\x3e\x3cspan id\x3d"chart2Per2"\x3e100\x3c/span\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e',
data:null,owner:self,vis:null,d3Nodes:null,colors:{dir:"#5687d1",jpeg:"#9b59b6",jpg:"#9b59b6",png:"#9b59b6",gif:"#9b59b6",psd:"#9b59b6",mp3:"#3498db",wav:"#3498db",wma:"#3498db",wmv:"#2ecc71","3gp":"#2ecc71",mp4:"#2ecc71",plv:"#2ecc71",mpg:"#2ecc71",mpeg:"#2ecc71",mkv:"#2ecc71",rm:"#2ecc71",rmvb:"#2ecc71",mov:"#2ecc71",doc:"#1abc9c",xls:"#1abc9c",ppt:"#1abc9c",docx:"#1abc9c",xlsx:"#1abc9c",pptx:"#1abc9c",pages:"#e74c3c",key:"#e74c3c",numbers:"#e74c3c",pdf:"#7b615c",epub:"#7b615c",c:"#f1c40f",cpp:"#f1c40f",
h:"#f1c40f",html:"#f1c40f",js:"#f1c40f",css:"#f1c40f",pl:"#f1c40f",py:"#f1c40f",php:"#f1c40f",sql:"#f1c40f",csv:"#de783b",odp:"#de783b",gz:"#6ab975",tar:"#6ab975",rar:"#6ab975",zip:"#6ab975","7z":"#6ab975","default":"#34495e"},totalSize:0,result:{},overallSize:0,buildHierarchy:function(k){for(var f={name:"root",children:[]},a=0;a<k.length;a++){var d=k[a][0],n=+k[a][1];if(!isNaN(n))for(var l=d.split("/"),p=f,r=0;r<l.length;r++){var m=p.children,c=l[r],q;if(r+1<l.length){for(var p=!1,v=0;v<m.length;v++)if(m[v].name==
c){q=m[v];p=!0;break}p||(q={name:c,type:"dir",children:[],path:d},m.push(q));p=q}else q=c.split(".").pop(),7>q.length&&(this.result[q]=q in this.result?this.result[q]+n:n),q={name:c,type:q,size:n,path:d},this.overallSize+=n,m.push(q)}}return f},bytesToSize:function(k){var f=["Bytes","KB","MB","GB","TB"];if(0==k)return"n/a";var a=parseInt(Math.floor(Math.log(k)/Math.log(1024)));return 0==a?k+" "+f[a]:(k/Math.pow(1024,a)).toFixed(1)+" "+f[a]},getAncestors:function(k){for(var f=[];k.parent;)f.unshift(k),
k=k.parent;return f},highlight:function(k){if(k){var f=(100*k.value/this.totalSize).toPrecision(3),a=f+"%";.1>f&&(a="\x3c 0.1%");var d=this.bytesToSize(k.value)+"/"+this.bytesToSize(this.totalSize),f=this.colors;d3.select("#percentage").text(a);d3.select("#percentageDetail").text(d);d3.select("#explanation").style("visibility","");var n=this.getAncestors(k);k=n.length;a="";for(d=0;d<k;d++)var l=n[d].type,a="dir"==l?a+('\x3cspan style\x3d"color:'+f[l]+'"\x3e'+n[d].name+"/\x3c/span\x3e"):a+('\x3cspan style\x3d"color:'+
f[l]+'"\x3e'+n[d].name+"\x3c/span\x3e");$("#detailInfo").html(a);d3.selectAll("path").style("opacity",.3);this.vis.selectAll("path").filter(function(a){return 0<=n.indexOf(a)}).style("opacity",1)}else console.error("cant find "+path)},createChart1:function(k,f,a,d,n){function l(a){var c=(100*a.value/r.totalSize).toPrecision(3),d=c+"%";.1>c&&(d="\x3c 0.1%");c=r.bytesToSize(a.value)+"/"+r.bytesToSize(r.totalSize);d3.select("#percentage").text(d);d3.select("#percentageDetail").text(c);d3.select("#explanation").style("visibility",
"");var m=r.getAncestors(a);a=m.length;d="";for(c=0;c<a;c++)var g=m[c].type,d="dir"==g?d+('\x3cspan style\x3d"color:'+p[g]+'"\x3e'+m[c].name+"/\x3c/span\x3e"):d+('\x3cspan style\x3d"color:'+p[g]+'"\x3e'+m[c].name+"\x3c/span\x3e");$("#detailInfo").html(d);d3.selectAll("path").style("opacity",.3);f.selectAll("path").filter(function(a){return 0<=m.indexOf(a)}).style("opacity",1)}f.append("svg:circle").attr("r",n).style("opacity",0);var p=this.colors,r=this;a=d3.layout.partition(n).size([2*Math.PI,n*
n]).value(function(a){return a.size}).nodes(k,n).filter(function(a){return.005<a.dx});d=d3.svg.arc().startAngle(function(a){return a.x}).endAngle(function(a){return a.x+a.dx}).innerRadius(function(a){return Math.sqrt(a.y)}).outerRadius(function(a){return Math.sqrt(a.y+a.dy)});k=f.data([k]).selectAll("path").data(a).enter().append("svg:path").attr("display",function(a){return a.depth?null:"none"}).attr("d",d).attr("fill-rule","evenodd").style("fill",function(a){return p[a.type]?p[a.type]:p["default"]}).style("opacity",
1).on("mouseover",l);d3.select("#container").on("mouseleave",function(a){d3.select("#trail").style("visibility","hidden");d3.selectAll("path").on("mouseover",null);d3.selectAll("path").transition().duration(1E3).style("opacity",1).each("end",function(){d3.select(this).on("mouseover",l)});d3.select("#explanation").transition().duration(1E3).style("visibility","hidden");$("#detailInfo").html("")});this.totalSize=k.node().__data__.value;return a},render:function(k){var f=$(this.tab2),a=f.height()-50,
f=f.height()-50;400>a&&(a=400);300>f&&(f=300);var d=f,n=d3.select(this.chart1).append("svg:svg").attr("width",a).attr("height",f).append("svg:g").attr("id","container").attr("transform","translate("+f/2+","+f/2+")"),a=this.createChart1(k,n,a,f,d/4,n);k=[];for(var l in this.result)if(d=this.result[l]/this.overallSize,!(.001>d)){var p=this.bytesToSize(this.result[l])+"/"+this.bytesToSize(this.overallSize);k.push({filetype:l,usage:d,detail:p})}this.vis=n;this.d3Nodes=a;a=$(this.tab1).width();400>a&&
(a=400);this.createChart2(k,a,f-100)},createChart2:function(k,f,a){var d=d3.scale.ordinal().rangeRoundBands([0,f],.1),n=d3.scale.linear().range([a,0]),l=d3.svg.axis().scale(d).orient("bottom"),p=d3.svg.axis().scale(n).orient("left"),r=this.colors;f=d3.select(this.tab1.children[0]).attr("width",f+40+30).attr("height",a+20+30).append("g").attr("transform","translate(40,20)");d.domain(k.map(function(a){return a.filetype}));n.domain([0,d3.max(k,function(a){return a.usage})]);f.append("g").attr("class",
"x axis").attr("transform","translate(0,"+a+")").call(l);f.append("g").attr("class","y axis").call(p);f.selectAll(".bar").data(k).enter().append("rect").attr("class","bar").attr("id",function(a){return"bar"+a.filetype}).attr("x",function(a){return d(a.filetype)}).attr("y",function(a){return n(a.usage)}).attr("height",function(d){return a-n(d.usage)}).attr("width",d.rangeBand()).attr("fill",function(a){return r[a.filetype]?r[a.filetype]:r["default"]}).on("mouseover",function(f){d3.select(this).transition().duration(50).attr("fill",
"#7f8c8d");var c=parseFloat(d3.select(this).attr("x"))+d.rangeBand()/2,k=parseFloat(d3.select(this).attr("y"))/2+a/2,m=parseFloat(100*f.usage).toFixed(2)+"%("+f.filetype+")";d3.select("#tooltip").style("left",c+"px").style("top",k+"px").select("#chart2Per2").text(f.detail);d3.select("#chart2Per1").text(m);d3.select("#tooltip").classed("hidden",!1)}).on("mouseout",function(){d3.select(this).transition().delay(100).duration(250).attr("fill",function(a){return r[a.filetype]?r[a.filetype]:r["default"]});
d3.select("#tooltip").classed("hidden",!0)})},startup:function(){if(this.owner){var k=this.owner,f=k.getRows(),a=[];_.each(f,function(d){a.push([d.path.replace("./",""),""+d.sizeBytes])});f=this.buildHierarchy(a);this.render(f);var d=this;k._on("selectionChanged",function(a){if("clear"!=a.why){a=(a=a.selection)?a[0]:null;var f=k.row(a),f=f?f.element:null;a&&f&&(a=a.path.replace("./",""),d.d3Nodes&&d.select(a))}})}}})})},"xfile/views/FileGrid":function(){define("xdojo/declare dojo/Deferred xide/types xide/utils xide/views/History xaction/DefaultActions xfile/views/Grid xfile/factory/Store xide/model/Path xfile/model/File xfile/types xlang/i18 xide/$".split(" "),
function(p,l,k,f,a,d,n,w,t,r,m,c,q){t=m.DEFAULT_FILE_GRID_PERMISSIONS;var v=p("xfile.views.FileGrid",n,{resizeAfterStartup:!0,formatters:{},hideExtensions:!1,menuOrder:{File:110,Edit:100,View:50,Settings:20,Navigation:10,Window:5},groupOrder:{Clipboard:110,File:100,Step:80,Open:70,Organize:60,Insert:10,Navigation:5,Select:0},tabOrder:{Home:100,View:50,Settings:20,Navigation:10},noDataMessage:"\x3cspan/\x3e",_history:null,options:f.clone(k.DEFAULT_GRID_OPTIONS),_columns:{},toolbarInitiallyHidden:!0,
itemType:k.ITEM_TYPE.FILE,permissions:t,contextMenuArgs:{limitTo:null,actionFilter:{quick:!0}},setState:function(a){this.inherited(arguments);var e=this,b=e.collection,c=a.store.path;b.getSync(c);var d=e.refresh();d.then(function(){b.getItem(c,!0).then(function(b){e.openFolder(b)})});return d},postMixInProperties:function(){var a=this.state;a&&a._columns&&(this._columns=a._columns);this.columns||(this.columns=this.getColumns());!this.collection&&this.state&&(a=this.state.store,this.collection=w.createFileStore(a.mount,
a.storeOptions,this.ctx.config).getDefaultCollection());return this.inherited(arguments)},getState:function(a){a=this.inherited(arguments)||{};a.store={mount:this.collection.mount,path:this.getCurrentFolder().path,storeOptions:this.collection.options};a._columns={};_.each(this._columns,function(e){a._columns[e.label]=!this.isColumnHidden(e.id)},this);return a},onSaveLayout:function(a){a=a.data;var e=this.getState();a.widgets.push({widget:this.declaredClass,state:e});return a},formatColumn:function(a,
e,b){var d=this.selectedRenderer?this.selectedRenderer.prototype:this;if(d.formatColumn&&(d=d.formatColumn.apply(arguments))||b.renderColumn&&(d=b.renderColumn.apply(this,arguments)))return d;switch(a){case "fileType":if("folder"==e)return c.localize("kindFolder");if(b.mime){var d="kind"+(b.mime.split("/")[1]||"unknown").toUpperCase(),g=c.localize(d);return d!==g?g:e}case "name":var k=b&&null!=b.directory&&!0===b.directory,m=!1===b.read&&!1===b.write,l=".."==b.name,d="",g=!1,d=k?l?"fa fa-level-up itemFolderList":
m?"fa fa-lock itemFolderList":"fa fa-folder itemFolderList":m?"fa fa-lock itemFolderList":"itemFolderList fa "+f.getIconClass(b.path),g=!0,k=!0===b.showPath?b.path:e;this.hideExtensions&&(k=f.pathinfo(k).filename);return g?'\x3cspan class\x3d"'+d+'""\x3e\x3c/span\x3e\x3cspan class\x3d"name fileGridNameNode" style\x3d"vertical-align: middle;padding-top: 0px"\x3e'+k+"\x3c/span\x3e":'\x3cimg class\x3d"fileGridIconCell" src\x3d" "/\x3e\x3cspan class\x3d"fileGridNameCell"\x3e'+k+"\x3c/span\x3e";case "sizeBytes":return b.size;
case "fileType":return f.capitalize(b.fileType||"unknown");case "mediaInfo":return b.mediaInfo||"unknown";case "owner":return b&&(d=b.owner)&&d.user?d.user.name:"";case "modified":if(""!==e)return k=null==!b.directory,!k&&c.translations.dateFormat?c.formatDate(e).replace("ms",""):""}return e},getColumns:function(a){function e(e,c,d,g){null!=b._columns[e]&&(g=!b._columns[e]);b.columns.push({renderExpando:"Name"===e,label:e,field:c,sortable:d,formatter:function(d,h){return e in a?a[e].apply(b,[c,d,
h]):b.formatColumn(c,d,h)},hidden:g})}a=a||this.formatters;var b=this;this.columns=[];e("Name","name",!0,!1);e("Type","fileType",!0,!0);e("Path","path",!0,!0);e("Size","sizeBytes",!0,!1);e("Modified","modified",!0,!1);e("Owner","owner",!0,!0);e("Media","mediaInfo",!0,!0);return this.columns},_focus:function(){var a=this.getRows();a[0]&&this.focus(this.row(a[0]))},setQueryEx:function(a){if(!a||!a.directory)return!1;this._lastPath=a.getPath();var e=this,b=new l,c=e.collection;"."===a.path?(c.resetQueryLog(),
e.set("collection",c.getDefaultCollection(a.getPath())),b.resolve()):c.open(a).then(function(d){c.resetQueryLog();e.set("collection",c.getDefaultCollection(a.getPath()));b.resolve(d)});return b},getCurrentFolder:function(){var a=this.getSelectedRenderer();if(a&&a.getCurrentFolder&&(a=a.getCurrentFolder.apply(this))){if(a.isBack){var e=this.collection.getSync(a.rPath);e&&(a=e)}return a}if((a=this.getRows()[0])&&(a._S||a._store)){if(!0===a.isBack&&(e=this.getHistory().getNow()))return this.collection.getSync(e);
if(a=a._S.getParent(a))return a}return null},getClass:function(){return v},getHistory:function(){this._history||(this._history=new a);return this._history},_createBackItem:function(a){return{name:"..",path:"..",rPath:a,sizeBytes:0,size:"",icon:"fa-level-up",isBack:!0,modified:"",_S:this.collection,directory:!0,_EX:!0,children:[],mayHaveChildren:!1}},startup:function(){if(!this._started){var c=this.inherited(arguments);q(this.domNode).addClass("xfileGrid");this.set("loading",!0);this.permissions&&
this.addActions([].concat(d.getDefaultActions(this.permissions,this,this).concat(this.getFileActions(this.permissions))));this._history=new a;var e=this;this.subscribe(k.EVENTS.ON_CLIPBOARD_COPY,function(b){b.type===e.itemType&&(e.currentCopySelection=b.selection,e.refreshActions())});e._on("noData",function(){if(!(0<e._total)){var b=e._history.getNow();b&&"./."!==b&&e.renderArray([this._createBackItem(b)])}});this.on("dgrid-refresh-complete",function(){var b=e.getRows();b&&1<b.length&&(b=_.find(b,
{isBack:!0}))&&(e.removeRow(b),e.refresh())});this._on("openFolder",function(b){e.set("title",b.item.name)});e.selectedRenderer&&(c=this.refresh())&&c.then(function(){e.set("loading",!1);e.setRenderer(e.selectedRenderer,!1)});this._on("onChangeRenderer",this.refresh);this._emit("startup");c.then(this.resize.bind(this));return c}}});v.prototype.Module=v;v.Module=v;v.createDefault=function(a,e,b,c,d,k){k={collection:k.getDefaultCollection(),_parent:b,Module:v,ctx:a};f.mixin(k,e||{});e=f.addWidget(v,
k,null,b,d,null,null,!0,null);c&&a.getWindowManager().registerView(e,!1);return e};v.DEFAULT_PERMISSIONS=t;return v})},"xfile/factory/Store":function(){define(["xide/types","xide/factory","xide/utils","xfile/data/Store"],function(p,l,k,f){l.createFileStore=function(a,d,l,w,t,r){d=d||{fields:p.FIELDS.SHOW_ISDIR|p.FIELDS.SHOW_OWNER|p.FIELDS.SHOW_SIZE|p.FIELDS.SHOW_MIME|p.FIELDS.SHOW_PERMISSIONS|p.FIELDS.SHOW_TIME|p.FIELDS.SHOW_MEDIA_INFO};k.mixin(d,w);a=new f(k.mixin({data:[],ctx:t,config:l,url:l.FILE_SERVICE,
serviceUrl:l.serviceUrl,serviceClass:l.FILES_STORE_SERVICE_CLASS,mount:a,options:d},r));a._state={initiated:!1,filter:null,filterDef:null};a.reset();a.setData([]);a.init();t&&t.getFileManager().addStore(a);return a};return l})},"xfile/data/Store":function(){define("dojo/_base/declare dojo/_base/lang dojo/Deferred xide/mixins/ReloadMixin xide/manager/ServerActionBase dstore/Cache dstore/QueryResults xide/types xide/utils dojo/when xide/data/TreeMemory dstore/Trackable xide/data/ObservableStore xfile/model/File xide/lodash".split(" "),
function(p,l,k,f,a,d,n,w,t,r,m,c,q,v,g){function e(){return{addDot:!0,recursive:!1,rootSegment:".",Model:v,idProperty:"path",parentProperty:"path",parentField:"parent",mount:"path",options:{fields:1663,includeList:"*",excludeList:"*"},serviceUrl:null,serviceClass:null,singleton:!0,queryAccessors:!0,autoEmitEvents:!1,mayHaveChildren:function(b){return 0==b.mayHaveChildren?!1:!0===b.directory},_lastFilter:null,_lastFilterDef:null,_lastFilterItem:null,_initiated:{value:!1},id:null,_state:{initiated:!1,
filter:null,filterDef:null},isInitiated:function(){return this._state.initiated},setInitiated:function(b){this._state.initiated=b},_extraSortProperties:{name:{ignoreCase:!0}},constructor:function(){this.id=t.createUUID()},onSorted:function(b,a){if(1==b.length&&"name"===b[0].property){b=b[0].descending;var e=function(b){return b.name},c=g.groupBy(a,function(b){return!0===b.directory},this);a=g.sortBy(c["true"],e);a=a.concat(g.sortBy(c["false"],e));b&&a.reverse()}if(b=g.find(a,{name:".."}))a.remove(b),
a.unshift(b);return a=this.onAfterSort(a)},onAfterSort:function(b){var a=this.micromatch;if("undefined"!==typeof mm&&a&&b&&b[0]){var e=b[0].realPath?"realPath":"path",e="name",c=g.pluck(b,e),d=mm(c,a);b=b.filter(function(b){return-1===d.indexOf(b[e])?null:b});this._onAfterSort&&(b=this._onAfterSort(b))}return b},_createSortQuerier:function(b){var a=this;return function(e){e=e.slice();e.sort("function"==typeof b?b:function(e,c){for(var d=0;d<b.length;d++){var h;if("function"==typeof b[d])h=b[d](e,
c);else{var f=b[d].property;a._extraSortProperties[f]&&t.mixin(b[d],a._extraSortProperties[f]);h=b[d].descending;var g=e.get?e.get(f):e[f],f=c.get?c.get(f):c[f],k=!!b[d].ignoreCase;null!=g&&(g=g.valueOf());null!=f&&(f=f.valueOf());k&&(g.toUpperCase&&(g=g.toUpperCase()),f.toUpperCase&&(f=f.toUpperCase()));h=g===f?0:!!h===(null===g||g>f)?-1:1}if(0!==h)return h}return 0});return a.onSorted(b,e)}},_getItem:function(b,a){"/"===b&&(b=".");var e=this.getSync(b)||this.getSync("./"+b);return e&&(this.isItemLoaded(e)||
1==a)?e:"."===b?this.getRootItem():null},getItem:function(b,a,e){b=b.replace("./","");if(0==a)return this._getItem(b);if(1==a){a=b.split("/");var c=this,d=[],h=c.getSync(b);if(h&&this.isItemLoaded(h))return h;for(var f=new k,u=function(){var a=!g.find(d,{loaded:!1});if(a)f.resolve(c._getItem(b));else{for(var h=0;h<d.length;h++)if(!d[h].loaded){if(a=c.getSync(d[h].path))if(!0===a.directory&&c.isItemLoaded(a)){d[h].loaded=!0;continue}else if(null==a.directory){f.resolve(a);break}c._loadPath(d[h].path,
!1,e).then(function(b){d[h].loaded=!0;u()},function(b){var a=Math.abs(Math.min(0,h-1));b=d[a];b||(a=d.length-1,b=d[a]);c.getItem(b.path);r(c.getItem(d[a].path,!1),function(b){f.resolve(b,d[a].path)})});break}(a=!g.find(d,{loaded:!1}))&&f.resolve(c._getItem(b))}},h=".",m=0;m<a.length;m++)"."!=a[m]&&(0<a.length&&(h+="/"),h+=a[m],d.push({path:h,loaded:!1}));u();return f}return"."===b?this.getRootItem():null},getRootItem:function(){return{_EX:!0,path:".",name:".",mount:this.mount,directory:!0,virtual:!0,
_S:this,getPath:function(){return this.path+"/"}}},getItemByPath:function(){},getParents:function(){return null},getParent:function(b){if(!b)return null;var a=b,e=null;l.isString(a)&&(a=this.getSync(b));a&&a.parent&&(e=this.getSync(a.parent));return e||this.getRootItem()},isItemLoaded:function(b){return b&&(!b.directory||this._isLoaded(b))},loadItem:function(b,a){return this._loadItem(b,a)},_parse:function(b){b._S=this;g.isEmpty(b.children)||(g.each(b.children,function(a){a.parent||(a.parent=b.path);
this._parse(a)},this),b._EX=!0,b.children=this.addItems(b.children));b.getPath=function(){return this.path};this.getSync(b.path)||this.putSync(b)},_loadPath:function(b,a,e){var c=this,d=this._request(b,e);d.then(function(d){var h=c._getItem(b,!0);if(h)return a&&(g.isEmpty(h.children)||c.removeItems(h.children)),h._EX=!0,c.addItems(d,a),h.children=d;if(e&&e.onError)e.onError("Error Requesting path on server : "+b);else throw Error("cant get item at "+b);}.bind(this),function(b){console.error("error in load")});
return d},addSync:function(b,a){(a=a||{}).overwrite=!1;return this.putSync(b,a)},_loadItem:function(b,a){var e=this,c=new k,d=this;if(!b)return c.reject("need item"),c;a&&("."===b.path?(d.setInitiated(!1),d.fetchRange().then(function(a){c.resolve({store:d,items:a,item:b})})):this._loadPath(b.path,!0).then(function(a){a=e.getSync(b.path);c.resolve(a)},function(b){console.error("error occured whilst loading items");c.reject(b)}));return c},_normalize:function(b){return b&&b.items?b.items[0]:[]},_isLoaded:function(b){return b&&
!0===b._EX},fetch:function(){},put:function(){},add:function(b){var a=this.getSync(b.path);a||(a=this.addSync(b),a._S=this,a.getPath=function(){return this.path});return a},removeItems:function(b){g.each(b,function(b){this.getSync(b.path)&&this.removeSync(b.path)},this)},getSync:function(b){b=b||"";var a=this.storage.fullData;return a[this.storage.index[b]]||a[this.storage.index[b.replace("./","")]]},addItems:function(b){var a=[];g.each(b,function(b){this.getSync(b.path)&&this.removeSync(b.path);
a.push(this.add(b))},this);return a},open:function(b){var a=this;if(this._isLoaded(b)){var e=new k;a.resetQueryLog();e.resolve(b.children);return e}b.isLoading=!0;return a._request(b.path).then(function(e){b.isLoading=!1;b._EX=!0;a.addItems(e);return b.children=e})},getDefaultSort:function(){return[{property:"name",descending:!1,ignoreCase:!0}]},filter:function(a){if(a&&"function"===typeof a)return this.inherited(arguments);a.parent&&(this._state.path=a.parent);var b=this.getSync(a.parent);b&&(this.isItemLoaded(b)?
this._state.filterDef=null:(b.isLoading=!0,this._state.filterDef=this._loadPath(b.path),this._state.filterDef.then(function(){b.isLoading=!1})));delete this._state.filter;this._state.filter=a;return this.inherited(arguments)},_request:function(a,e){var b=this,c=this;return this.runDeferred(null,"ls",{path:a,mount:this.mount,options:this.options,recursive:this.recursive},t.mixin({checkErrors:!1,displayError:!0},e),function(a){e&&!1===e.displayError||logError(a,"error in FileStore : "+b.mount+" :"+
a)}).then(function(a){a=c._normalize(a);c._parse(a);return a=a.children||a},function(a){e&&!1===e.displayError||logError(a,"error in FileStore : "+this.mount+" :"+a)})},fetchRangeSync:function(){var a=this.fetchSync(),e=new k;e.resolve(a.length);return new n(a,{totalLength:e})},reset:function(){this._state.filter=null;this._state.filterDef=null;this.resetQueryLog()},resetQueryLog:function(){this.queryLog=[]},fetchRange:function(){var a=this._fetchRange();return new n(a.then(function(a){return a}),
{totalLength:a.then(function(a){return a.length})})},initRoot:function(){var a=this;if(!this.isInitiated())return a._request(".").then(function(b){a.isInitiated()||(g.each(b,a._parse,a),a.setData(b),a.setInitiated(!0),a.emit("loaded"));return a.fetchRangeSync(arguments)}.bind(this));var e=new k;e.resolve();return e},_fetchRange:function(){if(this._state.filter){var a=this._state.filterDef;if(a)return a.then(function(b){this.reset();a&&a.resolve&&a.resolve(b)}.bind(this)),a}var e=this;if(this.isInitiated()){var c=
e.fetchRangeSync(arguments),d=new k,f=new k;d.resolve(c);f.resolve(c.length);e.emit("loaded");return new n(d,{totalLength:c.totalLength})}return e._request(".").then(function(a){e.isInitiated()||(g.each(a,e._parse,e),e.setData(a),e.setInitiated(!0),e.emit("loaded"));return e.fetchRangeSync(arguments)}.bind(this))},getDefaultCollection:function(a){var b=this.getDefaultSort();return null==a?this.sort(b):this.filter(function(b){return b.parent===a}).sort(b)},getChildren:function(a){return this.root.filter({parent:this.getIdentity(a)})},
spin:!0}}p=p("xfile/data/Store",[m,d,c,q,a.declare,f],e());p.Implementation=e;return p})},"xfile/model/File":function(){define(["dcl/dcl","xide/data/Model","xide/utils","xide/types","xide/lodash"],function(p,l,k,f,a){return p(l,{declaredClass:"xfile.model.File",getFolder:function(){var a=this.getPath();return this.directory?a:k.pathinfo(a,f.PATH_PARTS.ALL).dirname},getChildren:function(){return this.children},getParent:function(){return(this.getStore()||this._S).getParent(this)},getChild:function(d){return a.find(this.getChildren(),
{path:d})},getStore:function(){return this._store||this._S}})})},"xfile/config":function(){define(["dojo/_base/declare","xide/types"],function(p,l){l.config={ROOT_NODE:"xapp",FILE_SERVICE:"",START_PATH:"./",FILES_STORE_SERVICE_CLASS:"XCOM_Directory_Service",IS_MEDIA_PICKER:null,EDITOR_NODE:null,EDITOR_AFTER_NODE:null,ACTION_TOOLBAR:null,ALLOWED_DISPLAY_MODES:{TREE:1,LIST:1,THUMB:1,IMAGE_GRID:1},LAYOUT_PRESET:null,beanContextName:null};return l})},"xfile/manager/FileManager":function(){define("dcl/dcl dojo/_base/kernel xide/manager/ServerActionBase xide/types xfile/types xide/utils xide/encoding/SHA1 xide/manager/RPCService dojo/Deferred xdojo/has xfile/manager/FileManagerActions require xfile/factory/Store xide/lodash xdojo/has!electron?xfile/manager/Electron".split(" "),
function(p,l,k,f,a,d,n,w,t,r,m,c,q,v,g){k=[k,m];r("electronx")&&g&&k.push(g);return p(k,{declaredClass:"xfile.manager.FileManager",getNewName:function(a,b){a=a.name.replace(".meta.json","");for(var e=!1,c=1,d=null;!e;)d=a+"-"+c+".meta.json",v.find(b,{name:d})?c++:e=!0;return d},_uploadXHR:null,store:null,config:null,filesToUpload:null,serviceUrl:"index.php",serviceClass:"XCOM_Directory_Service",settingsStore:null,stores:[],getStore:function(a,b){var e=v.find(this.stores,{mount:a});return e&&!1!==
b?e:q.createFileStore(a,null,this.config,null,this.ctx)},addStore:function(a){this.stores.push(a);a._on("destroy",this.removeStore.bind(this))},removeStore:function(a){this.stores.indexOf(a)&&this.stores.remove(a)},download:function(a){[].push(a.path);if(r("nserver"))window.open("/files/"+a.mount+"/"+a.path+"?userDirectory\x3d"+encodeURIComponent(this.ctx.getUserDirectory()));else{var b=decodeURIComponent(this.serviceUrl),b=b.replace("view\x3drpc","view\x3dsmdCall"),b=-1!=b.indexOf("?")?b+"\x26":
b+"?",e=this.serviceClass||"XCOM_Directory_Service";a=d.buildPath(a.mount,a.path,!0);a=this.serviceObject.base64_encode(a);b+="service\x3d"+e+".get\x26path\x3d"+a+"\x26callback\x3dasdf";this.config.DOWNLOAD_URL&&(b=""+this.config.DOWNLOAD_URL,b+="\x26path\x3d"+a+"\x26callback\x3dasdf");var b=b+"\x26raw\x3dhtml\x26attachment\x3d1",c=d.getUrlArgs(location.href);d.mixin(c,{service:e+".get",path:a,callback:"asdf",raw:"html",attachment:"1",send:"1"});delete c.theme;delete c.debug;delete c.width;delete c.attachment;
delete c.send;e=l.toJson(JSON.stringify(c));e=n._hmac(e,this.config.RPC_PARAMS.rpcSignatureToken,1);b+="\x26"+this.config.RPC_PARAMS.rpcUserField+"\x3d"+this.config.RPC_PARAMS.rpcUserValue;b+="\x26"+this.config.RPC_PARAMS.rpcSignatureField+"\x3d"+e;window.open(b)}},getImageUrl:function(a,b,c){if(r("nserver"))return"/files/"+a.mount+"/"+a.path+"?userDirectory\x3d"+encodeURIComponent(this.ctx.getUserDirectory());b=-1!=location.href.indexOf("noImageCache")||!0===b||!0===a.dirty;var e=decodeURIComponent(this.serviceUrl),
e=e.replace("view\x3drpc","view\x3dsmdCall");a=d.buildPath(a.mount,a.path,!0);a=this.serviceObject.base64_encode(a);var f=this.ctx.getFileManager().serviceClass||"XCOM_Directory_Service",e=-1!=e.indexOf("?")?e+"\x26":e+"?",e=e+("service\x3d"+f+".get\x26path\x3d"+a+"\x26callback\x3dasdf");this.config.DOWNLOAD_URL&&(e=""+this.config.DOWNLOAD_URL,e+="\x26path\x3d"+a+"\x26callback\x3dasdf");var e=e+"\x26raw\x3dhtml\x26attachment\x3d0\x26send\x3d1",g=d.getUrlArgs(location.href);d.mixin(g,{service:f+".get",
path:a,callback:"asdf",raw:"html"});d.mixin(g,c);delete g.theme;delete g.debug;delete g.width;a=l.toJson(g);a=n._hmac(a,this.config.RPC_PARAMS.rpcSignatureToken,1);e+="\x26"+this.config.RPC_PARAMS.rpcUserField+"\x3d"+this.config.RPC_PARAMS.rpcUserValue;e+="\x26"+this.config.RPC_PARAMS.rpcSignatureField+"\x3d"+a;b&&(e+="\x26time\x3d"+(new Date).getTime());if(c)for(var h in c)e+="\x26"+h+"\x3d"+c[h];return e},onFileUploadFailed:function(a){var b=f.EVENTS;a.dfd&&a.dfd.reject(a);this.filesToUpload.remove(a);
this.publish(b.ON_UPLOAD_FAILED,{item:a},this)},onFileUploaded:function(a){var b=this,e=f.EVENTS;setTimeout(function(){b.publish(e.STATUS,{message:""+a.file.name+" uploaded to "+a.dstDir,messageArgs:{}},b);a.dfd&&a.dfd.resolve(a);b.filesToUpload.remove(a);b.publish(e.ON_UPLOAD_FINISH,{item:a})},500)},getUploadUrl:function(){if(r("nserver"))return this.serviceUrl.replace("/smd","/upload/?");var a=""+decodeURIComponent(this.serviceUrl),a=a.replace("view\x3drpc","view\x3dupload"),a=a.replace("../../../../",
"./"),a=a+"\x26service\x3d"+this.serviceClass;return a+".put\x26callback\x3dnada"},initXHRUpload:function(a,b,c,g){var e=new XMLHttpRequest;b=""+this.getUploadUrl()+("mount\x3d"+encodeURIComponent(g));b+="\x26dstDir\x3d"+encodeURIComponent(c);var h=this;c=e.upload;c.addEventListener("progress",function(b){if(b.lengthComputable)b={item:a,progress:b},a.isLoading=!0,a.dfd.progress(b);else h.onFileUploaded(a)}.bind(this),!1);e.onreadystatechange=function(){if(4==e.readyState){if(e.responseText&&"OK"!=
e.responseText){var b=d.getJson(e.responseText);!b&&e.responseText.indexOf("Fata Error")&&(b={result:[e.responseText],code:1});if(b&&b.result&&v.isArray(b.result)&&0<b.result.length){for(var c=null,g=0;g<b.result.length;g++)h.publish(f.EVENTS.ERROR,"Error uploading : "+a.name+" "+b.result[g],h),c=b.result[g];c&&(a.error=c);h.onFileUploadFailed(a);h.submitNext();return}b&&b.error&&(h.publish(f.EVENTS.ERROR,"Error uploading : "+a.name+" "+b.error.message,h),h.onFileUploadFailed(a))}h.onFileUploaded(a);
h.submitNext()}}.bind(this);c.onerror=function(){h.publish(f.EVENTS.ERROR,"Error uploading : "+a.name,h)};e.open("POST",b,!0);return e},hasLoadingItem:function(){for(var a=0;a<this.filesToUpload.length;a++)if("loading"==this.filesToUpload[a].status)return this.filesToUpload[a];return!1},upload:function(a,b,c,d,f){f=[];for(var e=0;e<a.length;e++){var g={file:a[e],dstDir:""+c,mount:""+b,callee:d,view:d,dfd:new t};f.push(g.dfd);this.filesToUpload.push(g)}this.submitNext();return f},sendFileUsingFormData:function(a,
b){var e=new FormData;e.append("userfile_0",b.file);a.send(e)},sendFileMultipart:function(a){a.status="loading";var b=this.initXHRUpload(a,"",a.dstDir,a.mount);this.publish(f.EVENTS.ON_UPLOAD_BEGIN,{item:a,name:a.name},this);window.FormData&&this.sendFileUsingFormData(b,a)},submitNext:function(){var a=this.getNextUploadItem();a&&this.sendFileMultipart(a)},getNextUploadItem:function(){for(var a=0;a<this.filesToUpload.length;a++)if(!this.filesToUpload[a].status)return this.filesToUpload[a];return!1},
onError:function(a){if(a)if(1===a.code){if(a.message&&v.isArray(a.message)){this.publish(f.EVENTS.ERROR,a.message.join("\x3cbr/\x3e"),this);return}}else 0===a.code&&this.publish(f.EVENTS.STATUS,"Ok",this);this.publish(f.EVENTS.ERROR,{error:a},this)},addError:function(a){var b=this;a.addCallback(function(){b.onError()})},downloadItem:function(a,b){return this.callMethod(f.OPERATION.DOWNLOAD,[a],b,!0)},downloadTo:function(a,b,c,d,g){if(g){var e=this,h=function(a){var b=!1;a&&a.error&&1==a.error.code&&
(b=!0);e.publish(f.EVENTS.ON_DOWNLOAD_TO_END,{terminatorItem:g,failed:b},this);d(arguments)};e.publish(f.EVENTS.ON_DOWNLOAD_TO_BEGIN,{dst:g,url:a,items:[g]},this)}return this.callMethod(f.OPERATION.DOWNLOAD_TO,[a,b,c],h,!0)},find:function(a,b,c){try{return this.callMethod(f.OPERATION.FIND,[a,b],c,!0)}catch(u){logError(u,"find")}},getContentSync:function(a,b,c,d){},getContent:function(a,b,g,k){if(this.getContentE){var e=this.getContentE.apply(this,arguments);if(e)return e}return r("php")?(e=d.buildPath(a,
b,!1),this.callMethod(f.OPERATION.GET_CONTENT,[e,!1,!1],g,!1)):this._getText(c.toUrl(a).replace("main.js","")+"/"+b,{sync:!1,handleAs:"text"}).then(function(a){try{g&&g(a)}catch(y){logError(y,"error running RPC")}})},setContent:function(a,b,c,d){this.publish(f.EVENTS.ON_CHANGED_CONTENT,{mount:a,path:b,content:c});this.publish(f.EVENTS.ON_STATUS_MESSAGE,{text:"Did save file : "+a+"://"+b});if(this.setContentE){var e=this.setContentE.apply(this,arguments);if(e)return e}return this.callMethod(f.OPERATION.SET_CONTENT,
[a,b,c],d,!0)},onMessages:function(a){if((a=d.getJson(a.events))&&v.isArray(a))for(var b=0;b<a.length;b++){var c={path:a[b].relPath};d.mixin(c,a[b]);this.publish(a[b].clientEvent,c,this)}},onErrors:function(a){},init:function(){this.stores=[];this.filesToUpload=[]},callMethodEx:function(a,b,c,g,k){var e=a||this.serviceClass,h=this;if(!this.serviceObject[e][b]){if(!0===k)this.onError({code:1,message:["Sorry, server doesnt know "+b]});return null}a={};a=d.mixin(a,this.config.RPC_PARAMS.rpcFixedParams);
a[this.config.RPC_PARAMS.rpcUserField]=this.config.RPC_PARAMS.rpcUserValue;this.serviceObject.extraArgs=a;this.serviceObject.signatureField=this.config.RPC_PARAMS.rpcSignatureField;this.serviceObject.signatureToken=this.config.RPC_PARAMS.rpcSignatureToken;this.serviceObject[e][b](c).then(function(a){try{g&&g(a)}catch(C){console.error("bad news : callback for method "+b+" caused a crash in service class "+e)}a&&a.error&&3==a.error.code&&setTimeout(function(){h.onMessages(a.error)},50);if(a&&a.error&&
a.error&&0!==a.error.code)h.onError(a.error);else h.publish(f.EVENTS.STATUS,{message:"Ok!"},this)},function(a){h.onError(a)})},callMethod:function(a,b,c,g){var e=this,h=this.serviceClass;try{if(!this.serviceObject[h][a]){if(!0===g)this.onError({code:1,message:["Sorry, server doesnt know "+a]});return null}h={};h=d.mixin(h,this.config.RPC_PARAMS.rpcFixedParams);h[this.config.RPC_PARAMS.rpcUserField]=this.config.RPC_PARAMS.rpcUserValue;this.serviceObject.extraArgs=h;this.serviceObject.signatureField=
this.config.RPC_PARAMS.rpcSignatureField;this.serviceObject.signatureToken=this.config.RPC_PARAMS.rpcSignatureToken;var k=this.serviceObject[this.serviceClass][a](b);k.then(function(b){try{c&&c(b)}catch(C){console.error("crashed in "+a),logError(C,"error running RPC")}b&&b.error&&3==b.error.code&&setTimeout(function(){e.onMessages(b.error)},50);if(b&&b.error&&b.error&&1==b.error.code)e.onError(b.error);else!1!==g&&e.publish(f.EVENTS.STATUS,{message:"Ok!"},this)},function(a){e.onError(a)});return k}catch(x){console.error("crash calling method"+
x,arguments),e.onError(x),logError(x,"error ")}},__initService:function(){this.filesToUpload=[];!this.serviceObject&&this.serviceUrl&&(this.serviceObject=new w(decodeURIComponent(this.serviceUrl)),this.serviceObject.config=this.config)}})})},"xfile/manager/FileManagerActions":function(){define(["dcl/dcl","xide/types","xide/utils"],function(p,l,k){return p(null,{declaredClass:"xfile/manager/FileManagerActions",_publishProgress:function(f,a,d,l,p){a={terminatorItem:a,failed:l,items:d||a};k.mixin(a,
p);this.publish(f,a,this)},doOperation:function(f,a,d,k,l,p){var n=this,m=f.substring(0,1).toUpperCase()+f.substring(1),c="on"+m+"End";n._publishProgress("on"+m+"Begin",d,k,!1,l);return this.runDeferred(null,f,a,p).then(function(){n._publishProgress(c,d,k,!1,l)},function(a){n._publishProgress(c,d,k,!0,l)})},deleteItems:function(f,a,d){return this.doOperation(l.OPERATION.DELETE,[f,a,!0],f,f,null,d)},copyItem:function(f,a,d,k){return this.doOperation(l.OPERATION.COPY,[f,a,d,!1],f,f,{dst:a},k)},mkdir:function(f,
a,d){return this.doOperation(l.OPERATION.NEW_DIRECTORY,[f,a],a,null,null,d)},mkfile:function(f,a,d){return this.doOperation(l.OPERATION.NEW_FILE,[f,a,d||""],a)},rename:function(f,a,d){return this.doOperation(l.OPERATION.RENAME,[f,a,d],a)},moveItem:function(f,a,d,k,p,t){return this.doOperation(l.OPERATION.MOVE,[f,a,d,k,p],f,null,null,t)},compressItem:function(f,a,d,k){return this.doOperation(l.OPERATION.COMPRESS,[f,a,d],a)},extractItem:function(f,a,d){return this.doOperation(l.OPERATION.EXTRACT,[f,
a],a)}})})},"xfile/manager/MountManager":function(){define("dcl/dcl dojo/_base/lang xdojo/has xide/manager/ResourceManager xide/mixins/ReloadMixin xide/mixins/EventedMixin xide/types xide/utils dojo/Deferred".split(" "),function(p,l,k,f,a,d,n,w,t){return p([f,d.dcl,a.dcl],{declaredClass:"xfile.manager.MountManager",serviceClass:"XApp_Resource_Service",mountData:null,didReload:!1,editMount:function(a){},removeMount:function(a){},getMounts:function(){return this.mountData},_onDialogOk:function(a,d,
c){var f=w.toOptions(d),k=this;a=null!=c.name;d={"class":"cmx.types.Resource",enabled:!0};for(var g=0;g<f.length;g++){var e=f[g];null==e.user?d[e.name]=e.value:(d.config||(d.config={}),d.config[e.name]=e.value)}f="";d.label?f=d.label:d.config.label&&(f=d.config.label);d.name=""+(null!=c.name?c.name:f.toLowerCase());"FILE_PROXY"===d.config.type?(d.path=""+d.path+"",l.mixin(d,d.config)):"REMOTE_FILE_PROXY"===d.config.type&&(d.path=d.name+"://");c=function(){k.ls(function(a){k.onMountDataReady(a)})};
a?this.updateResource(d,!1,c):this.createResource(d,!1,c)},registerLocalMount:function(a){},registerFTP:function(a){},registerSFTP:function(a){},registerDropbox:function(a){},registerWebDav:function(){},onMountDataReady:function(a){this.mountData=a;this.publish(n.EVENTS.ON_MOUNT_DATA_READY,{data:a});var d=this;setTimeout(function(){d.publish(n.EVENTS.ON_MOUNT_DATA_READY,{data:a})},4E3)},check:function(){this.serviceObject||this._initService()},init:function(){this.ctx.getFileManager()&&(this.serviceObject=
this.ctx.getFileManager().serviceObject)},createResource:function(a,d,c){return this.callMethodEx(null,"createResource",[a,d],c,!0)},removeResource:function(a,d,c){return this.callMethodEx(null,"removeResource",[a,!0],c,!0)},updateResource:function(a,d,c){return this.callMethodEx(null,"updateResource",[a,!0],c,!0)},ls:function(a){function d(c){k("debug")||(c=c[0]);this.mountData=c;this.onMountDataReady(c);a&&a(c)}if(!_.isEmpty(this.prefetch)){var c=new t;c.resolve(this.prefetch);d.apply(this,[this.prefetch]);
delete this.prefetch;return c}return this.runDeferred(null,"ls",[]).then(d.bind(this))}})})},"xfile/manager/BlockManager":function(){define(["dcl/dcl","xide/manager/ManagerBase","xide/mixins/ReloadMixin","xblox/manager/BlockManager"],function(p,l,k,f){return p([l,f,k.dcl],{declaredClass:"xfile/manager/BlockManager",currentItem:null,setScriptFunctions:function(a,d,f){this.inherited(arguments)}})})},"xfile/views/FileConsole":function(){define("xdojo/declare dcl/dcl xide/types xide/utils xide/mixins/PersistenceMixin xide/layout/_TabContainer xide/views/_Console xide/views/_ConsoleWidget xfile/views/FileSize xide/views/ConsoleView xide/lodash dojo/has!xace?xace/views/Editor".split(" "),
function(p,l,k,f,a,d,n,w,t,r,m,c){function q(){return l(null,{owner:null,onServerResponse:function(a,c,b){if(a&&c&&a.owner&&a.owner.onServerResponse)return a.owner.onServerResponse(c,b)},runBash:function(a,c,b,d){var e=this,f=e.ctx.fileManager;c=f.serviceObject.base64_encode(c);f.runDeferred("XShell","run",["sh",c,b]).then(function(b){d&&$(d).find(".consoleRunningCommand").remove();e.onServerResponse(a,b,!1)})},runPHP:function(a,c,b){var e=this,d=e.ctx.fileManager;c=d.serviceObject.base64_encode(c);
d.runDeferred("XShell","run",["php",c,b]).then(function(b){e.onServerResponse(a,b,!1)})},runJavascript:function(a,c,b,d){b=(new Function("{"+c+"; }")).call(b,d);return null!=b?(this.onServerResponse(a,b),b):c},onConsoleCommand:function(a,c){a=a.console;if("sh"===a.type){var b=this.onServerResponse(a,"\x3cspan class\x3d'consoleRunningCommand fa-spinner fa-spin'\x3e\x3c/span\x3e\x3cpre style\x3d'font-weight: bold'\x3e# "+c+"\x3c/pre\x3e",!0),e=null;if(this.owner&&this.owner.getCurrentFolder){var d=
this.owner.getCurrentFolder();d&&(e=f.buildPath(d.mount,d.path,!1))}return this.runBash(a,c,e,b)}if("php"===a.type)return e=null,a.isLinked()&&(e=this.getCurrentPath()),this.runPHP(a,c,e);if("javascript"===a.type)return this.runJavascript(a,c)},onConsoleEnter:function(a,c){return this.onConsoleCommand(a,c)}})}function v(){var a=l(r.Editor,{didAddMCompleter:!1,multiFileCompleter:null,blockScope:null,driverInstance:null,onACEReady:function(a){},onEditorCreated:function(a,b){this.inherited(arguments);
this.onACEReady(a)}});return l(r,{EditorClass:a,onAddEditorActions:l.superCall(function(a){return function(b){a.call(this,b);b=b.actions;m.find(b,{command:"File/Save"});b.remove(m.find(b,{command:"File/Save"}));b.remove(m.find(b,{command:"File/Reload"}))}}),logTemplate:'\x3cpre style\x3d"font-size:100%;padding: 0px;" class\x3d""\x3e    ${time} - ${result}\x3c/pre\x3e',_parse:function(a,b,c){var e=""+b;0<e.indexOf("{{")||0<e.indexOf("}}")?e=_parser.parse(k.EXPRESSION_PARSER.FILTREX,e,this,{variables:a.getVariablesAsObject(),
delimiters:{begin:"{{",end:"}}"}}):(a=a.parseExpression(b,null,null,null,c))&&(e=a);return e},parse:function(a,b){var c=this.driverInstance;return c&&c.blockScope?this._parse(c.blockScope,a,b):a}})}p=p("xfile.views.FileConsole",null,{isStatusbarOpen:!1,resizeToParent:!0,__bottomTabContainer:null,onCloseStatusPanel:function(a){},onOpenStatusPanel:function(a){if(!a._tabs){var c=this,b=this.__bottomTabContainer||f.addWidget(d,{direction:"below"},null,a,!0);this.__bottomTabContainer=a._tabs=b;var g=v(),
k=new (q());k.ctx=c.ctx;k.owner=this;var l=b.createTab("Bash","fa-terminal");l.add(g,{type:"sh",title:"Bash",icon:"fa-terminal",ctx:c.ctx,owner:c,value:"ls -l --color\x3dalways"},null,!0).delegate=k;l._onShown();l=b.createTab("Javascript","fa-code").add(g,{type:"javascript",title:"Javascript",ctx:c.ctx,value:"return 2+2;",owner:c},null,!1);l.delegate=k;var l=b.createTab("PHP","fa-terminal").add(g,{type:"php",title:"PHP",ctx:c.ctx,value:"\x3c?php \n\n\x3e",owner:c},null,!1),m=b.createTab("Sizes","fa-bar-chart");
this.__fileSize=m.add(t,{owner:this,ctx:c.ctx},null,!1);this._on("openedFolder",function(a){f.destroy(c.__fileSize);m.resize();c.resize();c.__fileSize=null;c.__fileSize=m.add(t,{owner:c,ctx:c.ctx},null,!1);f.resizeTo(c.__fileSize,m,!0,!0);c.__fileSize.startup()});a.add(b)}return this.inherited(arguments)},onStatusbarCollapse:function(a){var c=null;this.isStatusbarOpen?(c=this.getBottomPanel(!1,.2),c.collapse(),this.onCloseStatusPanel(a),a&&a.removeClass("fa-caret-down"),a&&a.addClass("fa-caret-up")):
((c=this._getBottom())?c.expand():c=this.getBottomPanel(!1,.2),this.onOpenStatusPanel(c),a&&a.removeClass("fa-caret-up"),a&&a.addClass("fa-caret-down"));this.isStatusbarOpen=!this.isStatusbarOpen;c.resize()}});p.createEditor=function(a,d,b,h){var e={filePath:"",fileName:""};d={_permissions:[],item:e,value:d,style:"padding:0px;top:0 !important",iconClass:"fa-code",options:f.mixin(h,{filePath:e.path,fileName:e.name}),storeDelegate:{},title:"No Title"};f.mixin(d,h);a=f.addWidget(c,d,b,a,!0,null,null,
!1);a.resize();return a};p.createShellViewDelegate=q;p.createShellViewClass=v;return p})},"xfile/data/DriverStore":function(){define("dojo/_base/declare dojo/Deferred xide/data/ObservableStore xide/data/TreeMemory xfile/data/Store xide/manager/ServerActionBase xide/utils".split(" "),function(p,l,k,f,a,d,n){a=a.Implementation;return p("driverFileStore",[f,k,d.declare],n.mixin(a(),{driver:null,addDot:!1,rootSegment:"/",getRootItem:function(){var a=this._root;return a?a:this._root={_EX:!1,path:"/",name:"/",
mount:this.mount,directory:!0,virtual:!0,_S:this,getPath:function(){return this.path}}},_filter:function(a){return a},_request:function(a){var d=this,f=this;if("."===a||"/"===a){var k=new l,c=f.driver.callCommand("LSProg",{override:{args:["/*"]}});c.then(function(a){a=a.files;_.each(a,function(a){a.parent="."});a=f._filter(a);a=d._normalize({items:[{mount:"root",path:"/",children:a,name:"/",isDir:!0}]});f._parse(a);a=a.children||a;k.resolve(a)})}else k=new l,c=f.driver.callCommand("LSProg",{override:{args:[a+
(f.glob||"/*")]}}),c.then(function(c){c=c.files;_.each(c,function(c){c.parent=a});c=f._filter(c);c=d._normalize({items:[{mount:"root",path:a,children:c,isDir:!0}]});f._parse(c);c=c.children||c;k.resolve(c)});return k}}))})},"xfile/views/FileGridLight":function(){define("xdojo/declare dojo/dom-class dojo/Deferred xide/types xide/utils xide/views/History xaction/DefaultActions xfile/views/GridLight xfile/factory/Store xide/model/Path xfile/model/File xfile/types xlang/i18".split(" "),function(p,l,k,
f,a,d,n,w,t,r,m,c,q){r=c.DEFAULT_FILE_GRID_PERMISSIONS;var v=p("xfile.views.FileGrid",w,{resizeAfterStartup:!0,menuOrder:{File:110,Edit:100,View:50,Settings:20,Navigation:10,Window:5},groupOrder:{Clipboard:110,File:100,Step:80,Open:70,Organize:60,Insert:10,Navigation:5,Select:0},tabOrder:{Home:100,View:50,Settings:20,Navigation:10},noDataMessage:"\x3cspan/\x3e",_history:null,options:a.clone(f.DEFAULT_GRID_OPTIONS),_columns:{},toolbarInitiallyHidden:!0,itemType:f.ITEM_TYPE.FILE,permissions:r,contextMenuArgs:{limitTo:null},
setState:function(a){this.inherited(arguments);var c=this,b=c.collection,d=a.store.path;b.getSync(d);var f=c.refresh();try{f.then(function(){b.getItem(d,!0).then(function(a){c.openFolder(a)})})}catch(z){console.error("error restoring folder state")}return f},postMixInProperties:function(){var a=this.state;a&&a._columns&&(this._columns=a._columns);this.columns||(this.columns=this.getColumns());!this.collection&&this.state&&(a=this.state.store,this.collection=t.createFileStore(a.mount,a.storeOptions,
this.ctx.config).getDefaultCollection());return this.inherited(arguments)},getState:function(a){a=this.inherited(arguments)||{};a.store={mount:this.collection.mount,path:this.getCurrentFolder().path,storeOptions:this.collection.options};a._columns={};_.each(this._columns,function(c){a._columns[c.label]=!this.isColumnHidden(c.id)},this);return a},onSaveLayout:function(a){a=a.data;var c=this.getState();a.widgets.push({widget:this.declaredClass,state:c});return a},formatColumn:function(c,d,b){var e=
this.selectedRenderer?this.selectedRenderer.prototype:this;if(e.formatColumn&&(e=e.formatColumn.apply(arguments))||b.renderColumn&&(e=b.renderColumn.apply(this,arguments)))return e;switch(c){case "fileType":if("folder"==d)return q.localize("kindFolder");if(b.mime){var e="kind"+(b.mime.split("/")[1]||"unknown").toUpperCase(),f=q.localize(e);return e!==f?f:d}case "name":var f=b&&null!=b.directory&&!0===b.directory,g=!1===b.read&&!1===b.write,k=".."==b.name,e="",e=f?k?"fa fa-level-up itemFolderList":
g?"fa fa-lock itemFolderList":"fa fa-folder itemFolderList":g?"fa fa-lock itemFolderList":"itemFolderList fa "+a.getIconClass(b.path),f=!0===b.showPath?b.path:d;return'\x3cspan class\x3d"'+e+'""\x3e\x3c/span\x3e\x3cspan class\x3d"name fileGridNameNode" style\x3d"vertical-align: middle;padding-top: 0px"\x3e'+f+"\x3c/span\x3e";case "sizeBytes":return b.size;case "fileType":return a.capitalize(b.fileType||"unknown");case "mediaInfo":return b.mediaInfo||"unknown";case "owner":return b&&(e=b.owner)&&e.user?
e.user.name:"";case "modified":if(""!==d)return f=null==!b.directory,!f&&q.translations.dateFormat?q.formatDate(d).replace("ms",""):""}return d},getColumns:function(){function a(a,d,e,f){null!=c._columns[a]&&(f=!c._columns[a]);c.columns.push({renderExpando:"Name"===a,label:a,field:d,sortable:e,formatter:function(a,b){return c.formatColumn(d,a,b)},hidden:f})}var c=this;this.columns=[];a("Name","name",!0,!1);a("Type","fileType",!0,!0);a("Path","path",!0,!0);a("Size","sizeBytes",!0,!1);a("Modified",
"modified",!0,!1);a("Owner","owner",!0,!0);a("Media","mediaInfo",!0,!0);return this.columns},_focus:function(){var a=this.getRows();a[0]&&(a=this.row(a[0]),this.focus(a.data))},setQueryEx:function(a,c){if(!a)return console.error("bad, no item!"),!1;if(!a.directory)return!1;this._lastPath=a.getPath();var b=this,d=new k;if(b){var e=this.collection;"."===a.path?(e.resetQueryLog(),b.set("collection",e.getDefaultCollection(a.getPath())),d.resolve&&d.resolve()):e.open(a).then(function(c){e.resetQueryLog();
b.set("collection",e.getDefaultCollection(a.getPath()));d.resolve&&d.resolve(c)});return d}console.error("have no grid")},getCurrentFolder:function(){var a=this.getSelectedRenderer();if(a&&a.getCurrentFolder&&(a=a.getCurrentFolder.apply(this))){if(a.isBack){var c=this.collection.getSync(a.rPath);c&&(a=c)}return a}if((a=this.getRows()[0])&&(a._S||a._store)){if(1==a.isBack&&(c=this.getHistory().getNow()))return this.collection.getSync(c);if(a=a._S.getParent(a))return a}return null},getClass:function(){return v},
getHistory:function(){this._history||(this._history=new d);return this._history},renderArray:function(a,c){_.find(arguments[0],{isBack:!0});return this.inherited(arguments)},startup:function(){if(!this._started){var a=this.inherited(arguments);l.add(this.domNode,"xfileGrid");this.set("loading",!0);if(this.permissions){var c=n.getDefaultActions(this.permissions,this,this),c=c.concat(this.getFileActions(this.permissions));this.addActions(c)}this._history=new d;var b=this;this.subscribe(f.EVENTS.ON_CLIPBOARD_COPY,
function(a){a.type===b.itemType&&(b.currentCopySelection=a.selection,b.refreshActions())});b._on("noData",function(){b.getRows();if(!(0<b._total)){var a=b._history.getNow();a&&"./."!==a&&b.renderArray([{name:"..",path:"..",rPath:a,sizeBytes:0,size:"",icon:"fa-level-up",isBack:!0,modified:"",_S:b.collection,directory:!0,_EX:!0,children:[],mayHaveChildren:!1}])}});this.on("dgrid-refresh-complete",function(){var a=b.getRows();a&&1<a.length&&(a=_.find(a,{isBack:!0}))&&(b.removeRow(a),b.refresh())});this._on("openFolder",
function(a){b.set("title",a.item.name)});b.selectedRenderer&&(a=this.refresh())&&a.then(function(){b.set("loading",!1);b.setRenderer(b.selectedRenderer,!1)});this._on("onChangeRenderer",function(){b.refresh()});setTimeout(function(){b.resize()},500);return a}}});v.prototype.Module=v;v.Module=v;v.createDefault=function(c,d,b,f,k,l){d=a.mixin({collection:l.getDefaultCollection(),_parent:b,Module:v,ctx:c},d||{});d=a.addWidget(v,d,null,b,k,null,null,!0,null);f&&c.getWindowManager().registerView(d,!1);
return d};v.DEFAULT_PERMISSIONS=r;return v})},"xfile/views/GridLight":function(){define("xdojo/declare xide/types xgrid/ListRenderer xfile/ThumbRenderer xgrid/TreeRenderer xgrid/GridLite xgrid/MultiRenderer xfile/FileActions xide/views/_LayoutMixin xgrid/KeyboardNavigation xgrid/Selection xide/mixins/_State xide/widgets/_Widget".split(" "),function(p,l,k,f,a,d,n,w,t,r,m,c,q){k=[k,f,a];p=p.classFactory("multiRenderer",{},k,n.Implementation);l=d.createGridClass("xfile.views.GridLight",{},{SELECTION:{CLASS:m},
KEYBOARD_SELECTION:!0,COLUMN_HIDER:!0,COLUMN_REORDER:!1,ACTIONS:l.GRID_FEATURES_LITE.ACTIONS,ITEM_ACTIONS:{CLASS:w},SPLIT:{CLASS:t},KEYBOARD_NAVIGATION:{CLASS:r},STATE:{CLASS:c},WIDGET:{CLASS:q}},{RENDERER:p},{renderers:k,selectedRenderer:a});l.DEFAULT_RENDERERS=k;l.DEFAULT_MULTI_RENDERER=p;return l})},"xfile/manager/Electron":function(){define(["dcl/dcl","xdojo/has","xide/utils","dojo/Deferred"],function(p,l,k,f){l("electronx");return p(null,{declaredClass:"xfile.manager.Electron",require:function(){return window.eRequire.apply(null,
arguments)},srequire:function(){return this.require("electron").remote.require.apply(null,arguments)},remote:function(){return(0,window.eRequire)("electron").remote},getContentE:function(a,d,l,p){var n=(this.ctx||sctx).getResourceManager().getVariable("VFS_CONFIG")||{};p=new f;this.require("os");this.require("electron");var r=this.require("path"),m=this.require("fs");a=a.replace("/","");if(n[a]){a=n[a];if(!a)return console.error("cant resolve file "+a+"/"+d),!1;d=d.replace("./","/");d=k.replaceAll("/",
r.sep,d);a=r.resolve(a+r.sep+d);if(m.existsSync(a)){d=m.statSync(a).size;r=new Buffer(d);a=m.openSync(a,"r");if(!d)return"";m.readSync(a,r,0,d,0);m.closeSync(a);m=r.toString();p.resolve(m);l&&l(m)}else return!1;return p}console.error("open in os failed: have no VFS config for "+a)},setContentE:function(a,d,l,p){var n=(this.ctx||sctx).getResourceManager().getVariable("VFS_CONFIG")||{},r=new f;this.require("os");var m=this.require("path"),c=this.require("fs");a=a.replace("/","");if(n[a]){a=n[a];if(!a)return!1;
d=d.replace("./","/");d=k.replaceAll("/",m.sep,d);m=m.resolve(a+m.sep+d);if(c.existsSync(m))try{c.writeFileSync(m,l),p&&p(),r.resolve()}catch(q){return console.error("error saving file "+m),!1}else return console.error("path "+m+" doesnt exists, fallback to legacy setContent"),!1;return r}console.error("open in os failed: have no VFS config for "+a)}})})}}});
//# sourceMappingURL=xfile.js.map